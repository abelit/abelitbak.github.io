<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.9" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.39" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://github.com/abelit/abelit-datapeacock.git/guide/database/mysql/ha/hasolution.html"><meta property="og:site_name" content="数之雀"><meta property="og:title" content="高可用方案"><meta property="og:description" content="MySQL 高可用 什么是高可用性？ 高可用性是指系统或服务在发生故障或中断时继续运行并保持可用的能力。高度可用的系统可确保组织的关键任务系统和应用程序始终正常运行。这对于医疗保健、金融和航空等行业的组织尤其重要，因为在这些行业中，关键任务系统的故障可能会造成严重后果。 高可用性通常表示为服务级别协议 (SLA) 定义的正常运行时间的百分比，得分为 1..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-05-11T14:06:18.000Z"><meta property="article:author" content="Abelit"><meta property="article:modified_time" content="2024-05-11T14:06:18.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"高可用方案","image":[""],"dateModified":"2024-05-11T14:06:18.000Z","author":[{"@type":"Person","name":"Abelit","url":"https://github.com/abelit"}]}</script><link rel="icon" href="/favicon.ico"><link rel="icon" href="/assets/icon/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icon/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icon/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icon/chrome-192.png" type="image/png" sizes="192x192"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><link rel="apple-touch-icon" href="/assets/icon/apple-icon-152.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-TileImage" content="/assets/icon/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><title>高可用方案 | 数之雀</title><meta name="description" content="MySQL 高可用 什么是高可用性？ 高可用性是指系统或服务在发生故障或中断时继续运行并保持可用的能力。高度可用的系统可确保组织的关键任务系统和应用程序始终正常运行。这对于医疗保健、金融和航空等行业的组织尤其重要，因为在这些行业中，关键任务系统的故障可能会造成严重后果。 高可用性通常表示为服务级别协议 (SLA) 定义的正常运行时间的百分比，得分为 1...">
    <link rel="preload" href="/assets/style-IQdVitae.css" as="style"><link rel="stylesheet" href="/assets/style-IQdVitae.css">
    <link rel="modulepreload" href="/assets/app-DR5J2daJ.js"><link rel="modulepreload" href="/assets/hasolution.html-BBgraHF5.js"><link rel="modulepreload" href="/assets/mysql_ndb_cluster_overview-tkRitJow.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">数之雀</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="开发"><!--[--><span class="font-icon icon iconfont icon-development" style=""></span>开发<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">程序设计语言</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/go/" aria-label="Go"><span class="font-icon icon iconfont icon-language-golang" style=""></span>Go<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/python/" aria-label="Python"><span class="font-icon icon iconfont icon-language-python" style=""></span>Python<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/rust/" aria-label="Rust"><span class="font-icon icon iconfont icon-language-rust" style=""></span>Rust<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/javascript/" aria-label="Javascript"><span class="font-icon icon iconfont icon-language-javascript" style=""></span>Javascript<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/typescript/" aria-label="Typescript"><span class="font-icon icon iconfont icon-language-typescript" style=""></span>Typescript<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">数据结构与算法</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/algorithm/" aria-label="Data Structure &amp; Algorithm"><span class="font-icon icon iconfont icon-algorithm" style=""></span>Data Structure &amp; Algorithm<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">后台框架</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/backend/flask/" aria-label="Flask"><span class="font-icon icon iconfont icon-flask" style=""></span>Flask<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/backend/django/" aria-label="Django"><span class="font-icon icon iconfont icon-django" style=""></span>Django<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/fastapi/" aria-label="FastAPI"><span class="font-icon icon iconfont icon-fastapi" style=""></span>FastAPI<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/gin/" aria-label="GIN"><span class="font-icon icon iconfont icon-gin" style=""></span>GIN<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/beego/" aria-label="Beego"><span class="font-icon icon iconfont icon-beego" style=""></span>Beego<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">前端框架</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/frontend/vue/" aria-label="Vue"><span class="font-icon icon iconfont icon-vue" style=""></span>Vue<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/frontend/react/" aria-label="React"><span class="font-icon icon iconfont icon-react" style=""></span>React<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">UI框架</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/ui/ant-design-vue.html" aria-label="ant-design-vue"><span class="font-icon icon iconfont icon-antdesign" style=""></span>ant-design-vue<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/ui/ant-design-react.html" aria-label="ant-design-react"><span class="font-icon icon iconfont icon-antdesign" style=""></span>ant-design-react<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/ui/element-plus.html" aria-label="element-plus"><span class="font-icon icon iconfont icon-eleme" style=""></span>element-plus<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/ui/vuetify.html" aria-label="vuetify"><span class="font-icon icon iconfont icon-vuetify" style=""></span>vuetify<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">模板</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="vp-link" href="https://pro.antdv.com/" rel="noopener noreferrer" target="_blank" aria-label="Ant Design Pro(Vue)"><!---->Ant Design Pro(Vue)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://pro.ant.design/" rel="noopener noreferrer" target="_blank" aria-label="Ant Design Pro(React)"><!---->Ant Design Pro(React)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://panjiachen.github.io/vue-element-admin-site/" rel="noopener noreferrer" target="_blank" aria-label="vue-element-admin"><!---->vue-element-admin<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://vvbin.cn/next/#/login?redirect=/dashboard" rel="noopener noreferrer" target="_blank" aria-label="vue-vben-admin"><!---->vue-vben-admin<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://pro.arco.design/" rel="noopener noreferrer" target="_blank" aria-label="Arco Design Pro"><!---->Arco Design Pro<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://github.com/vueleague/tpl-vue-admin-better?organization=vueleague&amp;organization=vueleague" rel="noopener noreferrer" target="_blank" aria-label="vue-admin-better"><!---->vue-admin-better<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="数据库"><!--[--><span class="font-icon icon iconfont icon-database" style=""></span>数据库<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">关系数据库</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/oracle/" aria-label="Oracle"><span class="font-icon icon iconfont icon-oracle" style=""></span>Oracle<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link active vp-link" href="/guide/database/mysql/" aria-label="MySQL"><span class="font-icon icon iconfont icon-mysql" style=""></span>MySQL<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/sqlite/" aria-label="SQlite"><span class="font-icon icon iconfont icon-sqlite" style=""></span>SQlite<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/postgresql/" aria-label="PostgreSQL"><span class="font-icon icon iconfont icon-postgresql" style=""></span>PostgreSQL<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/sqlserver/" aria-label="SQLServer"><span class="font-icon icon iconfont icon-sqlserver" style=""></span>SQLServer<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">非关系数据库</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/redis/" aria-label="Redis"><span class="font-icon icon iconfont icon-redis" style=""></span>Redis<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/mongo/" aria-label="MongoDB"><span class="font-icon icon iconfont icon-mongodb" style=""></span>MongoDB<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/couchdb/" aria-label="CouchDB"><span class="font-icon icon iconfont icon-couchdb" style=""></span>CouchDB<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/gauss/" aria-label="GaussDB"><span class="font-icon icon iconfont icon-opengauss" style=""></span>GaussDB<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/elasticsearch/" aria-label="ElasticSearch"><span class="font-icon icon iconfont icon-elasticsearch" style=""></span>ElasticSearch<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/hbase/" aria-label="HBase"><span class="font-icon icon iconfont icon-hbase" style=""></span>HBase<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/couchdb/" aria-label="CouchDB"><span class="font-icon icon iconfont icon-couchdb" style=""></span>CouchDB<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/clickhouse/" aria-label="ClickHouse"><span class="font-icon icon iconfont icon-clickhouse" style=""></span>ClickHouse<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="数据科学"><!--[--><span class="font-icon icon iconfont icon-datascience" style=""></span>数据科学<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">数据分析与挖掘</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/pandas/" aria-label="Pandas"><span class="font-icon icon iconfont icon-pandas-short" style=""></span>Pandas<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/numpy/" aria-label="Numpy"><span class="font-icon icon iconfont icon-numpy" style=""></span>Numpy<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/scipy/" aria-label="Scipy"><span class="font-icon icon iconfont icon-scipy" style=""></span>Scipy<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/sympy/" aria-label="Sympy"><span class="font-icon icon iconfont icon-sympy" style=""></span>Sympy<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">数据可视化</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/antv/" aria-label="Antv"><span class="font-icon icon iconfont icon-antv" style=""></span>Antv<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/echarts/" aria-label="Echarts"><span class="font-icon icon iconfont icon-echarts-footer-logo" style=""></span>Echarts<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/d3js/" aria-label="D3.js"><span class="font-icon icon iconfont icon-d3js" style=""></span>D3.js<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/thingjs/" aria-label="Thingjs"><span class="font-icon icon iconfont icon-thingjs" style=""></span>Thingjs<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/threejs/" aria-label="Threejs"><span class="font-icon icon iconfont icon-threejs" style=""></span>Threejs<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/matplotlib/" aria-label="Matplotlib"><span class="font-icon icon iconfont icon-matplotlib" style=""></span>Matplotlib<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/dashplotly/" aria-label="Dash/Plotly"><span class="font-icon icon iconfont icon-plotly" style=""></span>Dash/Plotly<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/highcharts/" aria-label="HighCharts"><span class="font-icon icon iconfont icon-highcharts" style=""></span>HighCharts<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">机器学习与深度学习</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/tensorflow/" aria-label="Tensorflow"><span class="font-icon icon iconfont icon-tensorflow" style=""></span>Tensorflow<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/pytorch/" aria-label="PyTorch"><span class="font-icon icon iconfont icon-pytorch" style=""></span>PyTorch<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/scikit-learn/" aria-label="Scikit-Learn"><span class="font-icon icon iconfont icon-scikitlearn" style=""></span>Scikit-Learn<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">商务智能报表</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/bi/tableau/" aria-label="Tableau"><span class="font-icon icon iconfont icon-tableau" style=""></span>Tableau<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/bi/powerbi/" aria-label="Power BI"><span class="font-icon icon iconfont icon-powerbi" style=""></span>Power BI<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/bi/finebi/" aria-label="Fine BI"><span class="font-icon icon iconfont icon-finebi" style=""></span>Fine BI<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/bi/pentaho/" aria-label="Pentaho"><span class="font-icon icon iconfont icon-pentaho" style=""></span>Pentaho<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="区块链"><!--[--><span class="font-icon icon iconfont icon-blockchain" style=""></span>区块链<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/blockchain/" aria-label="区块链"><!---->区块链<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/blockchain/coin/" aria-label="加密货币"><!---->加密货币<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Linux"><!--[--><span class="font-icon icon iconfont icon-linux" style=""></span>Linux<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/os/linux/administration/" aria-label="系统管理"><!---->系统管理<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/os/linux/program/" aria-label="内核编程"><!---->内核编程<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="DevOps"><!--[--><span class="font-icon icon iconfont icon-devops" style=""></span>DevOps<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/zabbix/" aria-label="Zabbix"><span class="font-icon icon iconfont icon-zabbix-outline" style=""></span>Zabbix<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/prometheus/" aria-label="Prometheus"><span class="font-icon icon iconfont icon-prometheus" style=""></span>Prometheus<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/openfalcon/" aria-label="Open-Falcon"><span class="font-icon icon iconfont icon-open-falcon" style=""></span>Open-Falcon<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/ansible/" aria-label="Ansible"><span class="font-icon icon iconfont icon-ansible" style=""></span>Ansible<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/terraform/" aria-label="Terraform"><span class="font-icon icon iconfont icon-terraform" style=""></span>Terraform<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/jenkins/" aria-label="Jenkins"><span class="font-icon icon iconfont icon-jenkins" style=""></span>Jenkins<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/nginx/" aria-label="Nginx"><span class="font-icon icon iconfont icon-nginx" style=""></span>Nginx<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/grafana/" aria-label="Grafana"><span class="font-icon icon iconfont icon-grafana" style=""></span>Grafana<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/teleport/" aria-label="Teleport"><span class="font-icon icon iconfont icon-teleport" style=""></span>Teleport<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/jumpserver/" aria-label="JumpServer"><span class="font-icon icon iconfont icon-jumpserver" style=""></span>JumpServer<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/nextcloud/" aria-label="Nextcloud"><span class="font-icon icon iconfont icon-nextcloud" style=""></span>Nextcloud<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="工具集"><!--[--><span class="font-icon icon iconfont icon-tool" style=""></span>工具集<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">常用工具</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/vim/" aria-label="Vim"><span class="font-icon icon iconfont icon-vim" style=""></span>Vim<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/vscode/" aria-label="VSCode"><span class="font-icon icon iconfont icon-vscode" style=""></span>VSCode<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/markdown/" aria-label="Markdown"><span class="font-icon icon iconfont icon-markdown" style=""></span>Markdown<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/tex/" aria-label="Tex"><span class="font-icon icon iconfont icon-tex" style=""></span>Tex<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/gitbook/" aria-label="Gitbook"><span class="font-icon icon iconfont icon-gitbook" style=""></span>Gitbook<!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://v2.vuepress.vuejs.org/" rel="noopener noreferrer" target="_blank" aria-label="VuePress"><span class="font-icon icon iconfont icon-vuepress" style=""></span>VuePress<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/git/" aria-label="Git"><span class="font-icon icon iconfont icon-git" style=""></span>Git<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/github/" aria-label="GitHub"><span class="font-icon icon iconfont icon-github" style=""></span>GitHub<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">文档主题</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="vp-link" href="https://v2.vuepress.vuejs.org/zh/" rel="noopener noreferrer" target="_blank" aria-label="VuePress"><!---->VuePress<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://vuepress-theme-hope.github.io/v2/" rel="noopener noreferrer" target="_blank" aria-label="Vuepres-Theme-Hope"><!---->Vuepres-Theme-Hope<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://vuepress-theme-mix.vercel.app/" rel="noopener noreferrer" target="_blank" aria-label="VuePress Mix Theme"><!---->VuePress Mix Theme<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="http://v2.vuepress-reco.recoluan.com/" rel="noopener noreferrer" target="_blank" aria-label="vuepress-theme-reco"><!---->vuepress-theme-reco<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="项目"><!--[--><span class="font-icon icon iconfont icon-project" style=""></span>项目<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="vp-link" href="https://github.com/abelit/abelit-archlinux.git" rel="noopener noreferrer" target="_blank" aria-label="Archlinux"><!---->Archlinux<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-item"><a class="vp-link" href="https://github.com/abelit/abelit-conky.git" rel="noopener noreferrer" target="_blank" aria-label="Conky"><!---->Conky<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-item"><a class="vp-link" href="https://github.com/abelit/abelit-pwdkeeper.git" rel="noopener noreferrer" target="_blank" aria-label="Password Keeper"><!---->Password Keeper<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul></button></div></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><div class="vp-nav-item"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="选择语言"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link active vp-link" href="/guide/database/mysql/ha/hasolution.html" aria-label="简体中文"><!---->简体中文<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/en/" aria-label="English"><!---->English<!----></a></li></ul></button></div></div><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/abelit/abelit-datapeacock" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">搜索</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/" aria-label="主页"><span class="font-icon icon iconfont icon-home" style=""></span>主页<!----></a></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable active"><span class="font-icon icon iconfont icon-note" style=""></span><a class="route-link active vp-link vp-sidebar-title" href="/guide/" aria-label="文档"><!---->文档<!----></a><!----></p><ul class="vp-sidebar-links"><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/" aria-label="指南"><span class="font-icon icon iconfont icon-creative" style=""></span>指南<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><span class="font-icon icon iconfont icon-database" style=""></span><span class="vp-sidebar-title">Database</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-oracle" style=""></span><span class="vp-sidebar-title">Oracle</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><span class="font-icon icon iconfont icon-mysql" style=""></span><span class="vp-sidebar-title">MySQL</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">高可用</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">MySQL高可用部署</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/mysql/ha/qa.html" aria-label="高可用常见问题"><!---->高可用常见问题<!----></a></li><li><a class="route-link active vp-link vp-sidebar-link vp-sidebar-page active" href="/guide/database/mysql/ha/hasolution.html" aria-label="高可用方案"><!---->高可用方案<!----></a></li></ul></section></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/mysql/dml.html" aria-label="DML"><!---->DML<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">MySQL监控</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/mysql/session.html" aria-label="会话"><!---->会话<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/mysql/partitioning.html" aria-label="分区"><!---->分区<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">备份与恢复</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">存储引擎</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/mysql/audit.html" aria-label="审计"><!---->审计<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/mysql/performance.html" aria-label="性能"><!---->性能<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">性能优化</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/mysql/user.html" aria-label="用户管理"><!---->用户管理<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">索引</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">锁</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-postgresql" style=""></span><span class="vp-sidebar-title">PostgreSQL</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-sqlserver" style=""></span><span class="vp-sidebar-title">SQL Server</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-sqlite" style=""></span><span class="vp-sidebar-title">SQLite</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-mongodb" style=""></span><span class="vp-sidebar-title">Mongo</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-opengauss" style=""></span><span class="vp-sidebar-title">Gausss</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-clickhouse" style=""></span><span class="vp-sidebar-title">ClickHouse</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-redis" style=""></span><span class="vp-sidebar-title">Redis</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-elasticsearch" style=""></span><span class="vp-sidebar-title">ElasticSearch</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-tidb" style=""></span><span class="vp-sidebar-title">TiDB</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-cassandra" style=""></span><span class="vp-sidebar-title">Cassandra</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-couchdb" style=""></span><span class="vp-sidebar-title">CouchDB</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-hbase" style=""></span><span class="vp-sidebar-title">HBase</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-etcd" style=""></span><span class="vp-sidebar-title">etcd</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-apachekylin" style=""></span><span class="vp-sidebar-title">Apache Kylin</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-devops" style=""></span><span class="vp-sidebar-title">DevOps</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-os" style=""></span><span class="vp-sidebar-title">OS</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-cncf" style=""></span><span class="vp-sidebar-title">云原生</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-ai" style=""></span><span class="vp-sidebar-title">人工智能</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-infosec" style=""></span><span class="vp-sidebar-title">信息安全</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-blockchain" style=""></span><span class="vp-sidebar-title">区块链</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-tool" style=""></span><span class="vp-sidebar-title">工具集</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-development" style=""></span><span class="vp-sidebar-title">开发</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-opensource-fill" style=""></span><span class="vp-sidebar-title">开源软件</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-mindmap" style=""></span><span class="vp-sidebar-title">思维导入与学习路径</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-finance-fill" style=""></span><span class="vp-sidebar-title">投资理财</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-datascience" style=""></span><span class="vp-sidebar-title">数据科学</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-algorithm" style=""></span><span class="vp-sidebar-title">数据结构与算法</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-markdown" style=""></span><span class="vp-sidebar-title">文档管理</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-iot" style=""></span><span class="vp-sidebar-title">物联网</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/slides/" aria-label="演示文稿"><span class="font-icon icon iconfont icon-office-pptx" style=""></span>演示文稿<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/demo/" aria-label="案例"><span class="font-icon icon iconfont icon-discover" style=""></span>案例<!----></a></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable"><span class="font-icon icon iconfont icon-workspace" style=""></span><a class="route-link vp-link vp-sidebar-title" href="/workspace/" aria-label="工作空间"><!---->工作空间<!----></a><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-creative" style=""></span><span class="vp-sidebar-title">多彩贵州航空知识分享</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->高可用方案</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/abelit" target="_blank" rel="noopener noreferrer">Abelit</a></span><span property="author" content="Abelit"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-05-11T14:06:18.000Z"></span><!----><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 106 分钟</span><meta property="timeRequired" content="PT106M"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!--[--><!----><!--]--><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mysql-高可用">MySQL 高可用</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#什么是高可用性">什么是高可用性？</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mysql-如何实现高可用">MySQL 如何实现高可用</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#高可用目标">高可用目标</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mysql-高可用典型解决方案">MySQL 高可用典型解决方案</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mysql-高可用注意事项">MySQL 高可用注意事项</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#高可用列表">高可用列表</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mysql复制技术">MySQL复制技术</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#异步复制">异步复制</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#半同步复制-after-commit">半同步复制（after_commit）</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#增强半同步复制-after-sync">增强半同步复制（after_sync）</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#全同步复制-组复制-mgr">全同步复制/组复制(MGR)</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mysql-高可用方案">MySQL 高可用方案</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mysql-高可用方案导图">MySQL 高可用方案导图</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mysql主从复制">MySQL主从复制</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理">原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#架构">架构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足">优势与不足</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#适用场景">适用场景</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#可用性">可用性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mha-基于-mysql-服务器特性">MHA（基于 MySQL 服务器特性）</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-1">原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#架构-1">架构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足-1">优势与不足</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#适用场景-1">适用场景</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#可用性-1">可用性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mha-proxysql-基于-mysql-服务器特性">MHA + ProxySQL（基于 MySQL 服务器特性）</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-2">原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#架构-2">架构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足-2">优势与不足</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#适用场景-2">适用场景</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#可用性-2">可用性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mmm-基于-mysql-服务器特性">MMM（基于 MySQL 服务器特性）</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-3">原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#架构-3">架构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足-3">优势与不足</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#适用场景-3">适用场景</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#可用性-3">可用性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mysql-innodb-cluster-1">MySQL Innodb Cluster</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-4">原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#架构-4">架构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足-4">优势与不足</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#适用场景-4">适用场景</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#可用性-4">可用性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mysql-innodb-clusterset">MySQL InnoDB ClusterSet</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-5">原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#架构-5">架构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足-5">优势与不足</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#适用场景-5">适用场景</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#可用性-5">可用性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mysql-innodb-replicaset">MySQL InnoDB ReplicaSet</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-6">原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#架构-6">架构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足-6">优势与不足</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#适用场景-6">适用场景</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#可用性-6">可用性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#galera-基于分布式协议">Galera (基于分布式协议)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-7">原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#工作原理图">工作原理图</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#架构-7">架构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足-7">优势与不足</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#适用场景-7">适用场景</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#可用性-7">可用性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#pxc">PXC</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-8">原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#架构-8">架构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足-8">优势与不足</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#适用场景-8">适用场景</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#可用性-8">可用性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mysql-cluster-基于分布式协议-存储引擎">MySQL Cluster (基于分布式协议+存储引擎)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-9">原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#架构-9">架构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足-9">优势与不足</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#适用场景-9">适用场景</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#可用性-9">可用性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#主从复制-keepalived">主从复制（Keepalived）</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-10">原理：</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#架构-10">架构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足-10">优势与不足</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#适用场景-10">适用场景</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#可用性-10">可用性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#主主复制-keepalived">主主复制（Keepalived）</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-11">原理：</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#架构-11">架构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足-11">优势与不足</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#适用场景-11">适用场景</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#可用性-11">可用性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#主主-主从复制-keepalived-lvs">主主/主从复制（Keepalived+LVS）</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-12">原理：</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#架构-12">架构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足-12">优势与不足</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#适用场景-12">适用场景</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#可用性-12">可用性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#xenon">Xenon</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-13">原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#架构-13">架构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足-13">优势与不足</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#适用场景-13">适用场景</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#可用性-13">可用性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mysql-consul">MySQL Consul</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-14">原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#架构-14">架构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足-14">优势与不足</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#适用场景-14">适用场景</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#可用性-14">可用性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mysql-fabric-1">MySQL Fabric</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-15">原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#架构-15">架构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足-15">优势与不足</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#适用场景-15">适用场景</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#可用性-15">可用性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#tungsten®-replicator-基于中间件">Tungsten® Replicator（基于中间件）</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-16">原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#架构-16">架构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足-16">优势与不足</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#适用场景-16">适用场景</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#可用性-16">可用性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#heartbeat-san-基于共享存储">Heartbeat + SAN （基于共享存储）</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-17">原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#架构-17">架构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足-17">优势与不足</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#适用场景-17">适用场景</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#可用性-17">可用性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#heartbeat-drdb-基于存储复制">Heartbeat + DRDB（基于存储复制）</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-18">原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#架构-18">架构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足-18">优势与不足</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#适用场景-18">适用场景</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#可用性-18">可用性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mysql-高可用相关技术">MySQL 高可用相关技术</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#paxos-分布式协议">Paxos 分布式协议</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-19">原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足-19">优势与不足</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#orchestrator">Orchestrator</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-20">原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#架构-19">架构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#优势与不足-20">优势与不足</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#高可用解决方案对比">高可用解决方案对比</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#数据库中间件">数据库中间件</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mycat">MyCat</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mysql-proxy">MySQL-Proxy</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#apache-shardingsphere">Apache ShardingSphere</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_360-atlas">360 Atlas</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mysql-高可用解决方案选择原则">MySQL 高可用解决方案选择原则</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><h2 id="mysql-高可用" tabindex="-1"><a class="header-anchor" href="#mysql-高可用"><span>MySQL 高可用</span></a></h2><h3 id="什么是高可用性" tabindex="-1"><a class="header-anchor" href="#什么是高可用性"><span>什么是高可用性？</span></a></h3><p>高可用性是指系统或服务在发生故障或中断时继续运行并保持可用的能力。高度可用的系统可确保组织的关键任务系统和应用程序始终正常运行。这对于医疗保健、金融和航空等行业的组织尤其重要，因为在这些行业中，关键任务系统的故障可能会造成严重后果。</p><p>高可用性通常表示为服务级别协议 (SLA) 定义的正常运行时间的百分比，得分为 100 表示系统永不出现故障。因为这实际上是不可能实现的，所以大多数组织的目标是“五个九”或 99.999% 的可用性。</p><h3 id="mysql-如何实现高可用" tabindex="-1"><a class="header-anchor" href="#mysql-如何实现高可用"><span>MySQL 如何实现高可用</span></a></h3><p>高可用系统必须能够在发生故障时立即恢复。高可用性架构至少需要三个基本元素，它们协同工作以确保可恢复性和高可用性：</p><ul><li><strong>故障检测</strong></li></ul><p>MySQL 具有高可用性选项，使应用程序能够满足更高的正常运行时间（和零数据丢失容忍度）的要求。当高可用性选项打开时，MySQL 系统会跨不同的故障域或可用区创建三个实例。</p><p>使用 MySQL 组复制在三个实例之间复制数据，应用程序连接到主实例以从数据库读取和写入数据。如果发生故障，系统会在几分钟内触发自动故障转移到辅助实例。</p><ul><li><strong>故障转移</strong></li></ul><p>故障转移机制将服务转移到复制实例。如果有多个备份实例可用，故障转移机制会选择最佳的一个来提升为主节点。</p><ul><li><strong>重定向机制</strong></li></ul><p>一旦故障转移到辅助实例，高可用性功能会将所有应用程序和用户连接重定向到现在的新主节点。它还将所有查询从旧主节点重定向到新主数据库。</p><h3 id="高可用目标" tabindex="-1"><a class="header-anchor" href="#高可用目标"><span>高可用目标</span></a></h3><table><thead><tr><th>可用性百分比</th><th>每年的停机时间</th><th>每月（30 天）的停机时间</th><th>每周的停机时间</th><th>每天的停机时间</th></tr></thead><tbody><tr><td>90%（“1 个 9”）</td><td>36.5 天</td><td>72 小时</td><td>16.8 小时</td><td>2.4 小时</td></tr><tr><td>95%</td><td>18.25 天</td><td>36 小时</td><td>8.4 小时</td><td>1.2 小时</td></tr><tr><td>97%</td><td>10.96 天</td><td>21.6 小时</td><td>5.04 小时</td><td>43.2 分钟</td></tr><tr><td>98%</td><td>7.30 天</td><td>14.4 小时</td><td>3.36 小时</td><td>28.8 分钟</td></tr><tr><td>99%（“2 个 9”）</td><td>3.65 天</td><td>7.2 小时</td><td>1.68 小时</td><td>14.4 分钟</td></tr><tr><td>99.50%</td><td>1.83 天</td><td>3.6 小时</td><td>50.4 分钟</td><td>7.2 分钟</td></tr><tr><td>99.80%</td><td>17.52 小时</td><td>86.23 分钟</td><td>20.16 分钟</td><td>2.88 分钟</td></tr><tr><td>99.9%（“3 个 9”）</td><td>8.76 小时</td><td>43.2 分钟</td><td>10.1 分钟</td><td>1.44 分钟</td></tr><tr><td>99.95%</td><td>4.38 小时</td><td>21.56 分钟</td><td>5.04 分钟</td><td>43.2 秒</td></tr><tr><td>99.99%（“4 个 9”）</td><td>52.56 分钟</td><td>4.32 分钟</td><td>1.01 分钟</td><td>8.66 秒</td></tr><tr><td>99.995%</td><td>26.28 分钟</td><td>2.16 分钟</td><td>30.24 秒</td><td>4.32 秒</td></tr><tr><td>99.999%（“5 个 9”）</td><td>5.26 分钟</td><td>25.9 秒</td><td>6.05 秒</td><td>864.3 毫秒</td></tr><tr><td>99.9999%（“6 个 9”）</td><td>31.5 秒</td><td>2.59 秒</td><td>604.8 毫秒</td><td>86.4 毫秒</td></tr><tr><td>99.99999%（“7 个 9”）</td><td>3.15 秒</td><td>262.97 毫秒</td><td>60.478 毫秒</td><td>8.64 毫秒</td></tr><tr><td>99.999999%（“8 个 9”）</td><td>315.569 毫秒</td><td>26.297 毫秒</td><td>6.048 毫秒</td><td>0.864 毫秒</td></tr><tr><td>99.9999999%（“9 个 9”）</td><td>31.5569 毫秒</td><td>2.6297 毫秒</td><td>0.6048 毫秒</td><td>0.0864 毫秒</td></tr></tbody></table><h3 id="mysql-高可用典型解决方案" tabindex="-1"><a class="header-anchor" href="#mysql-高可用典型解决方案"><span>MySQL 高可用典型解决方案</span></a></h3><p>MySQL的高可用性解决方案目前大致分为5种，按照高可用的级别（99.9999%为最高级）排序依次为，主从复制、具有自动故障转移功能的主从复制、利用共享存储、OS或虚拟化软件实现主备架构、MySQL Group Replication 群组复制，以及MySQL NDB Cluster。 <img src="/assets/db_ha_solutions_002-C3xWwQ9x.png" alt="MySQL高可用典型解决方案可用性图" loading="lazy"></p><h4 id="mysql-replication" tabindex="-1"><a class="header-anchor" href="#mysql-replication"><span>MySQL Replication</span></a></h4><p>MySQL Replication 就是通过 MySQL 原生的复制技术来实现数据的冗余，该方案也是最易实现和通用的方案，相关的原理介绍网上介绍很多，这里不再详细赘述，实现原理主要是通过2PC来实现本地BINLOG和本地数据的一致性，并再此基础上通过两个线程(IO线程和SQL线程)来实现远端数据和本地数据的同步，根据数据一致性程度不同复制技术又可以分为异步复制、半同步复制以及同步复制，另外在此冗余技术之上，一般会搭配使用MySQL Proxy、keepalived、MHA等第三方软件来实现自动容灾，此技术方案如果不做一定优化，可用性一般不到2个9。允许数据从一台实例上复制到一台或多台其它的实例上。</p><h4 id="mysql-group-replication" tabindex="-1"><a class="header-anchor" href="#mysql-group-replication"><span>MySQL Group Replication</span></a></h4><p>MySQL Group Replication 群组复制提供更好的冗余性、自动恢复以及写入扩展。</p><h4 id="mysql-innodb-cluster" tabindex="-1"><a class="header-anchor" href="#mysql-innodb-cluster"><span>MySQL InnoDB Cluster</span></a></h4><p>MySQL InnoDB Cluster基于群组复制，提供了易于管理的API、应用故障转移和路由、易于配置，提供比群组复制更高级别的可用性。</p><h4 id="mysql-fabric" tabindex="-1"><a class="header-anchor" href="#mysql-fabric"><span>MySQL Fabric</span></a></h4><p>MySQL Fabric 是Oracle官方提供的一种Mysql高可用方案，通过数据分片下的读写分离模式，该方案的可用性达到2个9。群组复制提供更好的冗余性、自动恢复以及写入扩展。</p><h4 id="drbd磁盘复制" tabindex="-1"><a class="header-anchor" href="#drbd磁盘复制"><span>DRBD磁盘复制</span></a></h4><p>DRBD磁盘复制,分布式块设备复制(Distributed Relicated Block Deivce,DRBD)，是一种基于软件、基于网络的块复制存储解决方案，主要用于对服务器之间的磁盘、分区、逻辑卷等进行数据镜像，当用户将数据写入本地磁盘时，还会将数据发送到网络中另一台主机的磁盘上，这样的本地主机(主节点)与远程主机(备节点)的数据就可以保证实时同步，当本地主机出现问题，远程主机上还保留着一份相同的数据，可以继续使用，保证了数据的安全，该方案缺点是IO性能影响严重，可用性不到3个9。</p><h4 id="solaris-clustering" tabindex="-1"><a class="header-anchor" href="#solaris-clustering"><span>Solaris Clustering</span></a></h4><p>Solaris Clustering，该方案代表这另一种技术方向，即以共享存储为基础,实现数据库服务器和存储设备的解耦，这样数据库服务器之间的冗余与数据无关，而数据的冗余则通过SAN共享储存或者分布式存储系统来实现，当然Solaris Clustering除此之外还提供了操作系统、硬件等各个层面的监控机制，该方案的可用性达到接近4个9，但是实现代价大，价格昂贵。</p><h4 id="mysql-cluster" tabindex="-1"><a class="header-anchor" href="#mysql-cluster"><span>MySQL Cluster</span></a></h4><p>MySQL Cluster是官方提供的一个开源方案，其将Mysql的集群分为SQL节点和数据节点，数据节点通过一种内存中的存储引擎来实现自动sharding和复制，虽然该方案号称接近5个9的可用性，但是缺点也是很多，如对内存消耗大，使用成本高，牺牲了过多的SQL语言特性，配置复杂等。</p><p>易与MySQL InnoDB Cluster混淆，是另外一款产品，提供更高级别的可用性和冗余性。适用于分布式计算环境，使用内存型的NDB存储引擎。</p><h4 id="paxos分布式一致性协议" tabindex="-1"><a class="header-anchor" href="#paxos分布式一致性协议"><span>PAXOS分布式一致性协议</span></a></h4><p>基于PAXOS分布式一致性协议的方案，Paxos 协议主要多数派投票的方式，来就分布式系统中某个值达成一致，该算法被业界认为唯一的分布式一致性算法，包括其在内衍生出来的分布式一致性算法（如Raft等）也在很多肯多开源分布式系统得到应用。Paxos与MySQL相结合可以实现在分布式的MySQL数据库最终一致性从而保证高可用，而使用分布式算法用来解决MySQL数据库数据一致性的问题的方法，也越来越被人们所接受，一系列产品如PhxSQL、MariaDB Galera Cluster、Percona XtraDB Cluster等越来越多的被应用到生产环境，而最近Oracle官方所推出的MySQL Group Replication的GA，更使其在Mysql高可用领域成为了一种民用技术；因此使用分布式协议和多副本来解决数据库一致性问题已经成为了主流的方向。但是此类方案还出于初级阶段，不够成熟，同时分布式一致性协议由于网络开销的原因在性能上还有待提高和优化。</p><h3 id="mysql-高可用注意事项" tabindex="-1"><a class="header-anchor" href="#mysql-高可用注意事项"><span>MySQL 高可用注意事项</span></a></h3><p>MySQL 数据库的高可用的架构时，主要要考虑如下几方面：</p><ul><li>如果数据库发生了宕机或者意外中断等故障，能尽快恢复数据库的可用性，尽可能的减少停机时间，保证业务不会因为数据库的故障而中断。</li><li>用作备份、只读副本等功能的非主节点的数据应该和主节点的数据实时或者最终保持一致。</li><li>当业务发生数据库切换时，切换前后的数据库内容应当一致，不会因为数据缺失或者数据不一致而影响业务。</li><li>关于对高可用的分级在这里我们不做详细的讨论，这里只讨论常用高可用方案的优缺点以及高可用方案的选型。</li></ul><p>随着人们对数据一致性的要求不断的提高，越来越多的方法被尝试用来解决分布式数据一致性的问题，如 MySQL 自身的优化、MySQL 集群架构的优化、Paxos、Raft、2PC 算法的引入等等。</p><p>而使用分布式算法用来解决 MySQL 数据库数据一致性的问题的方法，也越来越被人们所接受，一系列成熟的产品如 PhxSQL、MariaDB Galera Cluster、Percona XtraDB Cluster 等越来越多的被大规模使用。</p><p>随着官方 MySQL Group Replication 的 GA，使用分布式协议来解决数据一致性问题已经成为了主流的方向。期望越来越多优秀的解决方案被提出，MySQL 高可用问题可以被更好的解决。</p><h2 id="高可用列表" tabindex="-1"><a class="header-anchor" href="#高可用列表"><span>高可用列表</span></a></h2><ul><li>MySQL MHA (by DeNA)</li><li>MySQL Group Replication (by Oracle)</li><li>MySQL NDB Cluster (by Oracle)</li><li>Galera Cluster (by Galera)</li><li>XtraDB Cluster (by Percona)</li><li>MySQL Fabric Cluster (by Oracle)</li><li>MySQL Orchestrator (by Github)</li></ul><h2 id="mysql复制技术" tabindex="-1"><a class="header-anchor" href="#mysql复制技术"><span>MySQL复制技术</span></a></h2><p>MySQL 的主从复制模式分为：全同步复制，异步复制，半同步复制，增强半同步复制。</p><h3 id="异步复制" tabindex="-1"><a class="header-anchor" href="#异步复制"><span>异步复制</span></a></h3><h4 id="异步复制原理" tabindex="-1"><a class="header-anchor" href="#异步复制原理"><span>异步复制原理</span></a></h4><p>异步复制，当主库提交事务后会通知binlog dump线程发送binlog日志给从库，一旦binlog dump线程将binlog日志发送给从库之后，不需要等到从库也同步完成事务，主库就会讲处理结果返回给客户端。</p><p>因为主库只管自己执行完事务，就可以将处理结果返回给客户端，而不用关心从库是否执行完事务，这就可能导致短暂的主从数据不一致的问题了，比如刚在主库插入的数据，如果马上在从库查询就可能查询不到。</p><p>当主库提交事务后，如果宕机挂掉了，此时可能binlog还没来得及同步给从库，这时候如果为了回复故障切换主从节点的话，就会出现数据丢失的问题，所以异步复制虽然性能高，但数据一致性上是比较弱的。</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>MySQL默认采用的是异步复制模式。</p></div><ul><li><p>异步复制协议 <img src="/assets/mysql-async-replication-diagram-336DfgRE.png" alt="" loading="lazy"></p></li><li><p>异步复制原理图 <img src="/assets/mysql-async-replication-overview-BwCE2Ay7.png" alt="" loading="lazy"></p></li></ul><h3 id="半同步复制-after-commit" tabindex="-1"><a class="header-anchor" href="#半同步复制-after-commit"><span>半同步复制（after_commit）</span></a></h3><h4 id="半同步复制原理" tabindex="-1"><a class="header-anchor" href="#半同步复制原理"><span>半同步复制原理</span></a></h4><p>半同步复制就是介于全同步复制与全异步复制之间的一种，在同步复制和异步中做了折中选择，主库在执行完客户端提交的事务后不是立刻返回给客户端，而是等待至少一个从库接收到并写到relay log中才返回给客户端。相对于异步复制，半同步复制提高了数据的安全性，同时它也造成了一定程度的延迟，这个延迟最少是一个TCP/IP往返的时间。所以，半同步复制最好在低延时的网络中使用。</p><p>相比异步复制，半同步复制提高了数据完整性，在master的dump thread通知slave后，增加了一个ack这一个步骤。即binlog先在engine commit（对应二阶段提交中给redo打commit标记），然后再等待至少一个slave反馈收到relay log，只有收到ack后master才将commit ok结果反馈给客户端。否则需要等待直到超时时间然后切换成异步模式再提交。</p><ul><li><p>半同步复制协议 <img src="/assets/mysql-semisync-replication-diagram-DuHHRKME.png" alt="" loading="lazy"></p></li><li><p>半同步复制原理图 <img src="/assets/mysql-semisync-replication-after-commit-diagram-CEfd1YEC.png" alt="" loading="lazy"></p></li></ul><p>半同步复制也存在以下几个问题：</p><ul><li><p>半同步复制的性能，相比异步复制而言有所下降，因为需要等到等待至少一个从库确认接收到binlog日志的响应，所以新能上是有所损耗的。</p></li><li><p>主库等待从库响应的最大时长我们是可以配置的，如果超过了我们配置的事件，半同步复制就会变成异步复制，那么，异步复制的问题同样也就出现了。</p></li><li><p>在MySQL5.7.2之前的版本中，半同步复制存在幻读问题。当主库成功提交事务并处于等待从库确认的过程中，这个时候，从库都还没来得及返回处理结果给客户端，但因为主库存储引擎内部已经提交事务了，所以，其他客户端是可以到主库中读到数据的。但是，如果下一秒主库宕机，下次请求过来只能读取从库，因为从库还没有从主库同步数据，所以从库中读取不到这条数据了，和上一次读取数据的结果相比，就造成了幻读的现象。</p></li><li><p>半同步复制实现的方式是在engine commit后去等待从库的确认信息，在innodb引擎中，engine commit后事务做的修改其他会话就能读到了，这时如果其他会话读到了这个修改的事务，但是从库没有收到事务对应的binlog，主库突然crash掉发生了主备切换，再去做读操作的时候就会发现刚刚读到的这条数据读不到了，产生了幻读，而且产生数据丢失，除非手动修补binlog。</p></li></ul><h3 id="增强半同步复制-after-sync" tabindex="-1"><a class="header-anchor" href="#增强半同步复制-after-sync"><span>增强半同步复制（after_sync）</span></a></h3><h4 id="增强半同步复制原理" tabindex="-1"><a class="header-anchor" href="#增强半同步复制原理"><span>增强半同步复制原理</span></a></h4><p>增强半同步复制是MySQL5.7.2后的版本对半同步复制做的一个改进，原理几乎是一样的，主要是解决幻读的问题。</p><p>主库配置了参数<code>rpl_semi_sync_master_wait_point=AFTER_SYNC</code>后，主库在存储引擎提交事务前，必须先等从库数据同步完成的确认信息后，才能提交事务，以此来解决幻读问题。</p><ul><li><p>master将每个事务写入binlog，传递给slave刷新到磁盘(relay log)。master等待slave反馈接收到relay log的ack之后，再在引擎层提交事务并返回commit ok结果返回给客户端。</p></li><li><p>即使主库crash，所有在主库上已经提交的事务都能保证已经同步到slave的relay log中，即确保已经在relay log中了。这样就避免了早期半同步复制幻读的问题，这种半同步复制的实现方式就是增强半同步。</p></li><li><p>增强半同步复制原理图 <img src="/assets/mysql-semisync-replication-after-sync-diagram-D_eWiqkK.png" alt="" loading="lazy"></p></li></ul><h3 id="全同步复制-组复制-mgr" tabindex="-1"><a class="header-anchor" href="#全同步复制-组复制-mgr"><span>全同步复制/组复制(MGR)</span></a></h3><h4 id="全同步复制-组复制-mgr-原理" tabindex="-1"><a class="header-anchor" href="#全同步复制-组复制-mgr-原理"><span>全同步复制/组复制(MGR)原理</span></a></h4><p>全同步复制，就是当主库执行完一个事务之后，要求所有的从库也都必须执行完该事务，才可以返回处理结果给客户端；因此虽然全同步复制数据一致性得到保证了，但是主库完成一个事务需要等待所有从库也完成，性能就比较低了。</p><p>MySQL全同步复制使用MySQL Group Replication（MGR）技术实现。MySQL Group Replication 是 Oracle MySQL 于 2016 年 12 月发布 MySQL 5.7.17 推出的一个全新高可用和高扩展的解决方案。组复制是一个 MySQL 服务器插件，可以创建具有弹性、高可用性和容错的复制拓扑。组复制基于“Paxos”协议（“Mencius”）实现，支持多点写入，具有冲突检测和解决机制，它允许应用程序写入的数据在同一组内的所有服务器上保持一致。组复制内置的模块支持跨平台的分布式恢复，并通过内置的故障转移机制实现了容错。</p><p>引入复制组主要是为了解决传统异步复制和半同步复制可能产生数据不一致的问题。MGR 由若干个节点共同组成一个复制组，一个事务的提交，必须经过组内大多数节点 (N / 2 + 1) 决议并通过，才能得以提交。</p><p>当客户端发起一个更新事务时，该事务先在本地执行，执行完成之后就要发起对事务的提交操作。在还没有真正提交之前，需要将产生的复制写集广播出去，复制到其它成员。因为事务是通过原子广播发送的，所以组中的成员要么都接收事务，要么都不接收事务。如果组中的所有成员收到了该广播消息(事务)，那么他们会按照之前发送事务的相同顺序收到该广播消息。因此，所有组成员都以相同的顺序接收事务的写集，并为事务建立全局顺序。因此，所有组成员都以相同的顺序接收事务的写集，并为事务建立全局顺序。</p><p>在不同组成员并发执行的事务可能存在冲突。冲突是通过检查和比较两个不同并发事务的 write set 来验证的，这个过程称为认证。在认证期间，冲突检测在行级别执行的：如果在不同组成员上执行的两个并发事务更新了同一行数据，则存在冲突。根据冲突认证检测机制判断，按照顺序，第一次提交的会正常执行，第二次提交的事务会在事务发起的原始组成员上执行回滚,，组中的其他成员对该事务执行删除。如果两个事务经常发生冲突，那么最好将这两个事务放在同一个组成员中执行，这样它们在本地锁管理器的协调下将都有机会提交成功，而不至于因为处在两个不同的组成员中由于冲突认证而导致其中一个事务被频繁回滚。</p><p>最终，所有组内成员以相同的顺序接收同一组事务。因此组内成员以相同的顺序应用相同的修改，保证组内数据强一致性。</p><ul><li><p>MGR复制协议 <img src="/assets/mysql-gr-replication-diagram-DvyJNI3J.png" alt="" loading="lazy"></p></li><li><p>MGR原理图 <img src="/assets/mysql_mgr_overview-CmWrc6nE.png" alt="MGR 架构图" loading="lazy"></p></li></ul><h4 id="mgr特性" tabindex="-1"><a class="header-anchor" href="#mgr特性"><span>MGR特性：</span></a></h4><ul><li><p>避免脑裂：MGR 中不会出现脑裂的现象；</p></li><li><p>数据一致性保障：MGR 的冗余能力很好，能够保证 Binlog Event 至少被复制到超过一半的成员上，只要同时宕机的成员不超过半数便不会导致数据丢失。MGR还保证只要 Binlog Event 没有被传输到半数以上的成员，本地成员不会将事务的 Binlog Event 写入 Binlog 文件和提交事务，从而保证宕机的服务器上不会有组内在线成员上不存在的数据。因此，宕机的服务器重启后，不再需要特殊的处理就可以加入组；</p></li><li><p>多节点写入支持：多写模式下支持集群中的所有节点都可以写入。</p></li></ul><h4 id="mgr的应用场景" tabindex="-1"><a class="header-anchor" href="#mgr的应用场景"><span>MGR的应用场景</span></a></h4><ul><li><p>弹性复制：需要非常灵活的复制基础设施的环境，其中MySQL Server的数量必须动态增加或减少，并且在增加或减少Server的过程中，对业务的副作用尽可能少。例如，云数据库服务；</p></li><li><p>高可用分片：分片是实现写扩展的一种流行方法。基于 组复制 实现的高可用分片，其中每个分片都会映射到一个复制组上（逻辑上需要一一对应，但在物理上，一个复制组可以承载多个分片）；</p></li><li><p>替代主从复制：在某些情况下，使用一个主库会造成单点争用。在某些情况下，向整个组内的多个成员同时写入数据，对应用来说可能伸缩性更强；</p></li><li><p>自治系统：可以利用组复制内置的自动故障转移、数据在不同组成员之间的原子广播和最终数据一致性的特性来实现一些运维自动化。</p></li></ul><h2 id="mysql-高可用方案" tabindex="-1"><a class="header-anchor" href="#mysql-高可用方案"><span>MySQL 高可用方案</span></a></h2><h3 id="mysql-高可用方案导图" tabindex="-1"><a class="header-anchor" href="#mysql-高可用方案导图"><span>MySQL 高可用方案导图</span></a></h3><!--[--><div class="mermaid-actions"><button class="preview-button" title="preview"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1316 1024" fill="currentColor"><path d="M658.286 0C415.89 0 0 297.106 0 512c0 214.82 415.89 512 658.286 512 242.322 0 658.285-294.839 658.285-512S900.608 0 658.286 0zm0 877.714c-161.573 0-512-221.769-512-365.714 0-144.018 350.427-365.714 512-365.714 161.572 0 512 217.16 512 365.714s-350.428 365.714-512 365.714z"/><path d="M658.286 292.571a219.429 219.429 0 1 0 0 438.858 219.429 219.429 0 0 0 0-438.858zm0 292.572a73.143 73.143 0 1 1 0-146.286 73.143 73.143 0 0 1 0 146.286z"/></svg></button><button class="download-button" title="download"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" fill="currentColor"><path d="M828.976 894.125H190.189c-70.55 0-127.754-57.185-127.754-127.753V606.674c0-17.634 14.31-31.933 31.933-31.933h63.889c17.634 0 31.932 14.299 31.932 31.933v95.822c0 35.282 28.596 63.877 63.877 63.877h511.033c35.281 0 63.877-28.595 63.877-63.877v-95.822c0-17.634 14.298-31.933 31.943-31.933h63.878c17.635 0 31.933 14.299 31.933 31.933v159.7c0 70.566-57.191 127.751-127.754 127.751zM249.939 267.51c12.921-12.92 33.885-12.92 46.807 0l148.97 148.972V94.893c0-17.634 14.302-31.947 31.934-31.947h63.876c17.638 0 31.946 14.313 31.946 31.947v321.589l148.97-148.972c12.922-12.92 33.876-12.92 46.797 0l46.814 46.818c12.922 12.922 12.922 33.874 0 46.807L552.261 624.93c-1.14 1.138-21.664 13.684-42.315 13.693-20.877.01-41.88-12.542-43.021-13.693L203.122 361.135c-12.923-12.934-12.923-33.885 0-46.807l46.817-46.818z"/></svg></button></div><div class="mermaid-wrapper"><div class="loading-icon-wrapper mermaid-loading" style="display:flex;align-items:center;justify-content:center;height:96px;"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!--]--><h2 id="mysql主从复制" tabindex="-1"><a class="header-anchor" href="#mysql主从复制"><span>MySQL主从复制</span></a></h2><p>MySQL 复制（MySQL Replication），是 MySQL 自带的功能。MySQL数据库支持单向、双向、链式级联、环状等不同业务场景的复制。在复制过程中，一台服务器充当主服务器（Master），接收来自用户的内容更新，而一个或多个其他的服务器充当从服务器（Slave），接收来自主服务器binlog文件的日志内容，解析出SQL重新更新到从服务器，使得主从服务器数据达到一致。</p><p>如果设置了链式级联复制，那么，从（slave）服务器本身除了充当从服务器外，也会同时充当其下面从服务器的主服务器。链式级复制类似A→B→C的复制形式。</p><h3 id="原理" tabindex="-1"><a class="header-anchor" href="#原理"><span>原理</span></a></h3><p>主从复制是通过重放 binlog 实现主库数据的异步复制。即当主库执行了一条 sql 命令，那么在从库同样的执行一遍，从而达到主从复制的效果。在这个过程中，master 对数据的写操作记入二进制日志文件中(binlog)，生成一个 log dump 线程，用来给从库的 I/O 线程传 binlog。而从库的 I/O 线程去请求主库的 binlog，并将得到的 binlog 日志写到中继日志（relaylog）中，从库的 SQL 线程，会读取 relaylog 文件中的日志，并解析成具体操作，通过主从的操作一致，而达到最终数据一致。 复制的基本过程如下：</p><ul><li><p>Slave上面的IO进程连接上Master，并请求从指定日志文件的指定位置（或者从最开始的日志）之后的日志内容；</p></li><li><p>Master接收到来自Slave的IO进程的请求后，通过负责复制的IO进程根据请求信息读取制定日志指定位置之后的日志信息，返回给Slave 的IO进程。返回信息中除了日志所包含的信息之外，还包括本次返回的信息已经到Master端的bin-log文件的名称以及bin-log的位置；</p></li><li><p>Slave的IO进程接收到信息后，将接收到的日志内容依次添加到Slave端的relay-log文件的最末端，并将读取到的Master端的 bin-log的文件名和位置记录到master-info文件中，以便在下一次读取的时候能够清楚的告诉Master“我需要从某个bin-log的哪个位置开始往后的日志内容，请发给我”；</p></li><li><p>Slave的SQL进程检测到relay-log中新增加了内容后，会马上解析relay-log的内容成为在Master端真实执行时候的那些可执行的内容，并在自身执行。</p></li></ul><h3 id="架构" tabindex="-1"><a class="header-anchor" href="#架构"><span>架构</span></a></h3><figure><img src="/assets/mysql_replication_overview-P3ig-w-7.jpg" alt="MMM 架构图" tabindex="0" loading="lazy"><figcaption>MMM 架构图</figcaption></figure><h3 id="优势与不足" tabindex="-1"><a class="header-anchor" href="#优势与不足"><span>优势与不足</span></a></h3><ul><li><p>优点：</p><ul><li>如果让后台读操作连接从数据库，让写操作连接主数据库，能起到读写分离的作用，这个时候多个从数据库可以做负载均衡。</li><li>可以在某个从数据库中暂时中断复制进程，来备份数据，从而不影响主数据的对外服务（如果在 master 上执行 backup，需要让 master 处于 readonly 状态，这也意味这所有的 write 请求需要阻塞）。</li><li>主从复制是 mysql 自带的，无需借助第三方。</li><li>数据被删除，可以从 binlog 日志中恢复。</li><li>配置较为简单方便。</li></ul></li><li><p>缺点：</p><ul><li>从库要从 binlog 获取数据并重放，这肯定与主库写入数据存在时间延迟，因此从库的数据总是要滞后主库。</li><li>对主库与从库之间的网络延迟要求较高，若网络延迟太高，将加重上述的滞后，造成最终数据的不一致。</li><li>单一的主节点挂了，将不能对外提供写服务。</li></ul></li></ul><h3 id="适用场景" tabindex="-1"><a class="header-anchor" href="#适用场景"><span>适用场景</span></a></h3><ul><li><p>从服务器作为主服务器的实时数据备份。</p></li><li><p>从服务器实时读写分离，从服务器实现负载均衡。</p></li><li><p>把多个从服务器根据业务重要性进行拆分访问。</p></li></ul><h3 id="可用性" tabindex="-1"><a class="header-anchor" href="#可用性"><span>可用性</span></a></h3><p>可用性达到：99.9%</p><h2 id="mha-基于-mysql-服务器特性" tabindex="-1"><a class="header-anchor" href="#mha-基于-mysql-服务器特性"><span>MHA（基于 MySQL 服务器特性）</span></a></h2><p>MHA（Master High Avaliable） 是一款 MySQL 开源高可用程序，由日本DeNA公司开发，主要用于在故障切换和主从提升时进行快速切换，并最大程度保证数据一致性。MHA 在监测到主实例无响应后，可以自动将同步最靠前的 Slave 提升为 Master，然后将其他所有的 Slave 重新指向新的 Master。</p><p>MHA主要由两部分组成：</p><ol><li><p>MHA Manager(管理节点)，管理节点部署在群集之外，主要用于定期监测群集中的主节点，并在主从切换时负责管理调度切换流程。</p></li><li><p>MHA Node(数据节点)，数据节点部署在每个群集节点上，负责在主从切换时对比和应用差异日志。</p></li></ol><h3 id="原理-1" tabindex="-1"><a class="header-anchor" href="#原理-1"><span>原理</span></a></h3><p>相较于其它HA软件，MHA的目的在于维持MySQL Replication中Master库的高可用性，其最大特点是可以修复多个Slave之间的差异日志，最终使所有Slave保持数据一致，然后从中选择一个充当新的Master，并将其它Slave指向它。</p><ul><li><p>从宕机崩溃的master保存二进制日志事件(binlogevents)。</p></li><li><p>识别含有最新更新的slave。</p></li><li><p>应用差异的中继日志(relay log)到其它slave。</p></li><li><p>应用从master保存的二进制日志事件(binlogevents)。</p></li><li><p>提升一个slave为新master。</p></li><li><p>使其它的slave连接新的master进行复制。</p></li></ul><h3 id="架构-1" tabindex="-1"><a class="header-anchor" href="#架构-1"><span>架构</span></a></h3><figure><img src="/assets/mysql_mha_overview-C8fleug9.png" alt="MHA 架构图" tabindex="0" loading="lazy"><figcaption>MHA 架构图</figcaption></figure><h3 id="优势与不足-1" tabindex="-1"><a class="header-anchor" href="#优势与不足-1"><span>优势与不足</span></a></h3><ul><li><p>优点</p><ul><li>可以根据需要扩展 MySQL 的节点数量。</li><li>master failover和slave promotion非常快速。</li><li>自动探测，多重检测，切换过程中支持调用其他脚本的接口。</li><li>只要复制没有延迟，MHA 通常可以在几秒内实现故障切换。</li><li>master crash不会导致数据不一致，自动补齐数据，维护数据一致性，会尝试从旧的master中尽可能多的保存未同步日志，可以尽可能少的丢失事务。</li><li>不需要修改复制的任何设置，简单易部署，对现有架构无影响。</li><li>不需要增加很多额外的机器来部署MHA，支持多实例集中管理。</li><li>没有任何性能影响。</li><li>跨存储引擎，支持任何引擎。</li><li>支持基于GTID的复制和基于日志点的复制方式，相比于MMM架构工具只支持基于日志点的复制方式，MHA添加了对基于GTID的复制方式的支持。</li><li>可以从多个slave中选举最合适的新master。</li><li>同一个监控节点可以监控多个集群。</li></ul></li><li><p>缺点</p><ul><li>仅监视主数据库，只监控master，而没有对slave实现高可用，因为mha并没有对slave的监控，因此我们需要采用额外的方式来对slave进行监控。</li><li>需要自行开发写VIP迁移脚本。</li><li>需要基于 SSH 免认证配置，存在一定的安全隐患。</li><li>不支持多层次复制 (M1-&gt;M2-&gt;Slave)</li><li>Load Data [Local] Infile with SBR 不支持。</li><li>使用 Perl 开发，二次开发困难。</li><li>跟不上 MySQL 新版本，最近一次发版是 2018 年。</li></ul></li></ul><h3 id="适用场景-1" tabindex="-1"><a class="header-anchor" href="#适用场景-1"><span>适用场景</span></a></h3><ul><li><p>关键业务应用：对于那些对数据库的连续性和可用性要求很高的关键业务应用，使用MySQL MHA来实现主从复制和故障转移可以确保数据的可访问性和一致性，减少业务中断的风险。</p></li><li><p>高并发读写负载：当应用需要处理大量并发的读写请求时，MySQL MHA 可以通过自动将负载分布到从节点上来提高系统的性能和可扩展性。</p></li><li><p>节点故障容忍：MySQL MHA 可以通过快速故障检测和故障转移来应对节点故障，当主节点发生故障时，它可以自动将数据库切换到备用节点上，使系统快速恢复，并减少不可用时间。</p></li><li><p>故障恢复和数据冗余：通过配置多个备用节点来实现数据的冗余，并备份重要数据，即使主节点发生故障，也能够从备用节点中恢复数据。</p></li><li><p>数据库升级和维护：MySQL MHA 在数据库升级和维护过程中也非常有用。通过先将备用节点切换为主节点，然后对原主节点进行升级或维护，可以减少服务中断的时间。</p></li></ul><h3 id="可用性-1" tabindex="-1"><a class="header-anchor" href="#可用性-1"><span>可用性</span></a></h3><p>可用性达到：99.9%</p><h2 id="mha-proxysql-基于-mysql-服务器特性" tabindex="-1"><a class="header-anchor" href="#mha-proxysql-基于-mysql-服务器特性"><span>MHA + ProxySQL（基于 MySQL 服务器特性）</span></a></h2><p>MHA + ProxySQL 是两种可以用于提高 MySQL 可用性和性能的工具。MHA 是 MySQL 高可用性架构，它使用 MySQL 复制来实现数据冗余，并使用故障切换来实现自动故障转移。ProxySQL 是一个代理服务器，它可以用于负载平衡 MySQL 服务器、监控 MySQL 服务器的性能并执行一些 SQL 转换。</p><h3 id="原理-2" tabindex="-1"><a class="header-anchor" href="#原理-2"><span>原理</span></a></h3><p>MHA + ProxySQL 的工作原理如下：</p><ol><li>将 MySQL 服务器分布到多个节点上。</li><li>在每个节点上启动 MySQL Replication 服务。</li><li>在每个节点上启动 ProxySQL 服务。</li><li>使用 MHA 来配置 MySQL Replication 服务。</li><li>使用 ProxySQL 来配置负载平衡、监控和 SQL 转换。</li></ol><h3 id="架构-2" tabindex="-1"><a class="header-anchor" href="#架构-2"><span>架构</span></a></h3><figure><img src="/assets/mysql_mha_proxysql_overview-B5I-TJaf.png" alt="MHA + ProxySQL 架构图" tabindex="0" loading="lazy"><figcaption>MHA + ProxySQL 架构图</figcaption></figure><h3 id="优势与不足-2" tabindex="-1"><a class="header-anchor" href="#优势与不足-2"><span>优势与不足</span></a></h3><ul><li><p>优点：</p><ul><li>高可用性：MHA + ProxySQL 使用 MySQL Replication 和故障切换来实现数据冗余和自动故障转移，因此即使一个节点出现故障，数据仍然可以从其他节点访问。</li><li>高性能：ProxySQL 可以用于负载平衡 MySQL 服务器，因此可以提高数据访问性能。</li><li>易于管理：MHA 和 ProxySQL 都具有易于使用的管理界面，因此易于管理。</li></ul></li><li><p>缺点：</p><ul><li>复杂性：MHA + ProxySQL 是一个复杂的系统，因此需要一定的学习曲线才能使用。</li><li>成本：MHA + ProxySQL 需要额外的硬件和软件资源，因此成本较高。</li></ul></li></ul><h3 id="适用场景-2" tabindex="-1"><a class="header-anchor" href="#适用场景-2"><span>适用场景</span></a></h3><p>MHA + ProxySQL 适用于需要高可用性和高性能的场景，例如：</p><ul><li>电商网站</li><li>社交网络</li><li>游戏服务器</li></ul><h3 id="可用性-2" tabindex="-1"><a class="header-anchor" href="#可用性-2"><span>可用性</span></a></h3><p>可用性达到：99.999%</p><h2 id="mmm-基于-mysql-服务器特性" tabindex="-1"><a class="header-anchor" href="#mmm-基于-mysql-服务器特性"><span>MMM（基于 MySQL 服务器特性）</span></a></h2><p>MMM（Multi-Master Replication Manager）是一组灵活的脚本，用于执行 MySQL 主-主复制配置的监视/故障转移和管理（任何时候只有一个节点可写）。</p><p>同步数据的方式是 Multi-Master Replication Manager，在 MySQL 分表分块到主从解释，多主多从的设置，是一个 loop 环形，每个 DB 既是前一个 DB 的 Slave 又是后一个的 Master。优势就在于，一个 Master 挂掉，也还可以继续 DB 操作。每个 DB 都可以进行读写，分散压力。</p><h3 id="原理-3" tabindex="-1"><a class="header-anchor" href="#原理-3"><span>原理</span></a></h3><p>主要的思想还是主从复制，然后再多设置一个master来备用。MMM(Master-Master replication managerfor Mysql，Mysql主主复制管理器)是一套灵活的脚本程序，基于perl实现，用来对mysql replication进行监控和故障迁移，并能管理mysql Master-Master复制的配置(同一时间只有一个节点是可写的)。</p><ul><li><p>mmm_mond：监控进程，负责所有的监控工作，决定和处理所有节点角色活动。此脚本需要在监管机上运行。</p></li><li><p>mmm_agentd：运行在每个mysql服务器上的代理进程，完成监控的探针工作和执行简单的远端服务设置。此脚本需要在被监管机上运行。</p></li><li><p>mmm_control：一个简单的脚本，提供管理mmm_mond进程的命令。mysql-mmm的监管端会提供多个虚拟IP（VIP），包括一个可写VIP，多个可读VIP，通过监管的管理，这些IP会绑定在可用mysql之上，当某一台mysql宕机时，监管会将VIP迁移至其他mysql。</p></li></ul><p>在整个监管过程中，需要在mysql中添加相关授权用户，以便让mysql可以支持监理机的维护。授权的用户包括一个mmm_monitor用户和一个mmm_agent用户，如果想使用mmm的备份工具则还要添加一个mmm_tools用户。</p><h3 id="架构-3" tabindex="-1"><a class="header-anchor" href="#架构-3"><span>架构</span></a></h3><figure><img src="/assets/mysql_mmm_overview-0l9y5sep.png" alt="MMM 架构图" tabindex="0" loading="lazy"><figcaption>MMM 架构图</figcaption></figure><h3 id="优势与不足-3" tabindex="-1"><a class="header-anchor" href="#优势与不足-3"><span>优势与不足</span></a></h3><ul><li><p>优点：</p><ul><li>高可用性，扩展性好，出现故障自动切换，对于主主同步，在同一时间只提供一台数据库写操作，保证的数据的一致性。</li><li>自动的主主 Failover 切换，一般 3s 以内切换备机。</li><li>多个从节点读的负载均衡。</li><li>提供了读写VIP的配置。</li></ul></li><li><p>缺点：</p><ul><li>故障切换会丢事务(主备使用半同步复制解决)。</li><li>不支持GTID。</li><li>无法完全保证数据的一致性。 如主 1 挂了，MMM monitor 已经切换到主 2 上来了，而若此时双主复制中，主 2 数据落后于主 1（即还未完全复制完毕），那么此时的主 2 已经成为主节点，对外提供写服务，从而导致数据不一。（主从延迟越大，则当主节点切换时数据丢失的越多），建议采用半同步复制方式，减少失败的概率。</li><li>由于是使用虚拟 IP 浮动技术，类似 Keepalived，故 RIP（真实 IP）要和 VIP（虚拟 IP）在同一网段。如果是在不同网段也可以，需要用到虚拟路由技术。但是绝对要在同一个 IDC 机房，不可跨 IDC 机房组建集群。</li><li>Monitor节点是单点，可以结合Keepalived实现高可用。</li></ul></li></ul><h3 id="适用场景-3" tabindex="-1"><a class="header-anchor" href="#适用场景-3"><span>适用场景</span></a></h3><ul><li><p>使用基于日志点复制的主从复制方式</p></li><li><p>当前正在使用主主复制的架构，可以考虑使用MMM管理工具来进行管理</p></li><li><p>需要考虑读高可用的场景</p></li><li><p>多个地理位置和数据中心：对于分布在多个地理位置或数据中心的应用，MySQL MMM 可以配置多个主节点，实现跨地理位置或数据中心的数据复制和冗余，增加系统的容错性和可用性。MMM架构同时提供了读VIP和写VIP，而MHA架构则只提供了写VIP，也就是说在MHA中，并不会对slave的宕机进行监控。</p></li><li><p>MMM的适用场景为数据库访问量大，业务增长快，并且能实现读写分离的场景。</p></li></ul><h3 id="可用性-3" tabindex="-1"><a class="header-anchor" href="#可用性-3"><span>可用性</span></a></h3><p>可用性达到：99.9%</p><h2 id="mysql-innodb-cluster-1" tabindex="-1"><a class="header-anchor" href="#mysql-innodb-cluster-1"><span>MySQL Innodb Cluster</span></a></h2><h3 id="原理-4" tabindex="-1"><a class="header-anchor" href="#原理-4"><span>原理</span></a></h3><p>MySQL 5.7 推出了 MGR（MySQL Group Replication），与 PXC 类似，也实现了多节点数据写入和强一致性的特点。MGR 采用 GCS（Group Communication System）协议同步数据，GCS 可保证消息的原子性。在使用 MGR 时，如果要实现完整的高可用方案，就需要用到 InnoDB Cluster。</p><ul><li><p>InnoDB Cluster 由以下技术组成：</p><ul><li>MySQL Shell，MySQL 的高级客户端和代码编辑器，用于管理 MGR 集群。</li><li>MySQL Server 和Group Replication，使一组 MySQL 实例能够提供高可用性。InnoDB Cluster 提供了一种替代的、易于使用的编程方式来使用组复制。</li><li>MySQL Router，在应用程序和集群之间提供透明的路由。当 MGR 发生切换树，自动路由到新的 MGR 主节点。</li></ul></li></ul><p>基于 MySQL Group Replication构建，提供自动成员管理、容错、自动故障转移等功能。InnoDB Cluster通常以单主模式运行，具有一个主实例（读写）和多个辅助实例（只读）。高级用户还可以利用 多主 模式，其中所有实例都是主实例。您甚至可以在 InnoDB Cluster 在线时更改集群的拓扑，以确保尽可能高的可用性。</p><h3 id="架构-4" tabindex="-1"><a class="header-anchor" href="#架构-4"><span>架构</span></a></h3><figure><img src="/assets/mysql_innodb_cluster_overview-CGMlSKTu.png" alt="MySQL Innodb Cluster 架构图" tabindex="0" loading="lazy"><figcaption>MySQL Innodb Cluster 架构图</figcaption></figure><h3 id="优势与不足-4" tabindex="-1"><a class="header-anchor" href="#优势与不足-4"><span>优势与不足</span></a></h3><ul><li><p>优点</p><ul><li>集成易用。MySQL InnoDB集群紧密集成了MySQL Servers with Group Replication，MySQL Router，和MySQL Shell，所以你不必依赖于外部工具，脚本或其他部件。</li><li>支持多节点写入，有冲突检测机制。</li><li>一致性。数据零丢失（RPO=0）， 主要成员故障时，数据不会丢失。防止网络分区，通过大多数在线原则防止网络分区。InnoDB Cluster通过使用同步复制和组提交等技术确保数据的一致性。当一个事务被提交后，它会被同步地应用到所有节点上，从而保证数据的一致性。</li><li>高可用性。InnoDB Cluster支持自动故障检测和故障转移，当集群中的一个节点发生故障时，系统可以自动将工作负载迁移到其他节点上，保证数据库的高可用性。</li><li>水平扩展。InnoDB Cluster支持在集群中添加新的节点，从而实现水平扩展和负载均衡。通过添加更多的节点，可以提高系统的处理能力和性能。</li><li>全自动故障转移: InnoDB Cluster 能够自动检测和诊断故障，并进行必要的故障转移，使得数据可以继续可用。自动选取主要成员，自动控制网络分区。</li></ul></li><li><p>缺点</p><ul><li>只支持 InnoDB 表，每张表都要有主键。</li><li>最多只支持 9 个节点。</li><li>配置限制。InnoDB Cluster目前有一些配置上的限制，比如只能在相同的子网内运行节点、需要使用全局事务标识符（GTID）等。这些限制可能会对一些特定场景的部署造成影响。</li><li>复杂性：InnoDB Cluster 的部署和管理比较复杂，需要对 MySQL 的工作原理有一定的了解；</li><li>性能影响：由于自动复制和高可用性的要求，InnoDB Cluster 可能对 MySQL 的性能造成一定的影响；</li></ul></li></ul><h3 id="适用场景-4" tabindex="-1"><a class="header-anchor" href="#适用场景-4"><span>适用场景</span></a></h3><ul><li><p>关键业务应用：对于关键业务应用，数据的连续性和可用性至关重要。通过使用MySQL InnoDB Cluster，可以确保即使在节点故障的情况下，也能保持数据的可访问性和一致性。</p></li><li><p>大规模读写负载：当应用需要处理大量的读写请求时，MySQL InnoDB Cluster的水平扩展和负载均衡功能可以帮助扩展系统性能，并在需要时自动将负载分布到多个节点。</p></li><li><p>延迟敏感型应用：对于对响应时间要求高的应，MySQL InnoDB Cluster的自动故障检测和故障转移功能可以快速将工作负载迁移到备用节点上，从而最大程度地减少不可用时间和用户感知的延迟。</p></li><li><p>多地区数据复制：如果需要在不同地区进行数据复制或主从架构，MySQL InnoDB Cluster可以帮助实现跨地理位置的数据同步，确保数据的一致性和可用性。</p></li><li><p>数据库异地备份：通过MySQL InnoDB Cluster，可以设置异地备份节点以实现数据的容灾和灾备。这样，即使发生灾难，仍然可以恢复数据并保持业务的运行。</p></li></ul><h3 id="可用性-4" tabindex="-1"><a class="header-anchor" href="#可用性-4"><span>可用性</span></a></h3><p>可用性达到：99.999%</p><h2 id="mysql-innodb-clusterset" tabindex="-1"><a class="header-anchor" href="#mysql-innodb-clusterset"><span>MySQL InnoDB ClusterSet</span></a></h2><h3 id="原理-5" tabindex="-1"><a class="header-anchor" href="#原理-5"><span>原理</span></a></h3><p>MySQL InnoDB ClusterSet 通过将主要的 InnoDB Cluster 与其他位置（例如，不同数据中心）的一个或多个副本链接，为 InnoDB Cluster 部署提供容灾能力。InnoDB ClusterSet 使用专门的 ClusterSet 复制通道，自动管理从主要集群到副本集群的复制。如果主要集群因数据中心损毁或网络连接丢失变得无法使用，用户可以激活副本集群以恢复服务的可用性。</p><p>InnoDB ClusterSet优先考虑可用性而不是数据一致性，以便最大限度地提高容灾能力。当主集群遇到问题时，部分或全部复制集群与主集群不完全一致。在这些场景中，如果触发紧急故障转移，任何未复制或分散的事务都有丢失的风险，并且只能手动恢复和协调。不能保证在发生紧急故障转移时保留数据。</p><p>通过将一个主mgr集群和一个或多个在其他位置(比如不同的数据中心)的副本连接起来。InnoDB ClusterSet使用专用的ClusterSet复制通道自动管理从主集群到副本集群的复制。如果主集群由于数据中心的丢失或到它的网络连接的丢失而变得不可用，可以使一个副本集群激活以恢复服务的可用性。复制通道还是属于异步复制，所以通常会有一定的复制延迟。</p><h3 id="架构-5" tabindex="-1"><a class="header-anchor" href="#架构-5"><span>架构</span></a></h3><figure><img src="/assets/mysql_clusterset_overview-CILiJ9uR.png" alt="MySQL InnoDB ClusterSet架构图" tabindex="0" loading="lazy"><figcaption>MySQL InnoDB ClusterSet架构图</figcaption></figure><h3 id="优势与不足-5" tabindex="-1"><a class="header-anchor" href="#优势与不足-5"><span>优势与不足</span></a></h3><ul><li><p>优点</p><ul><li><p>主集群和副本集群之间的紧急故障转移可以由管理员通过 MySQL Shell，使用 AdminAPI 进行操作；</p></li><li><p>InnoDB ClusterSet 部署中可以拥有的副本集群的数量没有定义的限制；</p></li><li><p>异步复制通道将事务从主集群复制到副本集群。clusterset_replication 在 InnoDB ClusterSet 创建过程中，在每个集群上都设置了名为 ClusterSet 的复制通道，当集群是副本时，它使用该通道从主集群复制事务。底层组复制技术管理通道并确保复制始终在主集群的主服务器（作为发送方）和副本集群的主服务器（作为接收方）之间进行；</p></li><li><p>每个 InnoDB ClusterSet 集群，只有主集群能够接收写请求，大多数的读请求流量也会被路由到主集群，不过也可以指定读请求到其他的集群；</p></li></ul></li><li><p>缺点</p><ul><li>MySQL服务器版本为8.0.27之后</li><li>新加入的InnoDB Cluster不能是已有MySQL InnoDB ClusterSet的一部分</li><li>InnoDB Cluster必须使用单主模式</li><li>任何成员服务器上都不能有来自组外服务器的入站复制通道</li><li>在创建 InnoDB ClusterSet 部署时，InnoDB Cluster 必须在线，并且其主要成员服务器必须可以使用 MySQL Shell 访问</li><li>MySQL Shell与MySQL Router均须使用8.0.27之后版本</li><li>InnoDB ClusterSet 优先考虑可用性而不是一致性，以最大限度地提高容灾能力。如果用户不能容忍故障转移期间事务或数据的任何丢失，那么不要使用 InnoDB ClusterSet ，可以考虑使用单个 InnoDB Cluster</li><li>InnoDB ClusterSet 不会自动故障转移到副本集群。需要管理员确认后执行操作。</li><li>InnoDB ClusterSet 只支持异步复制，不能使用半同步复制，无法避免异步复制的缺陷：数据延迟、数据一致性等。</li><li>InnoDB ClusterSet 部署只能包含一个读写主集群。所有副本集群都是只读的。不允许使用具有多个主集群的双活设置，因为在集群发生故障时无法保证数据一致性。</li><li>一个 InnoDB Cluster 只能参与一个 InnoDB ClusterSet 部署</li><li>InnoDB ClusterSet 不支持使用运行 MySQL Server 5.7 的实例</li></ul></li></ul><h3 id="适用场景-5" tabindex="-1"><a class="header-anchor" href="#适用场景-5"><span>适用场景</span></a></h3><p>MySQL InnoDB ClusterSet适用于需要高可用性、可伸缩性和强一致性的场景。例如：</p><ul><li>电子商务网站：电子商务网站需要高可用性，以确保用户在任何时候都可以访问网站。MySQL InnoDB ClusterSet可以通过使用多个节点来实现高可用性。</li><li>社交媒体平台：社交媒体平台需要高可用性和可伸缩性，以支持大量用户。MySQL InnoDB ClusterSet可以通过使用多个节点来实现高可用性和可伸缩性。</li><li>游戏服务器：游戏服务器需要强一致性，以确保玩家在游戏中获得公平的体验。MySQL InnoDB ClusterSet可以通过使用 Raft 共识算法来实现强一致性。</li></ul><h3 id="可用性-5" tabindex="-1"><a class="header-anchor" href="#可用性-5"><span>可用性</span></a></h3><p>可用性达到：99.999%</p><h2 id="mysql-innodb-replicaset" tabindex="-1"><a class="header-anchor" href="#mysql-innodb-replicaset"><span>MySQL InnoDB ReplicaSet</span></a></h2><h3 id="原理-6" tabindex="-1"><a class="header-anchor" href="#原理-6"><span>原理</span></a></h3><p>MySQL InnoDB ReplicaSet 是 MySQL 团队在 2020 年推出的一款产品，用来帮助用户快速部署和管理主从复制。MySQL InnoDB ReplicaSet 在 MySQL 8.0.19 版本之后开始支持，本质还是是基于 GTID 的异步复制；并且 MySQL Shell 的 AdminAPI 新增了 对 InnoDB ReplicaSet 的支持，可以用与 InnoDB Cluster 类似的方式管理一组运行基于 GTID 的异步复制的 MySQL 实例。InnoDB ReplicaSet 由一个主和多个从组成。您可以使用 ReplicaSet 对象和 AdminAPI 操作，例如检查 InnoDB ReplicaSet 的状态，并在发生故障时手动故障转移到新的主数据库。与 InnoDB Cluster 类似，MySQL Router 支持针对 InnoDB ReplicaSet 的引导，这意味着可以自动配置 MySQL Router 以使用 InnoDB ReplicaSet，而无需手动配置它。这使 InnoDB ReplicaSet 成为启动和运行 MySQL 复制和 MySQL Router 的快速简便方法，使其非常适合横向扩展读取。</p><p>MySQL InnoDB ReplicaSet 整合了 MySQL 相关技术，用户能够通过 MySQL Shell 部署和管理 MySQL 主从复制。</p><p>MySQL InnoDB ReplicaSet 基于异步的主从复制实现，因此适用于用户对高可用性要求不高的环境，用户可以通过 MySQL Shell 快速搭建及管理主从复制，避免了搭建主从复制时，大量的手动操作。</p><p>InnoDB ReplicaSet由单个主节点和多个辅助节点（传统上称为 MySQL 复制源和副本）组成。InnoDB ReplicaSet 至少由两台 MySQL 服务器实例组成，并提供用户熟知的 MySQL 主从复制功能，例如，读取横向扩展和数据安全性。与InnoDB cluster 类似, MySQL Router 支持针对 InnoDB ReplicaSet 的引导, 这意味着可以自动配置 MySQL Router 以使用 InnoDB ReplicaSet, 而无需手动配置文件. 这使得 InnoDB ReplicaSet 成为一种快速简便的方法, 可以启动和运行 MySQL 复制和 MySQL Router, 非常适合扩展读取, 并在不需要 InnoDB 集群提供高可用性的用例中提供手动故障转移功能。</p><h3 id="架构-6" tabindex="-1"><a class="header-anchor" href="#架构-6"><span>架构</span></a></h3><figure><img src="/assets/mysql_replicaset_overview-UQ2Vw9-G.png" alt="MySQL InnoDB ReplicaSet" tabindex="0" loading="lazy"><figcaption>MySQL InnoDB ReplicaSet</figcaption></figure><h3 id="优势与不足-6" tabindex="-1"><a class="header-anchor" href="#优势与不足-6"><span>优势与不足</span></a></h3><ul><li>优点： <ul><li>MySQL Router 可以很好的兼容 InnoDB ReplicaSet，可自动识别到副本集主从切换，将新的 R/W 连接指向 Primary。</li><li>简单易用：InnoDB ReplicaSet 的部署和管理非常简单，只需要在每个节点上安装 MySQL 并配置主从复制即可，简化了对 MySQL 主从的相关管理操作。</li><li>高可用性：InnoDB ReplicaSet 通过使用主从复制技术，可以确保数据在主从节点之间保持一致，即使主节点发生故障，从节点也可以继续为用户提供服务。</li><li>扩展性：InnoDB ReplicaSet 可以通过增加从节点的数量来提高数据库的读取性能。</li></ul></li><li>缺点： <ul><li><p>没有自动故障转移，在主节点不可用的情况下，需要使用 AdminAPI 手动触发故障转移，然后才能再次进行任何更改。但是，辅助实例仍可用于读取；</p></li><li><p>由于意外停止或不可用，无法防止部分数据丢失：在意外停止时未完成的事务可能会丢失；</p></li><li><p>在意外退出或不可用后无法防止不一致。如果手动故障转移提升了一个辅助实例，而前一个主实例仍然可用，例如，由于网络分区，裂脑情况可能会导致数据不一致；</p></li><li><p>InnoDB ReplicaSet 不支持多主模式。允许写入所有成员的经典复制拓扑无法保证数据一致性；</p></li><li><p>读取横向扩展是有限的。InnoDB ReplicaSet 基于异步复制，因此无法像 Group Replication 那样调整流量控制；</p></li><li><p>一个 ReplicaSet 最多由一个主实例组成。支持一个或多个辅助。尽管可以添加到 ReplicaSet 的辅助节点的数量没有限制，但是连接到 ReplicaSet 的每个 MySQL Router 都必须监视每个实例。因此，一个 ReplicaSet 中加入的实例越多，监控就越多。 使用 InnoDB ReplicaSets 的主要原因是你有更好的写性能。使用 InnoDB ReplicaSets 的另一个原因是它们允许在不稳定或慢速网络上部署，而 InnoDB Cluster 则不允许。</p></li></ul></li></ul><h3 id="适用场景-6" tabindex="-1"><a class="header-anchor" href="#适用场景-6"><span>适用场景</span></a></h3><p>InnoDB ReplicaSet 是一种高可用、扩展性和简单易用的高可用解决方案，适合需要高可用性和扩展性的数据库应用程序。</p><h3 id="可用性-6" tabindex="-1"><a class="header-anchor" href="#可用性-6"><span>可用性</span></a></h3><p>可用性达到：99.999%</p><h2 id="galera-基于分布式协议" tabindex="-1"><a class="header-anchor" href="#galera-基于分布式协议"><span>Galera (基于分布式协议)</span></a></h2><h3 id="原理-7" tabindex="-1"><a class="header-anchor" href="#原理-7"><span>原理</span></a></h3><p>基于 Galera 的 MySQL 高可用集群， 是多主数据同步的 MySQL 集群解决方案，使用简单，没有单点故障，可用性高。 该架构主要有以下几种特性： (1).同步复制 Synchronous replication (2).Active-active multi-master 拓扑逻辑 (3).可对集群中任一节点进行数据读写 (4).自动成员控制，故障节点自动从集群中移除 (5).自动节点加入 (6).真正并行的复制，基于行级 (7).直接客户端连接，原生的 MySQL 接口 (8).每个节点都包含完整的数据副本 (9).多台数据库中数据同步由 wsrep 接口实现 其局限性体现在以下几点： (1).目前的复制仅仅支持 InnoDB 存储引擎,任何写入其他引擎的表，包括 mysql.*表将不会复制,但是 DDL 语句会被复制的,因此创建用户将会被复制,但是 insert into mysql.user…将不会被复制的. (2).DELETE 操作不支持没有主键的表,没有主键的表在不同的节点顺序将不同,如果执行 SELECT…LIMIT… 将出现不同的结果集. (3).在多主环境下 LOCK/UNLOCK TABLES 不支持,以及锁函数 GET_LOCK(), RELEASE_LOCK()… (4).查询日志不能保存在表中。如果开启查询日志，只能保存到文件中。 (5).允许最大的事务大小由 wsrep_max_ws_rows 和 wsrep_max_ws_size 定义。任何大型操作将被拒绝。如大型的 LOAD DATA 操作。 (6).由于集群是乐观的并发控制，事务 commit 可能在该阶段中止。如果有两个事务向在集群中不同的节点向同一行写入并提交，失败的节点将中止。对 于集群级别的中止，集群返回死锁错误代码(Error: 1213 SQLSTATE: 40001 (ER_LOCK_DEADLOCK)). (7).XA 事务不支持，由于在提交上可能回滚。 (8).整个集群的写入吞吐量是由最弱的节点限制，如果有一个节点变得缓慢，那么整个集群将是缓慢的。为了稳定的高性能要求，所有的节点应使用统一的硬件。 (9).集群节点建议最少 3 个。 (10).如果 DDL 语句有问题将破坏集群。</p><h3 id="工作原理图" tabindex="-1"><a class="header-anchor" href="#工作原理图"><span>工作原理图</span></a></h3><figure><img src="/assets/mysql_galera_cluster_workflow-DF6D7wTM.png" alt="MySQL Galera Cluster Work Flow" tabindex="0" loading="lazy"><figcaption>MySQL Galera Cluster Work Flow</figcaption></figure><h3 id="架构-7" tabindex="-1"><a class="header-anchor" href="#架构-7"><span>架构</span></a></h3><figure><img src="/assets/mysql_galera_cluster_overview_006-CtS42hod.png" alt="MySQL Galera Cluster" tabindex="0" loading="lazy"><figcaption>MySQL Galera Cluster</figcaption></figure><h3 id="优势与不足-7" tabindex="-1"><a class="header-anchor" href="#优势与不足-7"><span>优势与不足</span></a></h3><ul><li><p>优点：</p><ul><li>高可用性：Galera 集群通过使用多个节点来实现高可用性，即使主节点发生故障，其他节点也可以继续为用户提供服务。</li><li>强一致性：Galera 集群使用 2PC 协议在节点之间同步数据，这意味着所有节点都拥有相同的数据。</li><li>多主：Galera 集群允许多个节点同时写入数据，这提高了数据库的吞吐量。</li><li>易于管理：Galera 集群易于管理，可以通过 MySQL 管理工具进行管理。</li><li>有成熟的社区，有互联网公司在大规模地使用；</li><li>自动故障转移，自动添加、剔除节点。</li><li>读写可扩展性。</li></ul></li><li><p>缺点：</p><ul><li>需要为原生 MySQL 节点打 wsrep 补丁；</li><li>只支持 innodb 储存引擎；</li><li>至少三节点</li><li>Galera 集群的性能比传统的主从复制略低，但仍然能够满足大多数应用程序的需求。</li><li>更小的客户端延迟。</li></ul></li></ul><h3 id="适用场景-7" tabindex="-1"><a class="header-anchor" href="#适用场景-7"><span>适用场景</span></a></h3><ul><li>电子商务网站：电子商务网站需要高可用性，以确保用户在任何时候都可以访问网站。Galera 集群可以帮助确保即使主节点发生故障，用户仍然可以访问网站。</li><li>社交媒体平台：社交媒体平台需要高可用性，以确保用户在任何时候都可以访问平台。Galera 集群可以帮助确保即使主节点发生故障，用户仍然可以访问平台。</li><li>游戏服务器：游戏服务器需要高可用性，以确保玩家在任何时候都可以玩游戏。Galera 集群可以帮助确保即使主节点发生故障，玩家仍然可以玩游戏。</li></ul><h3 id="可用性-7" tabindex="-1"><a class="header-anchor" href="#可用性-7"><span>可用性</span></a></h3><p>可用性达到： 99.99%</p><h2 id="pxc" tabindex="-1"><a class="header-anchor" href="#pxc"><span>PXC</span></a></h2><p>PXC（Percona XtraDB Cluster）是一个完全开源的 MySQL 高可用解决方案。它将 Percona Server、Percona XtraBackup 与 Galera 库集成在一起，以实现多主复制的 MySQL 集群。</p><p>基于Galera的高可用方案主要有MariaDB Galera cluster和Percona XtraDB cluster，目前PXC架构在生产线上用的很多而且更加成熟。PXC相比那些传统的基于主从模式的集群架构MHA和双主，Galera cluster最突出的特点是解决了诟病已久的复制延迟问题，基本上可以达到实时同步。而且节点与节点之间，他们互相的关系是对等的。本身galera cluster也是一种多主架构。PXC是在存储引擎层实现的同步复制，而非异步复制，所以其数据的一致性是相当高的。</p><h3 id="原理-8" tabindex="-1"><a class="header-anchor" href="#原理-8"><span>原理</span></a></h3><p>Percona XtraDB Cluster (PXC) 是一个由 Percona 开发的高可用、可扩展和强一致的 MySQL 集群解决方案。PXC 基于 Galera Replication 技术，由一个包含多个节点的集群组成，每个节点都是一个完整的 MySQL 实例。PXC 通过使用多副本复制和 Paxos 算法来保证数据的强一致性。</p><p>PXC 的主要特性包括：</p><p>高可用性：PXC 可以通过使用多副本复制来实现数据的高可用性，即使一个节点发生故障，集群也可以继续提供服务。 可扩展性：PXC 可以通过增加节点的数量来实现数据库集群的可扩展性，以满足不断增长的业务需求。 强一致性：PXC 使用多副本复制和 Paxos 算法来保证数据的强一致性，即使发生网络分区，集群也可以保证数据的一致性。 高性能：PXC 使用多副本复制和 Paxos 算法来提高数据库集群的性能，可以满足高并发的业务需求。</p><h3 id="架构-8" tabindex="-1"><a class="header-anchor" href="#架构-8"><span>架构</span></a></h3><ul><li>数据读写示意图</li></ul><figure><img src="/assets/mysql_percona_xtradb_cluster_overview-Cu8Ndzfp.png" alt="Percona XtraDB Replication" tabindex="0" loading="lazy"><figcaption>Percona XtraDB Replication</figcaption></figure><ul><li>架构图</li></ul><figure><img src="/assets/mysql_percona_xtradb_cluster_overview_001-DctM-DXf.png" alt="Percona XtraDB Cluster" tabindex="0" loading="lazy"><figcaption>Percona XtraDB Cluster</figcaption></figure><h3 id="优势与不足-8" tabindex="-1"><a class="header-anchor" href="#优势与不足-8"><span>优势与不足</span></a></h3><ul><li><p>优点</p><ul><li>去中心：任何节点宕机，集群都可以继续运行而不会丢失任何数据。</li><li>多主复制：每个节点都可以写入数据并自动同步到其他节点。由于是多节点写入，所以DB故障切换很容易。完成了真正的多节点读写的集群方案；</li><li>同步复制：事务要么在所有节点提交或不提交。数据写入需要集群所有节点验证通过才会提交，保证了数据的强一致性。</li><li>在从服务器上并行应用事件，真正意义上的并行复制。 改善了主从复制延迟问题，基本上达到了实时同步；</li><li>节点自动配置，数据一致性，不再是异步复制。 新加入的节点可以自动部署，无需提交手动备份，维护方便；</li><li>PXC最大的优势：强一致性、实现了MySQL集群的高可用性和数据的强一致性；无同步延迟。</li></ul></li><li><p>缺点</p><ul><li>只支持 InnoDB 引擎，不支持表级锁，不支持XA事务。</li><li>生成的ID不连续。在PXC中，生成的ID有可能是不连续的，如果期望连续就需要将ID生成策略提高一级，比如放在数据切分中间件中，如mycat等。或者在程序中执行ID的赋予问题。</li><li>写扩大的问题，存在写扩大的问题。所以节点上都会发生写操作，对于写负载过大的场景，不推荐使用PXC。</li><li>加入新节点时开销大，增加节点时，必须从现有节点之一复制完整的数据集。</li><li>集群吞吐量取决于性能最差的节点（木桶效应）</li><li>锁冲突的问题，因为需要保证数据的一致性，PXC采用的实时基于存储引擎层来实现同步复制，所以在多节点并发写入时，锁冲突问题比较严重。</li><li>脑裂问题，PXC集群数量建议为奇数，防止脑裂。任何命令执行出现unkown command ，表示出现脑裂，集群两节点间4567端口连不通，无法提供对外服务。</li></ul></li></ul><h3 id="适用场景-8" tabindex="-1"><a class="header-anchor" href="#适用场景-8"><span>适用场景</span></a></h3><p>PXC 适用于需要高可用性、可扩展性和强一致性的 MySQL 应用场景，例如电商、金融、游戏等行业。</p><h3 id="可用性-8" tabindex="-1"><a class="header-anchor" href="#可用性-8"><span>可用性</span></a></h3><p>可用性达到：99.999%</p><h2 id="mysql-cluster-基于分布式协议-存储引擎" tabindex="-1"><a class="header-anchor" href="#mysql-cluster-基于分布式协议-存储引擎"><span>MySQL Cluster (基于分布式协议+存储引擎)</span></a></h2><p>MySQL cluster 是官方集群的部署方案，通过使用 NDB 存储引擎实时备份冗余数据，实现数据库的高可用性和数据一致性。</p><h3 id="原理-9" tabindex="-1"><a class="header-anchor" href="#原理-9"><span>原理</span></a></h3><p>MySQL 群集是 MySQL 适合于分布式计算环境的高可用、高冗余版本。它采用了 NDB Cluster 存储引擎，允许在 1 个群集中运行多个 MySQL 服务器。在 MySQL 5.0 及以上的二进制版本中，以及与最新的 Linux 版本兼容的 RPM 包中提供了该存储引擎。</p><p>MySQL 群集是一种技术，该技术允许在无共享的系统中部署“内存中”和“磁盘中”数据库的 Cluster 。通过无共享体系结构，系统能够使用廉价的硬件，而且对软硬件无特殊要求。此外，由于每个组件有自己的内存和磁盘，不存在单点故障。MySQL Cluster 由一组计算机构成，每台计算机上均运行着多种进程，包括 MySQL 服务器，NDB Cluster 的数据节点，管理服务器，以及（可能存在的）专门的数据访问程序。</p><p>管理服务器(MGM节点)负责管理 Cluster 配置文件和 Cluster 日志。Cluster 中的每个节点从管理服务器检索配置数据。</p><p>当数据节点内出现新的事件时，节点将关于这类事件的信息传输到管理服务器，然后，将这类信息写入 Cluster 日志。</p><p>目前能够运行 MySQL Cluster 的操作系统有 Linux、Mac OS X 和 Solaris，最新的版本已经支持 Windows 操作系统。</p><p>MySQL 群集的数据节点之间的通信是不加密的，并且需要高速的带宽，所以建议把群集建立在一个高速局域网内，不建议跨网段、跨公网的部署这种系统体系。</p><p>MySQL 群集分为三种节点：管理节点，数据节点和SQL节点。</p><ul><li><p>管理节点：主要用于管理各个节点，能够通过命令对某个节点进行重启、关闭、启动等操作。也能够监视全部节点的工作状态。</p></li><li><p>数据节点：主要是对数据的存储，不提供其他的服务。</p></li><li><p>SQL节点：主要是对外提供SQL功能，类似一台普通的 MySQL Server。</p></li></ul><p>其中数据节点会存储集群中的数据分区和分区的副本：</p><ul><li><p>节点组（Node Group）： 一组数据节点的集合。节点组的个数=节点数 / 副本数；比如有集群中 4 个节点，副本数为 2（对应 NoOfReplicas 的设置），那么节点组个数为2。在可用性方面，数据的副本在组内交叉分配，一个节点组内只有要一台机器可用，就可以保证整个集群的数据完整性，实现服务的整体可用。</p></li><li><p>分区（Partition）：MySql Cluster 是一个分布式的存储系统，数据按照 分区 划分成多份存储在各数据节点中，分区个数由系统自动计算，分区数 = 数据节点数 / LDM 线程数；</p></li><li><p>副本（Replica）：分区数据的备份，有几个分区就有几个副本，为了避免单点，保证 MySql Cluster 集群的高可用，原始数据对应的分区和副本通常会保存在不同的主机上，在一个节点组内进行交叉备份。</p></li></ul><h3 id="架构-9" tabindex="-1"><a class="header-anchor" href="#架构-9"><span>架构</span></a></h3><figure><img src="/assets/mysql_ndb_cluster_overview-CQ6OgoOw.png" alt="MySQL Cluster" tabindex="0" loading="lazy"><figcaption>MySQL Cluster</figcaption></figure><h3 id="优势与不足-9" tabindex="-1"><a class="header-anchor" href="#优势与不足-9"><span>优势与不足</span></a></h3><ul><li>优点： <ul><li>全部使用官方组件，不依赖于第三方软件；</li><li>可以实现数据的强一致性。</li><li>高可用性：MySQL Cluster 通过使用 Raft 算法来协调节点之间的状态，从而实现数据的强一致性。即使一个节点发生故障，其他节点也可以继续为客户端提供服务。</li><li>可扩展性：MySQL Cluster 可以水平扩展，以满足不断增长的数据量和负载。</li><li>快速的自动失效切换。</li><li>灵活的分布式体系结构，没有单点故障。</li><li>高吞吐量和低延迟。</li><li>可扩展性强，支持在线扩容。</li></ul></li><li>缺点： <ul><li>国内使用的较少；</li><li>配置较复杂，需要使用 NDB 储存引擎，与 MySQL 常规引擎存在一定差异；</li><li>至少三节点。</li><li>备份和恢复不方便。</li><li>不支持外键。</li><li>占用磁盘空间大，内存大。</li><li>重启的时候，数据节点将数据load到内存需要很长时间。</li></ul></li></ul><h3 id="适用场景-9" tabindex="-1"><a class="header-anchor" href="#适用场景-9"><span>适用场景</span></a></h3><p>MySQL 集群适用于需要高可用性、可扩展性和性能的数据库应用程序。例如，MySQL 集群可以用于以下场景：</p><ul><li>电子商务网站</li><li>社交媒体平台</li><li>游戏服务器</li><li>云计算平台</li><li>大数据平台</li></ul><h3 id="可用性-9" tabindex="-1"><a class="header-anchor" href="#可用性-9"><span>可用性</span></a></h3><p>可用性达到： 99.999%</p><h2 id="主从复制-keepalived" tabindex="-1"><a class="header-anchor" href="#主从复制-keepalived"><span>主从复制（Keepalived）</span></a></h2><h3 id="原理-10" tabindex="-1"><a class="header-anchor" href="#原理-10"><span>原理：</span></a></h3><p>MySQL架构为Master/Slave，在主实例的 Keepalived 中，增加监测本机 MySQL 是否存活的脚本，如果监测 MySQL 挂了，就会重启 Keepalived，从而使 VIP 飘到从实例。在这种架构中，故障自动切换以后，需要采取手动操作的方式与新的Master进行复制。当然也可以设置为Active-Passive模式下的双Master复制。</p><h3 id="架构-10" tabindex="-1"><a class="header-anchor" href="#架构-10"><span>架构</span></a></h3><figure><img src="/assets/mysql_ha_ms_keeplived_overview_01-lKhHODiN.png" alt="MySQL HA MS With Keepalived" tabindex="0" loading="lazy"><figcaption>MySQL HA MS With Keepalived</figcaption></figure><h3 id="优势与不足-10" tabindex="-1"><a class="header-anchor" href="#优势与不足-10"><span>优势与不足</span></a></h3><ul><li><p>优点</p><ul><li>架构比较简单，使用原生半同步复制作为数据同步的依据；</li><li>高可用性：当主服务器出现故障时，从服务器可以自动切换为主服务器，保证数据库始终可用。</li><li>负载均衡：Keepalived 可以将流量分发到主服务器和从服务器上，提高数据库的吞吐量。</li><li>易于管理：Keepalived 易于配置和管理。</li><li>双节点，需求资源少，部署简单；</li><li>只有两个节点，没有主实例宕机后选主的问题。</li></ul></li><li><p>缺点：</p><ul><li>级联复制或者一主多从在切换之后，其他从实例需要重新配置连接新主。</li><li>云环境使用不了。</li><li>需要额外考虑 haproxy、keepalived 的高可用机制。</li><li>完全依赖于半同步复制，如果半同步复制退化为异步复制，数据一致性无法得到保证。</li><li>高可用性切换的延迟：在发生故障时，Keepalived需要一定的时间来检测故障并切换到备份服务器，这可能会导致一段时间内的服务中断。</li></ul></li></ul><h3 id="适用场景-10" tabindex="-1"><a class="header-anchor" href="#适用场景-10"><span>适用场景</span></a></h3><p>MySQL 主从 + Keepalived 适用于对数据库可用性要求比较高的场景，例如：</p><ul><li>电商网站：电商网站需要保证 24/7 全天候可用，使用 MySQL 主从 + Keepalived 可以提高数据库的可用性。</li><li>游戏服务器：游戏服务器需要保证玩家可以随时随地进行游戏，使用 MySQL 主从 + Keepalived 可以提高数据库的可用性和性能。</li><li>企业应用：企业应用需要保证业务的连续性，使用 MySQL 主从 + Keepalived 可以提高数据库的可用性和安全性。</li></ul><h3 id="可用性-10" tabindex="-1"><a class="header-anchor" href="#可用性-10"><span>可用性</span></a></h3><p>可用性达到： 99.99%</p><h2 id="主主复制-keepalived" tabindex="-1"><a class="header-anchor" href="#主主复制-keepalived"><span>主主复制（Keepalived）</span></a></h2><h3 id="原理-11" tabindex="-1"><a class="header-anchor" href="#原理-11"><span>原理：</span></a></h3><p>MySQL 的 MM+Keepalived 方案。该方案由两个 MySQL 服务器组成，这两个 MySQL 互为主备。其中一台主作为写服务器，另一台主作为读服务器。通过 keepalived 软件管理写 vip，当承担写服务器的 MySQL 出现故障时，将写 VIP 漂移到读服务器上，实现高可用。</p><h3 id="架构-11" tabindex="-1"><a class="header-anchor" href="#架构-11"><span>架构</span></a></h3><figure><img src="/assets/mysql_ha_mm_keeplived_overview_01-CErG4K7Y.png" alt="MySQL HA MM With Keepalived" tabindex="0" loading="lazy"><figcaption>MySQL HA MM With Keepalived</figcaption></figure><h3 id="优势与不足-11" tabindex="-1"><a class="header-anchor" href="#优势与不足-11"><span>优势与不足</span></a></h3><ul><li><p>优点</p><ul><li>架构比较简单，使用原生半同步复制作为数据同步的依据；</li><li>高可用性：通过配置两个MySQL主机，实现互为主备，即使其中一个主机发生故障，另一个主机仍可继续提供服务，确保系统的可用性和连续性。</li><li>可扩展性：可以轻松添加更多 MySQL 服务器以提高可扩展性。</li><li>易于管理：Keepalived 易于配置和管理。</li><li>只有两个节点，没有主实例宕机后选主的问题。</li><li>故障切换：当一个主机发生故障时，Keepalived能够自动检测到故障，并将流量转发到另一个正常运行的主机，实现快速的故障切换，减少系统的中断时间。</li><li>负载均衡：Keepalived可以通过分发请求到两个主机来实现负载均衡，提高系统的性能和吞吐量。</li></ul></li><li><p>缺点：</p><ul><li>完全依赖于半同步复制，如果半同步复制退化为异步复制，数据一致性无法得到保证。</li><li>高可用性切换的延迟：在发生故障时，Keepalived需要一定的时间来检测故障并切换到备份服务器，这可能会导致一段时间内的服务中断。</li></ul></li></ul><h3 id="适用场景-11" tabindex="-1"><a class="header-anchor" href="#适用场景-11"><span>适用场景</span></a></h3><p>MySQL 主主 + Keepalived 是一种高可用性、负载均衡的解决方案，适合对数据库可用性要求比较高的场景。以下是一些使用场景：</p><ul><li>电商网站：电商网站需要保证 24/7 全天候可用，使用 MySQL 主主 + Keepalived 可以提高数据库的可用性。</li><li>游戏服务器：游戏服务器需要保证玩家可以随时随地进行游戏，使用 MySQL 主主 + Keepalived 可以提高数据库的可用性和性能。</li><li>企业应用：企业应用需要保证业务的连续性，使用 MySQL 主主 + Keepalived 可以提高数据库的可用性和安全性。</li></ul><h3 id="可用性-11" tabindex="-1"><a class="header-anchor" href="#可用性-11"><span>可用性</span></a></h3><p>可用性达到： 99.99%</p><h2 id="主主-主从复制-keepalived-lvs" tabindex="-1"><a class="header-anchor" href="#主主-主从复制-keepalived-lvs"><span>主主/主从复制（Keepalived+LVS）</span></a></h2><h3 id="原理-12" tabindex="-1"><a class="header-anchor" href="#原理-12"><span>原理：</span></a></h3><p>Keepalived 是一个高可用性软件，它可以监控服务器的状态，当主服务器出现故障时，Keepalived 会将 VIP 切换到从服务器上，保证数据库始终可用。LVS 是一个负载均衡器，它可以将用户的请求分发到两台 MySQL 服务器上，提高数据库的吞吐量。</p><p>通过MM+Keepalived+LVS方式来是实现MySQL的高可用性，利用LVS实现MySQL的读写负载均衡，Keepalived避免节点出现单点故障。</p><p>使用 Keepalived + LVS 实现 MySQL 双主高可用性可以提高数据库的可用性和性能。</p><h3 id="架构-12" tabindex="-1"><a class="header-anchor" href="#架构-12"><span>架构</span></a></h3><figure><img src="/assets/mysql_ha_mm_keeplived_overview_01-CErG4K7Y.png" alt="MySQL HA MM With Keepalived and LVS" tabindex="0" loading="lazy"><figcaption>MySQL HA MM With Keepalived and LVS</figcaption></figure><h3 id="优势与不足-12" tabindex="-1"><a class="header-anchor" href="#优势与不足-12"><span>优势与不足</span></a></h3><ul><li>优点 <ul><li>高可用性：当主服务器出现故障时，从服务器可以自动切换为主服务器，保证数据库始终可用。</li><li>可扩展性：可以轻松添加更多 MySQL 服务器以提高可扩展性。</li><li>易于管理：Keepalived 易于配置和管理。</li><li>只有两个节点，没有主实例宕机后选主的问题。</li><li>故障切换：当一个主机发生故障时，Keepalived能够自动检测到故障，并将流量转发到另一个正常运行的主机，实现快速的故障切换，减少系统的中断时间。</li><li>负载均衡：LVS 可以将用户的请求分发到两台 MySQL 服务器上，提高数据库的吞吐量。</li></ul></li><li>缺点： <ul><li>完全依赖于半同步复制，如果半同步复制退化为异步复制，数据一致性无法得到保证。</li><li>高可用性切换的延迟：在发生故障时，Keepalived需要一定的时间来检测故障并切换到备份服务器，这可能会导致一段时间内的服务中断。</li><li>配置复杂：Keepalived 和 LVS 的配置比较复杂，需要有一定的基础知识才能部署和维护。</li><li>成本：需要部署两台 MySQL 服务器和 Keepalived 和 LVS 软件，增加了成本。</li></ul></li></ul><h3 id="适用场景-12" tabindex="-1"><a class="header-anchor" href="#适用场景-12"><span>适用场景</span></a></h3><p>MySQL 双主 + Keepalived + LVS 是一种高可用性解决方案，适合对数据库可用性要求比较高的场景，例如：</p><ul><li>电商网站：电商网站需要保证 24/7 全天候可用，使用 MySQL 双主 + Keepalived + LVS 可以提高数据库的可用性。</li><li>游戏服务器：游戏服务器需要保证玩家可以随时随地进行游戏，使用 MySQL 双主 + Keepalived + LVS 可以提高数据库的可用性和性能。</li><li>企业应用：企业应用需要保证业务的连续性，使用 MySQL 双主 + Keepalived + LVS 可以提高数据库的可用性和安全性。</li></ul><h3 id="可用性-12" tabindex="-1"><a class="header-anchor" href="#可用性-12"><span>可用性</span></a></h3><p>可用性达到： 99.99%</p><h2 id="xenon" tabindex="-1"><a class="header-anchor" href="#xenon"><span>Xenon</span></a></h2><p>Xenon 一款由 RadonDB 开发团队研发并开源的新一代 MySQL 集群高可用工具。Xenon使用 Go 语言编写。基于 Raft 协议进行无中心化选主，实现主从秒级切换；基于 Semi-Sync 机制，保障数据不丢失，实现数据强一致性。并结合 MySQL（5.7 及以上版本）并行复制特性，实现 Binlog 并行回放，大大降低从库延迟。Xenon是后 MHA 时代的一种替代方案。</p><p>Xenon 还支持 MySQL 的半同步复制，半同步复制可以提高 MySQL 数据库的可用性。当主服务器写入数据时，它会将数据写入所有从服务器。如果其中一个从服务器没有收到数据，主服务器会等待该从服务器收到数据。这可以防止数据丢失。Xenon 是一个易于使用的软件，它可以提高 MySQL 数据库的可用性和性能。</p><h3 id="原理-13" tabindex="-1"><a class="header-anchor" href="#原理-13"><span>原理</span></a></h3><p>Xenon 就是基于 Raft + Semi-Sync + GTID 实现的高可用，保证大多数节点接收到数据。而 Raft 基于心跳管理，如果从节点超时收不到主的心跳，会尝试发起选举，若得到超过半数（非 IDLE 节点）的选票，则会当选为主节点。</p><p>Xenon 的原理如下：</p><ul><li>在多个 MySQL 服务器上部署 Xenon 软件。</li><li>将所有 MySQL 服务器加入一个 Raft 集群。</li><li>将主 MySQL 服务器指定为 Raft 集群的 leader。</li><li>当主 MySQL 服务器出现故障时，Raft 协议会将 leader 的角色转移到另一台 MySQL 服务器上。</li><li>从 MySQL 服务器会从新 leader 复制数据。</li></ul><p>下面以三节点（一主两从）Xenon 集群来简单说明工作原理。</p><p>{Leader, [GTID:{1,2,3,4,5}]</p><p>{Follower1, [GTID:{1,2,3,4,5}]</p><p>{Follower2, [GTID:{1,2,3}]</p><ul><li>当 Leader 不可用时，Follower1 和 Follower2 立即参与竞选成为主节点。</li><li>Xenon 校验 GTID 值较高的 Follower 成为新主节点，示例中 GTID 值较高的是 Follower1。</li><li>当 GTID 值最高的 Follower 被选举成为新主时，将结束竞选。示例中 Follower1 成为新主节点后，将会拒绝 Follower2 的选举。</li><li>自动完成主从切换。</li></ul><h4 id="xenon-企业级核心特性" tabindex="-1"><a class="header-anchor" href="#xenon-企业级核心特性"><span>Xenon 企业级核心特性</span></a></h4><ul><li>一主多从架构，确保金融级强一致性</li></ul><p>高可用架构大多采用一主两从的初始节点架构设计，并通过 MySQL 5.7 版本中的 Semi-Sync 特性实现数据的多副本同步复制，多个从节点的设置将极大的屏蔽掉单点故障带来的影响，确保至少一个从节点与主节点始终保持数据的完全一致，提供金融级数据强一致性。</p><ul><li>主副本秒级切换，确保业务高可用</li></ul><p>节点之间使用 Raft 协议进行管理，当主节点出现故障不可用时，集群会秒级响应并选出新的主节点（与主节点数据完全同步的从节点），并立即接管读写请求，确保业务的连续高可用。这一过程，无需设置后端集群中各节点的角色，一切由系统自动切换。集群中最多可以添加 6 个从节点，主节点可读可写，从节点设置为只读。同时，集群提供两个 VIP，分别是高可用读 IP 和高可用写 IP。读 IP 可将请求在所有节点之间进行负载分担，提供读取性能的同时，也消除了单点故障的影响，提供业务可靠性。写 IP 则始终指向主节点（Leader）。</p><ul><li>系统自动运维，优化系统空间使用效率</li></ul><p>通过对 binlog 日志的保留周期 expire_logs_days 的配置（1～4 天），主节点会定期清理不再使用的 binlog 日志，其他从节点已复制完毕，提高系统的空间利用率。</p><h3 id="架构-13" tabindex="-1"><a class="header-anchor" href="#架构-13"><span>架构</span></a></h3><figure><img src="/assets/mysql_ha_xenon_overview-CgSjt6g7.png" alt="MySQL Xenon" tabindex="0" loading="lazy"><figcaption>MySQL Xenon</figcaption></figure><h3 id="优势与不足-13" tabindex="-1"><a class="header-anchor" href="#优势与不足-13"><span>优势与不足</span></a></h3><ul><li><p>优点</p><ul><li>无数据丢失的快速故障转移。</li><li>高可用性：Xenon 使用 Raft 协议来实现高可用性，保证数据库始终可用。</li><li>性能：Xenon 支持 MySQL 的半同步复制，可以提高 MySQL 数据库的性能。与 GTID、MTS（并行复制） 结合，并行日志复制、并行日志回放。</li><li>多版本内核支持。支持 MySQL 5.6、5.7、8.0 内核版本。</li><li>多平台支持。支持物理机、虚拟机/云平台、容器/ Kubernetes 平台部署。</li><li>架构更简单。不需要管理节点，机器成本更低。</li><li>数据更安全。增强半同步复制不会降级为异步，保证数据零丢失，不会存在 MHA 在 GTID 模式下丢数据的风险。</li><li>故障修复全自动。Xenon 对于故障节点会自动先自我修复。</li><li>节点恢复快。配合 Xtrabackup 等可以实现快速恢复。</li></ul></li><li><p>缺点</p><ul><li>只适用于 GTID。</li><li>默认情况下，Xenon 和 MySQL 跑在同一个账号下。</li></ul></li></ul><h3 id="适用场景-13" tabindex="-1"><a class="header-anchor" href="#适用场景-13"><span>适用场景</span></a></h3><ul><li>需要高可用性的 MySQL 数据库。</li><li>需要支持半同步复制的 MySQL 数据库。</li><li>需要易于使用的 MySQL 高可用性软件。</li></ul><h3 id="可用性-13" tabindex="-1"><a class="header-anchor" href="#可用性-13"><span>可用性</span></a></h3><p>可用性达到： 99.99%</p><h2 id="mysql-consul" tabindex="-1"><a class="header-anchor" href="#mysql-consul"><span>MySQL Consul</span></a></h2><p>MySQL Consul 是基于 Consul 的 MySQL 服务发现和健康检查解决方案。它使用 Consul 的服务注册和发现功能来发现 MySQL 服务器，并使用 Consul 的健康检查功能来监控 MySQL 服务器的健康状况。</p><h3 id="原理-14" tabindex="-1"><a class="header-anchor" href="#原理-14"><span>原理</span></a></h3><p>MySQL Consul 的工作原理如下：</p><ol><li>MySQL 服务器注册到 Consul。</li><li>Consul 存储 MySQL 服务器的注册信息，包括服务器的 IP 地址、端口号、健康状态等。</li><li>客户端从 Consul 查询 MySQL 服务器的注册信息。</li><li>客户端使用 MySQL 服务器的 IP 地址和端口号连接到 MySQL 服务器。</li><li>Consul 监控 MySQL 服务器的健康状况。</li><li>如果 MySQL 服务器出现故障，Consul 会将 MySQL 服务器从注册表中删除。</li></ol><h3 id="架构-14" tabindex="-1"><a class="header-anchor" href="#架构-14"><span>架构</span></a></h3><figure><img src="/assets/mysql_consul_proxysql_overview-DiQZQaE5.png" alt="MySQL Consul 架构图" tabindex="0" loading="lazy"><figcaption>MySQL Consul 架构图</figcaption></figure><h3 id="优势与不足-14" tabindex="-1"><a class="header-anchor" href="#优势与不足-14"><span>优势与不足</span></a></h3><ul><li><p>优点：</p><ul><li>易于使用：MySQL Consul 使用简单的 API，易于使用。</li><li>可扩展性：MySQL Consul 可扩展到任何规模的部署。</li><li>可靠性：MySQL Consul 使用 Consul 的强大功能，可靠性高。</li><li>灵活性：MySQL Consul 灵活，可以满足各种需求。</li></ul></li><li><p>缺点：</p><ul><li>需要额外的资源：MySQL Consul 需要额外的资源，如 CPU、内存和存储。</li><li>需要管理：MySQL Consul 需要管理，如配置、监控和维护。</li></ul></li></ul><h3 id="适用场景-14" tabindex="-1"><a class="header-anchor" href="#适用场景-14"><span>适用场景</span></a></h3><ul><li>多节点 MySQL 集群</li><li>分布式 MySQL 系统</li><li>云原生 MySQL 应用程序</li></ul><h3 id="可用性-14" tabindex="-1"><a class="header-anchor" href="#可用性-14"><span>可用性</span></a></h3><p>可用性达到：99.99%</p><h2 id="mysql-fabric-1" tabindex="-1"><a class="header-anchor" href="#mysql-fabric-1"><span>MySQL Fabric</span></a></h2><p>MySQL Fabric 是一个 MySQL 分布式数据库管理系统，由 Percona 开发。它使用 MySQL Replication 技术来实现数据分布，并使用 MySQL Cluster 技术来实现数据共享。</p><h3 id="原理-15" tabindex="-1"><a class="header-anchor" href="#原理-15"><span>原理</span></a></h3><p>MySQL Fabric 的工作原理如下：</p><ol><li>将 MySQL 服务器分布到多个节点上。</li><li>在每个节点上启动 MySQL Replication 服务。</li><li>在每个节点上启动 MySQL Cluster 服务。</li><li>使用 MySQL Fabric 管理员工具来配置 MySQL Fabric 集群。</li><li>使用 MySQL Fabric 客户端工具来连接到 MySQL Fabric 集群。</li></ol><h3 id="架构-15" tabindex="-1"><a class="header-anchor" href="#架构-15"><span>架构</span></a></h3><figure><img src="/assets/mysql_fabric_overview-Bkghqomu.png" alt="MySQL Fabric 架构图" tabindex="0" loading="lazy"><figcaption>MySQL Fabric 架构图</figcaption></figure><h3 id="优势与不足-15" tabindex="-1"><a class="header-anchor" href="#优势与不足-15"><span>优势与不足</span></a></h3><ul><li><p>优点：</p><ul><li>高可用性：MySQL Fabric 使用 MySQL Replication 技术来实现数据冗余，因此即使一个节点出现故障，数据仍然可以从其他节点访问。</li><li>高性能：MySQL Fabric 使用 MySQL Cluster 技术来实现数据共享，因此可以提高数据访问性能。</li><li>易于管理：MySQL Fabric 使用 MySQL Fabric 管理员工具来配置 MySQL Fabric 集群，因此易于管理。</li></ul></li><li><p>缺点：</p><ul><li>复杂性：MySQL Fabric 是一个复杂的系统，因此需要一定的学习曲线才能使用。</li><li>成本：MySQL Fabric 需要额外的硬件和软件资源，因此成本较高</li></ul></li></ul><h3 id="适用场景-15" tabindex="-1"><a class="header-anchor" href="#适用场景-15"><span>适用场景</span></a></h3><p>MySQL Fabric 适用于需要高可用性和高性能的场景，例如：</p><ul><li>电商网站</li><li>社交网络</li><li>游戏服务器</li></ul><h3 id="可用性-15" tabindex="-1"><a class="header-anchor" href="#可用性-15"><span>可用性</span></a></h3><p>可用性达到：99.999%</p><h2 id="tungsten®-replicator-基于中间件" tabindex="-1"><a class="header-anchor" href="#tungsten®-replicator-基于中间件"><span>Tungsten® Replicator（基于中间件）</span></a></h2><h3 id="原理-16" tabindex="-1"><a class="header-anchor" href="#原理-16"><span>原理</span></a></h3><p>Tungsten-Replicator 是第三方的 MySQL 数据复制引擎，是个商业产品，同时提供开源版本。类似于 MySQL 自身的 replication，基于日志复制模式，不同的是 Tungsten 通过 Extractor 控件读取 mysql 主库的 binlog 解析成自己的日志格式--THL（Transaction History Log）, 在从库上通过 Applier 控件写入数据库。 Tungsten Replicator 是一个高性能的复制引擎，支持 MySQL、MariaDB 和 Percona Server。它提供了多种功能，使其适用于广泛的复制用例，包括：</p><ul><li>全局实时事务处理：Tungsten Replicator 可用于在集群之间创建 active/active 复制配置，从而实现全局实时事务处理。</li><li>简化实时数据聚合：Tungsten Replicator 可用于从多个位置聚合数据到单个数据库服务器，而无需数据转换。这对于实时报告和分析很有用。</li><li>更好的业务决策：Tungsten Replicator 可用于将数据复制到高性能数据分析引擎，这些引擎可用于获取可导致更好的业务决策的见解。</li></ul><p>除此之外，Tungsten Replicator 还支持多种其他功能，如：</p><ul><li>灵活的语句和/或行复制</li><li>全局事务 ID</li><li>高级拓扑支持</li><li>并行复制</li><li>在复制过程中过滤和修改信息</li><li>在本地和云端数据库之间部署</li></ul><p>Tungsten Replicator 是一个强大的工具，可用于解决各种复制挑战。它是一个商业产品，但也有开源版本。</p><p>Tungsten-Replicator 具有以下特性：</p><ul><li><p>支持高版本 MySQL 向低版本复制，如：MySQL5.1 --&gt; MySQL5.0;</p></li><li><p>支持跨数据库系统的复制，如：MySQL --&gt; PostgreSQL</p></li><li><p>支持多主库向单台 Slave 的复制，Multi-Master --&gt; Slave</p></li><li><p>Ganji-Replicator 提取数据的更新记录，写到 MySQL 队列表 Queue;基于这个队列，可以为其他应用服务提供便利，如检索系统数据更新，跨机房半同步。 MySQL --&gt; Queue</p></li></ul><h3 id="架构-16" tabindex="-1"><a class="header-anchor" href="#架构-16"><span>架构</span></a></h3><figure><img src="/assets/mysql_tungsten_overview-Crib-32Q.png" alt="MySQL Tungsten Replicator" tabindex="0" loading="lazy"><figcaption>MySQL Tungsten Replicator</figcaption></figure><h3 id="优势与不足-16" tabindex="-1"><a class="header-anchor" href="#优势与不足-16"><span>优势与不足</span></a></h3><ul><li><p>优点</p><ul><li>功能强大：Tungsten Replicator 是一个功能强大的工具，可用于解决各种复制挑战。</li><li>灵活：Tungsten Replicator 非常灵活，可用于各种复制场景。</li><li>可靠：Tungsten Replicator 是一个可靠的工具，可用于确保数据始终可用。</li><li>易于使用：Tungsten Replicator 使用起来非常简单，即使是初学者也可以使用。</li><li>数据压缩：数据压缩可以减少数据传输量，提高数据传输效率。</li><li>数据加密：数据加密可以保护数据安全，防止数据被盗。</li></ul></li><li><p>缺点</p><ul><li>价格昂贵：Tungsten Replicator 是一个商业软件，价格昂贵。</li><li>需要专业知识：Tungsten Replicator 使用起来很简单，但要充分利用它的功能，需要专业知识。</li><li>不支持所有数据库：Tungsten Replicator 不支持所有数据库，只支持 MySQL、MariaDB 和 Percona Server。</li></ul></li></ul><h3 id="适用场景-16" tabindex="-1"><a class="header-anchor" href="#适用场景-16"><span>适用场景</span></a></h3><ul><li>高可用性：Tungsten Replicator 可以将数据从一个主数据库服务器复制到一个或多个从数据库服务器。当主数据库服务器不可用时，从数据库服务器可以继续提供服务。</li><li>负载均衡：Tungsten Replicator 可以将读取请求分散到多个数据库服务器。这可以提高数据库系统的性能，并防止单个数据库服务器被过载。</li><li>数据迁移：Tungsten Replicator 可以将数据从一个数据库系统迁移到另一个数据库系统。这可以用于数据库扩展、数据库迁移和数据库灾难恢复。</li><li>数据分析：Tungsten Replicator 可以将数据复制到数据仓库或数据湖，用于数据分析。</li><li>数据备份：Tungsten Replicator 可以将数据复制到备份服务器，用于数据备份。</li></ul><h3 id="可用性-16" tabindex="-1"><a class="header-anchor" href="#可用性-16"><span>可用性</span></a></h3><p>可用性达到： 99.99%</p><h2 id="heartbeat-san-基于共享存储" tabindex="-1"><a class="header-anchor" href="#heartbeat-san-基于共享存储"><span>Heartbeat + SAN （基于共享存储）</span></a></h2><h3 id="原理-17" tabindex="-1"><a class="header-anchor" href="#原理-17"><span>原理</span></a></h3><p>共享存储实现了数据库服务器和存储设备的解耦，不同数据库之间的数据同步不再依赖于 MySQL 的原生复制功能，而是通过磁盘数据同步的手段，来保证数据的一致性。使用共享存储时，MySQL 服务器能够正常挂载文件系统并操作，如果主库发生宕机，备库可以挂载相同的文件系统，保证主库和备库使用相同的数据。</p><p>Heartbeat + SAN 是 MySQL 的高可用性解决方案，它使用 Heartbeat 来监控集群中节点的健康状况，并使用 SAN 来共享节点之间的数据。</p><p>Heartbeat 是一个软件应用程序，它通过在节点之间发送心跳消息来监控集群中节点的健康状况。如果一个节点没有响应心跳消息，Heartbeat 将假设该节点已关闭并将采取适当的操作，例如转移到另一个节点。</p><p>SAN 是一个存储区域网络，它为集群中的节点提供共享存储。允许存储设备和处理器（服务器）之间建立直接的高速网络（与 LAN 相比）连接，通过这种连接实现数据的集中式存储，该设备可由集群中的所有节点访问。</p><p>heartbeat 的工作原理：</p><ul><li><p>heartbeat 最核心的包括两个部分，心跳监测部分和资源接管部分，心跳监测可以通过网络链路和串口进行，而且支持冗余链路，它们之间相互发送报文来告诉对方自己当前的状态，如果在指定的时间内未受到对方发送的报文，那么就认为对方失效，这时需启动资源接管模块来接管运行在对方主机上的资源或者服务。</p></li><li><p>heartbeat 的两台主机分别为主节点和从节点。主节点在正常情况下占用资源并运行所有的服务，遇到故障时把资源交给从节点并由从节点运行服务。</p></li></ul><h3 id="架构-17" tabindex="-1"><a class="header-anchor" href="#架构-17"><span>架构</span></a></h3><figure><img src="/assets/mysql_ha_san_overview_001-cYIVUGkm.png" alt="MySQL Heartbeat SAN" tabindex="0" loading="lazy"><figcaption>MySQL Heartbeat SAN</figcaption></figure><h3 id="优势与不足-17" tabindex="-1"><a class="header-anchor" href="#优势与不足-17"><span>优势与不足</span></a></h3><ul><li>优点： <ul><li>两节点即可，部署简单，切换逻辑简单；</li><li>很好地保证数据的强一致性；</li><li>不会因为 MySQL 的逻辑错误发生数据不一致的情况。</li></ul></li><li>缺点： <ul><li>需要考虑共享存储的高可用；</li><li>单点故障：SAN 是一个单点故障。如果 SAN 发生故障，集群中的所有节点将无法使用</li><li>价格昂贵。</li></ul></li></ul><h3 id="适用场景-17" tabindex="-1"><a class="header-anchor" href="#适用场景-17"><span>适用场景</span></a></h3><ul><li>需要 24/7 可用性的 MySQL 部署</li><li>需要能够处理大量数据量的 MySQL 部署</li><li>需要能够在多个节点之间扩展的 MySQL 部署</li><li>需要能够在故障发生时进行自动故障转移的 MySQL 部署</li></ul><p>以下是一些具体示例：</p><ul><li>电子商务网站：电子商务网站需要能够 24/7 可用，并且需要能够处理大量数据量。Heartbeat + SAN 可以帮助确保电子商务网站始终可用，即使发生故障。</li><li>社交媒体网站：社交媒体网站需要能够 24/7 可用，并且需要能够在多个节点之间扩展。Heartbeat + SAN 可以帮助确保社交媒体网站始终可用，即使发生故障。</li><li>企业应用程序：企业应用程序需要能够 24/7 可用，并且需要能够处理大量数据量。Heartbeat + SAN 可以帮助确保企业应用程序始终可用，即使发生故障。</li></ul><h3 id="可用性-17" tabindex="-1"><a class="header-anchor" href="#可用性-17"><span>可用性</span></a></h3><p>可用性达到： 99.5%-99.9%</p><h2 id="heartbeat-drdb-基于存储复制" tabindex="-1"><a class="header-anchor" href="#heartbeat-drdb-基于存储复制"><span>Heartbeat + DRDB（基于存储复制）</span></a></h2><h3 id="原理-18" tabindex="-1"><a class="header-anchor" href="#原理-18"><span>原理</span></a></h3><p>处理 failover 的方式依旧是 Heartbeat。同步数据使用 DRBD：Distributed Replicated Block Device(DRBD)是一个用软件实现的、无共享的、服务器之间镜像块设备内容的存储复制解决方案。和 SAN 网络不同，它并不共享存储，而是通过服务器之间的网络复制数据。</p><p>DRBD 是一种基于软件、基于网络的块复制存储解决方案，主要用于对服务器之间的磁盘、分区、逻辑卷等进行数据镜像。 当用户将数据写入本地磁盘时，还会将数据发送到网络中另一台主机的磁盘上，这样本地主机(主节点)与远程主机(备节点)的数据就可以保证实时同步。</p><p>当本地主机出现问题，远程主机上还保留着一份相同的数据，可以继续使用，保证了数据的安全。 DRBD 是 linux 内核模块实现的快级别的同步复制技术，可以与 SAN 达到相同的共享存储效果。</p><h3 id="架构-18" tabindex="-1"><a class="header-anchor" href="#架构-18"><span>架构</span></a></h3><figure><img src="/assets/mysql_ha_drbd_overview-Cx_kWt5a.png" alt="MySQL Heartbeat DBRD" tabindex="0" loading="lazy"><figcaption>MySQL Heartbeat DBRD</figcaption></figure><h3 id="优势与不足-18" tabindex="-1"><a class="header-anchor" href="#优势与不足-18"><span>优势与不足</span></a></h3><ul><li>优点： <ul><li>两节点即可，部署简单，切换逻辑简单；</li><li>相比于 SAN 储存网络，价格低廉；</li><li>保证数据的强一致性。</li></ul></li><li>缺点： <ul><li>对 io 性能影响较大；</li><li>从库不提供读操作。</li></ul></li></ul><h3 id="适用场景-18" tabindex="-1"><a class="header-anchor" href="#适用场景-18"><span>适用场景</span></a></h3><p>Heartbeat + DBRD 适用于需要高可用性和可扩展性的 MySQL 部署。它特别适用于以下场景：</p><ul><li>需要 24/7 可用性的 MySQL 部署</li><li>需要能够处理大量数据量的 MySQL 部署</li><li>需要能够在多个节点之间扩展的 MySQL 部署</li><li>需要能够在故障发生时进行自动故障转移的 MySQL 部署</li></ul><p>Heartbeat + DBRD 是一种可靠和经济的高可用性解决方案。它可以帮助您确保您的 MySQL 数据库始终可用，即使发生故障。</p><p>以下是一些具体示例：</p><ul><li>电子商务网站：电子商务网站需要能够 24/7 可用，并且需要能够处理大量数据量。Heartbeat + DBRD 可以帮助确保电子商务网站始终可用，即使发生故障。</li><li>社交媒体网站：社交媒体网站需要能够 24/7 可用，并且需要能够在多个节点之间扩展。Heartbeat + DBRD 可以帮助确保社交媒体网站始终可用，即使发生故障。</li><li>企业应用程序：企业应用程序需要能够 24/7 可用，并且需要能够处理大量数据量。Heartbeat + DBRD 可以帮助确保企业应用程序始终可用，即使发生故障。</li></ul><h3 id="可用性-18" tabindex="-1"><a class="header-anchor" href="#可用性-18"><span>可用性</span></a></h3><p>可用性达到： 99.9%</p><h2 id="mysql-高可用相关技术" tabindex="-1"><a class="header-anchor" href="#mysql-高可用相关技术"><span>MySQL 高可用相关技术</span></a></h2><h3 id="paxos-分布式协议" tabindex="-1"><a class="header-anchor" href="#paxos-分布式协议"><span>Paxos 分布式协议</span></a></h3><h3 id="原理-19" tabindex="-1"><a class="header-anchor" href="#原理-19"><span>原理</span></a></h3><p>Paxos 算法解决的问题是一个分布式系统如何就某个值（决议）达成一致。这个算法被认为是同类算法中最有效的。Paxos 与 MySQL 相结合可以实现在分布式的 MySQL 数据的强一致性。</p><h3 id="优势与不足-19" tabindex="-1"><a class="header-anchor" href="#优势与不足-19"><span>优势与不足</span></a></h3><ul><li>优点： <ul><li>多主写入，无延迟复制，能保证数据强一致性；</li><li>有成熟理论基础；</li><li>自动故障转移，自动添加、剔除节点。</li></ul></li><li>缺点： <ul><li>只支持 innodb 储存引擎；</li><li>至少三节点。</li></ul></li></ul><h3 id="orchestrator" tabindex="-1"><a class="header-anchor" href="#orchestrator"><span>Orchestrator</span></a></h3><p>Orchestrator 是一款开源，对 MySQL 复制提供高可用、拓扑的可视化管理工具，采用 go 语言编写，它能够主动发现当前拓扑结构和主从复制状态，支持 MySQL 主从复制拓扑关系的调整、支持 MySQL 主库故障自动切换(failover)、手动主从切换(switchover)等功能。</p><h3 id="原理-20" tabindex="-1"><a class="header-anchor" href="#原理-20"><span>原理</span></a></h3><p>Orchestrator 后台依赖于 MySQL 或者 SQLite 存储元数据，能够提供 Web 界面展示 MySQL 集群的拓扑关系及实例状态，通过 Web 界面可更改 MySQL 实例的部分配置信息，同时也提供命令行和 api 接口，以便更加灵活的自动化运维管理。Orchestrator 对 MySQL 主库的故障切换分为自动切换和手动切换。手动切换又分为 recover、force-master-failover、force-master-takeover 以及 graceful-master-takeover。</p><p>相比于 MHA，Orchestrator 更加偏重于复制拓扑关系的管理，能够实现 MySQL 任一复制拓扑关系的调整，并在此基础上，实现 MySQL 高可用。另外，Orchestrator 自身也可以部署多个节点，通过 raft 分布式一致性协议，保证自身的高可用。</p><p>Orchestrator 是 Go 语音编写的 MySQL 高可用性和复制管理工具，作为服务运行并提供命令行访问、HTTP API 和 Web 界面。</p><h3 id="架构-19" tabindex="-1"><a class="header-anchor" href="#架构-19"><span>架构</span></a></h3><figure><img src="/assets/mysql_orchestrator_overview-DwI4vL9Q.png" alt="MySQL Orchestrator" tabindex="0" loading="lazy"><figcaption>MySQL Orchestrator</figcaption></figure><h3 id="优势与不足-20" tabindex="-1"><a class="header-anchor" href="#优势与不足-20"><span>优势与不足</span></a></h3><ul><li><p>优点</p><ul><li>自动发现 MySQL 拓扑，可以拖动拓扑图进行复制关系的变更，并且在web上展示。</li><li>提供命令行和 API 接口，方便运维管理。</li><li>快速故障转移。</li><li>重构复制关系， 可以在web进行拖图来进行复制关系变更。</li><li>多种故障等级，应对不同故障等级可配置不同处理办法。</li><li>支持命令行和web界面管理复制。</li></ul></li><li><p>缺点</p><ul><li>相对于其他高可用组件，参数多很多。</li><li>在某些场景可能出现丢数据的情况，数据补偿机制需要优化。</li></ul></li></ul><h2 id="高可用解决方案对比" tabindex="-1"><a class="header-anchor" href="#高可用解决方案对比"><span>高可用解决方案对比</span></a></h2><table><thead><tr><th>方案</th><th>可用性</th><th><div style="width:120px;">可扩展性</div></th><th><div style="width:120px;">灾难恢复</div></th><th><div style="width:120px;">复杂性</div></th><th><div style="width:120px;">成本</div></th><th><div style="width:120px;">数据一致性</div></th><th><div style="width:120px;">自动故障切换</div></th><th><div style="width:120px;">性能</div></th><th><div style="width:120px;">RTO</div></th><th><div style="width:120px;">RPO</div></th><th><div style="width:120px;">兼容的版本</div></th><th><div style="width:120px;">兼容的存储引擎</div></th><th><div style="width:120px;">优点</div></th><th><div style="width:120px;">缺点</div></th><th><div style="width:120px;">应用场景</div></th><th><div style="width:500px;">版本兼容详情 </div></th></tr></thead><tbody><tr><td>mysql mha</td><td>99.99%</td><td>高（支持多个备库， 只能水平扩展读节点）</td><td>快速（最多丢失 1 秒数据，支持多种备份和恢复方式）</td><td>中等（需要安装和配置MHA Manager和MHA Node）</td><td>开源，免费；低（无需额外硬件）</td><td>高（使用 binlog 进行数据同步）；异步复制 (可能有数据丢失或不一致)</td><td>是（MHA Manager 负责监控和切换）</td><td>中 (主从架构有写入瓶颈)</td><td>0~30 秒（取决于 MHA Manager 的检测间隔和切换时间）</td><td>0~1 秒（可能有数据丢失，取决于 binlog 同步延迟）</td><td>MySQL 5.0 及以上版本</td><td>所有存储引擎</td><td>简单易用，高可用，高性能，低成本，数据一致性高，支持在线切换和回切</td><td>需要额外安装和配置 MHA 软件，需要保证所有备库之间的数据一致性</td><td>适合对高可用、高性能、低成本、数据一致性有较高要求的场景; 读负载量大的场景，如 Web 应用</td><td>MySQL 5.0 ~ 8.0, MariaDB 5.5 ~ 10.3, Percona Server 5.5 ~ 8.0, Percona XtraDB Cluster 5.6 ~ 8.0, Galera Cluster 3.x ~ 4.x, MySQL NDB Cluster 7.4 ~ 8.0, MySQL InnoDB Cluster 5.7 ~ 8.0, MySQL Group Replication 5.7 ~ 8.0, MySQL InnoDB ReplicaSet 8.0, MySQL InnoDB ClusterSet 8.0, MySQL Router 2.1 ~ 8.0, MySQL Shell 1.0 ~ 8.0, MySQL Fabric 1.5 ~ 1.6, MySQL Utilities 1.3 ~ 1.6, MySQL Workbench 6.x ~ 8.x, Oracle Enterprise Manager for MySQL Database Release 13.x ~14.x, Oracle GoldenGate for MySQL Release 12.x ~19.x, Oracle Data Guard for MySQL Release 12.x ~19.x, Oracle Data Integrator for MySQL Release 12.x ~19.x, Oracle SQL Developer for MySQL Release 4.x ~19.x, Oracle Database Gateway for MySQL Release 12.x ~19.x</td></tr><tr><td>mysql mmm</td><td>99.9%</td><td>中（支持两个主库和多个备库，支持双主或多主架构）</td><td>较快（最多丢失 5 秒数据，支持多种备份和恢复方式）</td><td>较高（需要安装和配置 MMM 软件和监控代理）</td><td>开源，免费；中等（需要额外硬件支持虚拟 IP 地址）</td><td>中等（使用 binlog 进行数据同步，但可能存在数据冲突或丢失的风险）；异步复制 (可能有数据丢失或不一致)</td><td>是（MMM Monitor 负责监控和切换）</td><td>中等（主库之间需要同步 binlog，增加网络开销）</td><td>5~10 秒（取决于 MMM Monitor 的检测间隔和切换时间）</td><td>0~5 秒（取决于 binlog 同步延迟和冲突解决策略）</td><td>MySQL 5.0 及以上版本</td><td>所有存储引擎</td><td>支持双主模式，提供读写分离和负载均衡功能，支持自动故障切换</td><td>复杂度较高，需要额外硬件和软件支持，数据一致性较低，存在数据冲突或丢失的风险，不支持在线回切</td><td>适合对读写分离和负载均衡有较高要求，但对数据一致性和复杂度可以容忍的场景; 读负载量大的场景，如 Web 应用</td><td>MySQL 5.0 ~ 5.6, MariaDB 5.5 ~ 10.1, Percona Server 5.5 ~ 5.6, Percona XtraDB Cluster 5.6, Galera Cluster 3.x, MySQL NDB Cluster 7.4 ~ 7.6, MySQL InnoDB Cluster 5.7 ~ 8.0, MySQL Group Replication 5.7 ~ 8.0, MySQL InnoDB ReplicaSet 8.0, MySQL InnoDB ClusterSet 8.0, MySQL Router 2.1 ~ 8.0, MySQL Shell 1.0 ~ 8.0, MySQL Fabric 1.5 ~ 1.6, MySQL Utilities 1.3 ~ 1.6, MySQL Workbench 6.x ~ 8.x, Oracle Enterprise Manager for MySQL Database Release 13.x ~14.x, Oracle GoldenGate for MySQL Release 12.x ~19.x, Oracle Data Guard for MySQL Release 12.x ~19.x, Oracle Data Integrator for MySQL Release 12.x ~19.x, Oracle SQL Developer for MySQL Release 4.x ~19.x, Oracle Database Gateway for MySQL Release 12.x ~19.x</td></tr><tr><td>mysql Master-Slave Keepalived + LVS</td><td>99.9%</td><td>高（支持多个备库和多个 LVS 节点， 只能水平扩展读节点）</td><td>较快（最多丢失 1 秒数据，支持多种备份和恢复方式）</td><td>较高（需要安装和配置 Keepalived 和 LVS 软件）</td><td>开源，免费；中等（需要额外硬件支持虚拟 IP 地址和负载均衡）</td><td>高（使用 binlog 进行数据同步）；异步复制 (可能有数据丢失或不一致)</td><td>是（Keepalived 负责监控和切换）</td><td>高（主库无需额外负担，LVS 提供负载均衡功能）</td><td>1~5 秒（取决于 Keepalived 的检测间隔和切换时间）</td><td>0~1 秒（取决于 binlog 同步延迟）</td><td>MySQL 5.0 及以上版本</td><td>所有存储引擎</td><td>高可用，高性能，数据一致性高，支持读写分离和负载均衡功能，支持自动故障切换</td><td>复杂度较高，需要额外硬件和软件支持，不支持在线回切</td><td>适合对高可用、高性能、数据一致性有较高要求，同时需要读写分离和负载均衡功能的场景;读取量大的场景，如 Web 应用</td><td>MySQL 5.0 ~ 8.0, MariaDB 5.5 ~ 10.3, Percona Server 5.5 ~ 8.0, Percona XtraDB Cluster 5.6 ~ 8.0, Galera Cluster 3.x ~ 4.x, MySQL NDB Cluster 7.4 ~ 8.0, MySQL InnoDB Cluster 5.7 ~ 8.0, MySQL Group Replication 5.7 ~ 8.0, MySQL InnoDB ReplicaSet 8.0, MySQL InnoDB ClusterSet 8.0, MySQL Router 2.1 ~ 8.0, MySQL Shell 1.0 ~ 8.0, MySQL Fabric 1.5 ~ 1.6, MySQL Utilities 1.3 ~ 1.6, MySQL Workbench 6.x ~ 8.x, Oracle Enterprise Manager for MySQL Database Release 13.x ~14.x, Oracle GoldenGate for MySQL Release 12.x ~19.x, Oracle Data Guard for MySQL Release 12.x ~19.x, Oracle Data Integrator for MySQL Release 12.x ~19.x, Oracle SQL Developer for MySQL Release 4.x ~19.x, Oracle Database Gateway for MySQL Release 12.x ~19.x</td></tr><tr><td>mysql Master-Master Keepalived + LVS</td><td>99.9%</td><td>高（支持多个主库和多个 LVS 节点，可以水平扩展读写节点）</td><td>较快（最多丢失 5 秒数据，支持多种备份和恢复方式）</td><td>高（需要安装和配置 Keepalived、LVS 软件和双主模式）</td><td>开源，免费；高（需要额外硬件支持虚拟 IP 地址和负载均衡）</td><td>中等（使用 binlog 进行数据同步，但可能存在数据冲突或丢失的风险）；异步复制 (可能有数据丢失或不一致)</td><td>是（Keepalived 负责监控和切换）</td><td>中等（主库之间需要同步 binlog，增加网络开销）</td><td>5~10 秒（取决于 Keepalived 的检测间隔和切换时间）</td><td>0~5 秒（取决于 binlog 同步延迟和冲突解决策略）</td><td>MySQL 5.0 及以上版本</td><td>所有存储引擎</td><td>支持双主模式，提供读写分离和负载均衡功能，支持自动故障切换</td><td>复杂度高，成本高，数据一致性较低，存在数据冲突或丢失的风险，不支持在线回切</td><td>适合对读写分离和负载均衡有较高要求，但对数据一致性、复杂度和成本可以容忍的场景; 读写量都大的场景，如电商平台</td><td>MySQL 5.0 ~ 8.0, MariaDB 5.5 ~ 10.3, Percona Server 5.5 ~ 8.0, Percona XtraDB Cluster 5.6 ~ 8.0, Galera Cluster 3.x ~ 4.x, MySQL NDB Cluster 7.4 ~ 8.0, MySQL InnoDB Cluster 5.7 ~ 8.0, MySQL Group Replication 5.7 ~ 8.0, MySQL InnoDB ReplicaSet 8.0, MySQL InnoDB ClusterSet 8.0, MySQL Router 2.1 ~ 8.0, MySQL Shell 1.0 ~ 8.0, MySQL Fabric 1.5 ~ 1.6, MySQL Utilities 1.3 ~ 1.6, MySQL Workbench 6.x ~ 8.x, Oracle Enterprise Manager for MySQL Database Release 13.x ~14.x, Oracle GoldenGate for MySQL Release 12.x ~19.x, Oracle Data Guard for MySQL Release 12.x ~19.x, Oracle Data Integrator for MySQL Release 12.x ~19.x, Oracle SQL Developer for MySQL Release 4.x ~19.x, Oracle Database Gateway for MySQL Release 12.x ~19.x</td></tr><tr><td>MySQL MHA + ProxySQL</td><td>99.999% (双点故障)</td><td>高 (支持多主或单主架构，可以水平扩展读写节点)</td><td>高 (支持多种备份和恢复方式)</td><td>中 (需要安装和配置MHA和ProxySQL)</td><td>中 (开源免费，但需要额外的硬件资源)</td><td>异步复制 (可能有数据丢失或不一致)</td><td>是 (通过MHA监控和切换)</td><td>高 (多主或单主架构提高写入性能，ProxySQL提供负载均衡和读写分离功能)</td><td>短 (&lt; 30秒)</td><td>可能有数据丢失 (&lt; 1秒)</td><td>MySQL 5.7 以上</td><td>所有存储引擎 (但推荐使用InnoDB)</td><td>支持多主或单主架构，支持负载均衡和读写分离，支持在线扩容或缩容，支持半同步复制或组复制，支持GTID或并行复制,支持自动备份或恢复验证，支持延迟复制或闪回功能，支持数据冗余或校验和功能</td><td>ProxySQL 是一个商业软件，需要购买许可证， MHA + ProxySQL 的配置比较复杂。</td><td>适用于对高可用性要求较高，对数据一致性要求较低，对性能要求较高，对成本要求较中等的场景。例如：金融交易、电子支付、电子商务等。</td><td>MySQL 5.0 以上</td></tr><tr><td>MySQL Group Replication</td><td>99.999% (双点故障)</td><td>高 (支持多主或单主架构，可以水平扩展读写节点)</td><td>高 (支持多种备份和恢复方式)</td><td>中 (需要安装和配置MySQL Server和MySQL Router)</td><td>中 (开源免费，但需要额外的硬件资源)</td><td>组复制 (保证数据零丢失和强一致性)</td><td>是 (通过MySQL Server监控和切换)</td><td>高 (多主或单主架构提高写入性能，MySQL Router提供负载均衡和读写分离功能)</td><td>短 (&lt; 30秒)</td><td>无数据丢失 (0秒)</td><td>MySQL 5.0 以上</td><td>只支持InnoDB存储引擎</td><td>支持多主或单主架构，支持负载均衡和读写分离，支持在线扩容或缩容，支持半同步复制或组复制，支持GTID或并行复制</td><td>MGR的配置和管理比传统主从复制更复杂</td><td>需要提高数据库的可用性、读取性能、容错性或水平扩展，那么 MGR 是一个不错的选择。</td><td>MySQL 5.7 ~ 8.0, MariaDB 10.3, Percona Server 8.0, Percona XtraDB Cluster 8.0, Galera Cluster 4.x, MySQL NDB Cluster 8.0, MySQL InnoDB Cluster 8.0, MySQL InnoDB ReplicaSet 8.0, MySQL InnoDB ClusterSet 8.0, MySQL Router 2.1 ~ 8.0, MySQL Shell 1.0 ~ 8.0, MySQL Fabric 1.6, MySQL Utilities 1.6, MySQL Workbench 6.x ~ 8.x, Oracle Enterprise Manager for MySQL Database Release 13.x ~14.x, Oracle GoldenGate for MySQL Release 12.x ~19.x, Oracle Data Guard for MySQL Release 12.x ~19.x, Oracle Data Integrator for MySQL Release 12.x ~19.x, Oracle SQL Developer for MySQL Release 4.x ~19.x, Oracle Database Gateway for MySQL Release 12.x ~19.x</td></tr><tr><td>mysql innodb cluster</td><td>99.99%</td><td>高（支持多个节点和分片，可以水平扩展读写节点）</td><td>快速（无数据丢失，支持多种备份和恢复方式）</td><td>中等（需要安装和配置 MySQL Shell 和 MySQL Router）</td><td>开源，免费；中等（无需额外硬件）</td><td>高（使用组复制进行数据同步）；组复制 (保证数据零丢失和强一致性)</td><td>是（基于 Paxos 算法实现自动选主和故障转移）</td><td>高（支持多主模式和单主模式，提供负载均衡功能）</td><td>0~5 秒（取决于故障检测和选主时间）</td><td>0 秒（无数据丢失）</td><td>MySQL 8.0 及以上版本</td><td>InnoDB 存储引擎</td><td>高可用，高性能，数据一致性高，支持读写分离和负载均衡功能，支持自动故障切换和节点恢复，提供统一的管理接口和路由器</td><td>复杂度中等，需要额外软件支持，只兼容 InnoDB 存储引擎，存在网络分区或脑裂的风险</td><td>适合对高可用、高性能、数据一致性有较高要求，同时需要读写分离和负载均衡功能的场景; 对可用性、可靠性和扩展性要求高的场景，如金融行业</td><td>MySQL 5.7 ~ 8.0, MariaDB 10.3, Percona Server 8.0, Percona XtraDB Cluster 8.0, Galera Cluster 4.x, MySQL NDB Cluster 8.0, MySQL InnoDB ReplicaSet 8.0, MySQL InnoDB ClusterSet 8.0, MySQL Router 2.1 ~ 8.0, MySQL Shell 1.0 ~ 8.0, MySQL Fabric 1.6, MySQL Utilities 1.6, MySQL Workbench 6.x ~ 8.x, Oracle Enterprise Manager for MySQL Database Release 13.x ~14.x, Oracle GoldenGate for MySQL Release 12.x ~19.x, Oracle Data Guard for MySQL Release 12.x ~19.x, Oracle Data Integrator for MySQL Release 12.x ~19.x, Oracle SQL Developer for MySQL Release 4.x ~19.x, Oracle Database Gateway for MySQL Release 12.x ~19.x</td></tr><tr><td>mysql innodb replicaset</td><td>99.9%</td><td>高（支持多个备库和多个源库，只能水平扩展读节点）</td><td>较快（最多丢失 1 秒数据，支持多种备份和恢复方式）</td><td>中等（需要安装和配置 MySQL Shell 和 MySQL Router）</td><td>开源，免费；低（无需额外硬件）</td><td>高（使用 binlog 进行数据同步）；异步复制 (可能有数据丢失或不一致)</td><td>否（需要手动触发故障切换）</td><td>高（主库无需额外负担，提供负载均衡功能）</td><td>0~30 秒（取决于故障检测和切换时间）</td><td>0~1 秒（取决于 binlog 同步延迟）</td><td>MySQL 5.7 及以上版本</td><td>所有存储引擎</td><td>简单易用，高可用，高性能，低成本，数据一致性高，支持读写分离和负载均衡功能，支持在线切换和回切，支持采纳现有复制拓扑</td><td>复杂度中等，需要额外软件支持，不支持自动故障切换和节点恢复</td><td>适合对高可用、高性能、低成本、数据一致性有较高要求，但不需要自动故障切换的场景; 读负载量大的场景，如 Web 应用</td><td>MySQL 8.0, MariaDB 10.3, Percona Server 8.0, Percona XtraDB Cluster 8.0, Galera Cluster 4.x, MySQL NDB Cluster 8.0, MySQL InnoDB Cluster 8.0, MySQL Group Replication 8.0, MySQL InnoDB ClusterSet 8.0, MySQL Router 8.0, MySQL Shell 8.0, MySQL Fabric 1.6, MySQL Utilities 1.6, MySQL Workbench 8.x, Oracle Enterprise Manager for MySQL Database Release 13.x ~14.x, Oracle GoldenGate for MySQL Release 12.x ~19.x, Oracle Data Guard for MySQL Release 12.x ~19.x, Oracle Data Integrator for MySQL Release 12.x ~19.x, Oracle SQL Developer for MySQL Release 4.x ~19.x, Oracle Database Gateway for MySQL Release 12.x ~19.x</td></tr><tr><td>mysql innodb clusterset</td><td>99.999%</td><td>高（支持多个集群和分片，可以水平扩展读写节点）</td><td>快速（无数据丢失，支持多种备份和恢复方式）</td><td>高（需要安装和配置 MySQL Shell 和 MySQL Router，以及集群间的复制通道）</td><td>开源，免费；高（需要额外硬件支持跨地域部署）</td><td>高（使用组复制和 binlog 进行数据同步）；组复制 (保证数据零丢失和强一致性)</td><td>是（基于 Paxos 算法实现自动选主和故障转移，以及集群间的切换）</td><td>高（支持多主模式和单主模式，提供负载均衡功能）</td><td>0~5 秒（取决于故障检测和选主时间）</td><td>0 秒（无数据丢失）</td><td>MySQL 8.0.22 及以上版本</td><td>InnoDB 存储引擎</td><td>超高可用，高性能，数据一致性高，支持读写分离和负载均衡功能，支持自动故障切换和节点恢复，支持跨地域部署和灾备切换，提供统一的管理接口和路由器</td><td>复杂度高，成本高，需要额外软件和硬件支持，只兼容 InnoDB 存储引擎，存在网络分区或脑裂的风险</td><td>适合对超高可用、高性能、数据一致性有极高要求，同时需要跨地域部署和灾备切换功能的场景; 读负载量大的场景，如 Web 应用</td><td>MySQL 8.0, MariaDB 10.3, Percona Server 8.0, Percona XtraDB Cluster 8.0, Galera Cluster 4.x, MySQL NDB Cluster 8.0, MySQL InnoDB Cluster 8.0, MySQL Group Replication 8.0, MySQL InnoDB ReplicaSet 8.0, MySQL Router 8.0, MySQL Shell 8.0, MySQL Fabric 1.6, MySQL Utilities 1.6, MySQL Workbench 8.x, Oracle Enterprise Manager for MySQL Database Release 13.x ~14.x, Oracle GoldenGate for MySQL Release 12.x ~19.x, Oracle Data Guard for MySQL Release 12.x ~19.x, Oracle Data Integrator for MySQL Release 12.x ~19.x, Oracle SQL Developer for MySQL Release 4.x ~19.x, Oracle Database Gateway for MySQL Release 12.x ~19.x</td></tr><tr><td>mysql ndb cluster</td><td>99.999%</td><td>高（支持多个数据节点和分片，可以水平扩展读写节点）</td><td>快速（无数据丢失，支持多种备份和恢复方式）</td><td>高（需要安装和配置 NDB Cluster 软件和 MySQL Cluster Manager）</td><td>商业软件；高（需要额外硬件支持共享内存和分布式存储）</td><td>高（使用 NDB 引擎进行数据同步）；同步复制 (保证数据零丢失和强一致性)</td><td>是（基于心跳机制实现自动选主和故障转移）</td><td>高（支持多主模式，提供负载均衡功能）</td><td>0~5 秒（取决于故障检测和选主时间）</td><td>0 秒（无数据丢失）</td><td>MySQL 5.7 及以上版本</td><td>NDB 存储引擎</td><td>超高可用，高性能，数据一致性高，支持读写分离和负载均衡功能，支持自动故障切换和节点恢复，支持实时应用和大规模并发访问，提供统一的管理接口和路由器</td><td>复杂度高，成本高，需要额外软件和硬件支持，只兼容 NDB 存储引擎，存在内存限制和网络开销的问题</td><td>适合对超高可用、高性能、数据一致性有极高要求，同时需要实时应用和大规模并发访问功能的场景; 对可用性、性能和扩展性要求高的场景，如电信行业</td><td>MySQL 5.7 ~ 8.0, MariaDB 10.3, Percona Server 8.0, Percona XtraDB Cluster 8.0, Galera Cluster 4.x, MySQL InnoDB Cluster 8.0, MySQL Group Replication 8.0, MySQL InnoDB ReplicaSet 8.0, MySQL InnoDB ClusterSet 8.0, MySQL Router 2.1 ~ 8.0, MySQL Shell 1.0 ~ 8.0, MySQL Fabric 1.6, MySQL Utilities 1.6, MySQL Workbench 6.x ~ 8.x, Oracle Enterprise Manager for MySQL Database Release 13.x ~14.x, Oracle GoldenGate for MySQL Release 12.x ~19.x, Oracle Data Guard for MySQL Release 12.x ~19.x, Oracle Data Integrator for MySQL Release 12.x ~19.x, Oracle SQL Developer for MySQL Release 4.x ~19.x, Oracle Database Gateway for MySQL Release 12.x ~19.x</td></tr><tr><td>mysql xenon</td><td>99.99%</td><td>高（支持多个备库，可以水平扩展读写节点）</td><td>快速（最多丢失 1 秒数据，支持多种备份和恢复方式）</td><td>中等（需要安装和配置 xenon 软件）</td><td>商业软件；低（无需额外硬件）</td><td>高（使用 binlog 进行数据同步）；同步复制 (保证数据零丢失和强一致性)</td><td>是（xenon manager 负责监控和切换）</td><td>高（主库无需额外负担）</td><td>0~30 秒（取决于 xenon manager 的检测间隔和切换时间）</td><td>0~1 秒（取决于 binlog 同步延迟）</td><td>MySQL 5.0 及以上版本</td><td>所有存储引擎</td><td>简单易用，高可用，高性能，低成本，数据一致性高，支持在线切换和回切，支持流式备份和恢复</td><td>需要额外安装和配置 xenon 软件，需要保证所有备库之间的数据一致性，需要使用 mysqld_safe 启动 mysql</td><td>适合对高可用、高性能、低成本、数据一致性有较高要求的场景; 对可用性、可靠性和扩展性要求高的场景，如游戏行业</td><td>MySQL 5.6 ~ 8.0, MariaDB 10.3, Percona Server 5.6 ~ 8.0, Percona XtraDB Cluster 5.6 ~ 8.0, Galera Cluster 3.x ~ 4.x, MySQL NDB Cluster 7.4 ~ 8.0, MySQL InnoDB Cluster 5.7 ~ 8.0, MySQL Group Replication 5.7 ~ 8.0, MySQL InnoDB ReplicaSet 8.0, MySQL InnoDB ClusterSet 8.0, MySQL Router 2.1 ~ 8.0, MySQL Shell 1.0 ~ 8.0, MySQL Fabric 1.5 ~ 1.6, MySQL Utilities 1.3 ~ 1.6, MySQL Workbench 6.x ~ 8.x, Oracle Enterprise Manager for MySQL Database Release 13.x ~14.x, Oracle GoldenGate for MySQL Release 12.x ~19.x, Oracle Data Guard for MySQL Release 12.x ~19.x, Oracle Data Integrator for MySQL Release 12.x ~19.x, Oracle SQL Developer for MySQL Release 4.x ~19.x, Oracle Database Gateway for MySQL Release 12.x ~19.x</td></tr><tr><td>percona xtradb cluster</td><td>99.99%</td><td>高（支持多主或单主架构，可以水平扩展读写节点）</td><td>快速（无数据丢失，支持多种备份和恢复方式）</td><td>中等（需要安装和配置 percona server 和 percona xtrabackup）</td><td>开源，免费；中等（无需额外硬件）</td><td>高（使用组复制进行数据同步）；同步复制 (保证数据零丢失和强一致性)</td><td>是（基于 Paxos 算法实现自动选主和故障转移）</td><td>高（支持多主模式和单主模式，提供负载均衡功能）</td><td>0~5 秒（取决于故障检测和选主时间）</td><td>0 秒（无数据丢失）</td><td>MySQL 8.0 及以上版本</td><td>XtraDB/InnoDB、MyISAM(不完全支持) 存储引擎</td><td>高可用，高性能，数据一致性高，支持读写分离和负载均衡功能，支持自动故障切换和节点恢复，提供统一的管理接口和路由器，免费开源且提供专业支持服务</td><td>复杂度中等，需要额外软件支持，只兼容 InnoDB 存储引擎，存在网络分区或脑裂的风险</td><td>适合对高可用、高性能、数据一致性有较高要求，同时需要读写分离和负载均衡功能的场景; 对可用性、可靠性和扩展性要求高的场景，如企业级应用</td><td>MySQL 5.6 ~ 8.0, MariaDB 10.3, Percona Server 5.6 ~ 8.0, Galera Cluster 3.x ~ 4.x, MySQL NDB Cluster 7.4 ~ 8.0, MySQL InnoDB Cluster 5.7 ~ 8.0, MySQL Group Replication 5.7 ~ 8.0, MySQL InnoDB ReplicaSet 8.0, MySQL InnoDB ClusterSet 8.0, MySQL Router 2.1 ~ 8.0, MySQL Shell 1.0 ~ 8.0, MySQL Fabric 1.5 ~ 1.6, MySQL Utilities 1.3 ~ 1.6, MySQL Workbench 6.x ~ 8.x, Oracle Enterprise Manager for MySQL Database Release 13.x ~14.x, Oracle GoldenGate for MySQL Release 12.x ~19.x, Oracle Data Guard for MySQL Release 12.x ~19.x, Oracle Data Integrator for MySQL Release 12.x ~19.x, Oracle SQL Developer for MySQL Release 4.x ~19.x, Oracle Database Gateway for MySQL Release 12.x ~19.x</td></tr><tr><td>galera cluster</td><td>99.999%</td><td>高（支持多主或单主架构，可以水平扩展读写节点）</td><td>快速（无数据丢失，支持多种备份和恢复方式）</td><td>高（需要安装和配置 galera replication library 和 mysql-wsrep）</td><td>开源，免费；高（需要额外硬件支持共享内存和分布式存储）</td><td>高（使用 InnoDB 引擎进行数据同步）；同步复制 (保证数据零丢失和强一致性)</td><td>是（基于心跳机制实现自动选主和故障转移）</td><td>高（支持多主模式，提供负载均衡功能）</td><td>0~5 秒（取决于故障检测和选主时间）</td><td>0 秒（无数据丢失）</td><td>MySQL 5.7 及以上版本</td><td>XtraDB/InnoDB、MyISAM(不完全支持) 存储引擎</td><td>超高可用，高性能，数据一致性高，支持读写分离和负载均衡功能，支持自动故障切换和节点恢复，支持实时应用和大规模并发访问，提供统一的管理接口和路由器，免费开源且提供专业支持服务</td><td>复杂度高，成本高，需要额外软件和硬件支持，只兼容 NDB 存储引擎，存在内存限制和网络开销的问题</td><td>适合对超高可用、高性能、数据一致性有极高要求，同时需要实时应用和大规模并发访问功能的场景; 对可用性、可靠性和扩展性要求高的场景，如互联网行业</td><td>MySQL 5.6 ~ 8.0, MariaDB 10.3, Percona Server 5.6 ~ 8.0, Percona XtraDB Cluster 5.6 ~ 8.0, MySQL NDB Cluster 7.4 ~ 8.0, MySQL InnoDB Cluster 5.7 ~ 8.0, MySQL Group Replication 5.7 ~ 8.0, MySQL InnoDB ReplicaSet 8.0, MySQL InnoDB ClusterSet 8.0, MySQL Router 2.1 ~ 8.0, MySQL Shell 1.0 ~ 8.0, MySQL Fabric 1.5 ~ 1.6, MySQL Utilities 1.3 ~ 1.6, MySQL Workbench 6.x ~ 8.x, Oracle Enterprise Manager for MySQL Database Release 13.x ~14.x, Oracle GoldenGate for MySQL Release 12.x ~19.x, Oracle Data Guard for MySQL Release 12.x ~19.x, Oracle Data Integrator for MySQL Release 12.x ~19.x, Oracle SQL Developer for MySQL Release 4.x ~19.x, Oracle Database Gateway for MySQL Release 12.x ~19.x</td></tr><tr><td>mysql heartbeat+san</td><td>99.9%</td><td>中（支持两个节点和多个备库，可以水平扩展读写节点）</td><td>较快（最多丢失 1 秒数据，支持多种备份和恢复方式）</td><td>中等（需要安装和配置 heartbeat 软件和 san 存储）</td><td>开源，免费；高（需要额外硬件支持共享存储和虚拟 IP 地址）</td><td>高（共享存储，无数据丢失）</td><td>是（heartbeat 负责监控和切换）</td><td>高（主库无需额外负担，提供负载均衡功能）</td><td>1~5 秒（取决于 heartbeat 的检测间隔和切换时间）</td><td>0~1 秒（取决于 binlog 同步延迟）</td><td>MySQL 5.0 及以上版本</td><td>所有存储引擎</td><td>高可用，高性能，数据一致性高，支持读写分离和负载均衡功能，支持自动故障切换</td><td>复杂度中等，成本高，需要额外硬件和软件支持，不支持在线回切，存在网络分区或脑裂的风险</td><td>适合对高可用、高性能、数据一致性有较高要求，同时需要共享存储和虚拟 IP 地址功能的场景; 读负载量大的场景，如 Web 应用</td><td>MySQL 5.0 ~ 8.0, MariaDB 5.5 ~ 10.3, Percona Server 5.5 ~ 8.0, Percona XtraDB Cluster 5.6 ~ 8.0, Galera Cluster 3.x ~ 4.x, MySQL NDB Cluster 7.4 ~ 8.0, MySQL InnoDB Cluster 5.7 ~ 8.0, MySQL Group Replication 5.7 ~ 8.0, MySQL InnoDB ReplicaSet 8.0, MySQL InnoDB ClusterSet 8.0, MySQL Router 2.1 ~ 8.0, MySQL Shell 1.0 ~ 8.0, MySQL Fabric 1.5 ~ 1.6, MySQL Utilities 1.3 ~ 1.6, MySQL Workbench 6.x ~ 8.x, Oracle Enterprise Manager for MySQL Database Release 13.x ~14.x, Oracle GoldenGate for MySQL Release 12.x ~19.x, Oracle Data Guard for MySQL Release 12.x ~19.x, Oracle Data Integrator for MySQL Release 12.x ~19.x, Oracle SQL Developer for MySQL Release 4.x ~19.x, Oracle Database Gateway for MySQL Release 12.x ~19.x</td></tr><tr><td>mysql heartbeat+dbrd</td><td>99.99%</td><td>中（可以水平扩展读写节点）</td><td>快速（无数据丢失，支持多种备份和恢复方式）</td><td>高（需要安装和配置 heartbeat 软件和 dbrd 软件）</td><td>开源，免费；高（需要额外硬件支持镜像文件系统和虚拟 IP 地址）</td><td>高（使用 dbrd 进行数据同步）</td><td>是（heartbeat 负责监控和切换）</td><td>高（主库无需额外负担，提供负载均衡功能）</td><td>0~5 秒（取决于 heartbeat 的检测间隔和切换时间）</td><td>0 秒（无数据丢失）</td><td>MySQL 5.0 及以上版本</td><td>所有存储引擎</td><td>超高可用，高性能，数据一致性高，支持读写分离和负载均衡功能，支持自动故障切换和节点恢复，提供统一的管理接口和路由器</td><td>复杂度高，成本高，需要额外软件和硬件支持，存在恢复时间和性能损失的问题</td><td>适合对超高可用、高性能、数据一致性有极高要求，同时需要镜像文件系统和虚拟 IP 地址功能的场景; 读负载量大的场景，如 Web 应用</td><td>MySQL 5.0 ~ 8.0, MariaDB 5.5 ~ 10.3, Percona Server 5.5 ~ 8.0, Percona XtraDB Cluster 5.6 ~ 8.0, Galera Cluster 3.x ~ 4.x, MySQL NDB Cluster 7.4 ~ 8.0, MySQL InnoDB Cluster 5.7 ~ 8.0, MySQL Group Replication 5.7 ~ 8.0, MySQL InnoDB ReplicaSet 8.0, MySQL InnoDB ClusterSet 8.0, MySQL Router 2.1 ~ 8.0, MySQL Shell 1.0 ~ 8.0, MySQL Fabric 1.5 ~ 1.6, MySQL Utilities 1.3 ~ 1.6, MySQL Workbench 6.x ~ 8.x, Oracle Enterprise Manager for MySQL Database Release 13.x ~14.x, Oracle GoldenGate for MySQL Release 12.x ~19.x, Oracle Data Guard for MySQL Release 12.x ~19.x, Oracle Data Integrator for MySQL Release 12.x ~19.x, Oracle SQL Developer for MySQL Release 4.x ~19.x, Oracle Database Gateway for MySQL Release 12.x ~19.x</td></tr><tr><td>mysql Tungsten Replicator</td><td>99.99%</td><td>高（支持多个节点和多种目标，可以水平扩展读写节点）</td><td>快速（无数据丢失，支持多种备份和恢复方式）</td><td>中等（需要安装和配置 Tungsten Replicator 软件）</td><td>商业软件；中等（无需额外硬件）</td><td>高（使用 binlog 或组复制进行数据同步）</td><td>是（Tungsten Manager 负责监控和切换）</td><td>高（支持多主模式和单主模式，提供负载均衡功能）</td><td>0~5 秒（取决于 Tungsten Manager 的检测间隔和切换时间）</td><td>0 秒（无数据丢失）</td><td>MySQL 5.0 及以上版本</td><td>所有存储引擎</td><td>高可用，高性能，数据一致性高，支持读写分离和负载均衡功能，支持自动故障切换和节点恢复，支持异构复制到多种目标，提供统一的管理接口和路由器，免费开源且提供专业支持服务</td><td>复杂度中等，需要额外软件支持，存在网络分区或脑裂的风险</td><td>适合对高可用、高性能、数据一致性有较高要求，同时需要异构复制到多种目标的场景; 对性能和扩展性要求高的场景，如大数据应用</td><td>MySQL 5.0 ~ 8.0, MariaDB 5.5 ~ 10.3, Percona Server 5.5 ~ 8.0, Percona XtraDB Cluster 5.6 ~ 8.0, Galera Cluster 3.x ~ 4.x, MySQL NDB Cluster 7.4 ~ 8.0, MySQL InnoDB Cluster 5.7 ~ 8.0, MySQL Group Replication 5.7 ~ 8.0, MySQL InnoDB ReplicaSet 8.0, MySQL InnoDB ClusterSet 8.0, MySQL Router 2.1 ~ 8.0, MySQL Shell 1.0 ~ 8.0, MySQL Fabric 1.5 ~ 1.6, MySQL Utilities 1.3 ~ 1.6, MySQL Workbench 6.x ~ 8.x, Oracle Enterprise Manager for MySQL Database Release 13.x ~14.x, Oracle GoldenGate for MySQL Release 12.x ~19.x, Oracle Data Guard for MySQL Release 12.x ~19.x, Oracle Data Integrator for MySQL Release 12.x ~19.x, Oracle SQL Developer for MySQL Release 4.x ~19.x, Oracle Database Gateway for MySQL Release 12.x ~19.x</td></tr><tr><td>MySQL Consul</td><td>99.99% (单点故障)</td><td>高 (支持多种目标，可以水平扩展读写节点)</td><td>高 (支持多种备份和恢复方式)</td><td>中 (需要安装和配置Consul Server和Consul Client)</td><td>中 (开源免费，但需要额外的硬件资源)</td><td>异步复制 (可能有数据丢失或不一致)</td><td>是 (通过Consul Server监控和切换)</td><td>高 (支持多种目标提高写入性能，Consul Client提供负载均衡和读写分离功能)</td><td>中 (&lt; 5分钟)</td><td>可能有数据丢失 (&lt; 1秒)</td><td>MySQL 5.0 以上</td><td>所有存储引擎 (但推荐使用InnoDB)</td><td>支持负载均衡和读写分离，支持在线扩容或缩容，支持半同步复制或组复制，支持GTID或并行复制</td><td>不支持自动故障切换</td><td>适用于对高可用性要求较高，对数据一致性要求较低，对性能要求较高，对成本要求较中等的场景。例如：数据分析、数据仓库、数据迁移等。</td><td>MySQL 5.0 ~ 8.0, MariaDB 5.5 ~ 10.3, Percona Server 5.5 ~ 8.0, Percona XtraDB Cluster 5.6 ~ 8.0, Galera Cluster 3.x ~ 4.x, MySQL NDB Cluster 7.4 ~ 8.0, MySQL InnoDB Cluster 5.7 ~ 8.0, MySQL Group Replication 5.7 ~ 8.0, MySQL InnoDB ReplicaSet 8.0, MySQL InnoDB ClusterSet 8.0, MySQL Router 2.1 ~ 8.0, MySQL Shell 1.0 ~ 8.0, MySQL Fabric 1.5 ~ 1.6, MySQL Utilities 1.3 ~ 1.6, MySQL Workbench 6.x ~ 8.x, Oracle Enterprise Manager for MySQL Database Release 13.x ~14.x, Oracle GoldenGate for MySQL Release 12.x ~19.x, Oracle Data Guard for MySQL Release 12.x ~19.x, Oracle Data Integrator for MySQL Release 12.x ~19.x, Oracle SQL Developer for MySQL Release 4.x ~19.x, Oracle Database Gateway for MySQL Release 12.x ~19.x</td></tr><tr><td>MySQL Fabric</td><td>99.999% (双点故障)</td><td>高 (支持多主或单主架构，可以水平扩展读写节点)</td><td>高 (支持多种备份和恢复方式)</td><td>中 (需要安装和配置MySQL Fabric Server和MySQL Fabric Client)</td><td>中 (开源免费，但需要额外的硬件资源)</td><td>异步复制 (可能有数据丢失或不一致)</td><td>是 (通过MySQL Fabric Server监控和切换)</td><td>高 (多主或单主架构提高写入性能，MySQL Fabric Client提供负载均衡和读写分离功能)</td><td>短 (&lt; 30秒)</td><td>可能有数据丢失 (&lt; 1秒)</td><td>MySQL 5.6-5.7以上</td><td>所有存储引擎 (但推荐使用InnoDB)</td><td>支持多主或单主架构，支持自定义脚本和钩子，支持负载均衡和读写分离，支持在线扩容或缩容，支持半同步复制或组复制，支持GTID或并行复制，支持自动备份或恢复验证，支持延迟复制或闪回功能，支持数据冗余或校验和功能</td><td>不支持MySQL 8.0及以上版本</td><td>需要高可用性的数据库系统，需要扩展性的数据库系统。</td><td>MySQL 5.6 ~ 5.7, MariaDB 10.3, Percona Server 5.6 ~ 5.7, Percona XtraDB Cluster 5.6 ~ 5.7, Galera Cluster 3.x, MySQL NDB Cluster 7.4 ~ 7.6, MySQL InnoDB Cluster 5.7, MySQL Group Replication 5.7, MySQL InnoDB ReplicaSet 8.0, MySQL InnoDB ClusterSet 8.0, MySQL Router 2.1 ~ 2.2, MySQL Shell 1.0 ~ 1.1, MySQL Utilities 1.3 ~ 1.6, MySQL Workbench 6.x ~ 8.x, Oracle Enterprise Manager for MySQL Database Release 13.x ~14.x, Oracle GoldenGate for MySQL Release 12.x ~19.x, Oracle Data Guard for MySQL Release 12.x ~19.x, Oracle Data Integrator for MySQL Release 12.x ~19.x, Oracle SQL Developer for MySQL Release 4.x ~19.x, Oracle Database Gateway for MySQL Release 12.x ~19.x</td></tr></tbody></table><div class="hint-container tip"><p class="hint-container-title">说明：</p><p>高可用性指的是集群在出现故障时，仍然能够提供数据服务的能力。 可扩展性指的是集群在增加节点时，仍然能够提供良好的性能和可用性的能力。 灾难恢复指的是集群在出现灾难时，仍然能够快速恢复数据服务的能力。 复杂性指的是集群的部署和管理难度。 成本指的是集群的部署和维护成本。 数据一致性指的是集群中的数据在多个节点之间保持一致的能力。 自动故障切换指的是集群在出现故障时，能够自动将数据服务切换到另一个节点的能力。 性能指的是集群在提供数据服务时，能够达到的吞吐量和响应时间。 RTO 指的是集群在出现故障后，恢复数据服务所需的时间。 RPO 指的是集群在出现故障后，丢失的数据量。 兼容的版本指的是集群能够支持的 MySQL 版本。 兼容的存储引擎指的是集群能够支持的 MySQL 存储引擎。 优点是指集群的优势。 缺点是指集群的劣势。 应用场景是指集群适合的场景。</p></div><p><em>CHATGPT提示词</em>：</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>1. 请你以DBA专家的身份，对 mysql mha, mysql mmm, mysql innodb cluster, mysql innodb replicaset, mysql innodb clusterset, mysql ndb cluster, mysql xenon, percona xtradb cluster, galera cluser, mysql heartbeat+san, mysql heartbeat+dbrd 这些高可用方案进行客观、真实可靠、专业、详细的对比。对比参数应包含高可用性（用数字表示）、可扩展性、灾难恢复、复杂性、成本、性能、RTO、RPO、兼容的版本、兼容的存储引擎、优点、缺点、应用场景。请使用表格展示并显示所有结果。

2. 请你以DBA专家的身份，对 mysql mha, mysql mmm, mysql Master-Slave  Keepalived + LVS, mysql Master-Master  Keepalived + LVS, mysql innodb cluster, mysql innodb replicaset, mysql innodb clusterset, mysql ndb cluster,mysql xenon, percona xtradb cluster, galera cluser, mysql heartbeat+san, mysql heartbeat+dbrd, mysql Tungsten Replicator 这些高可用方案进行客观、真实可靠、专业、详细的对比。对比参数应包含高可用性（用数字表示）、可扩展性、灾难恢复、复杂性、成本、数据一致性、自动故障切换、性能、RTO、RPO、兼容的版本、兼容的存储引擎、优点、缺点、应用场景。请使用表格展示并显示所有结果。

2.1 请你以DBA专家的身份，对 mysql mha, mysql mmm, mysql Master-Slave  Keepalived + LVS, mysql Master-Master  Keepalived + LVS 这些高可用方案进行客观、真实可靠、专业、详细的对比。对比参数应包含高可用性（用数字表示）、可扩展性、灾难恢复、复杂性、成本、数据一致性、自动故障切换、性能、RTO、RPO、兼容的版本、兼容的存储引擎、优点、缺点、应用场景。请使用表格展示并显示所有结果。

2.2 请你以DBA专家的身份，对 mysql innodb cluster, mysql innodb replicaset, mysql innodb clusterset, mysql ndb cluster 这些高可用方案进行客观、真实可靠、专业、详细的对比。对比参数应包含高可用性（用数字表示）、可扩展性、灾难恢复、复杂性、成本、数据一致性、自动故障切换、性能、RTO、RPO、兼容的版本、兼容的存储引擎、优点、缺点、应用场景。请使用表格展示并显示所有结果。

2.3 请你以DBA专家的身份，对 mysql xenon, percona xtradb cluster, galera cluser 这些高可用方案进行客观、真实可靠、专业、详细的对比。对比参数应包含高可用性（用数字表示）、可扩展性、灾难恢复、复杂性、成本、数据一致性、自动故障切换、性能、RTO、RPO、兼容的版本、兼容的存储引擎、优点、缺点、应用场景。请使用表格展示并显示所有结果。

2.4 请你以DBA专家的身份，对 mysql heartbeat+san, mysql heartbeat+dbrd, mysql Tungsten Replicator 这些高可用方案进行客观、真实可靠、专业、详细的对比。对比参数应包含高可用性（用数字表示）、可扩展性、灾难恢复、复杂性、成本、数据一致性、自动故障切换、性能、RTO、RPO、兼容的版本、兼容的存储引擎、优点、缺点、应用场景。请使用表格展示并显示所有结果。


3. 请你以DBA专家的身份，对 mysql mha, mysql mmm, mysql Master-Slave  Keepalived + LVS, mysql Master-Master  Keepalived + LVS, mysql innodb cluster, mysql innodb replicaset, mysql innodb clusterset, mysql ndb cluster,mysql xenon, percona xtradb cluster, galera cluser, mysql heartbeat+san, mysql heartbeat+dbrd, mysql Tungsten Replicator 等mysql高可用方案进行客观、真实可靠、专业、详细的对比。对比参数应包含高可用性（用数字表示）、可扩展性、灾难恢复、复杂性、成本、数据一致性、自动故障切换、性能、RTO、RPO、兼容的版本、兼容的存储引擎、优点、缺点、应用场景。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!-- 
<iframe
  :src="$withBase('/markmap/mysql/demo.html')"
  width="100%"
  height="600"
  frameborder="0"
  scrolling="No"
  leftmargin="0"
  topmargin="0"
/> --><h2 id="数据库中间件" tabindex="-1"><a class="header-anchor" href="#数据库中间件"><span>数据库中间件</span></a></h2><h3 id="mycat" tabindex="-1"><a class="header-anchor" href="#mycat"><span>MyCat</span></a></h3><p>前身 Cobar，开源，较为活跃。</p><p>特点：</p><p>遵守 Mysql 原生协议，跨语言，跨数据库的通用中间件代理。</p><p>基于心跳的自动故障切换，支持读写分离，支持 MySQL 一双主多从，以及一主多从</p><p>有效管理数据源连接，基于数据分库，而不是分表的模式。</p><p>基于 NIO 实现，有效管理线程，高并发问题。</p><p>支持数据的多片自动路由与聚合，支持 sum , count , max 等常用的聚合函数。</p><p>支持 2 表 join，甚至基于 caltlet 的多表 join。</p><p>支持通过全局表，ER 关系的分片策略，实现了高效的多表 join 查询。</p><p>支持多租户方案。</p><p>支持分布式事务（弱 xa）</p><p>支持全局序列号，解决分布式下的主键生成问题。</p><p>分片规则丰富，插件化开发，易于扩展。</p><p>强大的 web，命令行监控。</p><p>支持前端作为 MySQL 通用代理，后端 JDBC 方式支持 Oracle、DB2、SQL Server 、 mongodb 、巨杉。</p><p>集群基于 ZooKeeper 管理，在线升级，扩容，智能优化，大数据处理（2.0 开发版）。</p><h3 id="mysql-proxy" tabindex="-1"><a class="header-anchor" href="#mysql-proxy"><span>MySQL-Proxy</span></a></h3><h3 id="apache-shardingsphere" tabindex="-1"><a class="header-anchor" href="#apache-shardingsphere"><span>Apache ShardingSphere</span></a></h3><h3 id="_360-atlas" tabindex="-1"><a class="header-anchor" href="#_360-atlas"><span>360 Atlas</span></a></h3><p>较为活跃，Atlas 是由 360 Web 平台部基础架构团队开发维护的一个基于 MySQL 协议的数据中间层项目。它是在 mysql-proxy 0.8.2 版本的基础上，对其进行了优化，增加了一些新的功能特性。360 内部使用 Atlas 运行的 MySQL 务，每天承载的读写请求数达几十亿条。</p><p>主要功能：</p><ol><li><p>读写分离</p></li><li><p>从库负载均衡</p></li><li><p>IP 过滤</p></li><li><p>SQL 语句黑白名单</p></li><li><p>自动分表</p></li></ol><h2 id="mysql-高可用解决方案选择原则" tabindex="-1"><a class="header-anchor" href="#mysql-高可用解决方案选择原则"><span>MySQL 高可用解决方案选择原则</span></a></h2></div><!--[--><!----><!--]--><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="vp-link vp-meta-label" href="https://github.com/abelit/abelit-datapeacock/edit/main/src/guide/database/mysql/ha/hasolution.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">上次编辑于: </span><!----></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: ychenid@live.com">ableit</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link vp-link prev" href="/guide/database/mysql/ha/qa.html" aria-label="高可用常见问题"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->高可用常见问题</div></a><!----></nav><!----><!--[--><!----><!--]--><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">MIT Licensed | Copyright © 2022-present Abelit</div><div class="vp-copyright">Copyright © 2024 Abelit </div></footer></div><!--]--><!--[--><!----><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-DR5J2daJ.js" defer></script>
  </body>
</html>
