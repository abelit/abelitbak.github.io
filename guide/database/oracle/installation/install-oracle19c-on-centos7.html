<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.9" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.39" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://github.com/abelit/abelit-datapeacock.git/guide/database/oracle/installation/install-oracle19c-on-centos7.html"><meta property="og:site_name" content="数之雀"><meta property="og:title" content="在CentOS/RHEL 7.x上安装Oracle"><meta property="og:description" content="自动安装脚本 自启动 设置/etc/oratab 使用dbstart和dbshut脚本需设置为$ORACLE_SID:$ORACLE_HOME:Y 开机启动脚本 如果监听名称不是默认“LISTENER”，需要在脚本中添加$ORACLE_HOME/bin/lsnrctl {start|stop} listener_name 配置run-level实现自启..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-05-11T14:06:18.000Z"><meta property="article:author" content="Abelit"><meta property="article:modified_time" content="2024-05-11T14:06:18.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"在CentOS/RHEL 7.x上安装Oracle","image":[""],"dateModified":"2024-05-11T14:06:18.000Z","author":[{"@type":"Person","name":"Abelit","url":"https://github.com/abelit"}]}</script><link rel="icon" href="/favicon.ico"><link rel="icon" href="/assets/icon/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icon/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icon/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icon/chrome-192.png" type="image/png" sizes="192x192"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><link rel="apple-touch-icon" href="/assets/icon/apple-icon-152.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-TileImage" content="/assets/icon/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><title>在CentOS/RHEL 7.x上安装Oracle | 数之雀</title><meta name="description" content="自动安装脚本 自启动 设置/etc/oratab 使用dbstart和dbshut脚本需设置为$ORACLE_SID:$ORACLE_HOME:Y 开机启动脚本 如果监听名称不是默认“LISTENER”，需要在脚本中添加$ORACLE_HOME/bin/lsnrctl {start|stop} listener_name 配置run-level实现自启...">
    <link rel="preload" href="/assets/style-IQdVitae.css" as="style"><link rel="stylesheet" href="/assets/style-IQdVitae.css">
    <link rel="modulepreload" href="/assets/app-DR5J2daJ.js"><link rel="modulepreload" href="/assets/install-oracle19c-on-centos7.html-C0UO7162.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">数之雀</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="开发"><!--[--><span class="font-icon icon iconfont icon-development" style=""></span>开发<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">程序设计语言</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/go/" aria-label="Go"><span class="font-icon icon iconfont icon-language-golang" style=""></span>Go<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/python/" aria-label="Python"><span class="font-icon icon iconfont icon-language-python" style=""></span>Python<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/rust/" aria-label="Rust"><span class="font-icon icon iconfont icon-language-rust" style=""></span>Rust<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/javascript/" aria-label="Javascript"><span class="font-icon icon iconfont icon-language-javascript" style=""></span>Javascript<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/typescript/" aria-label="Typescript"><span class="font-icon icon iconfont icon-language-typescript" style=""></span>Typescript<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">数据结构与算法</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/algorithm/" aria-label="Data Structure &amp; Algorithm"><span class="font-icon icon iconfont icon-algorithm" style=""></span>Data Structure &amp; Algorithm<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">后台框架</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/backend/flask/" aria-label="Flask"><span class="font-icon icon iconfont icon-flask" style=""></span>Flask<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/backend/django/" aria-label="Django"><span class="font-icon icon iconfont icon-django" style=""></span>Django<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/fastapi/" aria-label="FastAPI"><span class="font-icon icon iconfont icon-fastapi" style=""></span>FastAPI<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/gin/" aria-label="GIN"><span class="font-icon icon iconfont icon-gin" style=""></span>GIN<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/beego/" aria-label="Beego"><span class="font-icon icon iconfont icon-beego" style=""></span>Beego<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">前端框架</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/frontend/vue/" aria-label="Vue"><span class="font-icon icon iconfont icon-vue" style=""></span>Vue<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/frontend/react/" aria-label="React"><span class="font-icon icon iconfont icon-react" style=""></span>React<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">UI框架</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/ui/ant-design-vue.html" aria-label="ant-design-vue"><span class="font-icon icon iconfont icon-antdesign" style=""></span>ant-design-vue<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/ui/ant-design-react.html" aria-label="ant-design-react"><span class="font-icon icon iconfont icon-antdesign" style=""></span>ant-design-react<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/ui/element-plus.html" aria-label="element-plus"><span class="font-icon icon iconfont icon-eleme" style=""></span>element-plus<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/ui/vuetify.html" aria-label="vuetify"><span class="font-icon icon iconfont icon-vuetify" style=""></span>vuetify<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">模板</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="vp-link" href="https://pro.antdv.com/" rel="noopener noreferrer" target="_blank" aria-label="Ant Design Pro(Vue)"><!---->Ant Design Pro(Vue)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://pro.ant.design/" rel="noopener noreferrer" target="_blank" aria-label="Ant Design Pro(React)"><!---->Ant Design Pro(React)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://panjiachen.github.io/vue-element-admin-site/" rel="noopener noreferrer" target="_blank" aria-label="vue-element-admin"><!---->vue-element-admin<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://vvbin.cn/next/#/login?redirect=/dashboard" rel="noopener noreferrer" target="_blank" aria-label="vue-vben-admin"><!---->vue-vben-admin<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://pro.arco.design/" rel="noopener noreferrer" target="_blank" aria-label="Arco Design Pro"><!---->Arco Design Pro<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://github.com/vueleague/tpl-vue-admin-better?organization=vueleague&amp;organization=vueleague" rel="noopener noreferrer" target="_blank" aria-label="vue-admin-better"><!---->vue-admin-better<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="数据库"><!--[--><span class="font-icon icon iconfont icon-database" style=""></span>数据库<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">关系数据库</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link active vp-link" href="/guide/database/oracle/" aria-label="Oracle"><span class="font-icon icon iconfont icon-oracle" style=""></span>Oracle<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/mysql/" aria-label="MySQL"><span class="font-icon icon iconfont icon-mysql" style=""></span>MySQL<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/sqlite/" aria-label="SQlite"><span class="font-icon icon iconfont icon-sqlite" style=""></span>SQlite<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/postgresql/" aria-label="PostgreSQL"><span class="font-icon icon iconfont icon-postgresql" style=""></span>PostgreSQL<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/sqlserver/" aria-label="SQLServer"><span class="font-icon icon iconfont icon-sqlserver" style=""></span>SQLServer<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">非关系数据库</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/redis/" aria-label="Redis"><span class="font-icon icon iconfont icon-redis" style=""></span>Redis<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/mongo/" aria-label="MongoDB"><span class="font-icon icon iconfont icon-mongodb" style=""></span>MongoDB<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/couchdb/" aria-label="CouchDB"><span class="font-icon icon iconfont icon-couchdb" style=""></span>CouchDB<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/gauss/" aria-label="GaussDB"><span class="font-icon icon iconfont icon-opengauss" style=""></span>GaussDB<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/elasticsearch/" aria-label="ElasticSearch"><span class="font-icon icon iconfont icon-elasticsearch" style=""></span>ElasticSearch<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/hbase/" aria-label="HBase"><span class="font-icon icon iconfont icon-hbase" style=""></span>HBase<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/couchdb/" aria-label="CouchDB"><span class="font-icon icon iconfont icon-couchdb" style=""></span>CouchDB<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/clickhouse/" aria-label="ClickHouse"><span class="font-icon icon iconfont icon-clickhouse" style=""></span>ClickHouse<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="数据科学"><!--[--><span class="font-icon icon iconfont icon-datascience" style=""></span>数据科学<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">数据分析与挖掘</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/pandas/" aria-label="Pandas"><span class="font-icon icon iconfont icon-pandas-short" style=""></span>Pandas<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/numpy/" aria-label="Numpy"><span class="font-icon icon iconfont icon-numpy" style=""></span>Numpy<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/scipy/" aria-label="Scipy"><span class="font-icon icon iconfont icon-scipy" style=""></span>Scipy<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/sympy/" aria-label="Sympy"><span class="font-icon icon iconfont icon-sympy" style=""></span>Sympy<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">数据可视化</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/antv/" aria-label="Antv"><span class="font-icon icon iconfont icon-antv" style=""></span>Antv<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/echarts/" aria-label="Echarts"><span class="font-icon icon iconfont icon-echarts-footer-logo" style=""></span>Echarts<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/d3js/" aria-label="D3.js"><span class="font-icon icon iconfont icon-d3js" style=""></span>D3.js<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/thingjs/" aria-label="Thingjs"><span class="font-icon icon iconfont icon-thingjs" style=""></span>Thingjs<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/threejs/" aria-label="Threejs"><span class="font-icon icon iconfont icon-threejs" style=""></span>Threejs<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/matplotlib/" aria-label="Matplotlib"><span class="font-icon icon iconfont icon-matplotlib" style=""></span>Matplotlib<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/dashplotly/" aria-label="Dash/Plotly"><span class="font-icon icon iconfont icon-plotly" style=""></span>Dash/Plotly<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/highcharts/" aria-label="HighCharts"><span class="font-icon icon iconfont icon-highcharts" style=""></span>HighCharts<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">机器学习与深度学习</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/tensorflow/" aria-label="Tensorflow"><span class="font-icon icon iconfont icon-tensorflow" style=""></span>Tensorflow<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/pytorch/" aria-label="PyTorch"><span class="font-icon icon iconfont icon-pytorch" style=""></span>PyTorch<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/scikit-learn/" aria-label="Scikit-Learn"><span class="font-icon icon iconfont icon-scikitlearn" style=""></span>Scikit-Learn<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">商务智能报表</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/bi/tableau/" aria-label="Tableau"><span class="font-icon icon iconfont icon-tableau" style=""></span>Tableau<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/bi/powerbi/" aria-label="Power BI"><span class="font-icon icon iconfont icon-powerbi" style=""></span>Power BI<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/bi/finebi/" aria-label="Fine BI"><span class="font-icon icon iconfont icon-finebi" style=""></span>Fine BI<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/bi/pentaho/" aria-label="Pentaho"><span class="font-icon icon iconfont icon-pentaho" style=""></span>Pentaho<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="区块链"><!--[--><span class="font-icon icon iconfont icon-blockchain" style=""></span>区块链<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/blockchain/" aria-label="区块链"><!---->区块链<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/blockchain/coin/" aria-label="加密货币"><!---->加密货币<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Linux"><!--[--><span class="font-icon icon iconfont icon-linux" style=""></span>Linux<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/os/linux/administration/" aria-label="系统管理"><!---->系统管理<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/os/linux/program/" aria-label="内核编程"><!---->内核编程<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="DevOps"><!--[--><span class="font-icon icon iconfont icon-devops" style=""></span>DevOps<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/zabbix/" aria-label="Zabbix"><span class="font-icon icon iconfont icon-zabbix-outline" style=""></span>Zabbix<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/prometheus/" aria-label="Prometheus"><span class="font-icon icon iconfont icon-prometheus" style=""></span>Prometheus<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/openfalcon/" aria-label="Open-Falcon"><span class="font-icon icon iconfont icon-open-falcon" style=""></span>Open-Falcon<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/ansible/" aria-label="Ansible"><span class="font-icon icon iconfont icon-ansible" style=""></span>Ansible<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/terraform/" aria-label="Terraform"><span class="font-icon icon iconfont icon-terraform" style=""></span>Terraform<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/jenkins/" aria-label="Jenkins"><span class="font-icon icon iconfont icon-jenkins" style=""></span>Jenkins<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/nginx/" aria-label="Nginx"><span class="font-icon icon iconfont icon-nginx" style=""></span>Nginx<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/grafana/" aria-label="Grafana"><span class="font-icon icon iconfont icon-grafana" style=""></span>Grafana<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/teleport/" aria-label="Teleport"><span class="font-icon icon iconfont icon-teleport" style=""></span>Teleport<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/jumpserver/" aria-label="JumpServer"><span class="font-icon icon iconfont icon-jumpserver" style=""></span>JumpServer<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/nextcloud/" aria-label="Nextcloud"><span class="font-icon icon iconfont icon-nextcloud" style=""></span>Nextcloud<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="工具集"><!--[--><span class="font-icon icon iconfont icon-tool" style=""></span>工具集<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">常用工具</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/vim/" aria-label="Vim"><span class="font-icon icon iconfont icon-vim" style=""></span>Vim<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/vscode/" aria-label="VSCode"><span class="font-icon icon iconfont icon-vscode" style=""></span>VSCode<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/markdown/" aria-label="Markdown"><span class="font-icon icon iconfont icon-markdown" style=""></span>Markdown<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/tex/" aria-label="Tex"><span class="font-icon icon iconfont icon-tex" style=""></span>Tex<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/gitbook/" aria-label="Gitbook"><span class="font-icon icon iconfont icon-gitbook" style=""></span>Gitbook<!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://v2.vuepress.vuejs.org/" rel="noopener noreferrer" target="_blank" aria-label="VuePress"><span class="font-icon icon iconfont icon-vuepress" style=""></span>VuePress<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/git/" aria-label="Git"><span class="font-icon icon iconfont icon-git" style=""></span>Git<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/github/" aria-label="GitHub"><span class="font-icon icon iconfont icon-github" style=""></span>GitHub<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">文档主题</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="vp-link" href="https://v2.vuepress.vuejs.org/zh/" rel="noopener noreferrer" target="_blank" aria-label="VuePress"><!---->VuePress<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://vuepress-theme-hope.github.io/v2/" rel="noopener noreferrer" target="_blank" aria-label="Vuepres-Theme-Hope"><!---->Vuepres-Theme-Hope<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://vuepress-theme-mix.vercel.app/" rel="noopener noreferrer" target="_blank" aria-label="VuePress Mix Theme"><!---->VuePress Mix Theme<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="http://v2.vuepress-reco.recoluan.com/" rel="noopener noreferrer" target="_blank" aria-label="vuepress-theme-reco"><!---->vuepress-theme-reco<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="项目"><!--[--><span class="font-icon icon iconfont icon-project" style=""></span>项目<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="vp-link" href="https://github.com/abelit/abelit-archlinux.git" rel="noopener noreferrer" target="_blank" aria-label="Archlinux"><!---->Archlinux<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-item"><a class="vp-link" href="https://github.com/abelit/abelit-conky.git" rel="noopener noreferrer" target="_blank" aria-label="Conky"><!---->Conky<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-item"><a class="vp-link" href="https://github.com/abelit/abelit-pwdkeeper.git" rel="noopener noreferrer" target="_blank" aria-label="Password Keeper"><!---->Password Keeper<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul></button></div></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><div class="vp-nav-item"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="选择语言"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link active vp-link" href="/guide/database/oracle/installation/install-oracle19c-on-centos7.html" aria-label="简体中文"><!---->简体中文<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/en/" aria-label="English"><!---->English<!----></a></li></ul></button></div></div><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/abelit/abelit-datapeacock" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">搜索</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/" aria-label="主页"><span class="font-icon icon iconfont icon-home" style=""></span>主页<!----></a></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable active"><span class="font-icon icon iconfont icon-note" style=""></span><a class="route-link active vp-link vp-sidebar-title" href="/guide/" aria-label="文档"><!---->文档<!----></a><!----></p><ul class="vp-sidebar-links"><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/" aria-label="指南"><span class="font-icon icon iconfont icon-creative" style=""></span>指南<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><span class="font-icon icon iconfont icon-database" style=""></span><span class="vp-sidebar-title">Database</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><span class="font-icon icon iconfont icon-oracle" style=""></span><span class="vp-sidebar-title">Oracle</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">性能优化</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/ash.html" aria-label="ASH"><!---->ASH<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/awr.html" aria-label="AWR"><!---->AWR<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/dataguard.html" aria-label="Data Guard"><!---->Data Guard<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/ddl.html" aria-label="DDL创建语句"><!---->DDL创建语句<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/autotask.html" aria-label="Oracle AutoTask"><!---->Oracle AutoTask<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/netservice.html" aria-label="Oracle网络服务"><!---->Oracle网络服务<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Oracle高可用</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/pdb.html" aria-label="PDB"><!---->PDB<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">SQL</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/sqlplus.html" aria-label="sqlplus工具"><!---->sqlplus工具<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/transaction.html" aria-label="事务管理"><!---->事务管理<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/session.html" aria-label="会话"><!---->会话<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">备份与恢复</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/characterset.html" aria-label="字符集"><!---->字符集<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">安装指南</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link active vp-link vp-sidebar-link vp-sidebar-page active" href="/guide/database/oracle/installation/install-oracle19c-on-centos7.html" aria-label="在CentOS/RHEL 7.x上安装Oracle"><!---->在CentOS/RHEL 7.x上安装Oracle<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/installation/install-oracle19c-on-centos9.html" aria-label="在CentOS/RHEL 9.x上安装Oracle"><!---->在CentOS/RHEL 9.x上安装Oracle<!----></a></li></ul></section></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/instance.html" aria-label="实例"><!---->实例<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/archivelog.html" aria-label="归档日志"><!---->归档日志<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/error.html" aria-label="故障与错误"><!---->故障与错误<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/audit.html" aria-label="数据库审计"><!---->数据库审计<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/spaceobject.html" aria-label="数据库对象"><!---->数据库对象<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/user.html" aria-label="用户"><!---->用户<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/scripts.html" aria-label="脚本"><!---->脚本<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">表空间</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/scheduler.html" aria-label="调度器"><!---->调度器<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/trace.html" aria-label="跟踪文件"><!---->跟踪文件<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/flashback.html" aria-label="闪回"><!---->闪回<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-mysql" style=""></span><span class="vp-sidebar-title">MySQL</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-postgresql" style=""></span><span class="vp-sidebar-title">PostgreSQL</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-sqlserver" style=""></span><span class="vp-sidebar-title">SQL Server</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-sqlite" style=""></span><span class="vp-sidebar-title">SQLite</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-mongodb" style=""></span><span class="vp-sidebar-title">Mongo</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-opengauss" style=""></span><span class="vp-sidebar-title">Gausss</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-clickhouse" style=""></span><span class="vp-sidebar-title">ClickHouse</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-redis" style=""></span><span class="vp-sidebar-title">Redis</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-elasticsearch" style=""></span><span class="vp-sidebar-title">ElasticSearch</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-tidb" style=""></span><span class="vp-sidebar-title">TiDB</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-cassandra" style=""></span><span class="vp-sidebar-title">Cassandra</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-couchdb" style=""></span><span class="vp-sidebar-title">CouchDB</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-hbase" style=""></span><span class="vp-sidebar-title">HBase</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-etcd" style=""></span><span class="vp-sidebar-title">etcd</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-apachekylin" style=""></span><span class="vp-sidebar-title">Apache Kylin</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-devops" style=""></span><span class="vp-sidebar-title">DevOps</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-os" style=""></span><span class="vp-sidebar-title">OS</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-cncf" style=""></span><span class="vp-sidebar-title">云原生</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-ai" style=""></span><span class="vp-sidebar-title">人工智能</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-infosec" style=""></span><span class="vp-sidebar-title">信息安全</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-blockchain" style=""></span><span class="vp-sidebar-title">区块链</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-tool" style=""></span><span class="vp-sidebar-title">工具集</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-development" style=""></span><span class="vp-sidebar-title">开发</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-opensource-fill" style=""></span><span class="vp-sidebar-title">开源软件</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-mindmap" style=""></span><span class="vp-sidebar-title">思维导入与学习路径</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-finance-fill" style=""></span><span class="vp-sidebar-title">投资理财</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-datascience" style=""></span><span class="vp-sidebar-title">数据科学</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-algorithm" style=""></span><span class="vp-sidebar-title">数据结构与算法</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-markdown" style=""></span><span class="vp-sidebar-title">文档管理</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-iot" style=""></span><span class="vp-sidebar-title">物联网</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/slides/" aria-label="演示文稿"><span class="font-icon icon iconfont icon-office-pptx" style=""></span>演示文稿<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/demo/" aria-label="案例"><span class="font-icon icon iconfont icon-discover" style=""></span>案例<!----></a></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable"><span class="font-icon icon iconfont icon-workspace" style=""></span><a class="route-link vp-link vp-sidebar-title" href="/workspace/" aria-label="工作空间"><!---->工作空间<!----></a><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-creative" style=""></span><span class="vp-sidebar-title">多彩贵州航空知识分享</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->在CentOS/RHEL 7.x上安装Oracle</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/abelit" target="_blank" rel="noopener noreferrer">Abelit</a></span><span property="author" content="Abelit"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-05-11T14:06:18.000Z"></span><!----><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 59 分钟</span><meta property="timeRequired" content="PT59M"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!--[--><!----><!--]--><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#自动安装脚本">自动安装脚本</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#自启动">自启动</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#设置-etc-oratab">设置/etc/oratab</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#开机启动脚本">开机启动脚本</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#配置run-level实现自启动">配置run-level实现自启动</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#字符集">字符集</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#更改数据库字符集">更改数据库字符集</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#rac-安装常见问题">RAC 安装常见问题</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><h2 id="自动安装脚本" tabindex="-1"><a class="header-anchor" href="#自动安装脚本"><span>自动安装脚本</span></a></h2><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-3-0" aria-selected="false">RAC</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-3-1" aria-selected="false">common</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-3-2" aria-selected="false">modb onkey</button><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-3-3" aria-selected="true">11g</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-3-4" aria-selected="false">12c</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-3-5" aria-selected="false">18c</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-3-6" aria-selected="false">19c</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-3-7" aria-selected="false">21c</button></div><!--[--><div class="vp-code-tab" id="codetab-3-0" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">RAC</div><!--[--><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment">############ Author begin ##################################################</span>
<span class="token comment">## Author: Ableit</span>
<span class="token comment">## Date: 2022-07-20</span>
<span class="token comment">## Desc: Install Oracle Database</span>
<span class="token comment">## Env: RHEL/CentOS 7.x, Oracle Database RAC 11g +</span>
<span class="token comment">############ Author end ####################################################</span>

<span class="token comment">############ Env &amp; Virables begin ##########################################</span>
<span class="token comment">####### begin custom settings #######</span>
<span class="token comment"># package -------------</span>
<span class="token assign-left variable">V_RAC_PACKAGE_DIR</span><span class="token operator">=</span>/opt/package
<span class="token assign-left variable">V_RAC_OS_DBA_DIR</span><span class="token operator">=</span>/opt/dba

<span class="token comment"># os ---------------</span>
<span class="token assign-left variable">V_RAC_OS_ORACLE_USER_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;TestPwd2023Com&quot;</span>
<span class="token assign-left variable">V_RAC_OS_GRID_USER_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;TestPwd2023Com&quot;</span>
<span class="token assign-left variable">V_RAC_OS_HOSTNAME</span><span class="token operator">=</span><span class="token string">&quot;testdb1 testdb2&quot;</span>
<span class="token assign-left variable">V_RAC_OS_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;root@123 root@123&quot;</span>
<span class="token assign-left variable">V_RAC_OS_PUBLIC_NETWORKINTERFACE</span><span class="token operator">=</span><span class="token string">&quot;eth0 eth0&quot;</span>
<span class="token assign-left variable">V_RAC_OS_PRIVATE_NETWORKINTERFACE</span><span class="token operator">=</span><span class="token string">&quot;eth1 eth1&quot;</span>
<span class="token assign-left variable">V_RAC_OS_PUBLIC_SUBNET</span><span class="token operator">=</span><span class="token string">&quot;10.10.12.0&quot;</span>
<span class="token assign-left variable">V_RAC_OS_PRIVATE_SUBNET</span><span class="token operator">=</span><span class="token string">&quot;10.10.100.0&quot;</span>
<span class="token assign-left variable">V_RAC_OS_PUBLIC_IP</span><span class="token operator">=</span><span class="token string">&quot;10.10.12.212 10.10.12.213&quot;</span>
<span class="token assign-left variable">V_RAC_OS_PUBLIC_VIP</span><span class="token operator">=</span><span class="token string">&quot;10.10.12.222 10.10.12.223&quot;</span>
<span class="token assign-left variable">V_RAC_OS_PRIVATE_IP</span><span class="token operator">=</span><span class="token string">&quot;10.10.100.212 10.10.100.213&quot;</span>
<span class="token assign-left variable">V_RAC_OS_SCAN_IP</span><span class="token operator">=</span><span class="token string">&quot;10.10.12.200&quot;</span>

<span class="token comment"># oracle ------------</span>
<span class="token assign-left variable">V_RAC_ORACLE_DATABASE_VERSION</span><span class="token operator">=</span><span class="token number">21.3</span>.0.0
<span class="token assign-left variable">V_RAC_ORACLE_UNQNAME</span><span class="token operator">=</span>testdb
<span class="token assign-left variable">V_RAC_ORACLE_PDB_NAME</span><span class="token operator">=</span>abelitpdb
<span class="token assign-left variable">V_RAC_ORACLE_CHARSET</span><span class="token operator">=</span>AL32UTF8
<span class="token assign-left variable">V_RAC_ORACLE_SYS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;TestPwd2023Com&quot;</span>
<span class="token assign-left variable">V_RAC_ORACLE_SYSTEM_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;TestPwd2023Com&quot;</span>
<span class="token assign-left variable">V_RAC_ORACLE_PDB_ADMIN_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;TestPwd2023Com&quot;</span>
<span class="token assign-left variable">V_RAC_ORACLE_APP_ROOTDIR</span><span class="token operator">=</span>/u01

<span class="token comment"># grid --------------</span>
<span class="token assign-left variable">V_RAC_GRID_ORACLE_DATABASE_VERSION</span><span class="token operator">=</span><span class="token number">21.3</span>.0.0
<span class="token assign-left variable">V_RAC_GRID_APP_ROOTDIR</span><span class="token operator">=</span>/u01

<span class="token comment"># cluster --------------</span>
<span class="token assign-left variable">V_RAC_INSTANCE_ORACLE_SID</span><span class="token operator">=</span><span class="token string">&quot;testdb1 testdb2&quot;</span>
<span class="token assign-left variable">V_RAC_INSTANCE_GRID_ORACLE_SID</span><span class="token operator">=</span><span class="token string">&quot;+ASM1 +ASM2&quot;</span>
<span class="token assign-left variable">V_RAC_ASM_SYSASM_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;TestPwd2023Com&quot;</span>
<span class="token assign-left variable">V_RAC_ASM_MONITOR_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;TestPwd2023Com&quot;</span>
<span class="token assign-left variable">V_RAC_ORACLE_MONITOR_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;TestPwd2023Com&quot;</span>
<span class="token assign-left variable">V_RAC_ASM_DATA_DISKS</span><span class="token operator">=</span><span class="token string">&quot;/dev/sdd&quot;</span>
<span class="token assign-left variable">V_RAC_ASM_FRA_DISKS</span><span class="token operator">=</span><span class="token string">&quot;/dev/sde&quot;</span>
<span class="token assign-left variable">V_RAC_ASM_OCR_DISKS</span><span class="token operator">=</span><span class="token string">&quot;/dev/sdc /dev/sdf /dev/sdg&quot;</span>
<span class="token comment">####### end custom settings #######</span>

<span class="token comment">####### begin auto &amp; advanced settings #######</span>
<span class="token comment"># os ------------</span>
<span class="token assign-left variable">V_RAC_OS_MEMORY</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">free</span> <span class="token parameter variable">-b</span> <span class="token operator">|</span> <span class="token function">grep</span> Mem: <span class="token operator">|</span> <span class="token function">awk</span> -F<span class="token string">&#39; &#39;</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">)</span></span>
<span class="token assign-left variable">V_RAC_OS_SHMMAX</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$V_RAC_OS_MEMORY <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token variable">))</span></span>
<span class="token assign-left variable">V_RAC_OS_SHMALL</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$V_RAC_OS_SHMMAX <span class="token operator">/</span> <span class="token number">1024</span><span class="token variable">))</span></span>
<span class="token assign-left variable">V_RAC_OS_VERSION_ID</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /etc/os-release <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&#39;^VERSION_ID=&#39;</span> <span class="token operator">|</span> <span class="token function">awk</span> -F<span class="token string">&#39;=&#39;</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">)</span></span>

<span class="token assign-left variable">V_RAC_OS_ORACLE_USER</span><span class="token operator">=</span><span class="token string">&quot;oracle&quot;</span>
<span class="token assign-left variable">V_RAC_OS_GRID_USER</span><span class="token operator">=</span><span class="token string">&quot;grid&quot;</span>

<span class="token comment"># oracle ---------------</span>
<span class="token assign-left variable">V_RAC_TMP</span><span class="token operator">=</span>/tmp
<span class="token assign-left variable">V_RAC_ORACLE_BASE</span><span class="token operator">=</span><span class="token variable">$V_RAC_ORACLE_APP_ROOTDIR</span>/app/oracle
<span class="token assign-left variable">V_RAC_ORACLE_HOME</span><span class="token operator">=</span><span class="token variable">$V_RAC_ORACLE_BASE</span>/product/<span class="token variable">$V_RAC_ORACLE_DATABASE_VERSION</span>/db_1
<span class="token assign-left variable">V_RAC_ORACLE_ORA_INVENTORY</span><span class="token operator">=</span><span class="token variable">$V_RAC_ORACLE_APP_ROOTDIR</span>/app/oraInventory
<span class="token assign-left variable">V_RAC_ORACLE_PRIMARY_VERSION</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $V_RAC_ORACLE_DATABASE_VERSION <span class="token operator">|</span> <span class="token function">awk</span> -F<span class="token string">&#39;.&#39;</span> <span class="token string">&#39;{print $1}&#39;</span><span class="token variable">)</span></span>
<span class="token assign-left variable">V_RAC_ORACLE_TOTAL_MEMORY</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$V_RAC_OS_SHMMAX <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token variable">))</span></span>
<span class="token assign-left variable">V_RAC_ORACLE_DATA_DIR</span><span class="token operator">=</span>DATA
<span class="token assign-left variable">V_RAC_ORACLE_RECOVERY_AREA_DIR</span><span class="token operator">=</span>FRA
<span class="token assign-left variable">V_RAC_ORACLE_ARCH_DIR</span><span class="token operator">=</span>ARCH
<span class="token comment"># 64M</span>
<span class="token assign-left variable">V_RAC_ORACLE_REDOLOG_SIZE</span><span class="token operator">=</span><span class="token number">64</span>
<span class="token comment"># 64M*1024=64G</span>
<span class="token assign-left variable">V_RAC_ORACLE_RECOVERY_AREA_SIZE</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span><span class="token number">64</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token variable">))</span></span>

<span class="token comment"># grid --------------</span>
<span class="token assign-left variable">V_RAC_GRID_ORACLE_BASE</span><span class="token operator">=</span><span class="token variable">$V_RAC_GRID_APP_ROOTDIR</span>/app/grid
<span class="token assign-left variable">V_RAC_GRID_ORACLE_HOME</span><span class="token operator">=</span><span class="token variable">$V_RAC_GRID_APP_ROOTDIR</span>/app/<span class="token variable">$V_RAC_GRID_ORACLE_DATABASE_VERSION</span>/grid
<span class="token assign-left variable">V_RAC_GRID_ORACLE_PRIMARY_VERSION</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $V_RAC_GRID_ORACLE_DATABASE_VERSION <span class="token operator">|</span> <span class="token function">awk</span> -F<span class="token string">&#39;.&#39;</span> <span class="token string">&#39;{print $1}&#39;</span><span class="token variable">)</span></span>

<span class="token comment"># cluster -----------</span>
<span class="token assign-left variable">V_RAC_CRS_SCANPORT</span><span class="token operator">=</span><span class="token number">1521</span>
<span class="token assign-left variable">V_RAC_CRS_OCRVOTING_REDUNDANCY</span><span class="token operator">=</span>NORMAL
<span class="token assign-left variable">V_RAC_CRS_CLUSTER_NAME</span><span class="token operator">=</span><span class="token variable">${V_RAC_ORACLE_UNQNAME}</span>-cluster
<span class="token assign-left variable">V_RAC_CRS_SCANNAME</span><span class="token operator">=</span><span class="token variable">${V_RAC_ORACLE_UNQNAME}</span>-scan
<span class="token assign-left variable">V_RAC_ASM_DATA_DISKGROUP_NAME</span><span class="token operator">=</span>DATA
<span class="token assign-left variable">V_RAC_ASM_DATA_REDUNDANCY</span><span class="token operator">=</span>EXTERNAL
<span class="token assign-left variable">V_RAC_ASM_DATA_ASMDISK_PREFFIX</span><span class="token operator">=</span><span class="token string">&quot;ASM_DISK_DATA&quot;</span>
<span class="token assign-left variable">V_RAC_ASM_FRA_DISKGROUP_NAME</span><span class="token operator">=</span>FRA
<span class="token assign-left variable">V_RAC_ASM_FRA_REDUNDANCY</span><span class="token operator">=</span>EXTERNAL
<span class="token assign-left variable">V_RAC_ASM_FRA_ASMDISK_PREFFIX</span><span class="token operator">=</span><span class="token string">&quot;ASM_DISK_FRA&quot;</span>
<span class="token assign-left variable">V_RAC_ASM_DISKGROUP_NAME</span><span class="token operator">=</span>OCR
<span class="token assign-left variable">V_RAC_ASM_DISKGROUP_REDUNDANCY</span><span class="token operator">=</span>NORMAL
<span class="token assign-left variable">V_RAC_ASM_OCR_ASMDISK_PREFFIX</span><span class="token operator">=</span><span class="token string">&quot;ASM_DISK_OCR&quot;</span>

<span class="token comment"># V_RAC_CRS_CLUSTERNODES=testdb1:testdb1-vip,testdb2:testdb2-vip</span>
<span class="token comment"># eg. testdb1:testdb1-vip,testdb2:testdb2-vip</span>
<span class="token assign-left variable">V_RAC_CRS_CLUSTERNODES</span><span class="token operator">=</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">11</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_OS_HOSTNAME</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$V_RAC_CRS_CLUSTERNODES</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
            <span class="token assign-left variable">V_RAC_CRS_CLUSTERNODES</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_CRS_CLUSTERNODES</span>,<span class="token variable">$item</span>:<span class="token variable">$item</span>-vip&quot;</span>
        <span class="token keyword">else</span>
            <span class="token assign-left variable">V_RAC_CRS_CLUSTERNODES</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$item</span>:<span class="token variable">$item</span>-vip&quot;</span>
        <span class="token keyword">fi</span>
    <span class="token keyword">done</span>
    <span class="token assign-left variable">V_RAC_OS_PUBLIC_NETWORKINTERFACE_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PUBLIC_NETWORKINTERFACE</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_PRIVATE_NETWORKINTERFACE_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PRIVATE_NETWORKINTERFACE</span><span class="token punctuation">)</span>
    <span class="token comment"># V_RAC_CRS_NETWORKINTERFACES=eth0:10.10.12.0:1,eth1:10.10.100.0:2</span>
    <span class="token comment"># eg. eth0:10.10.12.0:1,eth1:10.10.100.0:2</span>
    <span class="token assign-left variable">V_RAC_CRS_NETWORKINTERFACES</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${V_RAC_OS_PUBLIC_NETWORKINTERFACE_ARR<span class="token punctuation">[</span>0<span class="token punctuation">]</span>}</span>:<span class="token variable">$V_RAC_OS_PUBLIC_SUBNET</span>:1,<span class="token variable">${V_RAC_OS_PRIVATE_NETWORKINTERFACE_ARR<span class="token punctuation">[</span>0<span class="token punctuation">]</span>}</span>:<span class="token variable">$V_RAC_OS_PRIVATE_SUBNET</span>:2&quot;</span>
    <span class="token comment"># V_RAC_INSTANCE_CLUSTER_NODES=testdb1,testdb2</span>
    <span class="token comment"># eg. testdb1,testdb2</span>
    <span class="token assign-left variable">V_RAC_INSTANCE_CLUSTER_NODES</span><span class="token operator">=</span><span class="token variable">${V_RAC_INSTANCE_ORACLE_SID<span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">/</span><span class="token operator">,</span>}</span>

<span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">12</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_OS_HOSTNAME</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$V_RAC_CRS_CLUSTERNODES</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
            <span class="token assign-left variable">V_RAC_CRS_CLUSTERNODES</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_CRS_CLUSTERNODES</span>,<span class="token variable">$item</span>:<span class="token variable">$item</span>-vip:HUB&quot;</span>
        <span class="token keyword">else</span>
            <span class="token assign-left variable">V_RAC_CRS_CLUSTERNODES</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$item</span>:<span class="token variable">$item</span>-vip:HUB&quot;</span>
        <span class="token keyword">fi</span>
    <span class="token keyword">done</span>

    <span class="token assign-left variable">V_RAC_OS_PUBLIC_NETWORKINTERFACE_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PUBLIC_NETWORKINTERFACE</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_PRIVATE_NETWORKINTERFACE_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PRIVATE_NETWORKINTERFACE</span><span class="token punctuation">)</span>
    <span class="token comment"># V_RAC_CRS_NETWORKINTERFACES=eth0:10.10.12.0:1,eth1:10.10.100.0:2</span>
    <span class="token comment"># eg. eth0:10.10.12.0:1,eth1:10.10.100.0:2</span>
    <span class="token assign-left variable">V_RAC_CRS_NETWORKINTERFACES</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${V_RAC_OS_PUBLIC_NETWORKINTERFACE_ARR<span class="token punctuation">[</span>0<span class="token punctuation">]</span>}</span>:<span class="token variable">$V_RAC_OS_PUBLIC_SUBNET</span>:1,<span class="token variable">${V_RAC_OS_PRIVATE_NETWORKINTERFACE_ARR<span class="token punctuation">[</span>0<span class="token punctuation">]</span>}</span>:<span class="token variable">$V_RAC_OS_PRIVATE_SUBNET</span>:5&quot;</span>
    <span class="token comment"># V_RAC_INSTANCE_CLUSTER_NODES=testdb1,testdb2</span>
    <span class="token comment"># eg. testdb1,testdb2</span>
    <span class="token assign-left variable">V_RAC_INSTANCE_CLUSTER_NODES</span><span class="token operator">=</span><span class="token variable">${V_RAC_INSTANCE_ORACLE_SID<span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">/</span><span class="token operator">,</span>}</span>

<span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">18</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_OS_HOSTNAME</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$V_RAC_CRS_CLUSTERNODES</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
            <span class="token assign-left variable">V_RAC_CRS_CLUSTERNODES</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_CRS_CLUSTERNODES</span>,<span class="token variable">$item</span>:<span class="token variable">$item</span>-vip:HUB&quot;</span>
        <span class="token keyword">else</span>
            <span class="token assign-left variable">V_RAC_CRS_CLUSTERNODES</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$item</span>:<span class="token variable">$item</span>-vip:HUB&quot;</span>
        <span class="token keyword">fi</span>
    <span class="token keyword">done</span>

    <span class="token assign-left variable">V_RAC_OS_PUBLIC_NETWORKINTERFACE_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PUBLIC_NETWORKINTERFACE</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_PRIVATE_NETWORKINTERFACE_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PRIVATE_NETWORKINTERFACE</span><span class="token punctuation">)</span>
    <span class="token comment"># V_RAC_CRS_NETWORKINTERFACES=eth0:10.10.12.0:1,eth1:10.10.100.0:2</span>
    <span class="token comment"># eg. eth0:10.10.12.0:1,eth1:10.10.100.0:2</span>
    <span class="token assign-left variable">V_RAC_CRS_NETWORKINTERFACES</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${V_RAC_OS_PUBLIC_NETWORKINTERFACE_ARR<span class="token punctuation">[</span>0<span class="token punctuation">]</span>}</span>:<span class="token variable">$V_RAC_OS_PUBLIC_SUBNET</span>:1,<span class="token variable">${V_RAC_OS_PRIVATE_NETWORKINTERFACE_ARR<span class="token punctuation">[</span>0<span class="token punctuation">]</span>}</span>:<span class="token variable">$V_RAC_OS_PRIVATE_SUBNET</span>:5&quot;</span>
    <span class="token comment"># V_RAC_INSTANCE_CLUSTER_NODES=testdb1,testdb2</span>
    <span class="token comment"># eg. testdb1,testdb2</span>
    <span class="token assign-left variable">V_RAC_INSTANCE_CLUSTER_NODES</span><span class="token operator">=</span><span class="token variable">${V_RAC_INSTANCE_ORACLE_SID<span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">/</span><span class="token operator">,</span>}</span>

<span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">19</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_OS_HOSTNAME</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$V_RAC_CRS_CLUSTERNODES</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
            <span class="token assign-left variable">V_RAC_CRS_CLUSTERNODES</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_CRS_CLUSTERNODES</span>,<span class="token variable">$item</span>:<span class="token variable">$item</span>-vip:HUB&quot;</span>
        <span class="token keyword">else</span>
            <span class="token assign-left variable">V_RAC_CRS_CLUSTERNODES</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$item</span>:<span class="token variable">$item</span>-vip:HUB&quot;</span>
        <span class="token keyword">fi</span>
    <span class="token keyword">done</span>

    <span class="token assign-left variable">V_RAC_OS_PUBLIC_NETWORKINTERFACE_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PUBLIC_NETWORKINTERFACE</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_PRIVATE_NETWORKINTERFACE_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PRIVATE_NETWORKINTERFACE</span><span class="token punctuation">)</span>
    <span class="token comment"># V_RAC_CRS_NETWORKINTERFACES=eth0:10.10.12.0:1,eth1:10.10.100.0:2</span>
    <span class="token comment"># eg. eth0:10.10.12.0:1,eth1:10.10.100.0:2</span>
    <span class="token assign-left variable">V_RAC_CRS_NETWORKINTERFACES</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${V_RAC_OS_PUBLIC_NETWORKINTERFACE_ARR<span class="token punctuation">[</span>0<span class="token punctuation">]</span>}</span>:<span class="token variable">$V_RAC_OS_PUBLIC_SUBNET</span>:1,<span class="token variable">${V_RAC_OS_PRIVATE_NETWORKINTERFACE_ARR<span class="token punctuation">[</span>0<span class="token punctuation">]</span>}</span>:<span class="token variable">$V_RAC_OS_PRIVATE_SUBNET</span>:5&quot;</span>
    <span class="token comment"># V_RAC_INSTANCE_CLUSTER_NODES=testdb1,testdb2</span>
    <span class="token comment"># eg. testdb1,testdb2</span>
    <span class="token assign-left variable">V_RAC_INSTANCE_CLUSTER_NODES</span><span class="token operator">=</span><span class="token variable">${V_RAC_INSTANCE_ORACLE_SID<span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">/</span><span class="token operator">,</span>}</span>

<span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">21</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_OS_HOSTNAME</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$V_RAC_CRS_CLUSTERNODES</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
            <span class="token assign-left variable">V_RAC_CRS_CLUSTERNODES</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_CRS_CLUSTERNODES</span>,<span class="token variable">$item</span>:<span class="token variable">$item</span>-vip:HUB&quot;</span>
        <span class="token keyword">else</span>
            <span class="token assign-left variable">V_RAC_CRS_CLUSTERNODES</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$item</span>:<span class="token variable">$item</span>-vip:HUB&quot;</span>
        <span class="token keyword">fi</span>
    <span class="token keyword">done</span>
    <span class="token assign-left variable">V_RAC_OS_PUBLIC_NETWORKINTERFACE_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PUBLIC_NETWORKINTERFACE</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_PRIVATE_NETWORKINTERFACE_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PRIVATE_NETWORKINTERFACE</span><span class="token punctuation">)</span>
    <span class="token comment"># V_RAC_CRS_NETWORKINTERFACES=eth0:10.10.12.0:1,eth1:10.10.100.0:2</span>
    <span class="token comment"># eg. eth0:10.10.12.0:1,eth1:10.10.100.0:2</span>
    <span class="token assign-left variable">V_RAC_CRS_NETWORKINTERFACES</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${V_RAC_OS_PUBLIC_NETWORKINTERFACE_ARR<span class="token punctuation">[</span>0<span class="token punctuation">]</span>}</span>:<span class="token variable">$V_RAC_OS_PUBLIC_SUBNET</span>:1,<span class="token variable">${V_RAC_OS_PRIVATE_NETWORKINTERFACE_ARR<span class="token punctuation">[</span>0<span class="token punctuation">]</span>}</span>:<span class="token variable">$V_RAC_OS_PRIVATE_SUBNET</span>:5&quot;</span>
    <span class="token comment"># V_RAC_INSTANCE_CLUSTER_NODES=testdb1,testdb2</span>
    <span class="token comment"># eg. testdb1,testdb2</span>
    <span class="token assign-left variable">V_RAC_INSTANCE_CLUSTER_NODES</span><span class="token operator">=</span><span class="token variable">${V_RAC_INSTANCE_ORACLE_SID<span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">/</span><span class="token operator">,</span>}</span>

<span class="token keyword">else</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;not supported version!&quot;</span>
    <span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span>

<span class="token comment"># V_RAC_ABELIT_ASM_TYPE=asmlib</span>
<span class="token comment"># options: asmlib,asmmultipath,asmudev,asmnfs</span>
<span class="token assign-left variable">V_RAC_ABELIT_ASM_TYPE</span><span class="token operator">=</span>
<span class="token comment"># V_RAC_ASM_DISKGROUP_DISKS=/dev/oracleasm/disks/ASM_DISK_OCR1,/dev/oracleasm/disks/ASM_DISK_OCR2,/dev/oracleasm/disks/ASM_DISK_OCR3</span>
<span class="token comment"># asmlib: /dev/oracleasm/disks/ASM_DISK_OCR1,/dev/oracleasm/disks/ASM_DISK_OCR2,/dev/oracleasm/disks/ASM_DISK_OCR3</span>
<span class="token comment"># asmmultipath: /dev/mapper/ASM_DISK_OCR1,/dev/mapper/ASM_DISK_OCR2,/dev/mapper/ASM_DISK_OCR3</span>
<span class="token comment"># asmudev: /dev/ASM_DISK_OCR1,/dev/ASM_DISK_OCR2,/dev/ASM_DISK_OCR3</span>
<span class="token comment"># asmnfs: /data/oracleasm/ASM_DISK_OCR1,/data/oracleasm/ASM_DISK_OCR2,/data/oracleasm/ASM_DISK_OCR3</span>
<span class="token assign-left variable">V_RAC_ASM_DISKGROUP_DISKS</span><span class="token operator">=</span>
<span class="token comment"># V_RAC_ASM_DISKGROUP_DISKDISCOVERY=/dev/oracleasm/disks/ASM_DISK_*</span>
<span class="token comment"># asmlib: /dev/oracleasm/disks/ASM_DISK_*</span>
<span class="token comment"># asmmultipath: /dev/mapper/ASM_DISK_*</span>
<span class="token comment"># asmudev: /dev/ASM_DISK_*</span>
<span class="token comment"># asmnfs: /data/oracleasm/ASM_DISK_*</span>
<span class="token assign-left variable">V_RAC_ASM_DISKGROUP_DISKDISCOVERY</span><span class="token operator">=</span>
<span class="token assign-left variable">V_RAC_ASM_DATA_ASMDISKS</span><span class="token operator">=</span>
<span class="token assign-left variable">V_RAC_ASM_FRA_ASMDISKS</span><span class="token operator">=</span>
<span class="token assign-left variable">V_RAC_ASM_OCR_ASMDISKS</span><span class="token operator">=</span>

<span class="token comment"># package --------------</span>
<span class="token assign-left variable">V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span><span class="token operator">=</span>
<span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_FILES</span><span class="token operator">=</span>
<span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_INSTALLER</span><span class="token operator">=</span>
<span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_TARGET</span><span class="token operator">=</span>
<span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_RESPONSE_FILE</span><span class="token operator">=</span>
<span class="token assign-left variable">V_RAC_PACKAGE_GRID_FILES</span><span class="token operator">=</span>
<span class="token assign-left variable">V_RAC_PACKAGE_GRID_INSTALLER</span><span class="token operator">=</span>
<span class="token assign-left variable">V_RAC_PACKAGE_GRID_TARGET</span><span class="token operator">=</span>
<span class="token assign-left variable">V_RAC_PACKAGE_GRID_RESPONSE_FILE</span><span class="token operator">=</span>
<span class="token assign-left variable">V_RAC_PACKAGE_DBCA_RESPONSE_FILE</span><span class="token operator">=</span>
<span class="token assign-left variable">V_RAC_PACKAGE_NETCA_RESPONSE_FILE</span><span class="token operator">=</span>
<span class="token comment">####### end auto&amp;advanced settings #######</span>
<span class="token comment">############ Env &amp; Virables end ############################################</span>
<span class="token keyword">function</span> <span class="token function-name function">ASMOptionsHelp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
Usage: <span class="token variable">$0</span> [option]
    options:
       -h | --help, help message.
       --asmtype [asmlib|asmudev|asmmultipath|asmnfs], specify asm storage type, description:
            asmlib: oracle asmlib.
            asmmultipath: multipath.
            asmnfs: nfs.
            asmudev: udev
EOF</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">ASMOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable">${<span class="token operator">#</span>}</span> <span class="token parameter variable">-gt</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token assign-left variable">error_message</span><span class="token operator">=</span><span class="token string">&quot;Error: a value is needed for &#39;<span class="token variable">$1</span>&#39;&quot;</span>
        <span class="token keyword">case</span> <span class="token variable">$1</span> <span class="token keyword">in</span>
        --asmtype<span class="token punctuation">)</span>
            <span class="token assign-left variable">V_RAC_ABELIT_ASM_TYPE</span><span class="token operator">=</span><span class="token variable">${2<span class="token operator">:?</span>$error_message}</span>
            <span class="token builtin class-name">shift</span> <span class="token number">2</span>
            <span class="token builtin class-name">break</span>
            <span class="token punctuation">;</span><span class="token punctuation">;</span>
        <span class="token parameter variable">-h</span> <span class="token operator">|</span> --help<span class="token punctuation">)</span>
            ASMOptionsHelp
            <span class="token builtin class-name">shift</span> <span class="token number">2</span>
            <span class="token builtin class-name">break</span>
            <span class="token punctuation">;</span><span class="token punctuation">;</span>
        *<span class="token punctuation">)</span>
            <span class="token builtin class-name">echo</span> <span class="token string">&quot;unknown option <span class="token variable">$1</span>&quot;</span>
            <span class="token builtin class-name">break</span>
            <span class="token punctuation">;</span><span class="token punctuation">;</span>
        <span class="token keyword">esac</span>
    <span class="token keyword">done</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">PreConfigurePackage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment"># package</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Preparing configuring database related packages ...&quot;</span>
    <span class="token assign-left variable">V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_DIR</span>

    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">11</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_FILES</span><span class="token operator">=</span><span class="token string">&quot;p13390677_112040_Linux-x86-64_1of7.zip p13390677_112040_Linux-x86-64_2of7.zip&quot;</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_FILES</span><span class="token operator">=</span><span class="token string">&quot;p13390677_112040_Linux-x86-64_3of7.zip&quot;</span>

        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_INSTALLER</span><span class="token operator">=</span><span class="token variable">${V_RAC_PACKAGE_DIR}</span>/grid
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_TARGET</span><span class="token operator">=</span><span class="token variable">${V_RAC_PACKAGE_DIR}</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_INSTALLER_EXE</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_PACKAGE_GRID_INSTALLER</span>/runInstaller -silent -showProgress -ignorePrereq -waitforcompletion&quot;</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_GRID_INSTALLER</span>/response/grid_install.rsp
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_INSTALLER_CONFIG</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_GRID_ORACLE_HOME</span>/cfgtoollogs/configToolAllCommands RESPONSE_FILE=<span class="token variable">$V_RAC_OS_DBA_DIR</span>/grid_install-<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +<span class="token string">&#39;%Y%m%d&#39;</span><span class="token variable">)</span></span>.rsp&quot;</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_INSTALLER_RPM</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_GRID_INSTALLER</span>/rpm

        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_INSTALLER</span><span class="token operator">=</span><span class="token variable">${V_RAC_PACKAGE_DIR}</span>/database
        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_TARGET</span><span class="token operator">=</span><span class="token variable">${V_RAC_PACKAGE_DIR}</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_INSTALLER_EXE</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER</span>/runInstaller  -silent -showProgress -ignorePrereq -waitforcompletion&quot;</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER</span>/response/db_install.rsp

        <span class="token assign-left variable">V_RAC_PACKAGE_DBCA_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER</span>/response/dbca.rsp
        <span class="token assign-left variable">V_RAC_PACKAGE_NETCA_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER</span>/response/netca.rsp
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">12</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_FILES</span><span class="token operator">=</span><span class="token string">&quot;linuxx64_12201_database.zip&quot;</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_FILES</span><span class="token operator">=</span><span class="token string">&quot;linuxx64_12201_grid_home.zip&quot;</span>

        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_INSTALLER</span><span class="token operator">=</span><span class="token variable">${V_RAC_GRID_ORACLE_HOME}</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_TARGET</span><span class="token operator">=</span><span class="token variable">${V_RAC_GRID_ORACLE_HOME}</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_INSTALLER_EXE</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_PACKAGE_GRID_INSTALLER</span>/gridSetup.sh -silent -ignorePrereqFailure -waitforcompletion&quot;</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_GRID_INSTALLER</span>/install/response/gridsetup.rsp
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_INSTALLER_CONFIG</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_GRID_ORACLE_HOME</span>/gridSetup.sh -silent -executeConfigTools -responseFile <span class="token variable">$V_RAC_OS_DBA_DIR</span>/grid_install-<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +<span class="token string">&#39;%Y%m%d&#39;</span><span class="token variable">)</span></span>.rsp&quot;</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_INSTALLER_RPM</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_GRID_INSTALLER</span>/cv/rpm

        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_INSTALLER</span><span class="token operator">=</span><span class="token variable">${V_RAC_PACKAGE_DIR}</span>/database
        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_TARGET</span><span class="token operator">=</span><span class="token variable">${V_RAC_PACKAGE_DIR}</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_INSTALLER_EXE</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER</span>/runInstaller  -silent -showProgress -ignorePrereq -waitforcompletion&quot;</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER</span>/response/db_install.rsp

        <span class="token assign-left variable">V_RAC_PACKAGE_DBCA_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER</span>/response/dbca.rsp
        <span class="token assign-left variable">V_RAC_PACKAGE_NETCA_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER</span>/response/netca.rsp

    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">18</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_FILES</span><span class="token operator">=</span><span class="token string">&quot;LINUX.X64_180000_db_home.zip&quot;</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_FILES</span><span class="token operator">=</span><span class="token string">&quot;LINUX.X64_180000_grid_home.zip&quot;</span>

        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_INSTALLER</span><span class="token operator">=</span><span class="token variable">${V_RAC_GRID_ORACLE_HOME}</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_TARGET</span><span class="token operator">=</span><span class="token variable">${V_RAC_GRID_ORACLE_HOME}</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_INSTALLER_EXE</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_PACKAGE_GRID_INSTALLER</span>/gridSetup.sh -silent -ignorePrereqFailure -waitforcompletion&quot;</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_GRID_INSTALLER</span>/install/response/gridsetup.rsp
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_INSTALLER_CONFIG</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_GRID_ORACLE_HOME</span>/gridSetup.sh -silent -executeConfigTools -responseFile <span class="token variable">$V_RAC_OS_DBA_DIR</span>/grid_install-<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +<span class="token string">&#39;%Y%m%d&#39;</span><span class="token variable">)</span></span>.rsp&quot;</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_INSTALLER_RPM</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_GRID_INSTALLER</span>/cv/rpm

        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_INSTALLER</span><span class="token operator">=</span><span class="token variable">${V_RAC_ORACLE_HOME}</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_TARGET</span><span class="token operator">=</span><span class="token variable">${V_RAC_ORACLE_HOME}</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_INSTALLER_EXE</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER</span>/runInstaller  -silent -ignorePrereq -waitforcompletion&quot;</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER</span>/response/db_install.rsp

        <span class="token assign-left variable">V_RAC_PACKAGE_DBCA_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER</span>/assistants/dbca/dbca.rsp
        <span class="token assign-left variable">V_RAC_PACKAGE_NETCA_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER</span>/assistants/netca/netca.rsp

    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">19</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_FILES</span><span class="token operator">=</span><span class="token string">&quot;LINUX.X64_193000_db_home.zip&quot;</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_FILES</span><span class="token operator">=</span><span class="token string">&quot;LINUX.X64_193000_grid_home.zip&quot;</span>

        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_INSTALLER</span><span class="token operator">=</span><span class="token variable">${V_RAC_GRID_ORACLE_HOME}</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_TARGET</span><span class="token operator">=</span><span class="token variable">${V_RAC_GRID_ORACLE_HOME}</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_INSTALLER_EXE</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_PACKAGE_GRID_INSTALLER</span>/gridSetup.sh -silent -ignorePrereqFailure -waitforcompletion&quot;</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_GRID_INSTALLER</span>/install/response/gridsetup.rsp
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_INSTALLER_CONFIG</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_GRID_ORACLE_HOME</span>/gridSetup.sh -silent -executeConfigTools -responseFile <span class="token variable">$V_RAC_OS_DBA_DIR</span>/grid_install-<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +<span class="token string">&#39;%Y%m%d&#39;</span><span class="token variable">)</span></span>.rsp&quot;</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_INSTALLER_RPM</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_GRID_INSTALLER</span>/cv/rpm

        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_INSTALLER</span><span class="token operator">=</span><span class="token variable">${V_RAC_ORACLE_HOME}</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_TARGET</span><span class="token operator">=</span><span class="token variable">${V_RAC_ORACLE_HOME}</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_INSTALLER_EXE</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER</span>/runInstaller  -silent -ignorePrereq -waitforcompletion&quot;</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER</span>/response/db_install.rsp

        <span class="token assign-left variable">V_RAC_PACKAGE_DBCA_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER</span>/assistants/dbca/dbca.rsp
        <span class="token assign-left variable">V_RAC_PACKAGE_NETCA_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER</span>/assistants/netca/netca.rsp
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">21</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_FILES</span><span class="token operator">=</span><span class="token string">&quot;LINUX.X64_213000_db_home.zip&quot;</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_FILES</span><span class="token operator">=</span><span class="token string">&quot;LINUX.X64_213000_grid_home.zip&quot;</span>

        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_INSTALLER</span><span class="token operator">=</span><span class="token variable">${V_RAC_GRID_ORACLE_HOME}</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_TARGET</span><span class="token operator">=</span><span class="token variable">${V_RAC_GRID_ORACLE_HOME}</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_INSTALLER_EXE</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_PACKAGE_GRID_INSTALLER</span>/gridSetup.sh -silent -ignorePrereqFailure -waitforcompletion&quot;</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_GRID_INSTALLER</span>/install/response/gridsetup.rsp
        <span class="token assign-left variable">V_RAC_PACKAGE_GRID_INSTALLER_RPM</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_GRID_INSTALLER</span>/cv/rpm

        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_INSTALLER</span><span class="token operator">=</span><span class="token variable">${V_RAC_ORACLE_HOME}</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_TARGET</span><span class="token operator">=</span><span class="token variable">${V_RAC_ORACLE_HOME}</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_INSTALLER_EXE</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER</span>/runInstaller  -silent -ignorePrereq -waitforcompletion&quot;</span>
        <span class="token assign-left variable">V_RAC_PACKAGE_DATABASE_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER</span>/response/db_install.rsp

        <span class="token assign-left variable">V_RAC_PACKAGE_DBCA_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER</span>/assistants/dbca/dbca.rsp
        <span class="token assign-left variable">V_RAC_PACKAGE_NETCA_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER</span>/assistants/netca/netca.rsp
    <span class="token keyword">else</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;The oracle version does not exists,contact dba to support!&quot;</span>
        <span class="token builtin class-name">exit</span>
    <span class="token keyword">fi</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">PreConfigureDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Preparing configuring database intallation ...&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Preparing configuring ASM disks ...&quot;</span>
    <span class="token assign-left variable">V_RAC_OS_CURRENT_HOSTNAME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">hostname</span><span class="token variable">)</span></span>

    ASMOptions <span class="token string">&quot;<span class="token variable">$@</span>&quot;</span>
    <span class="token assign-left variable">V_RAC_ASM_ASMDISKS_PATH</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$V_RAC_ABELIT_ASM_TYPE</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;asmlib&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">V_RAC_ASM_ASMDISKS_PATH</span><span class="token operator">=</span><span class="token string">&quot;/dev/oracleasm/disks&quot;</span>
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$V_RAC_ABELIT_ASM_TYPE</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;asmmultipath&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">V_RAC_ASM_ASMDISKS_PATH</span><span class="token operator">=</span><span class="token string">&quot;/dev/mapper&quot;</span>
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$V_RAC_ABELIT_ASM_TYPE</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;asmudev&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">V_RAC_ASM_ASMDISKS_PATH</span><span class="token operator">=</span><span class="token string">&quot;/dev&quot;</span>
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$V_RAC_ABELIT_ASM_TYPE</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;asmnfs&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">V_RAC_ASM_ASMDISKS_PATH</span><span class="token operator">=</span><span class="token string">&quot;/data/oracleasm&quot;</span>
    <span class="token keyword">else</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;The specified asm storage type does not exist.&quot;</span>
        <span class="token builtin class-name">exit</span> <span class="token number">1</span>
    <span class="token keyword">fi</span>

    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">disk_item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_OCR_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$V_RAC_ASM_DISKGROUP_DISKS</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
            <span class="token assign-left variable">V_RAC_ASM_DISKGROUP_DISKS</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_ASM_DISKGROUP_DISKS</span>,<span class="token variable">$V_RAC_ASM_ASMDISKS_PATH</span>/<span class="token variable">${V_RAC_ASM_OCR_ASMDISK_PREFFIX}</span><span class="token variable">${counter}</span>&quot;</span>
        <span class="token keyword">else</span>
            <span class="token assign-left variable">V_RAC_ASM_DISKGROUP_DISKS</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_ASM_ASMDISKS_PATH</span>/<span class="token variable">${V_RAC_ASM_OCR_ASMDISK_PREFFIX}</span><span class="token variable">${counter}</span>&quot;</span>
        <span class="token keyword">fi</span>
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>

    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">disk_item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_DATA_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$V_RAC_ASM_DATA_ASMDISKS</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
            <span class="token assign-left variable">V_RAC_ASM_DATA_ASMDISKS</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_ASM_DATA_ASMDISKS</span>,<span class="token variable">$V_RAC_ASM_ASMDISKS_PATH</span>/<span class="token variable">${V_RAC_ASM_DATA_ASMDISK_PREFFIX}</span><span class="token variable">${counter}</span>&quot;</span>
        <span class="token keyword">else</span>
            <span class="token assign-left variable">V_RAC_ASM_DATA_ASMDISKS</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_ASM_ASMDISKS_PATH</span>/<span class="token variable">${V_RAC_ASM_DATA_ASMDISK_PREFFIX}</span><span class="token variable">${counter}</span>&quot;</span>
        <span class="token keyword">fi</span>
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>

    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">disk_item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_FRA_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$V_RAC_ASM_FRA_ASMDISKS</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
            <span class="token assign-left variable">V_RAC_ASM_FRA_ASMDISKS</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_ASM_FRA_ASMDISKS</span>,<span class="token variable">$V_RAC_ASM_ASMDISKS_PATH</span>/<span class="token variable">${V_RAC_ASM_FRA_ASMDISK_PREFFIX}</span><span class="token variable">${counter}</span>&quot;</span>
        <span class="token keyword">else</span>
            <span class="token assign-left variable">V_RAC_ASM_FRA_ASMDISKS</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$V_RAC_ASM_ASMDISKS_PATH</span>/<span class="token variable">${V_RAC_ASM_FRA_ASMDISK_PREFFIX}</span><span class="token variable">${counter}</span>&quot;</span>
        <span class="token keyword">fi</span>
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>

    <span class="token assign-left variable">V_RAC_ASM_OCR_ASMDISKS</span><span class="token operator">=</span><span class="token variable">$V_RAC_ASM_DISKGROUP_DISKS</span>
    <span class="token assign-left variable">V_RAC_ASM_DISKGROUP_DISKDISCOVERY</span><span class="token operator">=</span><span class="token variable">$V_RAC_ASM_ASMDISKS_PATH</span>/ASM_DISK_*

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Preparing configuring installation options ... &quot;</span>
    <span class="token assign-left variable">V_RAC_ORACLE_DBCA_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">$V_RAC_OS_DBA_DIR</span>/dbca_<span class="token variable">$V_RAC_ORACLE_DATABASE_VERSION</span>.rsp

    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">11</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">V_RAC_ASM_DISKGROUP_ASM_COMPATIBLE</span><span class="token operator">=</span><span class="token string">&quot;11.2&quot;</span>
        <span class="token assign-left variable">V_RAC_ASM_DISKGROUP_RDBMMS_COMPATIBLE</span><span class="token operator">=</span><span class="token string">&quot;11.2&quot;</span>
        <span class="token assign-left variable">V_RAC_GRID_INSTALL_OPTION</span><span class="token operator">=</span><span class="token string">&quot;\
        oracle.install.responseFileVersion=/oracle/install/rspfmt_crsinstall_response_schema_v11_2_0 \
        ORACLE_HOSTNAME=<span class="token variable">$V_RAC_OS_CURRENT_HOSTNAME</span> \
        INVENTORY_LOCATION=<span class="token variable">$V_RAC_ORACLE_ORA_INVENTORY</span> \
        SELECTED_LANGUAGES=en \
        oracle.install.option=CRS_CONFIG \
        ORACLE_BASE=<span class="token variable">$V_RAC_GRID_ORACLE_BASE</span> \
        ORACLE_HOME=<span class="token variable">$V_RAC_GRID_ORACLE_HOME</span> \
        oracle.install.asm.OSDBA=asmdba \
        oracle.install.asm.OSOPER=asmoper \
        oracle.install.asm.OSASM=asmadmin \
        oracle.install.crs.config.gpnp.scanName=<span class="token variable">$V_RAC_CRS_SCANNAME</span> \
        oracle.install.crs.config.gpnp.scanPort=<span class="token variable">$V_RAC_CRS_SCANPORT</span> \
        oracle.install.crs.config.clusterName=<span class="token variable">$V_RAC_CRS_CLUSTER_NAME</span> \
        oracle.install.crs.config.gpnp.configureGNS=false \
        oracle.install.crs.config.gpnp.gnsSubDomain= \
        oracle.install.crs.config.gpnp.gnsVIPAddress= \
        oracle.install.crs.config.autoConfigureClusterNodeVIP=false \
        oracle.install.crs.config.clusterNodes=<span class="token variable">$V_RAC_CRS_CLUSTERNODES</span> \
        oracle.install.crs.config.networkInterfaceList=<span class="token variable">$V_RAC_CRS_NETWORKINTERFACES</span> \
        oracle.install.crs.config.storageOption=ASM_STORAGE \
        oracle.install.crs.config.sharedFileSystemStorage.diskDriveMapping= \
        oracle.install.crs.config.sharedFileSystemStorage.votingDiskLocations= \
        oracle.install.crs.config.sharedFileSystemStorage.votingDiskRedundancy=<span class="token variable">$V_RAC_CRS_OCRVOTING_REDUNDANCY</span> \
        oracle.install.crs.config.sharedFileSystemStorage.ocrLocations= \
        oracle.install.crs.config.sharedFileSystemStorage.ocrRedundancy=<span class="token variable">$V_RAC_CRS_OCRVOTING_REDUNDANCY</span> \
        oracle.install.crs.config.useIPMI=false \
        oracle.install.crs.config.ipmi.bmcUsername= \
        oracle.install.crs.config.ipmi.bmcPassword= \
        oracle.install.asm.SYSASMPassword=<span class="token variable">$V_RAC_ASM_SYSASM_PASSWORD</span> \
        oracle.install.asm.diskGroup.name=<span class="token variable">$V_RAC_ASM_DISKGROUP_NAME</span> \
        oracle.install.asm.diskGroup.redundancy=<span class="token variable">$V_RAC_ASM_DISKGROUP_REDUNDANCY</span> \
        oracle.install.asm.diskGroup.AUSize=1 \
        oracle.install.asm.diskGroup.disks=<span class="token variable">$V_RAC_ASM_DISKGROUP_DISKS</span> \
        oracle.install.asm.diskGroup.diskDiscoveryString=<span class="token variable">$V_RAC_ASM_DISKGROUP_DISKDISCOVERY</span> \
        oracle.install.asm.monitorPassword=<span class="token variable">$V_RAC_ASM_MONITOR_PASSWORD</span> \
        oracle.install.crs.upgrade.clusterNodes= \
        oracle.install.asm.upgradeASM=false \
        oracle.installer.autoupdates.option=SKIP_UPDATES \
        &quot;</span>

        <span class="token assign-left variable">V_RAC_ORACLE_INSTALL_OPTION</span><span class="token operator">=</span><span class="token string">&quot;\
        oracle.install.responseFileVersion=/oracle/install/rspfmt_dbinstall_response_schema_v11_2_0 \
        oracle.install.option=INSTALL_DB_SWONLY \
        ORACLE_HOSTNAME=<span class="token variable">$V_RAC_OS_CURRENT_HOSTNAME</span> \
        UNIX_GROUP_NAME=oinstall \
        INVENTORY_LOCATION=<span class="token variable">$V_RAC_ORACLE_ORA_INVENTORY</span> \
        SELECTED_LANGUAGES=en \
        ORACLE_HOME=<span class="token variable">$V_RAC_ORACLE_HOME</span> \
        ORACLE_BASE=<span class="token variable">$V_RAC_ORACLE_BASE</span> \
        oracle.install.db.InstallEdition=EE \
        oracle.install.db.EEOptionsSelection=false \
        oracle.install.db.DBA_GROUP=dba \
        oracle.install.db.OPER_GROUP=oper \
        oracle.install.db.OSBACKUPDBA_GROUP=backupdba \
        oracle.install.db.OSDGDBA_GROUP=dgdba \
        oracle.install.db.OSKMDBA_GROUP=kmdba \
        oracle.install.db.OSRACDBA_GROUP=racdba \
        oracle.install.db.CLUSTER_NODES=<span class="token variable">$V_RAC_INSTANCE_CLUSTER_NODES</span> \
        oracle.install.db.isRACOneInstall=false \
        oracle.install.db.racOneServiceName= \
        oracle.install.db.config.starterdb.type= \
        oracle.install.db.config.starterdb.globalDBName= \
        oracle.install.db.config.starterdb.SID= \
        oracle.install.db.config.starterdb.characterSet= \
        oracle.install.db.config.starterdb.memoryOption=true \
        oracle.install.db.config.starterdb.memoryLimit= \
        oracle.install.db.config.starterdb.installExampleSchemas=false \
        oracle.install.db.config.starterdb.enableSecuritySettings=true \
        oracle.install.db.config.starterdb.password.ALL= \
        oracle.install.db.config.starterdb.password.SYS= \
        oracle.install.db.config.starterdb.password.SYSTEM= \
        oracle.install.db.config.starterdb.password.SYSMAN= \
        oracle.install.db.config.starterdb.password.DBSNMP= \
        oracle.install.db.config.starterdb.control=DB_CONTROL \
        oracle.install.db.config.starterdb.gridcontrol.gridControlServiceURL= \
        oracle.install.db.config.starterdb.automatedBackup.enable=false \
        oracle.install.db.config.starterdb.automatedBackup.osuid= \
        oracle.install.db.config.starterdb.automatedBackup.ospwd= \
        oracle.install.db.config.starterdb.storageType= \
        oracle.install.db.config.starterdb.fileSystemStorage.dataLocation= \
        oracle.install.db.config.starterdb.fileSystemStorage.recoveryLocation= \
        oracle.install.db.config.asm.diskGroup= \
        oracle.install.db.config.asm.ASMSNMPPassword= \
        MYORACLESUPPORT_USERNAME= \
        MYORACLESUPPORT_PASSWORD= \
        SECURITY_UPDATES_VIA_MYORACLESUPPORT= \
        DECLINE_SECURITY_UPDATES=true \
        PROXY_HOST= \
        PROXY_PORT= \
        PROXY_USER= \
        PROXY_PWD= \
        PROXY_REALM= \
        COLLECTOR_SUPPORTHUB_URL= \
        oracle.installer.autoupdates.option= \
        oracle.installer.autoupdates.downloadUpdatesLoc= \
        AUTOUPDATES_MYORACLESUPPORT_USERNAME= \
        AUTOUPDATES_MYORACLESUPPORT_PASSWORD= \
        &quot;</span>
        <span class="token assign-left variable">V_RAC_ORACLE_DBCA_OPTION</span><span class="token operator">=</span><span class="token string">&quot;\
        -nodelist <span class="token variable">$V_RAC_INSTANCE_CLUSTER_NODES</span> \
        -gdbName <span class="token variable">$V_RAC_ORACLE_UNQNAME</span> \
        -sid <span class="token variable">$V_RAC_ORACLE_UNQNAME</span> \
        -characterSet <span class="token variable">$V_RAC_ORACLE_CHARSET</span> \
        -sysPassword <span class="token variable">$V_RAC_ORACLE_SYS_PASSWORD</span> \
        -systemPassword <span class="token variable">$V_RAC_ORACLE_SYSTEM_PASSWORD</span> \
        -databaseType MULTIPURPOSE \
        -memoryPercentage 66 \
        -totalMemory <span class="token variable">$V_RAC_ORACLE_TOTAL_MEMORY</span> \
        -storageType ASM \
        -diskGroupName <span class="token variable">$V_RAC_ORACLE_DATA_DIR</span> \
        -recoveryGroupName <span class="token variable">$V_RAC_ORACLE_RECOVERY_AREA_DIR</span> \
        -datafileDestination <span class="token variable">$V_RAC_ORACLE_DATA_DIR</span> \
        -recoveryAreaDestination <span class="token variable">$V_RAC_ORACLE_RECOVERY_AREA_DIR</span> \
        -redoLogFileSize <span class="token variable">$V_RAC_ORACLE_REDOLOG_SIZE</span> \
        -emConfiguration NONE \
        &quot;</span>

    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">12</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">V_RAC_ASM_DISKGROUP_ASM_COMPATIBLE</span><span class="token operator">=</span><span class="token string">&quot;12.2&quot;</span>
        <span class="token assign-left variable">V_RAC_ASM_DISKGROUP_RDBMMS_COMPATIBLE</span><span class="token operator">=</span><span class="token string">&quot;12.2&quot;</span>
        <span class="token assign-left variable">V_RAC_GRID_INSTALL_OPTION</span><span class="token operator">=</span><span class="token string">&quot;\
        oracle.install.responseFileVersion=/oracle/install/rspfmt_crsinstall_response_schema_v12.2.0 \
        INVENTORY_LOCATION=<span class="token variable">$V_RAC_ORACLE_ORA_INVENTORY</span> \
        oracle.install.option=CRS_CONFIG \
        ORACLE_BASE=<span class="token variable">$V_RAC_GRID_ORACLE_BASE</span> \
        ORACLE_HOME=<span class="token variable">$V_RAC_GRID_ORACLE_HOME</span> \
        oracle.install.asm.OSDBA=asmdba \
        oracle.install.asm.OSOPER=asmoper \
        oracle.install.asm.OSASM=asmadmin \
        oracle.install.crs.config.gpnp.scanName=<span class="token variable">$V_RAC_CRS_SCANNAME</span> \
        oracle.install.crs.config.gpnp.scanPort=<span class="token variable">$V_RAC_CRS_SCANPORT</span> \
        oracle.install.crs.config.ClusterConfiguration=STANDALONE \
        oracle.install.crs.config.configureAsExtendedCluster= \
        oracle.install.crs.config.memberClusterManifestFile= \
        oracle.install.crs.config.clusterName=<span class="token variable">$V_RAC_CRS_CLUSTER_NAME</span> \
        oracle.install.crs.config.gpnp.configureGNS=false \
        oracle.install.crs.config.autoConfigureClusterNodeVIP=false \
        oracle.install.crs.config.gpnp.gnsOption= \
        oracle.install.crs.config.gpnp.gnsClientDataFile= \
        oracle.install.crs.config.gpnp.gnsSubDomain= \
        oracle.install.crs.config.gpnp.gnsVIPAddress= \
        oracle.install.crs.config.sites= \
        oracle.install.crs.config.clusterNodes=<span class="token variable">$V_RAC_CRS_CLUSTERNODES</span> \
        oracle.install.crs.config.networkInterfaceList=<span class="token variable">$V_RAC_CRS_NETWORKINTERFACES</span> \
        oracle.install.asm.configureGIMRDataDG= \
        oracle.install.crs.config.storageOption= \
        oracle.install.crs.config.useIPMI=false \
        oracle.install.crs.config.ipmi.bmcUsername= \
        oracle.install.crs.config.ipmi.bmcPassword= \
        oracle.install.asm.storageOption=ASM \
        oracle.install.asmOnNAS.ocrLocation= \
        oracle.install.asmOnNAS.configureGIMRDataDG= \
        oracle.install.asmOnNAS.gimrLocation= \
        oracle.install.asm.SYSASMPassword=<span class="token variable">$V_RAC_ASM_SYSASM_PASSWORD</span> \
        oracle.install.asm.diskGroup.name=<span class="token variable">$V_RAC_ASM_DISKGROUP_NAME</span> \
        oracle.install.asm.diskGroup.redundancy=<span class="token variable">$V_RAC_ASM_DISKGROUP_REDUNDANCY</span> \
        oracle.install.asm.diskGroup.AUSize=1 \
        oracle.install.asm.diskGroup.FailureGroups= \
        oracle.install.asm.diskGroup.disksWithFailureGroupNames= \
        oracle.install.asm.diskGroup.disks=<span class="token variable">$V_RAC_ASM_DISKGROUP_DISKS</span> \
        oracle.install.asm.diskGroup.quorumFailureGroupNames= \
        oracle.install.asm.diskGroup.diskDiscoveryString=<span class="token variable">$V_RAC_ASM_DISKGROUP_DISKDISCOVERY</span> \
        oracle.install.asm.monitorPassword=<span class="token variable">$V_RAC_ASM_MONITOR_PASSWORD</span> \
        oracle.install.asm.gimrDG.name= \
        oracle.install.asm.gimrDG.redundancy= \
        oracle.install.asm.gimrDG.AUSize= \
        oracle.install.asm.gimrDG.FailureGroups= \
        oracle.install.asm.gimrDG.disksWithFailureGroupNames= \
        oracle.install.asm.gimrDG.disks= \
        oracle.install.asm.gimrDG.quorumFailureGroupNames= \
        oracle.install.asm.configureAFD= \
        oracle.install.crs.configureRHPS= \
        oracle.install.crs.config.ignoreDownNodes= \
        oracle.install.config.managementOption= \
        oracle.install.config.omsHost= \
        oracle.install.config.omsPort= \
        oracle.install.config.emAdminUser= \
        oracle.install.config.emAdminPassword= \
        oracle.install.crs.rootconfig.executeRootScript= \
        oracle.install.crs.rootconfig.configMethod= \
        oracle.install.crs.rootconfig.sudoPath= \
        oracle.install.crs.rootconfig.sudoUserName= \
        oracle.install.crs.config.batchinfo= \
        oracle.install.crs.app.applicationAddress= \
        &quot;</span>
        <span class="token assign-left variable">V_RAC_ORACLE_INSTALL_OPTION</span><span class="token operator">=</span><span class="token string">&quot;\
        oracle.install.responseFileVersion=/oracle/install/rspfmt_dbinstall_response_schema_v12.2.0 \
        oracle.install.option=INSTALL_DB_SWONLY \
        UNIX_GROUP_NAME=oinstall \
        INVENTORY_LOCATION=<span class="token variable">$V_RAC_ORACLE_ORA_INVENTORY</span> \
        ORACLE_HOME=<span class="token variable">$V_RAC_ORACLE_HOME</span> \
        ORACLE_BASE=<span class="token variable">$V_RAC_ORACLE_BASE</span> \
        oracle.install.db.InstallEdition=EE \
        oracle.install.db.OSDBA_GROUP=dba \
        oracle.install.db.OSOPER_GROUP=oper \
        oracle.install.db.OSBACKUPDBA_GROUP=backupdba \
        oracle.install.db.OSDGDBA_GROUP=dgdba \
        oracle.install.db.OSKMDBA_GROUP=kmdba \
        oracle.install.db.OSRACDBA_GROUP=racdba \
        oracle.install.db.rac.configurationType= \
        oracle.install.db.CLUSTER_NODES=<span class="token variable">$V_RAC_INSTANCE_CLUSTER_NODES</span> \
        oracle.install.db.isRACOneInstall=false \
        oracle.install.db.racOneServiceName= \
        oracle.install.db.rac.serverpoolName= \
        oracle.install.db.rac.serverpoolCardinality= \
        oracle.install.db.config.starterdb.type= \
        oracle.install.db.config.starterdb.globalDBName= \
        oracle.install.db.config.starterdb.SID= \
        oracle.install.db.ConfigureAsContainerDB= \
        oracle.install.db.config.PDBName= \
        oracle.install.db.config.starterdb.characterSet= \
        oracle.install.db.config.starterdb.memoryOption= \
        oracle.install.db.config.starterdb.memoryLimit= \
        oracle.install.db.config.starterdb.installExampleSchemas= \
        oracle.install.db.config.starterdb.password.ALL= \
        oracle.install.db.config.starterdb.password.SYS= \
        oracle.install.db.config.starterdb.password.SYSTEM= \
        oracle.install.db.config.starterdb.password.DBSNMP= \
        oracle.install.db.config.starterdb.password.PDBADMIN= \
        oracle.install.db.config.starterdb.managementOption= \
        oracle.install.db.config.starterdb.omsHost= \
        oracle.install.db.config.starterdb.omsPort= \
        oracle.install.db.config.starterdb.emAdminUser= \
        oracle.install.db.config.starterdb.emAdminPassword= \
        oracle.install.db.config.starterdb.enableRecovery= \
        oracle.install.db.config.starterdb.storageType= \
        oracle.install.db.config.starterdb.fileSystemStorage.dataLocation= \
        oracle.install.db.config.starterdb.fileSystemStorage.recoveryLocation= \
        oracle.install.db.config.asm.diskGroup= \
        oracle.install.db.config.asm.ASMSNMPPassword= \
        MYORACLESUPPORT_USERNAME= \
        MYORACLESUPPORT_PASSWORD= \
        SECURITY_UPDATES_VIA_MYORACLESUPPORT= \
        DECLINE_SECURITY_UPDATES=true \
        PROXY_HOST= \
        PROXY_PORT= \
        PROXY_USER= \
        PROXY_PWD= \
        COLLECTOR_SUPPORTHUB_URL= \
        &quot;</span>
        <span class="token assign-left variable">V_RAC_ORACLE_DBCA_OPTION</span><span class="token operator">=</span><span class="token string">&quot;\
        -nodelist <span class="token variable">$V_RAC_INSTANCE_CLUSTER_NODES</span> \
        -gdbName <span class="token variable">$V_RAC_ORACLE_UNQNAME</span> \
        -sid <span class="token variable">$V_RAC_ORACLE_UNQNAME</span> \
        -characterSet <span class="token variable">$V_RAC_ORACLE_CHARSET</span> \
        -sysPassword <span class="token variable">$V_RAC_ORACLE_SYS_PASSWORD</span> \
        -systemPassword <span class="token variable">$V_RAC_ORACLE_SYSTEM_PASSWORD</span> \
        -asmsnmpPassword <span class="token variable">$V_RAC_ORACLE_MONITOR_PASSWORD</span> \
        -createAsContainerDatabase true \
        -numberOfPDBs 1 \
        -pdbName <span class="token variable">$V_RAC_ORACLE_PDB_NAME</span> \
        -pdbAdminPassword <span class="token variable">$V_RAC_ORACLE_PDB_ADMIN_PASSWORD</span> \
        -databaseType MULTIPURPOSE \
        -memoryMgmtType AUTO_SGA \
        -totalMemory <span class="token variable">$V_RAC_ORACLE_TOTAL_MEMORY</span> \
        -storageType ASM \
        -diskGroupName <span class="token variable">$V_RAC_ORACLE_DATA_DIR</span> \
        -recoveryGroupName <span class="token variable">$V_RAC_ORACLE_RECOVERY_AREA_DIR</span> \
        -datafileDestination <span class="token variable">$V_RAC_ORACLE_DATA_DIR</span> \
        -recoveryAreaDestination +<span class="token variable">$V_RAC_ORACLE_RECOVERY_AREA_DIR</span> \
        -redoLogFileSize <span class="token variable">$V_RAC_ORACLE_REDOLOG_SIZE</span> \
        -useLocalUndoForPDBs true \
        -databaseConfigType RAC \
        -emConfiguration NONE \
        -ignorePreReqs \
        &quot;</span>

        <span class="token function">cat</span> <span class="token operator">&gt;</span><span class="token variable">$V_RAC_ORACLE_DBCA_RESPONSE_FILE</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
        responseFileVersion=/oracle/assistants/rspfmt_dbca_response_schema_v12.2.0
        gdbName=<span class="token variable">$V_RAC_ORACLE_UNQNAME</span>
        sid=<span class="token variable">$V_RAC_ORACLE_UNQNAME</span>
        databaseConfigType=RAC
        RACOneNodeServiceName=
        policyManaged=false
        createServerPool=false
        serverPoolName=
        cardinality=
        force=
        pqPoolName=
        pqCardinality=
        createAsContainerDatabase=true
        numberOfPDBs=1
        pdbName=<span class="token variable">$V_RAC_ORACLE_PDB_NAME</span>
        useLocalUndoForPDBs=true
        pdbAdminPassword=<span class="token variable">$V_RAC_ORACLE_PDB_ADMIN_PASSWORD</span>
        nodelist=<span class="token variable">$V_RAC_INSTANCE_CLUSTER_NODES</span>
        templateName=
        sysPassword=<span class="token variable">$V_RAC_ORACLE_SYS_PASSWORD</span>
        systemPassword=<span class="token variable">$V_RAC_ORACLE_SYSTEM_PASSWORD</span>
        oracleHomeUserPassword=
        emConfiguration=
        emExpressPort=
        runCVUChecks=
        dbsnmpPassword=<span class="token variable">$V_RAC_ASM_MONITOR_PASSWORD</span>
        omsHost=
        omsPort=
        emUser=
        emPassword=
        dvConfiguration=
        dvUserName=
        dvUserPassword=
        dvAccountManagerName=
        dvAccountManagerPassword=
        olsConfiguration=
        datafileJarLocation=
        datafileDestination=<span class="token variable">$V_RAC_ORACLE_DATA_DIR</span>
        recoveryAreaDestination=<span class="token variable">$V_RAC_ORACLE_RECOVERY_AREA_DIR</span>
        storageType=ASM
        diskGroupName=<span class="token variable">$V_RAC_ORACLE_DATA_DIR</span>
        asmsnmpPassword=
        recoveryGroupName=<span class="token variable">$V_RAC_ORACLE_RECOVERY_AREA_DIR</span>
        characterSet=<span class="token variable">$V_RAC_ORACLE_CHARSET</span>
        nationalCharacterSet=
        registerWithDirService=
        dirServiceUserName=
        dirServicePassword=
        walletPassword=
        listeners=
        variablesFile=
        variables=
        initParams=
        sampleSchema=
        memoryPercentage=66
        databaseType=MULTIPURPOSE
        automaticMemoryManagement=
        totalMemory=<span class="token variable">$V_RAC_ORACLE_TOTAL_MEMORY</span>
EOF</span>
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">18</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">V_RAC_ASM_DISKGROUP_ASM_COMPATIBLE</span><span class="token operator">=</span><span class="token string">&quot;18.0&quot;</span>
        <span class="token assign-left variable">V_RAC_ASM_DISKGROUP_RDBMMS_COMPATIBLE</span><span class="token operator">=</span><span class="token string">&quot;18.0&quot;</span>
        <span class="token assign-left variable">V_RAC_GRID_INSTALL_OPTION</span><span class="token operator">=</span><span class="token string">&quot;\
        oracle.install.responseFileVersion=/oracle/install/rspfmt_crsinstall_response_schema_v18.0.0 \
        INVENTORY_LOCATION=<span class="token variable">$V_RAC_ORACLE_ORA_INVENTORY</span> \
        oracle.install.option=CRS_CONFIG \
        ORACLE_BASE=<span class="token variable">$V_RAC_GRID_ORACLE_BASE</span> \
        ORACLE_HOME=<span class="token variable">$V_RAC_GRID_ORACLE_HOME</span> \
        oracle.install.asm.OSDBA=asmdba \
        oracle.install.asm.OSOPER=asmoper \
        oracle.install.asm.OSASM=asmadmin \
        oracle.install.crs.config.scanType= \
        oracle.install.crs.config.SCANClientDataFile= \
        oracle.install.crs.config.gpnp.scanName=<span class="token variable">$V_RAC_CRS_SCANNAME</span> \
        oracle.install.crs.config.gpnp.scanPort=<span class="token variable">$V_RAC_CRS_SCANPORT</span> \
        oracle.install.crs.config.ClusterConfiguration=STANDALONE \
        oracle.install.crs.config.configureAsExtendedCluster= \
        oracle.install.crs.config.memberClusterManifestFile= \
        oracle.install.crs.config.clusterName=<span class="token variable">$V_RAC_CRS_CLUSTER_NAME</span> \
        oracle.install.crs.config.gpnp.configureGNS= \
        oracle.install.crs.config.autoConfigureClusterNodeVIP=false \
        oracle.install.crs.config.gpnp.gnsOption= \
        oracle.install.crs.config.gpnp.gnsClientDataFile= \
        oracle.install.crs.config.gpnp.gnsSubDomain= \
        oracle.install.crs.config.gpnp.gnsVIPAddress= \
        oracle.install.crs.config.sites= \
        oracle.install.crs.config.clusterNodes=<span class="token variable">$V_RAC_CRS_CLUSTERNODES</span> \
        oracle.install.crs.config.networkInterfaceList=<span class="token variable">$V_RAC_CRS_NETWORKINTERFACES</span> \
        oracle.install.asm.configureGIMRDataDG= \
        oracle.install.crs.config.storageOption= \
        oracle.install.crs.config.useIPMI= \
        oracle.install.crs.config.ipmi.bmcUsername= \
        oracle.install.crs.config.ipmi.bmcPassword= \
        oracle.install.asm.storageOption=ASM \
        oracle.install.asmOnNAS.ocrLocation= \
        oracle.install.asmOnNAS.configureGIMRDataDG= \
        oracle.install.asmOnNAS.gimrLocation= \
        oracle.install.asm.SYSASMPassword=<span class="token variable">$V_RAC_ASM_SYSASM_PASSWORD</span> \
        oracle.install.asm.diskGroup.name=<span class="token variable">$V_RAC_ASM_DISKGROUP_NAME</span> \
        oracle.install.asm.diskGroup.redundancy=<span class="token variable">$V_RAC_ASM_DISKGROUP_REDUNDANCY</span> \
        oracle.install.asm.diskGroup.AUSize=1 \
        oracle.install.asm.diskGroup.FailureGroups= \
        oracle.install.asm.diskGroup.disksWithFailureGroupNames= \
        oracle.install.asm.diskGroup.disks=<span class="token variable">$V_RAC_ASM_DISKGROUP_DISKS</span> \
        oracle.install.asm.diskGroup.quorumFailureGroupNames= \
        oracle.install.asm.diskGroup.diskDiscoveryString=<span class="token variable">$V_RAC_ASM_DISKGROUP_DISKDISCOVERY</span> \
        oracle.install.asm.monitorPassword=<span class="token variable">$V_RAC_ASM_MONITOR_PASSWORD</span> \
        oracle.install.asm.gimrDG.name= \
        oracle.install.asm.gimrDG.redundancy= \
        oracle.install.asm.gimrDG.AUSize= \
        oracle.install.asm.gimrDG.FailureGroups= \
        oracle.install.asm.gimrDG.disksWithFailureGroupNames= \
        oracle.install.asm.gimrDG.disks= \
        oracle.install.asm.gimrDG.quorumFailureGroupNames= \
        oracle.install.asm.configureAFD= \
        oracle.install.crs.configureRHPS= \
        oracle.install.crs.config.ignoreDownNodes= \
        oracle.install.config.managementOption= \
        oracle.install.config.omsHost= \
        oracle.install.config.omsPort= \
        oracle.install.config.emAdminUser= \
        oracle.install.config.emAdminPassword= \
        oracle.install.crs.rootconfig.executeRootScript= \
        oracle.install.crs.rootconfig.configMethod= \
        oracle.install.crs.rootconfig.sudoPath= \
        oracle.install.crs.rootconfig.sudoUserName= \
        oracle.install.crs.config.batchinfo= \
        oracle.install.crs.app.applicationAddress= \
        oracle.install.crs.deleteNode.nodes= \
        &quot;</span>
        <span class="token assign-left variable">V_RAC_ORACLE_INSTALL_OPTION</span><span class="token operator">=</span><span class="token string">&quot;\
        oracle.install.responseFileVersion=/oracle/install/rspfmt_dbinstall_response_schema_v18.0.0 \
        oracle.install.option=INSTALL_DB_SWONLY \
        UNIX_GROUP_NAME=oinstall \
        INVENTORY_LOCATION=<span class="token variable">$V_RAC_ORACLE_ORA_INVENTORY</span> \
        ORACLE_HOME=<span class="token variable">$V_RAC_ORACLE_HOME</span> \
        ORACLE_BASE=<span class="token variable">$V_RAC_ORACLE_BASE</span> \
        oracle.install.db.InstallEdition=EE \
        oracle.install.db.OSDBA_GROUP=dba \
        oracle.install.db.OSOPER_GROUP=oper \
        oracle.install.db.OSBACKUPDBA_GROUP=backupdba \
        oracle.install.db.OSDGDBA_GROUP=dgdba \
        oracle.install.db.OSKMDBA_GROUP=kmdba \
        oracle.install.db.OSRACDBA_GROUP=racdba \
        oracle.install.db.CLUSTER_NODES=<span class="token variable">$V_RAC_INSTANCE_CLUSTER_NODES</span> \
        oracle.install.db.config.starterdb.type= \
        oracle.install.db.config.starterdb.globalDBName= \
        oracle.install.db.config.starterdb.SID= \
        oracle.install.db.ConfigureAsContainerDB= \
        oracle.install.db.config.PDBName= \
        oracle.install.db.config.starterdb.characterSet= \
        oracle.install.db.config.starterdb.memoryOption= \
        oracle.install.db.config.starterdb.memoryLimit= \
        oracle.install.db.config.starterdb.installExampleSchemas= \
        oracle.install.db.config.starterdb.password.ALL= \
        oracle.install.db.config.starterdb.password.SYS= \
        oracle.install.db.config.starterdb.password.SYSTEM= \
        oracle.install.db.config.starterdb.password.DBSNMP= \
        oracle.install.db.config.starterdb.password.PDBADMIN= \
        oracle.install.db.config.starterdb.managementOption= \
        oracle.install.db.config.starterdb.omsHost= \
        oracle.install.db.config.starterdb.omsPort= \
        oracle.install.db.config.starterdb.emAdminUser= \
        oracle.install.db.config.starterdb.emAdminPassword= \
        oracle.install.db.config.starterdb.enableRecovery= \
        oracle.install.db.config.starterdb.storageType= \
        oracle.install.db.config.starterdb.fileSystemStorage.dataLocation= \
        oracle.install.db.config.starterdb.fileSystemStorage.recoveryLocation= \
        oracle.install.db.config.asm.diskGroup= \
        oracle.install.db.config.asm.ASMSNMPPassword= \
        &quot;</span>
        <span class="token assign-left variable">V_RAC_ORACLE_DBCA_OPTION</span><span class="token operator">=</span><span class="token string">&quot;\
        -nodelist <span class="token variable">$V_RAC_INSTANCE_CLUSTER_NODES</span> \
        -gdbName <span class="token variable">$V_RAC_ORACLE_UNQNAME</span> \
        -sid <span class="token variable">$V_RAC_ORACLE_UNQNAME</span> \
        -characterSet <span class="token variable">$V_RAC_ORACLE_CHARSET</span> \
        -sysPassword <span class="token variable">$V_RAC_ORACLE_SYS_PASSWORD</span> \
        -systemPassword <span class="token variable">$V_RAC_ORACLE_SYSTEM_PASSWORD</span> \
        -asmsnmpPassword <span class="token variable">$V_RAC_ORACLE_MONITOR_PASSWORD</span> \
        -createAsContainerDatabase true \
        -numberOfPDBs 1 \
        -pdbName <span class="token variable">$V_RAC_ORACLE_PDB_NAME</span> \
        -pdbAdminPassword <span class="token variable">$V_RAC_ORACLE_PDB_ADMIN_PASSWORD</span> \
        -databaseType MULTIPURPOSE \
        -memoryMgmtType AUTO_SGA \
        -totalMemory <span class="token variable">$V_RAC_ORACLE_TOTAL_MEMORY</span> \
        -storageType ASM \
        -diskGroupName <span class="token variable">$V_RAC_ORACLE_DATA_DIR</span> \
        -recoveryGroupName <span class="token variable">$V_RAC_ORACLE_RECOVERY_AREA_DIR</span> \
        -datafileDestination <span class="token variable">$V_RAC_ORACLE_DATA_DIR</span> \
        -recoveryAreaDestination +<span class="token variable">$V_RAC_ORACLE_RECOVERY_AREA_DIR</span> \
        -redoLogFileSize <span class="token variable">$V_RAC_ORACLE_REDOLOG_SIZE</span> \
        -useLocalUndoForPDBs true \
        -databaseConfigType RAC \
        -emConfiguration NONE \
        -ignorePreReqs \
        &quot;</span>
        <span class="token function">cat</span> <span class="token operator">&gt;</span><span class="token variable">$V_RAC_ORACLE_DBCA_RESPONSE_FILE</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
        responseFileVersion=/oracle/assistants/rspfmt_dbca_response_schema_v12.2.0
        gdbName=<span class="token variable">$V_RAC_ORACLE_UNQNAME</span>
        sid=<span class="token variable">$V_RAC_ORACLE_UNQNAME</span>
        databaseConfigType=RAC
        RACOneNodeServiceName=
        policyManaged=false
        createServerPool=false
        serverPoolName=
        cardinality=
        force=
        pqPoolName=
        pqCardinality=
        createAsContainerDatabase=true
        numberOfPDBs=1
        pdbName=<span class="token variable">$V_RAC_ORACLE_PDB_NAME</span>
        useLocalUndoForPDBs=true
        pdbAdminPassword=<span class="token variable">$V_RAC_ORACLE_PDB_ADMIN_PASSWORD</span>
        nodelist=<span class="token variable">$V_RAC_INSTANCE_CLUSTER_NODES</span>
        templateName=
        sysPassword=<span class="token variable">$V_RAC_ORACLE_SYS_PASSWORD</span>
        systemPassword= <span class="token variable">$V_RAC_ORACLE_SYSTEM_PASSWORD</span>
        oracleHomeUserPassword=
        emConfiguration=
        emExpressPort=5500
        runCVUChecks=
        dbsnmpPassword=<span class="token variable">$V_RAC_ASM_MONITOR_PASSWORD</span>
        omsHost=
        omsPort=
        emUser=
        emPassword=
        dvConfiguration=
        dvUserName=
        dvUserPassword=
        dvAccountManagerName=
        dvAccountManagerPassword=
        olsConfiguration=
        datafileJarLocation=
        datafileDestination=<span class="token variable">$V_RAC_ORACLE_DATA_DIR</span>
        recoveryAreaDestination=<span class="token variable">$V_RAC_ORACLE_RECOVERY_AREA_DIR</span>
        storageType=ASM
        diskGroupName=<span class="token variable">$V_RAC_ORACLE_DATA_DIR</span>
        asmsnmpPassword=
        recoveryGroupName=<span class="token variable">$V_RAC_ORACLE_RECOVERY_AREA_DIR</span>
        characterSet=<span class="token variable">$V_RAC_ORACLE_CHARSET</span>
        nationalCharacterSet=
        registerWithDirService=
        dirServiceUserName=
        dirServicePassword=
        walletPassword=
        listeners=
        variablesFile=
        variables=
        initParams=
        sampleSchema=
        memoryPercentage=
        databaseType=
        automaticMemoryManagement=
        totalMemory=<span class="token variable">$V_RAC_ORACLE_TOTAL_MEMORY</span>
EOF</span>
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">19</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">V_RAC_ASM_DISKGROUP_ASM_COMPATIBLE</span><span class="token operator">=</span><span class="token string">&quot;19.0&quot;</span>
        <span class="token assign-left variable">V_RAC_ASM_DISKGROUP_RDBMMS_COMPATIBLE</span><span class="token operator">=</span><span class="token string">&quot;19.0&quot;</span>
        <span class="token assign-left variable">V_RAC_GRID_INSTALL_OPTION</span><span class="token operator">=</span><span class="token string">&quot;\
        oracle.install.responseFileVersion=/oracle/install/rspfmt_crsinstall_response_schema_v19.0.0 \
        INVENTORY_LOCATION=<span class="token variable">$V_RAC_ORACLE_ORA_INVENTORY</span> \
        oracle.install.option=CRS_CONFIG \
        ORACLE_BASE=<span class="token variable">$V_RAC_GRID_ORACLE_BASE</span> \
        ORACLE_HOME=<span class="token variable">$V_RAC_GRID_ORACLE_HOME</span> \
        oracle.install.asm.OSDBA=asmdba \
        oracle.install.asm.OSOPER=asmoper \
        oracle.install.asm.OSASM=asmadmin \
        oracle.install.crs.config.scanType= \
        oracle.install.crs.config.SCANClientDataFile= \
        oracle.install.crs.config.gpnp.scanName=<span class="token variable">$V_RAC_CRS_SCANNAME</span> \
        oracle.install.crs.config.gpnp.scanPort=<span class="token variable">$V_RAC_CRS_SCANPORT</span> \
        oracle.install.crs.config.ClusterConfiguration=STANDALONE \
        oracle.install.crs.config.configureAsExtendedCluster= \
        oracle.install.crs.config.memberClusterManifestFile= \
        oracle.install.crs.config.clusterName=<span class="token variable">$V_RAC_CRS_CLUSTER_NAME</span> \
        oracle.install.crs.config.gpnp.configureGNS= \
        oracle.install.crs.config.autoConfigureClusterNodeVIP=false \
        oracle.install.crs.config.gpnp.gnsOption= \
        oracle.install.crs.config.gpnp.gnsClientDataFile= \
        oracle.install.crs.config.gpnp.gnsSubDomain= \
        oracle.install.crs.config.gpnp.gnsVIPAddress= \
        oracle.install.crs.config.sites= \
        oracle.install.crs.config.clusterNodes=<span class="token variable">$V_RAC_CRS_CLUSTERNODES</span> \
        oracle.install.crs.config.networkInterfaceList=<span class="token variable">$V_RAC_CRS_NETWORKINTERFACES</span> \
        oracle.install.crs.configureGIMR= \
        oracle.install.asm.configureGIMRDataDG= \
        oracle.install.crs.config.storageOption= \
        oracle.install.crs.config.sharedFileSystemStorage.votingDiskLocations= \
        oracle.install.crs.config.sharedFileSystemStorage.ocrLocations= \
        oracle.install.crs.config.useIPMI= \
        oracle.install.crs.config.ipmi.bmcUsername= \
        oracle.install.crs.config.ipmi.bmcPassword= \
        oracle.install.asm.SYSASMPassword=<span class="token variable">$V_RAC_ASM_SYSASM_PASSWORD</span> \
        oracle.install.asm.diskGroup.name=<span class="token variable">$V_RAC_ASM_DISKGROUP_NAME</span> \
        oracle.install.asm.diskGroup.redundancy=<span class="token variable">$V_RAC_ASM_DISKGROUP_REDUNDANCY</span> \
        oracle.install.asm.diskGroup.AUSize=1 \
        oracle.install.asm.diskGroup.FailureGroups= \
        oracle.install.asm.diskGroup.disksWithFailureGroupNames= \
        oracle.install.asm.diskGroup.disks=<span class="token variable">$V_RAC_ASM_DISKGROUP_DISKS</span> \
        oracle.install.asm.diskGroup.quorumFailureGroupNames= \
        oracle.install.asm.diskGroup.diskDiscoveryString=<span class="token variable">$V_RAC_ASM_DISKGROUP_DISKDISCOVERY</span> \
        oracle.install.asm.monitorPassword=<span class="token variable">$V_RAC_ASM_MONITOR_PASSWORD</span> \
        oracle.install.asm.gimrDG.name= \
        oracle.install.asm.gimrDG.redundancy= \
        oracle.install.asm.gimrDG.AUSize= \
        oracle.install.asm.gimrDG.FailureGroups= \
        oracle.install.asm.gimrDG.disksWithFailureGroupNames= \
        oracle.install.asm.gimrDG.disks= \
        oracle.install.asm.gimrDG.quorumFailureGroupNames= \
        oracle.install.asm.configureAFD= \
        oracle.install.crs.configureRHPS= \
        oracle.install.crs.config.ignoreDownNodes= \
        oracle.install.config.managementOption= \
        oracle.install.config.omsHost= \
        oracle.install.config.omsPort= \
        oracle.install.config.emAdminUser= \
        oracle.install.config.emAdminPassword= \
        oracle.install.crs.rootconfig.executeRootScript= \
        oracle.install.crs.rootconfig.configMethod= \
        oracle.install.crs.rootconfig.sudoPath= \
        oracle.install.crs.rootconfig.sudoUserName= \
        oracle.install.crs.config.batchinfo= \
        oracle.install.crs.app.applicationAddress= \
        oracle.install.crs.deleteNode.nodes= \
        &quot;</span>
        <span class="token assign-left variable">V_RAC_ORACLE_INSTALL_OPTION</span><span class="token operator">=</span><span class="token string">&quot;\
        oracle.install.responseFileVersion=/oracle/install/rspfmt_dbinstall_response_schema_v19.0.0 \
        oracle.install.option=INSTALL_DB_SWONLY \
        UNIX_GROUP_NAME=oinstall \
        INVENTORY_LOCATION=<span class="token variable">$V_RAC_ORACLE_ORA_INVENTORY</span> \
        ORACLE_HOME=<span class="token variable">$V_RAC_ORACLE_HOME</span> \
        ORACLE_BASE=<span class="token variable">$V_RAC_ORACLE_BASE</span> \
        oracle.install.db.InstallEdition=EE \
        oracle.install.db.OSDBA_GROUP=dba \
        oracle.install.db.OSOPER_GROUP=oper \
        oracle.install.db.OSBACKUPDBA_GROUP=backupdba \
        oracle.install.db.OSDGDBA_GROUP=dgdba \
        oracle.install.db.OSKMDBA_GROUP=kmdba \
        oracle.install.db.OSRACDBA_GROUP=racdba \
        oracle.install.db.rootconfig.executeRootScript= \
        oracle.install.db.rootconfig.configMethod= \
        oracle.install.db.rootconfig.sudoPath= \
        oracle.install.db.rootconfig.sudoUserName= \
        oracle.install.db.CLUSTER_NODES=<span class="token variable">$V_RAC_INSTANCE_CLUSTER_NODES</span> \
        oracle.install.db.config.starterdb.type= \
        oracle.install.db.config.starterdb.globalDBName= \
        oracle.install.db.config.starterdb.SID= \
        oracle.install.db.ConfigureAsContainerDB= \
        oracle.install.db.config.PDBName= \
        oracle.install.db.config.starterdb.characterSet= \
        oracle.install.db.config.starterdb.memoryOption= \
        oracle.install.db.config.starterdb.memoryLimit= \
        oracle.install.db.config.starterdb.installExampleSchemas= \
        oracle.install.db.config.starterdb.password.ALL= \
        oracle.install.db.config.starterdb.password.SYS= \
        oracle.install.db.config.starterdb.password.SYSTEM= \
        oracle.install.db.config.starterdb.password.DBSNMP= \
        oracle.install.db.config.starterdb.password.PDBADMIN= \
        oracle.install.db.config.starterdb.managementOption= \
        oracle.install.db.config.starterdb.omsHost= \
        oracle.install.db.config.starterdb.omsPort= \
        oracle.install.db.config.starterdb.emAdminUser= \
        oracle.install.db.config.starterdb.emAdminPassword= \
        oracle.install.db.config.starterdb.enableRecovery= \
        oracle.install.db.config.starterdb.storageType= \
        oracle.install.db.config.starterdb.fileSystemStorage.dataLocation= \
        oracle.install.db.config.starterdb.fileSystemStorage.recoveryLocation= \
        oracle.install.db.config.asm.diskGroup= \
        oracle.install.db.config.asm.ASMSNMPPassword= \
        &quot;</span>
        <span class="token assign-left variable">V_RAC_ORACLE_DBCA_OPTION</span><span class="token operator">=</span><span class="token string">&quot;\
        -nodelist <span class="token variable">$V_RAC_INSTANCE_CLUSTER_NODES</span> \
        -gdbName <span class="token variable">$V_RAC_ORACLE_UNQNAME</span> \
        -sid <span class="token variable">$V_RAC_ORACLE_UNQNAME</span> \
        -characterSet <span class="token variable">$V_RAC_ORACLE_CHARSET</span> \
        -sysPassword <span class="token variable">$V_RAC_ORACLE_SYS_PASSWORD</span> \
        -systemPassword <span class="token variable">$V_RAC_ORACLE_SYSTEM_PASSWORD</span> \
        -asmsnmpPassword <span class="token variable">$V_RAC_ORACLE_MONITOR_PASSWORD</span> \
        -createAsContainerDatabase true \
        -numberOfPDBs 1 \
        -pdbName <span class="token variable">$V_RAC_ORACLE_PDB_NAME</span> \
        -pdbAdminPassword <span class="token variable">$V_RAC_ORACLE_PDB_ADMIN_PASSWORD</span> \
        -databaseType MULTIPURPOSE \
        -memoryMgmtType AUTO_SGA \
        -totalMemory <span class="token variable">$V_RAC_ORACLE_TOTAL_MEMORY</span> \
        -storageType ASM \
        -diskGroupName +<span class="token variable">$V_RAC_ORACLE_DATA_DIR</span> \
        -recoveryGroupName +<span class="token variable">$V_RAC_ORACLE_RECOVERY_AREA_DIR</span> \
        -datafileDestination +<span class="token variable">$V_RAC_ORACLE_DATA_DIR</span> \
        -recoveryAreaDestination +<span class="token variable">$V_RAC_ORACLE_RECOVERY_AREA_DIR</span> \
        -redoLogFileSize <span class="token variable">$V_RAC_ORACLE_REDOLOG_SIZE</span> \
        -useLocalUndoForPDBs true \
        -databaseConfigType RAC \
        -emConfiguration NONE \
        -ignorePreReqs \
        &quot;</span>

        <span class="token function">cat</span> <span class="token operator">&gt;</span><span class="token variable">$V_RAC_ORACLE_DBCA_RESPONSE_FILE</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
        responseFileVersion=/oracle/assistants/rspfmt_dbca_response_schema_v19.0.0
        gdbName=
        sid=
        databaseConfigType=
        RACOneNodeServiceName=
        policyManaged=
        createServerPool=
        serverPoolName=
        cardinality=
        force=
        pqPoolName=
        pqCardinality=
        createAsContainerDatabase=
        numberOfPDBs=
        pdbName=
        useLocalUndoForPDBs=
        pdbAdminPassword=
        nodelist=
        templateName=
        sysPassword=
        systemPassword= 
        oracleHomeUserPassword=
        emConfiguration=
        emExpressPort=5500
        runCVUChecks=
        dbsnmpPassword=
        omsHost=
        omsPort=
        emUser=
        emPassword=
        dvConfiguration=
        dvUserName=
        dvUserPassword=
        dvAccountManagerName=
        dvAccountManagerPassword=
        olsConfiguration=
        datafileJarLocation=
        datafileDestination=
        recoveryAreaDestination=
        storageType=
        diskGroupName=
        asmsnmpPassword=
        recoveryGroupName=
        characterSet=
        nationalCharacterSet=
        registerWithDirService=
        dirServiceUserName=
        dirServicePassword=
        walletPassword=
        listeners=
        variablesFile=
        variables=
        initParams=
        sampleSchema=
        memoryPercentage=
        databaseType=
        automaticMemoryManagement=
        totalMemory=
EOF</span>

    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">21</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">V_RAC_ASM_DISKGROUP_ASM_COMPATIBLE</span><span class="token operator">=</span><span class="token string">&quot;21.0&quot;</span>
        <span class="token assign-left variable">V_RAC_ASM_DISKGROUP_RDBMMS_COMPATIBLE</span><span class="token operator">=</span><span class="token string">&quot;21.0&quot;</span>
        <span class="token assign-left variable">V_RAC_GRID_INSTALL_OPTION</span><span class="token operator">=</span><span class="token string">&quot;\
        oracle.install.responseFileVersion=/oracle/install/rspfmt_crsinstall_response_schema_v21.0.0 \
        INVENTORY_LOCATION=<span class="token variable">$V_RAC_ORACLE_ORA_INVENTORY</span> \
        oracle.install.option=CRS_CONFIG \
        ORACLE_BASE=<span class="token variable">$V_RAC_GRID_ORACLE_BASE</span> \
        ORACLE_HOME=<span class="token variable">$V_RAC_GRID_ORACLE_HOME</span> \
        oracle.install.asm.OSDBA=asmdba \
        oracle.install.asm.OSOPER=asmoper \
        oracle.install.asm.OSASM=asmadmin \
        oracle.install.crs.config.scanType= \
        oracle.install.crs.config.SCANClientDataFile= \
        oracle.install.crs.config.gpnp.scanName=<span class="token variable">$V_RAC_CRS_SCANNAME</span> \
        oracle.install.crs.config.gpnp.scanPort=<span class="token variable">$V_RAC_CRS_SCANPORT</span> \
        oracle.install.crs.config.ClusterConfiguration=STANDALONE \
        oracle.install.crs.config.configureAsExtendedCluster= \
        oracle.install.crs.config.clusterName=<span class="token variable">$V_RAC_CRS_CLUSTER_NAME</span> \
        oracle.install.crs.config.gpnp.configureGNS= \
        oracle.install.crs.config.autoConfigureClusterNodeVIP=false \
        oracle.install.crs.config.gpnp.gnsOption= \
        oracle.install.crs.config.gpnp.gnsClientDataFile= \
        oracle.install.crs.config.gpnp.gnsSubDomain= \
        oracle.install.crs.config.gpnp.gnsVIPAddress= \
        oracle.install.crs.config.sites= \
        oracle.install.crs.config.clusterNodes=<span class="token variable">$V_RAC_CRS_CLUSTERNODES</span> \
        oracle.install.crs.config.networkInterfaceList=<span class="token variable">$V_RAC_CRS_NETWORKINTERFACES</span> \
        oracle.install.crs.config.storageOption= \
        oracle.install.crs.exascale.vault.name= \
        oracle.install.crs.config.sharedFileSystemStorage.votingDiskLocations= \
        oracle.install.crs.config.sharedFileSystemStorage.ocrLocations= \
        oracle.install.asm.ClientDataFile= \
        oracle.install.crs.config.useIPMI= \
        oracle.install.crs.config.ipmi.bmcBinpath= \
        oracle.install.crs.config.ipmi.bmcUsername= \
        oracle.install.crs.config.ipmi.bmcPassword= \
        oracle.install.asm.SYSASMPassword=<span class="token variable">$V_RAC_ASM_SYSASM_PASSWORD</span> \
        oracle.install.asm.diskGroup.name=<span class="token variable">$V_RAC_ASM_DISKGROUP_NAME</span> \
        oracle.install.asm.diskGroup.redundancy=<span class="token variable">$V_RAC_ASM_DISKGROUP_REDUNDANCY</span> \
        oracle.install.asm.diskGroup.AUSize=1 \
        oracle.install.asm.diskGroup.FailureGroups= \
        oracle.install.asm.diskGroup.disksWithFailureGroupNames= \
        oracle.install.asm.diskGroup.disks=<span class="token variable">$V_RAC_ASM_DISKGROUP_DISKS</span> \
        oracle.install.asm.diskGroup.quorumFailureGroupNames= \
        oracle.install.asm.diskGroup.diskDiscoveryString=<span class="token variable">$V_RAC_ASM_DISKGROUP_DISKDISCOVERY</span> \
        oracle.install.asm.monitorPassword=<span class="token variable">$V_RAC_ASM_MONITOR_PASSWORD</span> \
        oracle.install.asm.configureAFD= \
        oracle.install.crs.configureRHPS= \
        oracle.install.crs.config.ignoreDownNodes= \
        oracle.install.crs.configureGIMR= \
        oracle.install.crs.configureRemoteGIMR= \
        oracle.install.crs.RemoteGIMRCredFile= \
        oracle.install.asm.configureGIMRDataDG= \
        oracle.install.asm.gimrDG.name= \
        oracle.install.asm.gimrDG.redundancy= \
        oracle.install.asm.gimrDG.AUSize= \
        oracle.install.asm.gimrDG.FailureGroups= \
        oracle.install.asm.gimrDG.disksWithFailureGroupNames= \
        oracle.install.asm.gimrDG.disks= \
        oracle.install.asm.gimrDG.quorumFailureGroupNames= \
        oracle.install.config.managementOption= \
        oracle.install.config.omsHost= \
        oracle.install.config.omsPort= \
        oracle.install.config.emAdminUser= \
        oracle.install.config.emAdminPassword= \
        oracle.install.crs.rootconfig.executeRootScript= \
        oracle.install.crs.rootconfig.configMethod= \
        oracle.install.crs.rootconfig.sudoPath= \
        oracle.install.crs.rootconfig.sudoUserName= \
        oracle.install.crs.config.batchinfo= \
        oracle.install.crs.deleteNode.nodes= \
        &quot;</span>
        <span class="token assign-left variable">V_RAC_ORACLE_INSTALL_OPTION</span><span class="token operator">=</span><span class="token string">&quot;\
        oracle.install.responseFileVersion=/oracle/install/rspfmt_dbinstall_response_schema_v21.0.0 \
        oracle.install.option=INSTALL_DB_SWONLY \
        UNIX_GROUP_NAME=oinstall \
        INVENTORY_LOCATION=<span class="token variable">$V_RAC_ORACLE_ORA_INVENTORY</span> \
        ORACLE_HOME=<span class="token variable">$V_RAC_ORACLE_HOME</span> \
        ORACLE_BASE=<span class="token variable">$V_RAC_ORACLE_BASE</span> \
        oracle.install.db.InstallEdition=EE \
        oracle.install.db.OSDBA_GROUP=dba \
        oracle.install.db.OSOPER_GROUP=oper \
        oracle.install.db.OSBACKUPDBA_GROUP=backupdba \
        oracle.install.db.OSDGDBA_GROUP=dgdba \
        oracle.install.db.OSKMDBA_GROUP=kmdba \
        oracle.install.db.OSRACDBA_GROUP=racdba \
        oracle.install.db.rootconfig.executeRootScript= \
        oracle.install.db.rootconfig.configMethod= \
        oracle.install.db.rootconfig.sudoPath= \
        oracle.install.db.rootconfig.sudoUserName= \
        oracle.install.db.CLUSTER_NODES=<span class="token variable">$V_RAC_INSTANCE_CLUSTER_NODES</span> \
        oracle.install.db.config.starterdb.type= \
        oracle.install.db.config.starterdb.globalDBName= \
        oracle.install.db.config.starterdb.SID= \
        oracle.install.db.config.PDBName= \
        oracle.install.db.config.starterdb.characterSet= \
        oracle.install.db.config.starterdb.memoryOption= \
        oracle.install.db.config.starterdb.memoryLimit= \
        oracle.install.db.config.starterdb.password.ALL= \
        oracle.install.db.config.starterdb.password.SYS= \
        oracle.install.db.config.starterdb.password.SYSTEM= \
        oracle.install.db.config.starterdb.password.DBSNMP= \
        oracle.install.db.config.starterdb.password.PDBADMIN= \
        oracle.install.db.config.starterdb.managementOption= \
        oracle.install.db.config.starterdb.omsHost= \
        oracle.install.db.config.starterdb.omsPort= \
        oracle.install.db.config.starterdb.emAdminUser= \
        oracle.install.db.config.starterdb.emAdminPassword= \
        oracle.install.db.config.starterdb.enableRecovery= \
        oracle.install.db.config.starterdb.storageType= \
        oracle.install.db.config.starterdb.fileSystemStorage.dataLocation= \
        oracle.install.db.config.starterdb.fileSystemStorage.recoveryLocation= \
        oracle.install.db.config.asm.diskGroup= \
        oracle.install.db.config.asm.ASMSNMPPassword= \
        &quot;</span>
        <span class="token assign-left variable">V_RAC_ORACLE_DBCA_OPTION</span><span class="token operator">=</span><span class="token string">&quot;\
        -nodelist <span class="token variable">$V_RAC_INSTANCE_CLUSTER_NODES</span> \
        -gdbName <span class="token variable">$V_RAC_ORACLE_UNQNAME</span> \
        -sid <span class="token variable">$V_RAC_ORACLE_UNQNAME</span> \
        -characterSet <span class="token variable">$V_RAC_ORACLE_CHARSET</span> \
        -sysPassword <span class="token variable">$V_RAC_ORACLE_SYS_PASSWORD</span> \
        -systemPassword <span class="token variable">$V_RAC_ORACLE_SYSTEM_PASSWORD</span> \
        -asmsnmpPassword <span class="token variable">$V_RAC_ORACLE_MONITOR_PASSWORD</span> \
        -createAsContainerDatabase true \
        -numberOfPDBs 1 \
        -pdbName <span class="token variable">$V_RAC_ORACLE_PDB_NAME</span> \
        -pdbAdminPassword <span class="token variable">$V_RAC_ORACLE_PDB_ADMIN_PASSWORD</span> \
        -databaseType MULTIPURPOSE \
        -memoryMgmtType AUTO_SGA \
        -totalMemory <span class="token variable">$V_RAC_ORACLE_TOTAL_MEMORY</span> \
        -storageType ASM \
        -diskGroupName <span class="token variable">$V_RAC_ORACLE_DATA_DIR</span> \
        -recoveryGroupName <span class="token variable">$V_RAC_ORACLE_RECOVERY_AREA_DIR</span> \
        -datafileDestination <span class="token variable">$V_RAC_ORACLE_DATA_DIR</span> \
        -recoveryAreaDestination +<span class="token variable">$V_RAC_ORACLE_RECOVERY_AREA_DIR</span> \
        -redoLogFileSize <span class="token variable">$V_RAC_ORACLE_REDOLOG_SIZE</span> \
        -useLocalUndoForPDBs true \
        -databaseConfigType RAC \
        -emConfiguration NONE \
        -ignorePreReqs \
        &quot;</span>

        <span class="token function">cat</span> <span class="token operator">&gt;</span><span class="token variable">$V_RAC_ORACLE_DBCA_RESPONSE_FILE</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
        responseFileVersion=/oracle/assistants/rspfmt_dbca_response_schema_v21.0.0
        gdbName=
        sid=
        databaseConfigType=
        RACOneNodeServiceName=
        policyManaged=
        managementPolicy=
        createServerPool=
        serverPoolName=
        cardinality=
        force=
        pqPoolName=
        pqCardinality=
        createAsContainerDatabase=
        numberOfPDBs=
        pdbName=
        useLocalUndoForPDBs=
        pdbAdminPassword=
        nodelist=
        templateName=
        sysPassword=
        systemPassword= 
        oracleHomeUserPassword=
        emConfiguration=
        emExpressPort=5500
        runCVUChecks=
        dbsnmpPassword=
        omsHost=
        omsPort=
        emUser=
        emPassword=
        dvConfiguration=
        dvUserName=
        dvUserPassword=
        dvAccountManagerName=
        dvAccountManagerPassword=
        olsConfiguration=
        datafileJarLocation=
        datafileDestination=
        recoveryAreaDestination=
        storageType=
        diskGroupName=
        asmsnmpPassword=
        recoveryGroupName=
        characterSet=
        nationalCharacterSet=
        registerWithDirService=
        dirServiceUserName=
        dirServicePassword=
        walletPassword=
        listeners=
        variablesFile=
        variables=
        initParams=
        sampleSchema=
        memoryPercentage=
        databaseType=
        automaticMemoryManagement=
        totalMemory=
EOF</span>
    <span class="token keyword">else</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Not supported version!&quot;</span>
        <span class="token builtin class-name">exit</span> <span class="token number">1</span>
    <span class="token keyword">fi</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">DownloadOraclePackage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment"># wget detecting</span>
    <span class="token assign-left variable">has_wget</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">rpm</span> <span class="token parameter variable">-qa</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token function">wget</span><span class="token variable">)</span></span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$has_wget</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        yum <span class="token function">install</span> <span class="token parameter variable">-y</span> <span class="token function">wget</span>
    <span class="token keyword">fi</span>

    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-d</span> <span class="token string">&quot;<span class="token variable">$V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span>
    <span class="token keyword">fi</span>

    <span class="token comment"># package download url setting, multiple urls separated by space</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">11</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">package_urls</span><span class="token operator">=</span><span class="token string">&quot;ftp://10.10.12.158/pub/oracle/p13390677_112040_Linux-x86-64_1of7.zip 
        ftp://10.10.12.158/pub/oracle/p13390677_112040_Linux-x86-64_2of7.zip 
        ftp://10.10.12.158/pub/oracle/p13390677_112040_Linux-x86-64_3of7.zip
        ftp://10.10.12.158/pub/oracle/p18370031_112040_Linux-x86-64.zip&quot;</span>
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">12</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">package_urls</span><span class="token operator">=</span><span class="token string">&quot;ftp://10.10.12.158/pub/oracle/linuxx64_12201_database.zip ftp://10.10.12.158/pub/oracle/linuxx64_12201_grid_home.zip&quot;</span>
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">18</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">package_urls</span><span class="token operator">=</span><span class="token string">&quot;ftp://10.10.12.158/pub/oracle/LINUX.X64_180000_db_home.zip ftp://10.10.12.158/pub/oracle/LINUX.X64_180000_grid_home.zip&quot;</span>
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">19</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">package_urls</span><span class="token operator">=</span><span class="token string">&quot;ftp://10.10.12.158/pub/oracle/LINUX.X64_193000_db_home.zip ftp://10.10.12.158/pub/oracle/LINUX.X64_193000_grid_home.zip&quot;</span>
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">21</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">package_urls</span><span class="token operator">=</span><span class="token string">&quot;ftp://10.10.12.158/pub/oracle/LINUX.X64_213000_db_home.zip ftp://10.10.12.158/pub/oracle/LINUX.X64_213000_grid_home.zip&quot;</span>
    <span class="token keyword">else</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;The oracle version does not exists,contact dba to support!&quot;</span>
        <span class="token comment"># exit</span>
    <span class="token keyword">fi</span>

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Downloading oracle package ...&quot;</span>
    <span class="token function">wget</span> <span class="token parameter variable">-nc</span> <span class="token parameter variable">-P</span> <span class="token variable">$V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span> <span class="token variable">$package_urls</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">DownloadOracleASMLibPackage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment"># wget detecting</span>
    <span class="token assign-left variable">has_wget</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">rpm</span> <span class="token parameter variable">-qa</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token function">wget</span><span class="token variable">)</span></span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$has_wget</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        yum <span class="token function">install</span> <span class="token parameter variable">-y</span> <span class="token function">wget</span>
    <span class="token keyword">fi</span>

    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-d</span> <span class="token string">&quot;<span class="token variable">$V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span>
    <span class="token keyword">fi</span>

    <span class="token comment"># asmlib for el7</span>
    <span class="token assign-left variable">package_urls</span><span class="token operator">=</span><span class="token string">&quot;ftp://10.10.12.158/pub/oracle/oracleasm-support-2.1.11-2.el7.x86_64.rpm ftp://10.10.12.158/pub/oracle/oracleasmlib-2.0.12-1.el7.x86_64.rpm&quot;</span>

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Downloading asmlib package ...&quot;</span>
    <span class="token function">wget</span> <span class="token parameter variable">-P</span> <span class="token variable">$V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span> <span class="token variable">$package_urls</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">InstallDependency</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token assign-left variable">V_RAC_OS_PUBLIC_IP_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PUBLIC_IP</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_PUBLIC_VIP_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PUBLIC_VIP</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_PRIVATE_IP_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PRIVATE_IP</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_SCAN_IP_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_SCAN_IP</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_INSTANCE_ORACLE_SID_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_INSTANCE_ORACLE_SID</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_INSTANCE_GRID_ORACLE_SID_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_INSTANCE_GRID_ORACLE_SID</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_HOSTNAME_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_HOSTNAME</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_ROOT_PASSWORD_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_ROOT_PASSWORD</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span>
            <span class="token builtin class-name">declare</span> <span class="token parameter variable">-p</span> V_RAC_OS_PUBLIC_IP_ARR V_RAC_OS_PUBLIC_VIP_ARR V_RAC_OS_PRIVATE_IP_ARR V_RAC_OS_SCAN_IP_ARR V_RAC_OS_HOSTNAME_ARR V_RAC_ORACLE_UNQNAME
            <span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">&#39;SSHEOF&#39;
    echo &quot;3.Set hosts ...&quot;
    if [ ! -f &quot;/etc/hosts.orabak&quot; ];then
        cp /etc/hosts /etc/hosts.orabak
    fi
    echo &quot;# public ip&quot; &gt;&gt;/etc/hosts
    for item in ${!V_RAC_OS_PUBLIC_IP_ARR[@]}; do
        echo ${V_RAC_OS_PUBLIC_IP_ARR[item]}   ${V_RAC_OS_HOSTNAME_ARR[item]} &gt;&gt;/etc/hosts
    done

    echo &quot;# public vip&quot; &gt;&gt;/etc/hosts
    for item in ${!V_RAC_OS_PUBLIC_VIP_ARR[@]}; do
        echo ${V_RAC_OS_PUBLIC_VIP_ARR[item]}   ${V_RAC_OS_HOSTNAME_ARR[item]}-vip &gt;&gt;/etc/hosts
    done

    echo &quot;# private ip&quot; &gt;&gt;/etc/hosts
    for item in ${!V_RAC_OS_PRIVATE_IP_ARR[@]}; do
        echo ${V_RAC_OS_PRIVATE_IP_ARR[item]}   ${V_RAC_OS_HOSTNAME_ARR[item]}-priv &gt;&gt;/etc/hosts
    done

    echo &quot;# scan ip&quot; &gt;&gt;/etc/hosts
    for item in ${!V_RAC_OS_SCAN_IP_ARR[@]}; do
        echo ${V_RAC_OS_SCAN_IP_ARR[item]}   ${V_RAC_ORACLE_UNQNAME}-scan &gt;&gt;/etc/hosts
    done
SSHEOF</span>
        <span class="token punctuation">)</span>
    <span class="token keyword">done</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token assign-left variable">V_RAC_ORACLE_SID</span><span class="token operator">=</span><span class="token variable">${V_RAC_INSTANCE_ORACLE_SID_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>
        <span class="token assign-left variable">V_RAC_GRID_ORACLE_SID</span><span class="token operator">=</span><span class="token variable">${V_RAC_INSTANCE_GRID_ORACLE_SID_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
    echo &quot;0.Set locale ...&quot;
    echo LANG=&quot;en_US.UTF-8&quot; &gt;/etc/locale.conf
    localectl set-locale LANG=&quot;en_US.UTF-8&quot;
    export LANG=&quot;en_US.UTF-8&quot;

    echo &quot;1.Disable selinux and stop firewalld ...&quot;
    if [ ! -f &quot;/etc/selinux/config.orabak&quot; ];then
        cp /etc/selinux/config /etc/selinux/config.orabak
    fi
    sed -i &#39;s/^SELINUX=enforcing/SELINUX=disabled/g&#39; /etc/selinux/config
    setenforce 0
    systemctl stop firewalld
    systemctl disable firewalld

    echo &quot;2.Set hostname ...&quot;
    echo <span class="token variable">${V_RAC_OS_HOSTNAME_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> &gt;/etc/hostname
    hostnamectl set-hostname <span class="token variable">${V_RAC_OS_HOSTNAME_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>


    echo &quot;4.Set sysctl.conf ... &quot;
    if [ ! -f &quot;/etc/sysctl.conf.orabak&quot; ];then
        cp /etc/sysctl.conf /etc/sysctl.conf.orabak
    fi
    cat &gt; /etc/sysctl.d/97-oracle-database-sysctl.conf &lt;&lt;EOF
fs.file-max = 6815744
kernel.sem = 250 32000 100 128
kernel.shmmni = 4096
kernel.shmall = <span class="token variable">$V_RAC_OS_SHMALL</span> 
kernel.shmmax = <span class="token variable">$V_RAC_OS_SHMMAX</span>
kernel.panic_on_oops = 1
net.core.rmem_default = 262144
net.core.rmem_max = 4194304
net.core.wmem_default = 262144
net.core.wmem_max = 1048576
net.ipv4.conf.all.rp_filter = 2
net.ipv4.conf.default.rp_filter = 2
fs.aio-max-nr = 1048576
net.ipv4.ip_local_port_range = 9000 65500
EOF
    sysctl -p

    echo &quot;5.Set resource usage limitation ...&quot;
    if [ ! -f &quot;/etc/security/limits.conf.orabak&quot; ];then
        cp /etc/security/limits.conf /etc/security/limits.conf.orabak
    fi
    cat &gt;&gt; /etc/security/limits.conf &lt;&lt;EOF
<span class="token variable">$V_RAC_OS_ORACLE_USER</span>   soft   nofile    1024
<span class="token variable">$V_RAC_OS_ORACLE_USER</span>   hard   nofile    65536
<span class="token variable">$V_RAC_OS_ORACLE_USER</span>   soft   nproc    16384
<span class="token variable">$V_RAC_OS_ORACLE_USER</span>   hard   nproc    16384
<span class="token variable">$V_RAC_OS_ORACLE_USER</span>   soft   stack    10240
<span class="token variable">$V_RAC_OS_ORACLE_USER</span>   hard   stack    32768
<span class="token variable">$V_RAC_OS_ORACLE_USER</span>   hard   memlock    134217728
<span class="token variable">$V_RAC_OS_ORACLE_USER</span>   soft   memlock    134217728
<span class="token variable">$V_RAC_OS_GRID_USER</span>   soft   nofile    1024
<span class="token variable">$V_RAC_OS_GRID_USER</span>   hard   nofile    65536
<span class="token variable">$V_RAC_OS_GRID_USER</span>   soft   nproc    16384
<span class="token variable">$V_RAC_OS_GRID_USER</span>   hard   nproc    16384
<span class="token variable">$V_RAC_OS_GRID_USER</span>   soft   stack    10240
<span class="token variable">$V_RAC_OS_GRID_USER</span>   hard   stack    32768
<span class="token variable">$V_RAC_OS_GRID_USER</span>   hard   memlock    134217728
<span class="token variable">$V_RAC_OS_GRID_USER</span>   soft   memlock    134217728
EOF
    if [ ! -f &quot;/etc/pam.d/login.orabak&quot; ];then
        cp /etc/pam.d/login /etc/pam.d/login.orabak
    fi
    echo &quot;session   required    pam_limits.so&quot; &gt;&gt;/etc/pam.d/login

    echo &quot;6.Install dependencies ...&quot;
    yum install -y \
        bc binutils compat-libcap1 compat-libcap1-1.10-3.el7.x86_64 compat-libstdc++-33 \
        compat-libstdc++-33.i686 dtrace-utils elfutils-libelf elfutils-libelf-devel \
        elfutils-libelf-devel.i686 elfutils-libelf.i686 fontconfig-devel gcc gcc-c++ \
        glibc glibc-2.17-36.el7.i686 glibc-2.17-36.el7.x86_64 glibc-devel glibc-devel.i686 \
        glibc.i686 ksh libaio libaio-devel libaio-devel.i686 libaio.i686 libcap \
        libdtrace-ctf-devel libgcc libgcc.i686 librdmacm-devel libstdc++ libstdc++-devel \
        libstdc++-devel.i686 libstdc++.i686 libX11 libX11.i686 libXau libXau.i686 libxcb \
        libxcb.i686 libXext libXext.i686 libXi libXi.i686 libXrender libXrender-devel libXtst \
        libXtst.i686 make net-tools nfs-utils policycoreutils policycoreutils-python python \
        python-configshell python-rtslib python-six smartmontools sysstat targetcli unixODBC \
        unixODBC-devel unzip zlib-devel wget

    echo &quot;7.Add oracle groups and users ...&quot;
    groupadd -g 54321 oinstall
    groupadd -g 54322 dba
    groupadd -g 54323 oper
    groupadd -g 54324 backupdba
    groupadd -g 54325 dgdba
    groupadd -g 54326 kmdba
    groupadd -g 54327 asmdba
    groupadd -g 54328 asmoper
    groupadd -g 54329 asmadmin
    groupadd -g 54330 racdba
    useradd -m -u 54321 -g oinstall -G dba,oper,backupdba,dgdba,kmdba,asmdba,racdba <span class="token variable">$V_RAC_OS_ORACLE_USER</span>
    useradd -m -u 54322 -g oinstall -G asmadmin,asmdba,asmoper,dba,racdba,oper <span class="token variable">$V_RAC_OS_GRID_USER</span>
    echo <span class="token variable">$V_RAC_OS_ORACLE_USER_PASSWORD</span> | passwd --stdin <span class="token variable">$V_RAC_OS_ORACLE_USER</span>
    echo <span class="token variable">$V_RAC_OS_GRID_USER_PASSWORD</span> | passwd --stdin <span class="token variable">$V_RAC_OS_GRID_USER</span>

    echo &quot;8.Create directories ...&quot;
    mkdir -p <span class="token variable">$V_RAC_PACKAGE_DIR</span> <span class="token variable">$V_RAC_OS_DBA_DIR</span>
    mkdir -p <span class="token variable">$V_RAC_GRID_ORACLE_BASE</span> <span class="token variable">$V_RAC_GRID_ORACLE_HOME</span> <span class="token variable">$V_RAC_ORACLE_ORA_INVENTORY</span>
    mkdir -p <span class="token variable">$V_RAC_ORACLE_HOME</span>

    chown -R <span class="token variable">$V_RAC_OS_ORACLE_USER</span>:oinstall <span class="token variable">$V_RAC_PACKAGE_DIR</span> <span class="token variable">$V_RAC_OS_DBA_DIR</span>
    chown -R <span class="token variable">$V_RAC_OS_GRID_USER</span>:oinstall <span class="token variable">$V_RAC_GRID_APP_ROOTDIR</span> <span class="token variable">$V_RAC_ORACLE_APP_ROOTDIR</span> <span class="token variable">$V_RAC_GRID_ORACLE_BASE</span> <span class="token variable">$V_RAC_GRID_ORACLE_HOME</span> <span class="token variable">$V_RAC_ORACLE_ORA_INVENTORY</span>
    chown -R <span class="token variable">$V_RAC_OS_ORACLE_USER</span>:oinstall <span class="token variable">$V_RAC_ORACLE_BASE</span> <span class="token variable">$V_RAC_ORACLE_HOME</span>

    chmod -R 775 <span class="token variable">$V_RAC_PACKAGE_DIR</span> <span class="token variable">$V_RAC_OS_DBA_DIR</span> <span class="token variable">$V_RAC_GRID_APP_ROOTDIR</span> <span class="token variable">$V_RAC_ORACLE_APP_ROOTDIR</span> <span class="token variable">$V_RAC_ORACLE_ORA_INVENTORY</span>

    echo &quot;9.Set oracle env ...&quot;
    if [ ! -f &quot;/home/<span class="token variable">$V_RAC_OS_ORACLE_USER</span>/.bash_profile.orabak&quot; ];then
        cp /home/<span class="token variable">$V_RAC_OS_ORACLE_USER</span>/.bash_profile /home/<span class="token variable">$V_RAC_OS_ORACLE_USER</span>/.bash_profile.orabak
    fi
    cat &gt;&gt;/home/<span class="token variable">$V_RAC_OS_ORACLE_USER</span>/.bash_profile &lt;&lt;EOF
### Begin Oracle ENV ###
export TMP=<span class="token variable">$V_RAC_TMP</span>
export TMPDIR=<span class="token variable">$V_RAC_TMP</span>
export ORACLE_HOSTNAME=<span class="token variable">${V_RAC_OS_HOSTNAME_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>
export ORACLE_UNQNAME=<span class="token variable">$V_RAC_ORACLE_UNQNAME</span>
export ORACLE_SID=<span class="token variable">$V_RAC_ORACLE_SID</span>
export ORACLE_BASE=<span class="token variable">$V_RAC_ORACLE_BASE</span>
export ORACLE_HOME=<span class="token variable">$V_RAC_ORACLE_HOME</span>
export ORA_INVENTORY=<span class="token variable">$V_RAC_ORACLE_ORA_INVENTORY</span>
export LD_LIBRARY_PATH=\<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;$&quot;</span><span class="token variable">)</span></span>ORACLE_HOME/lib:/lib:/usr/lib
export CLASSPATH=\<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;$&quot;</span><span class="token variable">)</span></span>ORACLE_HOME/JRE:\<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;$&quot;</span><span class="token variable">)</span></span>ORACLE_HOME/jlib:\<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;$&quot;</span><span class="token variable">)</span></span>ORACLE_HOME/rdbms/jlib
export PATH=\<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;$&quot;</span><span class="token variable">)</span></span>ORACLE_HOME/bin:\<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;$&quot;</span><span class="token variable">)</span></span>PATH
### End Oracle Env ###
EOF
    if [ ! -f &quot;/home/<span class="token variable">$V_RAC_OS_GRID_USER</span>/.bash_profile.orabak&quot; ];then
        cp /home/<span class="token variable">$V_RAC_OS_GRID_USER</span>/.bash_profile /home/<span class="token variable">$V_RAC_OS_GRID_USER</span>/.bash_profile.orabak
    fi
    cat &gt;&gt;/home/<span class="token variable">$V_RAC_OS_GRID_USER</span>/.bash_profile &lt;&lt;EOF
### Begin Oracle Grid ENV ###
export TMP=<span class="token variable">$V_RAC_TMP</span>
export TMPDIR=<span class="token variable">$V_RAC_TMP</span>
export ORACLE_SID=<span class="token variable">$V_RAC_GRID_ORACLE_SID</span>
export ORACLE_BASE=<span class="token variable">$V_RAC_GRID_ORACLE_BASE</span>
export ORACLE_HOME=<span class="token variable">$V_RAC_GRID_ORACLE_HOME</span>
export ORA_INVENTORY=<span class="token variable">$V_RAC_ORACLE_ORA_INVENTORY</span>
export LD_LIBRARY_PATH=\<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;$&quot;</span><span class="token variable">)</span></span>ORACLE_HOME/lib:/lib:/usr/lib
export CLASSPATH=\<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;$&quot;</span><span class="token variable">)</span></span>ORACLE_HOME/JRE:\<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;$&quot;</span><span class="token variable">)</span></span>ORACLE_HOME/jlib:\<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;$&quot;</span><span class="token variable">)</span></span>ORACLE_HOME/rdbms/jlib
export PATH=\<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;$&quot;</span><span class="token variable">)</span></span>ORACLE_HOME/bin:\<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;$&quot;</span><span class="token variable">)</span></span>PATH
### End Oracle Grid Env ###
EOF

        su - <span class="token variable">$V_RAC_OS_ORACLE_USER</span> &lt;&lt;ORACLEEOF
ssh-keygen -t rsa -N &#39;&#39; -f ~/.ssh/id_rsa &lt;&lt;&lt; y
ORACLEEOF

su - <span class="token variable">$V_RAC_OS_GRID_USER</span> &lt;&lt;GRIDEOF
ssh-keygen -t rsa -N &#39;&#39; -f ~/.ssh/id_rsa &lt;&lt;&lt; y
GRIDEOF
SSHEOF</span>
    <span class="token keyword">done</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token assign-left variable">V_RAC_ORACLE_SID</span><span class="token operator">=</span><span class="token variable">${V_RAC_INSTANCE_ORACLE_SID_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>
        <span class="token assign-left variable">V_RAC_GRID_ORACLE_SID</span><span class="token operator">=</span><span class="token variable">${V_RAC_INSTANCE_GRID_ORACLE_SID_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>
        <span class="token variable">${V_RAC_OS_HOSTNAME_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span><span class="token operator">=</span><span class="token variable">${V_RAC_OS_HOSTNAME_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>

        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">$V_RAC_OS_ORACLE_USER_PASSWORD</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no <span class="token variable">$V_RAC_OS_ORACLE_USER</span>@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
            for otherhostip in <span class="token variable">$V_RAC_OS_PUBLIC_IP</span>; do
                sshpass -p &quot;<span class="token variable">$V_RAC_OS_ORACLE_USER_PASSWORD</span>&quot; ssh-copy-id -o StrictHostKeyChecking=no -i /home/<span class="token variable">$V_RAC_OS_ORACLE_USER</span>/.ssh/id_rsa.pub <span class="token variable">$V_RAC_OS_ORACLE_USER</span>@\<span class="token variable">$otherhostip</span>
            done

            for otherhostname in <span class="token variable">$V_RAC_OS_HOSTNAME</span>; do
                ssh -o StrictHostKeyChecking=no <span class="token variable">$V_RAC_OS_ORACLE_USER</span>@\<span class="token variable">$otherhostname</span>
            done
SSHEOF</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">$V_RAC_OS_GRID_USER_PASSWORD</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no <span class="token variable">$V_RAC_OS_GRID_USER</span>@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
            for otherhostip in <span class="token variable">$V_RAC_OS_PUBLIC_IP</span>; do
                sshpass -p &quot;<span class="token variable">$V_RAC_OS_GRID_USER_PASSWORD</span>&quot; ssh-copy-id -o StrictHostKeyChecking=no -i /home/<span class="token variable">$V_RAC_OS_GRID_USER</span>/.ssh/id_rsa.pub <span class="token variable">$V_RAC_OS_GRID_USER</span>@\<span class="token variable">$otherhostip</span>
            done

            for otherhostname in <span class="token variable">$V_RAC_OS_HOSTNAME</span>; do
                ssh -o StrictHostKeyChecking=no <span class="token variable">$V_RAC_OS_GRID_USER</span>@\<span class="token variable">$otherhostname</span>
            done
SSHEOF</span>
    <span class="token keyword">done</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">ConfigureASMOracleASMLib</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Configuring asm by ASMLib ...&quot;</span>
    <span class="token assign-left variable">V_RAC_OS_PUBLIC_IP_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PUBLIC_IP</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_ROOT_PASSWORD_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_ROOT_PASSWORD</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">scp</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no <span class="token variable">$V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span>/oracleasm*.rpm root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span><span class="token builtin class-name">:</span><span class="token variable">$V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span>/
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
    has_oracleasmsupport=<span class="token variable"><span class="token variable">$(</span><span class="token function">rpm</span> <span class="token parameter variable">-qa</span> <span class="token operator">|</span> <span class="token function">grep</span> oracleasm-support<span class="token variable">)</span></span>
    has_oracleasmlib=<span class="token variable"><span class="token variable">$(</span><span class="token function">rpm</span> <span class="token parameter variable">-qa</span> <span class="token operator">|</span> <span class="token function">grep</span> oracleasmlib<span class="token variable">)</span></span>

    if [ &quot;<span class="token variable">$has_oracleasmsupport</span>&quot; = &quot;&quot; ] || [ &quot;<span class="token variable">$has_oracleasmlib</span>&quot; = &quot;&quot; ]; then
        yum install -y <span class="token variable">$V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span>/oracleasm*.rpm
    fi
SSHEOF</span>
    <span class="token keyword">done</span>
    <span class="token comment"># fdisk</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">disk_item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_OCR_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;n<span class="token entity" title="\n">\n</span>p<span class="token entity" title="\n">\n</span>1<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>w&quot;</span> <span class="token operator">|</span> <span class="token function">fdisk</span> <span class="token variable">$disk_item</span>
    <span class="token keyword">done</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">disk_item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_DATA_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;n<span class="token entity" title="\n">\n</span>p<span class="token entity" title="\n">\n</span>1<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>w&quot;</span> <span class="token operator">|</span> <span class="token function">fdisk</span> <span class="token variable">$disk_item</span>
    <span class="token keyword">done</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">disk_item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_FRA_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;n<span class="token entity" title="\n">\n</span>p<span class="token entity" title="\n">\n</span>1<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>w&quot;</span> <span class="token operator">|</span> <span class="token function">fdisk</span> <span class="token variable">$disk_item</span>
    <span class="token keyword">done</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
    oracleasm configure -u <span class="token variable">$V_RAC_OS_GRID_USER</span> -g asmadmin -e -s y
    oracleasm init
SSHEOF</span>
    <span class="token keyword">done</span>
    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">disk_item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_OCR_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        oracleasm createdisk <span class="token variable">${V_RAC_ASM_OCR_ASMDISK_PREFFIX}</span><span class="token variable">${counter}</span> <span class="token variable">${disk_item}</span><span class="token number">1</span>
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>

    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">disk_item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_DATA_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        oracleasm createdisk <span class="token variable">${V_RAC_ASM_DATA_ASMDISK_PREFFIX}</span><span class="token variable">${counter}</span> <span class="token variable">${disk_item}</span><span class="token number">1</span>
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>

    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">disk_item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_FRA_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        oracleasm createdisk <span class="token variable">${V_RAC_ASM_FRA_ASMDISK_PREFFIX}</span><span class="token variable">${counter}</span> <span class="token variable">${disk_item}</span><span class="token number">1</span>
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
    oracleasm scandisks
    oracleasm listdisks
SSHEOF</span>
    <span class="token keyword">done</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">DeconfigureASMOracleASMLib</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Deconfiguring asm by ASMLib ...&quot;</span>
    <span class="token assign-left variable">V_RAC_OS_PUBLIC_IP_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PUBLIC_IP</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_ROOT_PASSWORD_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_ROOT_PASSWORD</span><span class="token punctuation">)</span>

    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">disk_item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_OCR_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        oracleasm deletedisk <span class="token variable">${V_RAC_ASM_OCR_ASMDISK_PREFFIX}</span><span class="token variable">${counter}</span>
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>

    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">disk_item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_DATA_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        oracleasm deletedisk <span class="token variable">${V_RAC_ASM_DATA_ASMDISK_PREFFIX}</span><span class="token variable">${counter}</span>
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>

    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">disk_item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_FRA_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        oracleasm deletedisk <span class="token variable">${V_RAC_ASM_FRA_ASMDISK_PREFFIX}</span><span class="token variable">${counter}</span>
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
    oracleasm scandisks
    oracleasm listdisks
SSHEOF</span>
    <span class="token keyword">done</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">ConfigureASMMultipath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Configuring ASM by multipath ...&quot;</span>
    <span class="token assign-left variable">V_RAC_OS_PUBLIC_IP_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PUBLIC_IP</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_ROOT_PASSWORD_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_ROOT_PASSWORD</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
        yum install -y device-mapper-multipath

        echo &quot;Adding multipath to kernel ...&quot;
        modprobe dm-multipath
        modprobe dm-round-robin

        /sbin/mpathconf  --enable
SSHEOF</span>
    <span class="token keyword">done</span>

    <span class="token assign-left variable">multipath_details</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">disk_item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_OCR_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token assign-left variable">multipath_details</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$multipath_details</span> <span class="token entity" title="\n">\n</span>multipath {<span class="token entity" title="\n">\n</span>   wwid    <span class="token variable"><span class="token variable">$(</span>/usr/lib/udev/scsi_id <span class="token parameter variable">-g</span> <span class="token parameter variable">-u</span> <span class="token parameter variable">-d</span> $disk_item<span class="token variable">)</span></span><span class="token entity" title="\n">\n</span>   alias   <span class="token variable">${V_RAC_ASM_OCR_ASMDISK_PREFFIX}</span><span class="token variable">$counter</span><span class="token entity" title="\n">\n</span>   path_grouping_policy    multibus<span class="token entity" title="\n">\n</span>   path_selector           <span class="token entity" title="\&quot;">\&quot;</span>round-robin 0<span class="token entity" title="\&quot;">\&quot;</span><span class="token entity" title="\n">\n</span>}&quot;</span>
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>

    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">disk_item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_DATA_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token assign-left variable">multipath_details</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$multipath_details</span> <span class="token entity" title="\n">\n</span>multipath {<span class="token entity" title="\n">\n</span>   wwid    <span class="token variable"><span class="token variable">$(</span>/usr/lib/udev/scsi_id <span class="token parameter variable">-g</span> <span class="token parameter variable">-u</span> <span class="token parameter variable">-d</span> $disk_item<span class="token variable">)</span></span><span class="token entity" title="\n">\n</span>   alias   <span class="token variable">${V_RAC_ASM_DATA_ASMDISK_PREFFIX}</span><span class="token variable">$counter</span><span class="token entity" title="\n">\n</span>   path_grouping_policy    multibus<span class="token entity" title="\n">\n</span>   path_selector           <span class="token entity" title="\&quot;">\&quot;</span>round-robin 0<span class="token entity" title="\&quot;">\&quot;</span><span class="token entity" title="\n">\n</span>}&quot;</span>
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>

    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">disk_item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_FRA_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token assign-left variable">multipath_details</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$multipath_details</span> <span class="token entity" title="\n">\n</span>multipath {<span class="token entity" title="\n">\n</span>   wwid    <span class="token variable"><span class="token variable">$(</span>/usr/lib/udev/scsi_id <span class="token parameter variable">-g</span> <span class="token parameter variable">-u</span> <span class="token parameter variable">-d</span> $disk_item<span class="token variable">)</span></span><span class="token entity" title="\n">\n</span>   alias   <span class="token variable">${V_RAC_ASM_FRA_ASMDISK_PREFFIX}</span><span class="token variable">$counter</span><span class="token entity" title="\n">\n</span>   path_grouping_policy    multibus<span class="token entity" title="\n">\n</span>   path_selector           <span class="token entity" title="\&quot;">\&quot;</span>round-robin 0<span class="token entity" title="\&quot;">\&quot;</span><span class="token entity" title="\n">\n</span>}&quot;</span>
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>

    <span class="token function">cat</span> <span class="token operator">&gt;</span>/etc/multipath.conf <span class="token operator">&lt;&lt;</span><span class="token string">CONFEOF
# multipath.
#
# For a complete list of the default configuration values, run either
# multipath -t
# or
# multipathd show config

defaults {
    user_friendly_names yes
    find_multipaths yes
}

blacklist {
    devnode &quot;^sd[a-b]&quot;
}
multipaths {
    <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> $multipath_details<span class="token variable">)</span></span>
}
CONFEOF</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">scp</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no /etc/multipath.conf root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>:/etc/multipath.conf
    <span class="token keyword">done</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
        echo &quot;Enabling multipath ...&quot;
        for item in <span class="token variable">$V_RAC_ASM_OCR_DISKS</span> <span class="token variable">$V_RAC_ASM_DATA_DISKS</span> <span class="token variable">$V_RAC_ASM_FRA_DISKS</span>; do
            echo \<span class="token variable">$item</span>
            multipath -a \<span class="token variable">$item</span>
        done 
        multipath -F
        multipath -v2
        multipath -ll
        systemctl enable multipathd.service
        systemctl restart multipathd.service
SSHEOF</span>
    <span class="token keyword">done</span>

    <span class="token function">cat</span> <span class="token operator">&gt;</span>/etc/udev/rules.d/99-oracle-asmdevices.rules <span class="token operator">&lt;&lt;</span><span class="token string">EOF
KERNEL==&quot;dm-[4-9]&quot;,OWNER=&quot;grid&quot;,GROUP=&quot;asmadmin&quot;,MODE=&quot;660&quot;
EOF</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">scp</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no /etc/udev/rules.d/99-oracle-asmdevices.rules root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>:/etc/udev/rules.d/99-oracle-asmdevices.rules
    <span class="token keyword">done</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
        udevadm control --reload
        udevadm trigger
SSHEOF</span>
    <span class="token keyword">done</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">DeconfigureASMMultipath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Deconfiguring ASM by multipath ...&quot;</span>
    <span class="token assign-left variable">V_RAC_OS_PUBLIC_IP_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PUBLIC_IP</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_ROOT_PASSWORD_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_ROOT_PASSWORD</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
        echo &quot;Disabling multipath ...&quot;
        for item in <span class="token variable">$V_RAC_ASM_OCR_DISKS</span> <span class="token variable">$V_RAC_ASM_DATA_DISKS</span> <span class="token variable">$V_RAC_ASM_FRA_DISKS</span>; do
            multipath -w \<span class="token variable">$item</span>
        done 
        rm -f /etc/multipath.conf
        multipath -F
        multipath -v2
        multipath -ll
        systemctl diable multipathd.service
        systemctl stop multipathd.service
SSHEOF</span>
    <span class="token keyword">done</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">ConfigureASMUDEV</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Configuring ASM by UDEV ...&quot;</span>
    <span class="token assign-left variable">V_RAC_OS_PUBLIC_IP_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PUBLIC_IP</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_ROOT_PASSWORD_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_ROOT_PASSWORD</span><span class="token punctuation">)</span>

    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_OCR_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;KERNEL==<span class="token entity" title="\&quot;">\&quot;</span>sd*<span class="token entity" title="\&quot;">\&quot;</span>,SUBSYSTEM==<span class="token entity" title="\&quot;">\&quot;</span>block<span class="token entity" title="\&quot;">\&quot;</span>,PROGRAM==<span class="token entity" title="\&quot;">\&quot;</span>/usr/lib/udev/scsi_id -g -u -d /dev/\<span class="token variable">$name</span><span class="token entity" title="\&quot;">\&quot;</span>,RESULT==<span class="token entity" title="\&quot;">\&quot;</span><span class="token variable"><span class="token variable">$(</span>/usr/lib/udev/scsi_id <span class="token parameter variable">-g</span> <span class="token parameter variable">-u</span> <span class="token parameter variable">-d</span> $item<span class="token variable">)</span></span><span class="token entity" title="\&quot;">\&quot;</span>,SYMLINK+=<span class="token entity" title="\&quot;">\&quot;</span><span class="token variable">${V_RAC_ASM_OCR_ASMDISK_PREFFIX}</span><span class="token variable">$counter</span><span class="token entity" title="\&quot;">\&quot;</span>,OWNER=<span class="token entity" title="\&quot;">\&quot;</span>grid<span class="token entity" title="\&quot;">\&quot;</span>,GROUP=<span class="token entity" title="\&quot;">\&quot;</span>asmadmin<span class="token entity" title="\&quot;">\&quot;</span>,MODE=<span class="token entity" title="\&quot;">\&quot;</span>0660<span class="token entity" title="\&quot;">\&quot;</span>&quot;</span> <span class="token operator">&gt;&gt;</span>/etc/udev/rules.d/99-oracle-asmdevices.rules
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>

    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_DATA_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;KERNEL==<span class="token entity" title="\&quot;">\&quot;</span>sd*<span class="token entity" title="\&quot;">\&quot;</span>,SUBSYSTEM==<span class="token entity" title="\&quot;">\&quot;</span>block<span class="token entity" title="\&quot;">\&quot;</span>,PROGRAM==<span class="token entity" title="\&quot;">\&quot;</span>/usr/lib/udev/scsi_id -g -u -d /dev/\<span class="token variable">$name</span><span class="token entity" title="\&quot;">\&quot;</span>,RESULT==<span class="token entity" title="\&quot;">\&quot;</span><span class="token variable"><span class="token variable">$(</span>/usr/lib/udev/scsi_id <span class="token parameter variable">-g</span> <span class="token parameter variable">-u</span> <span class="token parameter variable">-d</span> $item<span class="token variable">)</span></span><span class="token entity" title="\&quot;">\&quot;</span>,SYMLINK+=<span class="token entity" title="\&quot;">\&quot;</span><span class="token variable">${V_RAC_ASM_DATA_ASMDISK_PREFFIX}</span><span class="token variable">$counter</span><span class="token entity" title="\&quot;">\&quot;</span>,OWNER=<span class="token entity" title="\&quot;">\&quot;</span>grid<span class="token entity" title="\&quot;">\&quot;</span>,GROUP=<span class="token entity" title="\&quot;">\&quot;</span>asmadmin<span class="token entity" title="\&quot;">\&quot;</span>,MODE=<span class="token entity" title="\&quot;">\&quot;</span>0660<span class="token entity" title="\&quot;">\&quot;</span>&quot;</span> <span class="token operator">&gt;&gt;</span>/etc/udev/rules.d/99-oracle-asmdevices.rules
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>

    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_FRA_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;KERNEL==<span class="token entity" title="\&quot;">\&quot;</span>sd*<span class="token entity" title="\&quot;">\&quot;</span>,SUBSYSTEM==<span class="token entity" title="\&quot;">\&quot;</span>block<span class="token entity" title="\&quot;">\&quot;</span>,PROGRAM==<span class="token entity" title="\&quot;">\&quot;</span>/usr/lib/udev/scsi_id -g -u -d /dev/\<span class="token variable">$name</span><span class="token entity" title="\&quot;">\&quot;</span>,RESULT==<span class="token entity" title="\&quot;">\&quot;</span><span class="token variable"><span class="token variable">$(</span>/usr/lib/udev/scsi_id <span class="token parameter variable">-g</span> <span class="token parameter variable">-u</span> <span class="token parameter variable">-d</span> $item<span class="token variable">)</span></span><span class="token entity" title="\&quot;">\&quot;</span>,SYMLINK+=<span class="token entity" title="\&quot;">\&quot;</span><span class="token variable">${V_RAC_ASM_FRA_ASMDISK_PREFFIX}</span><span class="token variable">$counter</span><span class="token entity" title="\&quot;">\&quot;</span>,OWNER=<span class="token entity" title="\&quot;">\&quot;</span>grid<span class="token entity" title="\&quot;">\&quot;</span>,GROUP=<span class="token entity" title="\&quot;">\&quot;</span>asmadmin<span class="token entity" title="\&quot;">\&quot;</span>,MODE=<span class="token entity" title="\&quot;">\&quot;</span>0660<span class="token entity" title="\&quot;">\&quot;</span>&quot;</span> <span class="token operator">&gt;&gt;</span>/etc/udev/rules.d/99-oracle-asmdevices.rules
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">scp</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no /etc/udev/rules.d/99-oracle-asmdevices.rules root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>:/etc/udev/rules.d/99-oracle-asmdevices.rules
    <span class="token keyword">done</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
        udevadm control --reload
        udevadm trigger
SSHEOF</span>
    <span class="token keyword">done</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">DeconfigureASMUDEV</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;deconfiguring ASM by UDEV ...&quot;</span>
    <span class="token assign-left variable">V_RAC_OS_PUBLIC_IP_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PUBLIC_IP</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_ROOT_PASSWORD_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_ROOT_PASSWORD</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
        rm -f /etc/udev/rules.d/99-oracle-asmdevices.rules
        udevadm control --reload
        udevadm trigger
SSHEOF</span>
    <span class="token keyword">done</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">ConfigureASMNFS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Configuring ASM by NFS ...&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Configuring NFS Server ...&quot;</span>

    <span class="token assign-left variable">V_RAC_OS_PUBLIC_IP_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PUBLIC_IP</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_ROOT_PASSWORD_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_ROOT_PASSWORD</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_NFS_SERVER_IP</span><span class="token operator">=</span><span class="token string">&quot;10.10.12.214&quot;</span>
    <span class="token assign-left variable">V_RAC_OS_NFS_SERVER_OS_USER</span><span class="token operator">=</span><span class="token string">&quot;root&quot;</span>
    <span class="token assign-left variable">V_RAC_OS_NFS_SERVER_OS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;root@123&quot;</span>
    <span class="token assign-left variable">V_RAC_OS_NFS_SERVER_MOUNT</span><span class="token operator">=</span>/data/oracleasm
    <span class="token assign-left variable">V_RAC_OS_NFS_CLIENT_MOUNT</span><span class="token operator">=</span>/data/oracleasm

    sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">$V_RAC_OS_NFS_SERVER_OS_PASSWORD</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">$V_RAC_OS_NFS_SERVER_IP</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
        yum install -y nfs-utils rpcbind

        mkdir -p <span class="token variable">$V_RAC_OS_NFS_SERVER_MOUNT</span>

        cat &gt; /etc/exports &lt;&lt;NFSEOF
<span class="token variable">$V_RAC_OS_NFS_SERVER_MOUNT</span> *(rw,sync,no_wdelay,insecure,no_root_squash)
NFSEOF

systemctl enable nfs
systemctl restart nfs

showmount -e <span class="token variable">$V_RAC_OS_NFS_SERVER_IP</span>

SSHEOF</span>

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Cofiguring NFS Client on every RAC nodes ...&quot;</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
        yum install -y nfs-utils rpcbind
        mkdir -p <span class="token variable">$V_RAC_OS_NFS_CLIENT_MOUNT</span>
        cp /etc/fstab /etc/fstab.orabak
        cat &gt;&gt; /etc/fstab &lt;&lt;NFSEOF
<span class="token variable">$V_RAC_OS_NFS_SERVER_IP</span>:<span class="token variable">$V_RAC_OS_NFS_SERVER_MOUNT</span>   <span class="token variable">$V_RAC_OS_NFS_CLIENT_MOUNT</span>  nfs  rw,bg,hard,nointr,tcp,vers=3,timeo=600,rsize=32768,wsize=32768,actimeo=0  0 0
NFSEOF
        mount <span class="token variable">$V_RAC_OS_NFS_CLIENT_MOUNT</span>
SSHEOF</span>
    <span class="token keyword">done</span>

    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_OCR_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token function">dd</span> <span class="token assign-left variable">if</span><span class="token operator">=</span>/dev/zero <span class="token assign-left variable">of</span><span class="token operator">=</span><span class="token variable">$V_RAC_OS_NFS_CLIENT_MOUNT</span>/<span class="token variable">${V_RAC_ASM_OCR_ASMDISK_PREFFIX}</span><span class="token variable">$counter</span> <span class="token assign-left variable">bs</span><span class="token operator">=</span>1k <span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token number">10000000</span>
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>

    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_DATA_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token function">dd</span> <span class="token assign-left variable">if</span><span class="token operator">=</span>/dev/zero <span class="token assign-left variable">of</span><span class="token operator">=</span><span class="token variable">$V_RAC_OS_NFS_CLIENT_MOUNT</span>/<span class="token variable">${V_RAC_ASM_DATA_ASMDISK_PREFFIX}</span><span class="token variable">$counter</span> <span class="token assign-left variable">bs</span><span class="token operator">=</span>1k <span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token number">20000000</span>
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>

    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_FRA_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token function">dd</span> <span class="token assign-left variable">if</span><span class="token operator">=</span>/dev/zero <span class="token assign-left variable">of</span><span class="token operator">=</span><span class="token variable">$V_RAC_OS_NFS_CLIENT_MOUNT</span>/<span class="token variable">${V_RAC_ASM_FRA_ASMDISK_PREFFIX}</span><span class="token variable">$counter</span> <span class="token assign-left variable">bs</span><span class="token operator">=</span>1k <span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token number">20000000</span>
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>

    <span class="token function">chown</span> <span class="token parameter variable">-R</span> grid:asmadmin <span class="token variable">$V_RAC_OS_NFS_CLIENT_MOUNT</span>/<span class="token variable">${V_RAC_ASM_OCR_ASMDISK_PREFFIX}</span>*
    <span class="token function">chown</span> <span class="token parameter variable">-R</span> grid:asmadmin <span class="token variable">$V_RAC_OS_NFS_CLIENT_MOUNT</span>/<span class="token variable">${V_RAC_ASM_DATA_ASMDISK_PREFFIX}</span>*
    <span class="token function">chown</span> <span class="token parameter variable">-R</span> grid:asmadmin <span class="token variable">$V_RAC_OS_NFS_CLIENT_MOUNT</span>/<span class="token variable">${V_RAC_ASM_FRA_ASMDISK_PREFFIX}</span>*
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">DeconfigureASMNFS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Deconfiguring ASM by NFS ...&quot;</span>
    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_OCR_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token function">rm</span> <span class="token parameter variable">-f</span> <span class="token variable">$V_RAC_OS_NFS_CLIENT_MOUNT</span>/<span class="token variable">${V_RAC_ASM_OCR_ASMDISK_PREFFIX}</span><span class="token variable">$counter</span>
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>

    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_DATA_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token function">rm</span> <span class="token parameter variable">-f</span> <span class="token variable">$V_RAC_OS_NFS_CLIENT_MOUNT</span>/<span class="token variable">${V_RAC_ASM_DATA_ASMDISK_PREFFIX}</span><span class="token variable">$counter</span>
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>

    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_FRA_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token function">rm</span> <span class="token parameter variable">-f</span> <span class="token variable">$V_RAC_OS_NFS_CLIENT_MOUNT</span>/<span class="token variable">${V_RAC_ASM_FRA_ASMDISK_PREFFIX}</span><span class="token variable">$counter</span>
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">ConfigureASMISCSI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Configuring ASM by ISCSI ...&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Configuring ISCSI Server ...&quot;</span>
    <span class="token assign-left variable">V_RAC_OS_PUBLIC_IP_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PUBLIC_IP</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_ROOT_PASSWORD_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_ROOT_PASSWORD</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_ISCSI_SERVER_IP</span><span class="token operator">=</span><span class="token string">&quot;10.10.12.214&quot;</span>
    <span class="token assign-left variable">V_RAC_OS_ISCSI_SERVER_ALLOW_IPNET</span><span class="token operator">=</span><span class="token string">&quot;10.10.12.0&quot;</span>
    <span class="token assign-left variable">V_RAC_OS_ISCSI_SERVER_ALLOW_NETMASK</span><span class="token operator">=</span><span class="token number">24</span>
    <span class="token assign-left variable">V_RAC_OS_ISCSI_SERVER_OS_USER</span><span class="token operator">=</span><span class="token string">&quot;root&quot;</span>
    <span class="token assign-left variable">V_RAC_OS_ISCSI_SERVER_OS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;root@123&quot;</span>
    <span class="token assign-left variable">V_RAC_OS_ISCSI_SERVER_DISKS</span><span class="token operator">=</span><span class="token string">&quot;/dev/sdc /dev/sdd /dev/sde /dev/sdf /dev/sdg&quot;</span>
    <span class="token assign-left variable">V_RAC_OS_ISCSI_SERVER_MOUNT</span><span class="token operator">=</span>/data/oracleasm
    <span class="token assign-left variable">V_RAC_OS_ISCSI_CLIENT_MOUNT</span><span class="token operator">=</span>/data/oracleasm
    <span class="token assign-left variable">V_RAC_OS_ISCSI_SERVER_MOUNT_IQN</span><span class="token operator">=</span><span class="token string">&quot;iqn.abelit.com.oracle:rac&quot;</span>

    <span class="token assign-left variable">target_disks</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_OS_ISCSI_SERVER_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token assign-left variable">target_disks</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$target_disks</span> <span class="token entity" title="\n">\n</span>backing-store   <span class="token variable">$item</span><span class="token entity" title="\n">\n</span>&quot;</span>
    <span class="token keyword">done</span>

    sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">$V_RAC_OS_ISCSI_SERVER_OS_PASSWORD</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">$V_RAC_OS_ISCSI_SERVER_IP</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
        yum install -y epel-release
        yum install -y targetcli scsi-target-utils libxslt
        systemctl enable target.service
        systemctl enable tgtd.service

        cat &gt;&gt; /etc/tgt/targets.conf &lt;&lt;EOF
&lt;target <span class="token variable">$V_RAC_OS_ISCSI_SERVER_MOUNT_IQN</span>&gt;
    <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> $target_disks<span class="token variable">)</span></span> 
    initiator-address <span class="token variable">$V_RAC_OS_ISCSI_SERVER_ALLOW_IPNET</span>/<span class="token variable">$V_RAC_OS_ISCSI_SERVER_ALLOW_NETMASK</span>
    write-cache off
&lt;/target&gt;
EOF

    tgtadm --lld iscsi --mode target --op show
    systemctl restart target.service
    systemctl restart tgtd.service
SSHEOF</span>

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Configuring iscsi client ...&quot;</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
        yum install -y iscsi-initiator-utils
        systemctl restart iscsid.service

        echo &quot;InitiatorName=<span class="token variable">$V_RAC_OS_ISCSI_SERVER_MOUNT_IQN</span>&quot; &gt;&gt; /etc/iscsi/initiatorname.iscsi

        systemctl enable iscsi.service
        systemctl restart iscsi.service

        iscsiadm -m discovery -tsendtargets -p <span class="token variable">$V_RAC_OS_ISCSI_SERVER_IP</span>:3260
        iscsiadm -m node -T discovery -T <span class="token variable">$V_RAC_OS_ISCSI_SERVER_MOUNT_IQN</span> -p <span class="token variable">$V_RAC_OS_ISCSI_SERVER_IP</span>:3260

        iscsiadm -m node -T <span class="token variable">$V_RAC_OS_ISCSI_SERVER_MOUNT_IQN</span> -p <span class="token variable">$V_RAC_OS_ISCSI_SERVER_IP</span>:3260 -l
        partprobe
        fdisk -l
SSHEOF</span>
    <span class="token keyword">done</span>

<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">ConfigASMDisks</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$V_RAC_ABELIT_ASM_TYPE</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;asmlib&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        DownloadOracleASMLibPackage
        ConfigureASMOracleASMLib
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$V_RAC_ABELIT_ASM_TYPE</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;asmmultipath&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        ConfigureASMMultipath
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$V_RAC_ABELIT_ASM_TYPE</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;asmudev&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        ConfigureASMUDEV
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$V_RAC_ABELIT_ASM_TYPE</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;asmnfs&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        ConfigureASMNFS
    <span class="token keyword">else</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;The specified asm storage type does not exist.&quot;</span>
        <span class="token builtin class-name">exit</span> <span class="token number">1</span>
    <span class="token keyword">fi</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">DeconfigASMDisks</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$V_RAC_ABELIT_ASM_TYPE</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;asmlib&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        DeconfigureASMOracleASMLib
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$V_RAC_ABELIT_ASM_TYPE</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;asmmultipath&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        DeconfigureASMMultipath
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$V_RAC_ABELIT_ASM_TYPE</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;asmudev&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        DeconfigureASMUDEV
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$V_RAC_ABELIT_ASM_TYPE</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;asmnfs&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        DeconfigureASMNFS
    <span class="token keyword">else</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;The specified asm storage type does not exist.&quot;</span>
        <span class="token builtin class-name">exit</span> <span class="token number">1</span>
    <span class="token keyword">fi</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">CheckNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">su</span> - <span class="token variable">$V_RAC_OS_GRID_USER</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
    <span class="token variable">$V_RAC_PACKAGE_GRID_INSTALLER</span>/runcluvfy.sh stage -pre crsinst -n <span class="token variable">$V_RAC_INSTANCE_CLUSTER_NODES</span> -verbose
EOF</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">ExtractPackage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Unzipping grid software (on one node) ...&quot;</span>
    <span class="token function">su</span> - <span class="token variable">$V_RAC_OS_GRID_USER</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
    for zipfile in <span class="token variable">$V_RAC_PACKAGE_GRID_FILES</span>; do
        unzip -oqn -d <span class="token variable">$V_RAC_PACKAGE_GRID_TARGET</span> <span class="token variable">$V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span>/\<span class="token variable">$zipfile</span>
    done
EOF</span>
    <span class="token function">su</span> - <span class="token variable">$V_RAC_OS_ORACLE_USER</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
    for zipfile in <span class="token variable">$V_RAC_PACKAGE_DATABASE_FILES</span>; do
        unzip -oqn -d <span class="token variable">$V_RAC_PACKAGE_DATABASE_TARGET</span> <span class="token variable">$V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span>/\<span class="token variable">$zipfile</span>
    done
EOF</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">InstallBasePackage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token assign-left variable">V_RAC_OS_PUBLIC_IP_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PUBLIC_IP</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_ROOT_PASSWORD_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_ROOT_PASSWORD</span><span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installing cvuqdisk ...&quot;</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">scp</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no <span class="token variable">$V_RAC_PACKAGE_GRID_INSTALLER_RPM</span>/cvuqdisk*.rpm root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span><span class="token builtin class-name">:</span><span class="token variable">$V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span>/
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
            yum install -y <span class="token variable">$V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span>/cvuqdisk*.rpm
SSHEOF</span>
    <span class="token keyword">done</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">InstallGridSoftware</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token assign-left variable">V_RAC_OS_PUBLIC_IP_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PUBLIC_IP</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_ROOT_PASSWORD_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_ROOT_PASSWORD</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_HOSTNAME_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_HOSTNAME</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_CURRENT_HOSTNAME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">hostname</span><span class="token variable">)</span></span>

    <span class="token comment">#     echo &quot;Installing cvuqisk package to discovery shared disks for cluster  (on all node) ...&quot;</span>
    <span class="token comment">#     for hostip in ${!V_RAC_OS_PUBLIC_IP_ARR[@]}; do</span>
    <span class="token comment">#         sshpass -p &quot;${V_RAC_OS_ROOT_PASSWORD_ARR[$hostip]}&quot; scp -o StrictHostKeyChecking=no $V_RAC_PACKAGE_GRID_INSTALLER/rpm/cvuqdisk*.rpm root@${V_RAC_OS_PUBLIC_IP_ARR[$hostip]}:$V_RAC_PACKAGE_ORACLE_ALL_SOURCE/</span>
    <span class="token comment">#         sshpass -p &quot;${V_RAC_OS_ROOT_PASSWORD_ARR[$hostip]}&quot; ssh -o StrictHostKeyChecking=no root@${V_RAC_OS_PUBLIC_IP_ARR[$hostip]} bash &lt;&lt;SSHEOF</span>
    <span class="token comment">#         yum install -y $V_RAC_PACKAGE_ORACLE_ALL_SOURCE/cvuqdisk*.rpm</span>
    <span class="token comment"># SSHEOF</span>
    <span class="token comment">#     done</span>

    <span class="token function">su</span> - <span class="token variable">$V_RAC_OS_GRID_USER</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
    echo &quot;Saving grid installation response file to <span class="token variable">$V_RAC_OS_DBA_DIR</span>/grid_install-<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +<span class="token string">&#39;%Y%m%d&#39;</span><span class="token variable">)</span></span>.rsp (on one node) ...&quot;
    echo &quot;<span class="token variable">$V_RAC_GRID_INSTALL_OPTION</span>&quot; &gt; <span class="token variable">$V_RAC_OS_DBA_DIR</span>/grid_install-<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +<span class="token string">&#39;%Y%m%d&#39;</span><span class="token variable">)</span></span>.rsp
    echo &quot;Installing grid software (on one node) ...&quot;
    <span class="token variable">$V_RAC_PACKAGE_GRID_INSTALLER_EXE</span> <span class="token variable">$V_RAC_GRID_INSTALL_OPTION</span>
EOF</span>
    <span class="token comment"># apply clusterware patch in rac 11g installation in RHEL 7.x+</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">11</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
            sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">scp</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no <span class="token variable">$V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span>/p18370031_112040_Linux-x86-64.zip root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span><span class="token builtin class-name">:</span><span class="token variable">$V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span>/
            sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
        unzip -oqn -d <span class="token variable">$V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span> <span class="token variable">$V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span>/p18370031_112040_Linux-x86-64.zip
        chown -R <span class="token variable">$V_RAC_OS_GRID_USER</span>:oinstall <span class="token variable">$V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span>/18370031
        su - <span class="token variable">$V_RAC_OS_GRID_USER</span> &lt;&lt;EOF 
        <span class="token variable">$V_RAC_GRID_ORACLE_HOME</span>/OPatch/opatch napply -oh <span class="token variable">$V_RAC_GRID_ORACLE_HOME</span> -local <span class="token variable">$V_RAC_PACKAGE_ORACLE_ALL_SOURCE</span>/18370031 -silent
EOF
SSHEOF</span>
        <span class="token keyword">done</span>
    <span class="token keyword">fi</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
            echo &quot;Executing &#39;<span class="token variable">${V_RAC_ORACLE_ORA_INVENTORY}</span>/orainstRoot.sh&#39; and &#39;<span class="token variable">${V_RAC_GRID_ORACLE_HOME}</span>/root.sh&#39; as root  (on all node by order) ...&quot;
            <span class="token variable">${V_RAC_ORACLE_ORA_INVENTORY}</span>/orainstRoot.sh
            <span class="token variable">${V_RAC_GRID_ORACLE_HOME}</span>/root.sh
SSHEOF</span>
    <span class="token keyword">done</span>
    <span class="token function">su</span> - <span class="token variable">$V_RAC_OS_GRID_USER</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
    <span class="token variable">$V_RAC_PACKAGE_GRID_INSTALLER_CONFIG</span>
EOF</span>

    <span class="token function">su</span> - <span class="token variable">$V_RAC_OS_GRID_USER</span> <span class="token operator">&lt;&lt;</span><span class="token string">&#39;EOF&#39;
    echo &quot;Query asm disk group ....&quot;
    sqlplus / as sysasm &lt;&lt;&#39;SQLEOF&#39;
    set linesize 200
    col path format a30
    select inst_id,group_number,name,total_mb from gv$asm_diskgroup;
    select a.path,a.name,a.mode_status,b.name diskgroupname,b.type from v$asm_disk a,v$asm_diskgroup b where a.group_number=b.group_number;
    select inst_id,group_number,name,path from gv$asm_disk;
SQLEOF
EOF</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">GetRACInformation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">su</span> - <span class="token variable">$V_RAC_OS_GRID_USER</span> <span class="token operator">&lt;&lt;</span><span class="token string">&#39;EOF&#39;
    echo &quot;Getting RAC Information ...&quot;
    crsctl check cluster -all
    crsctl status resource -t 

    echo &quot;Getting asm disk group ....&quot;
    sqlplus / as sysasm &lt;&lt;&#39;SQLEOF&#39;
    set linesize 200
    col path format a30
    select inst_id,group_number,name,total_mb from gv$asm_diskgroup;
    select a.path,a.name,a.mode_status,b.name diskgroupname,b.type from v$asm_disk a,v$asm_diskgroup b where a.group_number=b.group_number;
    select inst_id,group_number,name,path from gv$asm_disk;
SQLEOF
EOF</span>

    <span class="token function">su</span> - <span class="token variable">$V_RAC_OS_ORACLE_USER</span> <span class="token operator">&lt;&lt;</span><span class="token string">&#39;EOF&#39;
    echo &quot;Getting Database and Instance ....&quot;
    sqlplus / as sysdba &lt;&lt;&#39;SQLEOF&#39;
    set linesize 200;
    select INST_ID,NAME,LOG_MODE,FORCE_LOGGING,OPEN_MODE,CURRENT_SCN,CREATED from gv$database;
    col host_name format 30;
    select INST_ID,INSTANCE_NAME,HOST_NAME,STARTUP_TIME,STATUS,THREAD#,DATABASE_STATUS from gv$instance;
    col file_name format a100;
    select FILE_NAME,TABLESPACE_NAME,BYTES,STATUS from dba_data_files;
    col member format a100;
    select t1.INST_ID,t1.GROUP#,t1.THREAD#,t1.SEQUENCE#,t1.MEMBERS,t2.member from gv$log t1 join gv$logfile t2 on t1.INST_ID=t2.INST_ID and t1.GROUP#=t2.GROUP#;
    col name format a100;
    select inst_id,name,status from gv$controlfile;
SQLEOF
EOF</span>

    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$V_RAC_ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-ge</span> <span class="token number">12</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token function">su</span> - <span class="token variable">$V_RAC_OS_ORACLE_USER</span> <span class="token operator">&lt;&lt;</span><span class="token string">&#39;EOF&#39;
    echo &quot;Getting PDB information ....&quot;
    sqlplus / as sysdba &lt;&lt;&#39;SQLEOF&#39;
    show pdbs;
SQLEOF
EOF</span>
    <span class="token keyword">fi</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">ModifyDiskgroupAttribute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ALTER DISKGROUP DATA SET ATTRIBUTE <span class="token string">&#39;compatible.asm&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;12.2&#39;</span>
    ALTER DISKGROUP DATA SET ATTRIBUTE <span class="token string">&#39;compatible.rdbms&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;12.2&#39;</span>
    ALTER DISKGROUP DATA SET ATTRIBUTE <span class="token string">&#39;compatible.advm&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;12.2&#39;</span>

    ALTER DISKGROUP FRA SET ATTRIBUTE <span class="token string">&#39;compatible.asm&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;12.2&#39;</span>
    ALTER DISKGROUP FRA SET ATTRIBUTE <span class="token string">&#39;compatible.rdbms&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;12.2&#39;</span>
    ALTER DISKGROUP FRA SET ATTRIBUTE <span class="token string">&#39;compatible.advm&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;12.2&#39;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">CreateASMDiskGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Creating ASM disk group (on one node) ...&quot;</span>
    <span class="token assign-left variable">data_asmdisks</span><span class="token operator">=</span><span class="token variable">${V_RAC_ASM_DATA_ASMDISKS<span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">/</span><span class="token operator">,</span>}</span>
    <span class="token assign-left variable">fra_asmdisks</span><span class="token operator">=</span><span class="token variable">${V_RAC_ASM_FRA_ASMDISKS<span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">/</span><span class="token operator">,</span>}</span>

    <span class="token function">su</span> - <span class="token variable">$V_RAC_OS_GRID_USER</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
    asmca -silent -createDiskGroup \
    -diskGroupName <span class="token variable">$V_RAC_ASM_DATA_DISKGROUP_NAME</span> \
       -diskList &quot;<span class="token variable">$data_asmdisks</span>&quot; \
    -redundancy <span class="token variable">$V_RAC_ASM_DATA_REDUNDANCY</span> \
    -au_size 64 \
    -compatible.asm &#39;<span class="token variable">$V_RAC_ASM_DISKGROUP_ASM_COMPATIBLE</span>&#39; \
    -compatible.rdbms &#39;<span class="token variable">$V_RAC_ASM_DISKGROUP_RDBMMS_COMPATIBLE</span>&#39; 
    
    asmca -silent -createDiskGroup \
    -diskGroupName <span class="token variable">$V_RAC_ASM_FRA_DISKGROUP_NAME</span> \
       -diskList &quot;<span class="token variable">$fra_asmdisks</span>&quot; \
    -redundancy <span class="token variable">$V_RAC_ASM_FRA_REDUNDANCY</span> \
    -au_size 64 \
    -compatible.asm &#39;<span class="token variable">$V_RAC_ASM_DISKGROUP_ASM_COMPATIBLE</span>&#39; \
    -compatible.rdbms &#39;<span class="token variable">$V_RAC_ASM_DISKGROUP_RDBMMS_COMPATIBLE</span>&#39; 
EOF</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">InstallDatabaseSoftware</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token assign-left variable">V_RAC_OS_PUBLIC_IP_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PUBLIC_IP</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_ROOT_PASSWORD_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_ROOT_PASSWORD</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_HOSTNAME_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_HOSTNAME</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_CURRENT_HOSTNAME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">hostname</span><span class="token variable">)</span></span>

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Unzipping database software (on one node) ...&quot;</span>
    <span class="token function">su</span> - <span class="token variable">$V_RAC_OS_ORACLE_USER</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
    echo &quot;Installing database software (on one node) ...&quot;
    echo &quot;<span class="token variable">$V_RAC_ORACLE_INSTALL_OPTION</span>&quot; &gt; <span class="token variable">$V_RAC_OS_DBA_DIR</span>/db_install-<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +<span class="token string">&#39;%Y%m%d&#39;</span><span class="token variable">)</span></span>.rsp
    <span class="token variable">$V_RAC_PACKAGE_DATABASE_INSTALLER_EXE</span> <span class="token variable">$V_RAC_ORACLE_INSTALL_OPTION</span>
EOF</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
        echo &quot;Executing &#39;<span class="token variable">${V_RAC_ORACLE_ORA_INVENTORY}</span>/orainstRoot.sh&#39; and &#39;<span class="token variable">${V_RAC_ORACLE_HOME}</span>/root.sh&#39; as root (on all nodes by order) ...&quot;
        <span class="token variable">$V_RAC_ORACLE_ORA_INVENTORY</span>/orainstRoot.sh
        <span class="token variable">$V_RAC_ORACLE_HOME</span>/root.sh
SSHEOF</span>
    <span class="token keyword">done</span>

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installed database software <span class="token variable">$V_RAC_ORACLE_DATABASE_VERSION</span> successfully!&quot;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">CreateNetca</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Creating netca ...&quot;</span>
    <span class="token function">su</span> - <span class="token variable">$V_RAC_OS_ORACLE_USER</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
echo &quot;12.Create the listener ...&quot;
netca -silent -responsefile <span class="token variable">${V_RAC_ORACLE_HOME}</span>/assistants/netca/netca.rsp -lisport <span class="token variable">$V_RAC_CRS_SCANPORT</span>
echo &quot;12.Start the listener ...&quot;
lsnrctl start
EOF</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">CreateDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Creating database (on one node) ...&quot;</span>
    <span class="token assign-left variable">V_RAC_ORACLE_SID_CURRENT</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">hostname</span><span class="token variable">)</span></span>
    <span class="token function">su</span> - <span class="token variable">$V_RAC_OS_ORACLE_USER</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
echo &quot;Starting the listener ...&quot;
lsnrctl start

echo &quot;Saving database installation response to <span class="token variable">$V_RAC_OS_DBA_DIR</span>/dbca-<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +<span class="token string">&#39;%Y%m%d&#39;</span><span class="token variable">)</span></span>.rsp (on one node) ...&quot;
echo <span class="token variable">$V_RAC_ORACLE_DBCA_OPTION</span> &gt;  <span class="token variable">$V_RAC_OS_DBA_DIR</span>/dbca-<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +<span class="token string">&#39;%Y%m%d&#39;</span><span class="token variable">)</span></span>.rsp
dbca -silent -createDatabase -templateName General_Purpose.dbc <span class="token variable">$V_RAC_ORACLE_DBCA_OPTION</span>
   
echo &quot;Created rac database <span class="token variable">$V_RAC_ORACLE_DATABASE_VERSION</span> successfully!&quot;
EOF</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">SetFirewall</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment"># add allow port to firewalld</span>
    systemctl start firewalld
    firewall-cmd --add-port<span class="token operator">=</span><span class="token variable">$V_RAC_CRS_SCANPORT</span> <span class="token parameter variable">--zone</span><span class="token operator">=</span>public <span class="token parameter variable">--permanent</span>
    firewall-cmd <span class="token parameter variable">--reload</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">RemoveAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token assign-left variable">V_RAC_OS_PUBLIC_IP_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_PUBLIC_IP</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">V_RAC_OS_ROOT_PASSWORD_ARR</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$V_RAC_OS_ROOT_PASSWORD</span><span class="token punctuation">)</span>

    <span class="token function">su</span> - <span class="token variable">$V_RAC_OS_ORACLE_USER</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
    echo &quot;Uninstall database ...&quot;
    dbca -silent -deleteDatabase -sourceDB <span class="token variable">$V_RAC_ORACLE_UNQNAME</span> -sysDBAPassword <span class="token variable">$V_RAC_ORACLE_SYS_PASSWORD</span>
EOF</span>

    <span class="token variable">$V_RAC_GRID_ORACLE_HOME</span>/bin/crsctl stop cluster <span class="token parameter variable">-all</span>
     <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
    echo &quot;Stopping crs ...&quot;
    <span class="token variable">$V_RAC_GRID_ORACLE_HOME</span>/bin/crsctl stop crs
SSHEOF</span>
    <span class="token keyword">done</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">&#39;SSHEOF&#39;
    echo &quot;Shutdown database and stop listener ...&quot;
    $V_RAC_GRID_ORACLE_HOME/bin/crsctl stop crs
    while true; do
        oracle_processes=$(ps -ef | grep -E &quot;oracle|grid&quot; | grep -v &quot;grep&quot; | awk -F &#39; &#39; &#39;{print $2}&#39;)
        oracle_processes_count=$(ps -ef | grep -E &quot;oracle|grid&quot; | grep -v &quot;grep&quot; | awk -F &#39; &#39; &#39;{print $2}&#39;|wc -l)
        if [ $oracle_processes_count -gt 0 ]; then
            echo &quot;There existing some oracle processes and killing all of theme ...&quot; $oracle_processes
            kill -9 $oracle_processes
        else 
            echo &quot;All of oracle processes have been killed&quot;
            break
        fi
    done
SSHEOF</span>
    <span class="token keyword">done</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">hostip</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        sshpass <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">${V_RAC_OS_ROOT_PASSWORD_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">StrictHostKeyChecking</span><span class="token operator">=</span>no root@<span class="token variable">${V_RAC_OS_PUBLIC_IP_ARR<span class="token punctuation">[</span>$hostip<span class="token punctuation">]</span>}</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">SSHEOF
    echo &quot;Shutdown database and stop listener ...&quot;
    su - <span class="token variable">$V_RAC_OS_ORACLE_USER</span> &lt;&lt;OUT
sqlplus / as sysdba &lt;&lt;SQL
shutdown immediate;
SQL
lsnrctl stop
OUT

    echo &quot;Removing oraInst.loc and oratab file ...&quot;
    rm -f /etc/oraInst.loc
    rm -f /etc/oratab

    rm -rf /etc/oracle

    rm -rf /var/tmp/.oracle*
    rm -rf /tmp/.oracle*

    rm -rf /var/tmp/*
    rm -rf /tmp/*

    rm -rf  /etc/init.d/init.tfa
    rm -rf /etc/init.d/init.ohasd

    echo &quot;Removing database file and database software ...&quot;
    rm -rf <span class="token variable">$V_RAC_GRID_ORACLE_BASE</span> <span class="token variable">$V_RAC_GRID_ORACLE_HOME</span> <span class="token variable">$V_RAC_ORACLE_ORA_INVENTORY</span>
    rm -rf <span class="token variable">$V_RAC_ORACLE_HOME</span>
    rm -rf <span class="token variable">$V_RAC_GRID_APP_ROOTDIR</span>
    rm -rf <span class="token variable">$V_RAC_ORACLE_APP_ROOTDIR</span>

    echo &quot;Removing Oracle Group and User ...&quot;
    userdel <span class="token variable">$V_RAC_OS_ORACLE_USER</span>
    rm -rf /home/<span class="token variable">$V_RAC_OS_ORACLE_USER</span>

    userdel <span class="token variable">$V_RAC_OS_GRID_USER</span>
    rm -rf /home/<span class="token variable">$V_RAC_OS_GRID_USER</span>

    groupdel oinstall
    groupdel dba
    groupdel oper
    groupdel backupdba
    groupdel dgdba
    groupdel kmdba
    groupdel asmdba
    groupdel asmoper
    groupdel asmadmin
    groupdel racdba

    echo &quot;Reset Resource Usage Limit ...&quot;
    cp -f /etc/pam.d/login.orabak /etc/pam.d/login
    cp -f /etc/security/limits.conf.orabak /etc/security/limits.conf

    echo &quot;Reset sysctl.conf ...&quot;
    cp -f /etc/sysctl.conf.orabak /etc/sysctl.conf

    echo &quot;Reset hosts ...&quot;
    cp /etc/hosts.orabak /etc/hosts
SSHEOF</span>
    <span class="token keyword">done</span>

    <span class="token keyword">for</span> <span class="token for-or-select variable">item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_OCR_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token function">dd</span> <span class="token assign-left variable">if</span><span class="token operator">=</span>/dev/zero <span class="token assign-left variable">of</span><span class="token operator">=</span><span class="token variable">$item</span> <span class="token assign-left variable">bs</span><span class="token operator">=</span>1M <span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token number">30000</span>
    <span class="token keyword">done</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_DATA_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token function">dd</span> <span class="token assign-left variable">if</span><span class="token operator">=</span>/dev/zero <span class="token assign-left variable">of</span><span class="token operator">=</span><span class="token variable">$item</span> <span class="token assign-left variable">bs</span><span class="token operator">=</span>1M <span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token number">30000</span>
    <span class="token keyword">done</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">item</span> <span class="token keyword">in</span> <span class="token variable">$V_RAC_ASM_FRA_DISKS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token function">dd</span> <span class="token assign-left variable">if</span><span class="token operator">=</span>/dev/zero <span class="token assign-left variable">of</span><span class="token operator">=</span><span class="token variable">$item</span> <span class="token assign-left variable">bs</span><span class="token operator">=</span>1M <span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token number">30000</span>
    <span class="token keyword">done</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">ConfigureNetwork</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    nmcli con <span class="token function">add</span> <span class="token builtin class-name">type</span> ethernet con-name eth1 ifname eth1 ip4 <span class="token number">10.10</span>.100.212/24 gw4 <span class="token string">&quot;&quot;</span> ipv4.method manual
    nmcli con up eth1 ifname eth1
    nmcli con mod eth1 ipv4.method manual

    nmcli con <span class="token function">add</span> <span class="token builtin class-name">type</span> ethernet con-name eth1 ifname eth1 ip4 <span class="token number">10.10</span>.100.213/24 gw4 <span class="token string">&quot;&quot;</span> ipv4.method manual
    nmcli con up eth1 ifname eth1

    nmcli con delete <span class="token variable"><span class="token variable">$(</span>nmcli con show <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&#39;Wire&#39;</span> <span class="token operator">|</span> <span class="token function">awk</span> -F<span class="token string">&#39; &#39;</span> <span class="token string">&#39;{print $4}&#39;</span><span class="token variable">)</span></span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">Step</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$0</span> ipkg --&gt; <span class="token variable">$0</span> download --&gt; <span class="token variable">$0</span> extract --&gt; <span class="token variable">$0</span> ibp --&gt; <span class="token variable">$0</span> &lt;asmudev/asmmultipath/asmlib/asmnfs&gt; --&gt; <span class="token variable">$0</span> igrid --&gt; <span class="token variable">$0</span> asmdg --&gt; <span class="token variable">$0</span> idb --&gt; <span class="token variable">$0</span> createdb&quot;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;This is test ...&quot;</span>
    <span class="token comment"># FOO=&quot;none foo&quot;</span>
    <span class="token comment"># BAR=&quot;none bar&quot;</span>
    <span class="token comment"># echo $FOO --- $BAR --- previous</span>
    <span class="token comment"># test_options &quot;$@&quot;</span>
    <span class="token comment"># echo $FOO --- $BAR --- after</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$V_RAC_ASM_DATA_ASMDISKS</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$V_RAC_ASM_FRA_ASMDISKS</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$V_RAC_ASM_OCR_ASMDISKS</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$V_RAC_ASM_DISKGROUP_DISKDISCOVERY</span>

<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">test_options</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable">${<span class="token operator">#</span>}</span> <span class="token parameter variable">-gt</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token assign-left variable">error_message</span><span class="token operator">=</span><span class="token string">&quot;Error: a value is needed for &#39;<span class="token variable">$1</span>&#39;&quot;</span>
        <span class="token keyword">case</span> <span class="token variable">$1</span> <span class="token keyword">in</span>
        <span class="token parameter variable">-f</span> <span class="token operator">|</span> --foo<span class="token punctuation">)</span>
            <span class="token assign-left variable">FOO</span><span class="token operator">=</span><span class="token variable">${2<span class="token operator">:?</span>$error_message}</span>
            <span class="token builtin class-name">shift</span> <span class="token number">2</span>
            <span class="token punctuation">;</span><span class="token punctuation">;</span>
        <span class="token parameter variable">-b</span> <span class="token operator">|</span> --bar<span class="token punctuation">)</span>
            <span class="token assign-left variable">BAR</span><span class="token operator">=</span><span class="token variable">${2<span class="token operator">:?</span>$error_message}</span>
            <span class="token builtin class-name">shift</span> <span class="token number">2</span>
            <span class="token punctuation">;</span><span class="token punctuation">;</span>
        *<span class="token punctuation">)</span>
            <span class="token builtin class-name">echo</span> <span class="token string">&quot;unknown option <span class="token variable">$1</span>&quot;</span>
            <span class="token builtin class-name">break</span>
            <span class="token punctuation">;</span><span class="token punctuation">;</span>
        <span class="token keyword">esac</span>
    <span class="token keyword">done</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">Usage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
Usage: <span class="token variable">$0</span> &lt;subcommand&gt; [option]
    subcommand:
       help, help message.
       asm, configure asm disks
       asmdg, create asm disk group by asmca.
       asmiscsi, configure asm by iscsi.
       check, check node requirements.
       createdb, create database.
       download, download database package.
       enable, enable database auto startup after system boot/reboot.
       extract, extract packages.
       firewall, set firewall.
       get, get rac information.
       iall, install dependency,grid software,database software,create database.
       ibp, install base packages, eg. cvuqdisk.*    
       idb, install database software.
       igrid, install grid software.
       ipkg, install oracle dependency.  
       rasm, deconfigure or remove asm disks.
       rasmiscsi, deconfigure asm by iscsi.
       remove, uninstall database.
       step, show Oracle RAC installation steps.
EOF</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$1</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;help&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    PreConfigurePackage
<span class="token keyword">fi</span>

<span class="token keyword">case</span> <span class="token variable">$1</span> <span class="token keyword">in</span>
igrid <span class="token operator">|</span> iall <span class="token operator">|</span> idb <span class="token operator">|</span> createdb <span class="token operator">|</span> asmdg <span class="token operator">|</span> asm <span class="token operator">|</span> rasm<span class="token punctuation">)</span>
    PreConfigureDatabase <span class="token string">&quot;<span class="token variable">${@<span class="token operator">:</span>2}</span>&quot;</span>
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
*<span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>

<span class="token keyword">function</span> <span class="token function-name function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token variable"><span class="token punctuation">((</span>${#} <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">))</span></span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        Usage <span class="token number">0</span>
        <span class="token builtin class-name">exit</span> <span class="token number">1</span>
    <span class="token keyword">fi</span>

    <span class="token keyword">case</span> <span class="token variable">${1}</span> <span class="token keyword">in</span>
    <span class="token builtin class-name">help</span><span class="token punctuation">)</span>
        Usage
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    asm<span class="token punctuation">)</span>
        ConfigASMDisks
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    asmdg<span class="token punctuation">)</span>
        CreateASMDiskGroup
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    asmiscsi<span class="token punctuation">)</span>
        ConfigureASMISCSI
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    check<span class="token punctuation">)</span>
        CheckNode
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    createdb<span class="token punctuation">)</span>
        CreateDatabase
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    download<span class="token punctuation">)</span>
        DownloadOraclePackage
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token builtin class-name">enable</span><span class="token punctuation">)</span>
        EnableAutoStartup
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    extract<span class="token punctuation">)</span>
        ExtractPackage
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    firewall<span class="token punctuation">)</span>
        SetFirewall
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    get<span class="token punctuation">)</span>
        GetRACInformation
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    iall<span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installing Oracle RAC in one step ...&quot;</span>
        InstallDependency
        DownloadOraclePackage
        ExtractPackage
        InstallBasePackage
        ConfigASMDisks
        InstallGridSoftware
        CreateASMDiskGroup
        InstallDatabaseSoftware
        CreateDatabase
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    ibp<span class="token punctuation">)</span>
        InstallBasePackage
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    idb<span class="token punctuation">)</span>
        InstallDatabaseSoftware
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    igrid<span class="token punctuation">)</span>
        InstallGridSoftware
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    ipkg<span class="token punctuation">)</span>
        InstallDependency
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    remove<span class="token punctuation">)</span>
        RemoveAll
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    rasm<span class="token punctuation">)</span>
        DeconfigASMDisks
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    step<span class="token punctuation">)</span>
        Step
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token builtin class-name">test</span><span class="token punctuation">)</span>
        <span class="token builtin class-name">test</span> <span class="token string">&quot;<span class="token variable">${@<span class="token operator">:</span>2}</span>&quot;</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    *<span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;unknown command: <span class="token variable">$1</span>&quot;</span>
        Usage
        <span class="token builtin class-name">exit</span> <span class="token number">1</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token keyword">esac</span>
<span class="token punctuation">}</span>

<span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
main <span class="token string">&quot;<span class="token variable">$@</span>&quot;</span>
<span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;Completed and elapsed time: <span class="token variable"><span class="token variable">$((</span>$ENDTIME <span class="token operator">-</span> $STARTTIME<span class="token variable">))</span></span> s&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-3-1" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">common</div><!--[--><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment">############ Author begin ##################################################</span>
<span class="token comment">## Author: Ableit</span>
<span class="token comment">## Date: 2022-07-20</span>
<span class="token comment">## Desc: Install Oracle Database</span>
<span class="token comment">## Env: RHEL/CentOS 7.x, Oracle Database 18c</span>
<span class="token comment">############ Author end ####################################################</span>

<span class="token comment">############ Env &amp; Virables begin ##########################################</span>
<span class="token comment">####### begin custom settings #######</span>
<span class="token assign-left variable">PACKAGE_URLS_11</span><span class="token operator">=</span><span class="token string">&quot;ftp://10.10.12.158/pub/oracle/p13390677_112040_Linux-x86-64_1of7.zip ftp://10.10.12.158/pub/oracle/p13390677_112040_Linux-x86-64_2of7.zip&quot;</span>
<span class="token assign-left variable">PACKAGE_URLS_12</span><span class="token operator">=</span><span class="token string">&quot;ftp://10.10.12.158/pub/oracle/linuxx64_12201_database.zip&quot;</span>
<span class="token assign-left variable">PACKAGE_URLS_18</span><span class="token operator">=</span><span class="token string">&quot;ftp://10.10.12.158/pub/oracle/LINUX.X64_180000_db_home.zip&quot;</span> <span class="token comment"># multiple urls separated by space</span>
<span class="token assign-left variable">PACKAGE_URLS_19</span><span class="token operator">=</span><span class="token string">&quot;ftp://10.10.12.158/pub/oracle/LINUX.X64_193000_db_home.zip&quot;</span>
<span class="token assign-left variable">PACKAGE_URLS_21</span><span class="token operator">=</span><span class="token string">&quot;ftp://10.10.12.158/pub/oracle/LINUX.X64_213000_db_home.zip&quot;</span>

<span class="token comment"># PACKAGE_URLS=$PACKAGE_URLS_11</span>

<span class="token assign-left variable">OS_DBA_HOME</span><span class="token operator">=</span>/opt/database/dba
<span class="token assign-left variable">OS_PACKAGE_DIR</span><span class="token operator">=</span>/opt/package
<span class="token assign-left variable">OS_HOSTNAME</span><span class="token operator">=</span>testdb-node01
<span class="token assign-left variable">OS_IPADDR</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ip</span> <span class="token parameter variable">-4</span> addr show dev eth0 <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-oP</span> <span class="token string">&#39;(?&lt;=inet\s)\d+(\.\d+){3}&#39;</span><span class="token variable">)</span></span>
<span class="token assign-left variable">OS_ORACLE_USER</span><span class="token operator">=</span><span class="token string">&quot;oracle&quot;</span>
<span class="token assign-left variable">OS_ORACLE_USER_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>

<span class="token assign-left variable">ORACLE_UNQNAME</span><span class="token operator">=</span>testdb
<span class="token assign-left variable">ORACLE_SID</span><span class="token operator">=</span>testdb
<span class="token assign-left variable">ORACLE_PDB_NAME</span><span class="token operator">=</span>testpdb
<span class="token assign-left variable">ORACLE_CHARSET</span><span class="token operator">=</span>AL32UTF8
<span class="token assign-left variable">ORACLE_SYS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>
<span class="token assign-left variable">ORACLE_SYSTEM_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>
<span class="token assign-left variable">ORACLE_PDB_ADMIN_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>
<span class="token assign-left variable">ORACLE_BASE_APP_DIR</span><span class="token operator">=</span>/u01
<span class="token assign-left variable">ORACLE_BASE_DATA_DIR</span><span class="token operator">=</span>/data
<span class="token assign-left variable">ORACLE_BASE_RECOVERY_AREA_DIR</span><span class="token operator">=</span>/data
<span class="token assign-left variable">ORACLE_DATABASE_VERSION</span><span class="token operator">=</span><span class="token number">18.0</span>.0.0
<span class="token assign-left variable">ORACLE_LISTENER_PORT</span><span class="token operator">=</span><span class="token number">1521</span>
<span class="token assign-left variable">ORACLE_REDOLOG_SIZE</span><span class="token operator">=</span><span class="token number">64</span>                   <span class="token comment"># 64M</span>
<span class="token assign-left variable">ORACLE_RECOVERY_AREA_SIZE</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span><span class="token number">64</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token variable">))</span></span> <span class="token comment"># 64M*1024=64G</span>
<span class="token assign-left variable">ORACLE_ARCHIVE</span><span class="token operator">=</span>true
<span class="token comment">####### end custom settings #######</span>

<span class="token comment">####### begin auto settings #######</span>
<span class="token comment"># Oracle Auto Settings</span>
<span class="token assign-left variable">TMP</span><span class="token operator">=</span>/tmp
<span class="token assign-left variable">ORACLE_HOSTNAME</span><span class="token operator">=</span><span class="token variable">$OS_HOSTNAME</span>
<span class="token assign-left variable">ORACLE_BASE</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_APP_DIR</span>/app/oracle
<span class="token assign-left variable">ORACLE_HOME</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE</span>/product/<span class="token variable">$ORACLE_DATABASE_VERSION</span>/db_1
<span class="token assign-left variable">ORACLE_DATA_DIR</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_DATA_DIR</span>/oracle/oradata
<span class="token assign-left variable">ORACLE_ORA_INVENTORY</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_APP_DIR</span>/app/oraInventory
<span class="token assign-left variable">ORACLE_RECOVERY_AREA_DIR</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_RECOVERY_AREA_DIR</span>/oracle/fast_recovery_area

<span class="token comment"># os auto settings</span>
<span class="token assign-left variable">OS_MEMORY</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">free</span> <span class="token parameter variable">-b</span> <span class="token operator">|</span> <span class="token function">grep</span> Mem: <span class="token operator">|</span> <span class="token function">awk</span> -F<span class="token string">&#39; &#39;</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">)</span></span>
<span class="token assign-left variable">OS_SHMMAX</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$OS_MEMORY <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token variable">))</span></span>
<span class="token assign-left variable">OS_SHMALL</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$OS_SHMMAX <span class="token operator">/</span> <span class="token number">1024</span><span class="token variable">))</span></span>
<span class="token assign-left variable">OS_VERSION_ID</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /etc/os-release <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&#39;^VERSION_ID=&#39;</span> <span class="token operator">|</span> <span class="token function">awk</span> -F<span class="token string">&#39;=&#39;</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">)</span></span>
hostnamectl set-hostname <span class="token variable">$OS_HOSTNAME</span>
<span class="token assign-left variable">ORACLE_TOTAL_MEMORY</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$OS_SHMMAX <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token variable">))</span></span>
<span class="token assign-left variable">ORACLE_PRIMARY_VERSION</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $ORACLE_DATABASE_VERSION <span class="token operator">|</span> <span class="token function">awk</span> -F<span class="token string">&#39;.&#39;</span> <span class="token string">&#39;{print $1}&#39;</span><span class="token variable">)</span></span>
<span class="token assign-left variable">OS_PACKAGE_ORACLE_DATABASE</span><span class="token operator">=</span><span class="token variable">$OS_PACKAGE_DIR</span>/oracle/<span class="token variable">$ORACLE_DATABASE_VERSION</span>

<span class="token comment">####### end auto settings #######</span>
<span class="token comment">############ Env &amp; Virables end ############################################</span>

<span class="token keyword">function</span> <span class="token function-name function">PackageVersionCongiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">11</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">PACKAGE_URLS</span><span class="token operator">=</span><span class="token variable">$PACKAGE_URLS_11</span>
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">12</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">PACKAGE_URLS</span><span class="token operator">=</span><span class="token variable">$PACKAGE_URLS_12</span>
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">18</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">PACKAGE_URLS</span><span class="token operator">=</span><span class="token variable">$PACKAGE_URLS_18</span>
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">19</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">PACKAGE_URLS</span><span class="token operator">=</span><span class="token variable">$PACKAGE_URLS_19</span>
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">21</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">PACKAGE_URLS</span><span class="token operator">=</span><span class="token variable">$PACKAGE_URLS_21</span>
    <span class="token keyword">fi</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">DatabaseVersionConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment"># install auto settings</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-le</span> <span class="token number">11</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">OS_ORACLE_PROFILE</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
        <span class="token assign-left variable">ORACLE_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">${OS_PACKAGE_DIR}</span>/database/response/db_install.rsp
        <span class="token assign-left variable">ORACLE_SOFTWARE_PREPARE_DIR</span><span class="token operator">=</span><span class="token variable">${OS_PACKAGE_DIR}</span>/database
        <span class="token assign-left variable">ORACLE_SOFTWARE_UNPACK_DIR</span><span class="token operator">=</span><span class="token variable">${OS_PACKAGE_DIR}</span>
        <span class="token assign-left variable">ORACLE_INSTALLER_SPECIAL_OPTIONS</span><span class="token operator">=</span><span class="token string">&quot;oracle.install.db.DBA_GROUP=dba oracle.install.db.OPER_GROUP=oper&quot;</span>
        <span class="token assign-left variable">ORACLE_DBCA_SPECIAL_OPTIONS</span><span class="token operator">=</span><span class="token string">&quot;-memoryPercentage 66&quot;</span>

    <span class="token keyword">elif</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-eq</span> <span class="token number">12</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">OS_ORACLE_PROFILE</span><span class="token operator">=</span><span class="token string">&quot;export PDB_NAME=<span class="token variable">$ORACLE_PDB_NAME</span>&quot;</span>
        <span class="token assign-left variable">ORACLE_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">${OS_PACKAGE_DIR}</span>/database/response/db_install.rsp
        <span class="token assign-left variable">ORACLE_SOFTWARE_PREPARE_DIR</span><span class="token operator">=</span><span class="token variable">${OS_PACKAGE_DIR}</span>/database
        <span class="token assign-left variable">ORACLE_SOFTWARE_UNPACK_DIR</span><span class="token operator">=</span><span class="token variable">${OS_PACKAGE_DIR}</span>
        <span class="token assign-left variable">ORACLE_INSTALLER_SPECIAL_OPTIONS</span><span class="token operator">=</span><span class="token string">&quot;oracle.install.db.OSDBA_GROUP=dba oracle.install.db.OSOPER_GROUP=oper&quot;</span>
        <span class="token assign-left variable">ORACLE_DBCA_SPECIAL_OPTIONS</span><span class="token operator">=</span><span class="token string">&quot;-createAsContainerDatabase true -numberOfPDBs 1 -pdbName <span class="token variable">${ORACLE_PDB_NAME}</span> -pdbAdminPassword <span class="token variable">$ORACLE_PDB_ADMIN_PASSWORD</span> -enableArchive <span class="token variable">${ORACLE_ARCHIVE}</span> -recoveryAreaSize <span class="token variable">${ORACLE_RECOVERY_AREA_SIZE}</span> -memoryMgmtType auto_sga -ignorePreReqs&quot;</span>

    <span class="token keyword">elif</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-gt</span> <span class="token number">12</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$ORACLE_PRIMARY_VERSION</span> <span class="token parameter variable">-le</span> <span class="token number">21</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">OS_ORACLE_PROFILE</span><span class="token operator">=</span><span class="token string">&quot;export PDB_NAME=<span class="token variable">$ORACLE_PDB_NAME</span>&quot;</span>
        <span class="token assign-left variable">ORACLE_RESPONSE_FILE</span><span class="token operator">=</span><span class="token variable">${ORACLE_HOME}</span>/install/response/db_install.rsp
        <span class="token assign-left variable">ORACLE_SOFTWARE_PREPARE_DIR</span><span class="token operator">=</span><span class="token variable">${ORACLE_HOME}</span>
        <span class="token assign-left variable">ORACLE_SOFTWARE_UNPACK_DIR</span><span class="token operator">=</span><span class="token variable">${ORACLE_HOME}</span>
        <span class="token assign-left variable">ORACLE_INSTALLER_SPECIAL_OPTIONS</span><span class="token operator">=</span><span class="token string">&quot;oracle.install.db.OSDBA_GROUP=dba oracle.install.db.OSOPER_GROUP=oper&quot;</span>
        <span class="token assign-left variable">ORACLE_DBCA_SPECIAL_OPTIONS</span><span class="token operator">=</span><span class="token string">&quot;-createAsContainerDatabase true -numberOfPDBs 1 -pdbName <span class="token variable">${ORACLE_PDB_NAME}</span> -pdbAdminPassword <span class="token variable">$ORACLE_PDB_ADMIN_PASSWORD</span> -enableArchive <span class="token variable">${ORACLE_ARCHIVE}</span> -recoveryAreaSize <span class="token variable">${ORACLE_RECOVERY_AREA_SIZE}</span> -memoryMgmtType auto_sga -ignorePreReqs&quot;</span>
    <span class="token keyword">else</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;The oracle version is not supported.&quot;</span>
        <span class="token builtin class-name">exit</span>
    <span class="token keyword">fi</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">DownloadPackage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Download package ...&quot;</span>
    <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$OS_PACKAGE_DIR</span> <span class="token variable">$OS_PACKAGE_ORACLE_DATABASE</span>
    yum <span class="token function">install</span> <span class="token parameter variable">-y</span> <span class="token function">wget</span>
    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">download_url</span> <span class="token keyword">in</span> <span class="token variable">$PACKAGE_URLS</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token function">wget</span> <span class="token parameter variable">-O</span> <span class="token variable">$OS_PACKAGE_ORACLE_DATABASE</span>/database-<span class="token variable">${ORACLE_DATABASE_VERSION}</span>-<span class="token variable">${counter}</span>.zip <span class="token string">&quot;<span class="token variable">$download_url</span>&quot;</span>
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$counter <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">done</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">InstallDependency</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;0.Set locale ...&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;en_US.UTF-8&quot;</span> <span class="token operator">&gt;</span>/etc/locale.conf
    localectl set-locale <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;en_US.UTF-8&quot;</span>
    <span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;en_US.UTF-8&quot;</span>

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;1.Disable selinux and stop firewalld ...&quot;</span>
    <span class="token function">cp</span> /etc/selinux/config /etc/selinux/config.orabak
    <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;s/^SELINUX=enforcing/SELINUX=disabled/g&#39;</span> /etc/selinux/config
    setenforce <span class="token number">0</span>
    systemctl stop firewalld
    systemctl disable firewalld
    <span class="token function">sleep</span> <span class="token number">1</span>

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;2.Set hostname ...&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$OS_HOSTNAME</span> <span class="token operator">&gt;</span>/etc/hostname
    <span class="token function">sleep</span> <span class="token number">1</span>

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;3.Set hosts ...&quot;</span>
    <span class="token function">cp</span> /etc/hosts /etc/hosts.orabak
    <span class="token builtin class-name">echo</span> <span class="token variable">$OS_IPADDR</span><span class="token string">&#39;   &#39;</span><span class="token variable">$OS_HOSTNAME</span> <span class="token operator">&gt;&gt;</span>/etc/hosts
    <span class="token function">sleep</span> <span class="token number">1</span>

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;4.Set sysctl.conf ... &quot;</span>
    <span class="token function">cp</span> /etc/sysctl.conf /etc/sysctl.conf.orabak
    <span class="token function">cat</span> <span class="token operator">&gt;&gt;</span>/etc/sysctl.conf <span class="token operator">&lt;&lt;</span><span class="token string">EOF
fs.file-max = 6815744
kernel.sem = 250 32000 100 128
kernel.shmmni = 4096
kernel.shmall = <span class="token variable">$OS_SHMALL</span> 
kernel.shmmax = <span class="token variable">$OS_SHMMAX</span>
kernel.panic_on_oops = 1
net.core.rmem_default = 262144
net.core.rmem_max = 4194304
net.core.wmem_default = 262144
net.core.wmem_max = 1048576
net.ipv4.conf.all.rp_filter = 2
net.ipv4.conf.default.rp_filter = 2
fs.aio-max-nr = 1048576
net.ipv4.ip_local_port_range = 9000 65500
EOF</span>
    <span class="token function">sysctl</span> <span class="token parameter variable">-p</span>
    <span class="token function">sleep</span> <span class="token number">1</span>

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;5.Set resource usage limitation ...&quot;</span>
    <span class="token function">cp</span> /etc/security/limits.conf /etc/security/limits.conf.orabak
    <span class="token function">cat</span> <span class="token operator">&gt;&gt;</span>/etc/security/limits.conf <span class="token operator">&lt;&lt;</span><span class="token string">EOF
<span class="token variable">$OS_ORACLE_USER</span>   soft   nofile    1024
<span class="token variable">$OS_ORACLE_USER</span>   hard   nofile    65536
<span class="token variable">$OS_ORACLE_USER</span>   soft   nproc    16384
<span class="token variable">$OS_ORACLE_USER</span>   hard   nproc    16384
<span class="token variable">$OS_ORACLE_USER</span>   soft   stack    10240
<span class="token variable">$OS_ORACLE_USER</span>   hard   stack    32768
<span class="token variable">$OS_ORACLE_USER</span>   hard   memlock    134217728
<span class="token variable">$OS_ORACLE_USER</span>   soft   memlock    134217728
EOF</span>

    <span class="token function">cp</span> /etc/pam.d/login /etc/pam.d/login.orabak
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;session   required    pam_limits.so&quot;</span> <span class="token operator">&gt;&gt;</span>/etc/pam.d/login
    <span class="token function">sleep</span> <span class="token number">1</span>

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;6.Install dependencies ...&quot;</span>
    yum <span class="token function">install</span> <span class="token parameter variable">-y</span> <span class="token punctuation">\</span>
        <span class="token function">bc</span> binutils compat-libcap1 compat-libcap1-1.10-3.el7.x86_64 compat-libstdc++-33 <span class="token punctuation">\</span>
        compat-libstdc++-33.i686 dtrace-utils elfutils-libelf elfutils-libelf-devel <span class="token punctuation">\</span>
        elfutils-libelf-devel.i686 elfutils-libelf.i686 fontconfig-devel gcc gcc-c++ <span class="token punctuation">\</span>
        glibc glibc-2.17-36.el7.i686 glibc-2.17-36.el7.x86_64 glibc-devel glibc-devel.i686 <span class="token punctuation">\</span>
        glibc.i686 ksh libaio libaio-devel libaio-devel.i686 libaio.i686 libcap <span class="token punctuation">\</span>
        libdtrace-ctf-devel libgcc libgcc.i686 librdmacm-devel libstdc++ libstdc++-devel <span class="token punctuation">\</span>
        libstdc++-devel.i686 libstdc++.i686 libX11 libX11.i686 libXau libXau.i686 libxcb <span class="token punctuation">\</span>
        libxcb.i686 libXext libXext.i686 libXi libXi.i686 libXrender libXrender-devel libXtst <span class="token punctuation">\</span>
        libXtst.i686 <span class="token function">make</span> net-tools nfs-utils policycoreutils policycoreutils-python python <span class="token punctuation">\</span>
        python-configshell python-rtslib python-six smartmontools sysstat targetcli unixODBC <span class="token punctuation">\</span>
        unixODBC-devel <span class="token function">unzip</span> zlib-devel
    <span class="token function">sleep</span> <span class="token number">1</span>

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;7.Add oracle groups and users ...&quot;</span>
    <span class="token function">groupadd</span> <span class="token parameter variable">-g</span> <span class="token number">54321</span> oinstall
    <span class="token function">groupadd</span> <span class="token parameter variable">-g</span> <span class="token number">54322</span> dba
    <span class="token function">groupadd</span> <span class="token parameter variable">-g</span> <span class="token number">54323</span> oper
    <span class="token function">useradd</span> <span class="token parameter variable">-u</span> <span class="token number">54321</span> <span class="token parameter variable">-g</span> oinstall <span class="token parameter variable">-G</span> dba,oper <span class="token variable">$OS_ORACLE_USER</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$OS_ORACLE_USER_PASSWORD</span> <span class="token operator">|</span> <span class="token function">passwd</span> <span class="token parameter variable">--stdin</span> <span class="token variable">$OS_ORACLE_USER</span>
    <span class="token function">sleep</span> <span class="token number">1</span>

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;8.Create directories ...&quot;</span>
    <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$ORACLE_HOME</span> <span class="token variable">$ORACLE_DATA_DIR</span> <span class="token variable">$ORACLE_ORA_INVENTORY</span> <span class="token variable">$ORACLE_RECOVERY_AREA_DIR</span> <span class="token variable">$OS_PACKAGE_DIR</span>
    <span class="token function">chown</span> <span class="token parameter variable">-R</span> <span class="token variable">$OS_ORACLE_USER</span>:oinstall <span class="token variable">$ORACLE_BASE_APP_DIR</span> <span class="token variable">$ORACLE_BASE_DATA_DIR</span> <span class="token variable">$ORACLE_BASE_RECOVERY_AREA_DIR</span> <span class="token variable">$OS_PACKAGE_DIR</span>
    <span class="token function">chmod</span> <span class="token parameter variable">-R</span> <span class="token number">775</span> <span class="token variable">$ORACLE_BASE_APP_DIR</span> <span class="token variable">$ORACLE_BASE_DATA_DIR</span> <span class="token variable">$ORACLE_BASE_RECOVERY_AREA_DIR</span> <span class="token variable">$OS_PACKAGE_DIR</span>
    <span class="token function">sleep</span> <span class="token number">1</span>

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;9.Set oracle env ...&quot;</span>
    <span class="token function">cp</span> /home/<span class="token variable">$OS_ORACLE_USER</span>/.bash_profile /home/<span class="token variable">$OS_ORACLE_USER</span>/.bash_profile.orabak
    <span class="token function">cat</span> <span class="token operator">&gt;&gt;</span>/home/<span class="token variable">$OS_ORACLE_USER</span>/.bash_profile <span class="token operator">&lt;&lt;</span><span class="token string">EOF
### Begin Oracle ENV ###
export TMP=<span class="token variable">$TMP</span>
export TMPDIR=<span class="token variable">$TMP</span>
export ORACLE_HOSTNAME=<span class="token variable">$ORACLE_HOSTNAME</span>
export ORACLE_UNQNAME=<span class="token variable">$ORACLE_UNQNAME</span>
export ORACLE_SID=<span class="token variable">$ORACLE_SID</span>
<span class="token variable">$OS_ORACLE_PROFILE</span>
export ORACLE_BASE=<span class="token variable">$ORACLE_BASE</span>
export ORACLE_HOME=<span class="token variable">$ORACLE_HOME</span>
export ORA_INVENTORY=<span class="token variable">$ORACLE_ORA_INVENTORY</span>
export DATA_DIR=<span class="token variable">$ORACLE_DATA_DIR</span>
export ORACLE_HOME_LISTNER=\<span class="token variable">$ORACLE_HOME</span>
export LD_LIBRARY_PATH=\<span class="token variable">$ORACLE_HOME</span>/lib:/lib:/usr/lib
export CLASSPATH=\<span class="token variable">$ORACLE_HOME</span>/jlib:\<span class="token variable">$ORACLE_HOME</span>/rdbms/jlib
export PATH=\<span class="token variable">$ORACLE_HOME</span>/bin:\<span class="token environment constant">$PATH</span>
### End Oracle Env ###
EOF</span>
    <span class="token function">sleep</span> <span class="token number">1</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">InstallSoftware</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;10.unzip oracle database package ...&quot;</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">dbfile</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span> $OS_PACKAGE_ORACLE_DATABASE<span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Extract <span class="token variable">$dbfile</span> to <span class="token variable">$ORACLE_SOFTWARE_UNPACK_DIR</span>&quot;</span>
        <span class="token function">unzip</span> <span class="token parameter variable">-oq</span> <span class="token parameter variable">-d</span> <span class="token variable">$ORACLE_SOFTWARE_UNPACK_DIR</span> <span class="token variable">$OS_PACKAGE_ORACLE_DATABASE</span>/<span class="token variable">$dbfile</span>
    <span class="token keyword">done</span>

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;change directory permission ...&quot;</span>
    <span class="token function">chown</span> <span class="token parameter variable">-R</span> <span class="token variable">$OS_ORACLE_USER</span>:oinstall <span class="token variable">$ORACLE_SOFTWARE_UNPACK_DIR</span>
    <span class="token function">chmod</span> <span class="token parameter variable">-R</span> <span class="token number">775</span> <span class="token variable">$ORACLE_SOFTWARE_UNPACK_DIR</span>

    <span class="token function">su</span> - <span class="token variable">$OS_ORACLE_USER</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
cd <span class="token variable">$ORACLE_SOFTWARE_PREPARE_DIR</span>

echo &quot;11.install database software ...&quot;
./runInstaller -ignorePrereq -waitforcompletion -silent                        \
    -responseFile <span class="token variable">$ORACLE_RESPONSE_FILE</span>                                        \
    oracle.install.option=INSTALL_DB_SWONLY                                    \
    ORACLE_HOSTNAME=<span class="token variable">${ORACLE_HOSTNAME}</span>                                         \
    UNIX_GROUP_NAME=oinstall                                                   \
    INVENTORY_LOCATION=<span class="token variable">${ORACLE_ORA_INVENTORY}</span>                                 \
    SELECTED_LANGUAGES=en                                                      \
    ORACLE_HOME=<span class="token variable">${ORACLE_HOME}</span>                                                 \
    ORACLE_BASE=<span class="token variable">${ORACLE_BASE}</span>                                                 \
    oracle.install.db.InstallEdition=EE                                        \
    oracle.install.db.OSBACKUPDBA_GROUP=dba                                    \
    oracle.install.db.OSDGDBA_GROUP=dba                                        \
    oracle.install.db.OSKMDBA_GROUP=dba                                        \
    oracle.install.db.OSRACDBA_GROUP=dba                                       \
    <span class="token variable">$ORACLE_INSTALLER_SPECIAL_OPTIONS</span>                                          \
    SECURITY_UPDATES_VIA_MYORACLESUPPORT=false                                 \
    DECLINE_SECURITY_UPDATES=true                                              \
    oracle.installer.autoupdates.option=SKIP_UPDATES
EOF</span>

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Run &#39;<span class="token variable">${ORACLE_ORA_INVENTORY}</span>/orainstRoot.sh&#39; as root ...&quot;</span>
    <span class="token variable">${ORACLE_ORA_INVENTORY}</span>/orainstRoot.sh
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Run &#39;<span class="token variable">${ORACLE_HOME}</span>/root.sh&#39; as root ...&quot;</span>
    <span class="token variable">${ORACLE_HOME}</span>/root.sh
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">CreateNetca</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;12.Create Netca ...&quot;</span>
    <span class="token function">su</span> - <span class="token variable">$OS_ORACLE_USER</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
echo &quot;12.Create the listener ...&quot;
netca -silent -responsefile <span class="token variable">${ORACLE_HOME}</span>/assistants/netca/netca.rsp -lisport <span class="token variable">$ORACLE_LISTENER_PORT</span>
echo &quot;12.Start the listener ...&quot;
lsnrctl start
EOF</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">CreateDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;13.Create Database ...&quot;</span>
    <span class="token function">su</span> - <span class="token variable">$OS_ORACLE_USER</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
echo &quot;12.Start the listener ...&quot;
lsnrctl start

dbca -silent -createDatabase                                                   \
     -initParams db_unique_name=<span class="token variable">${ORACLE_UNQNAME}</span>                              \
     -responseFile NO_VALUE                                                    \
     -templateName General_Purpose.dbc                                         \
     -gdbname <span class="token variable">${ORACLE_SID}</span>                                                    \
     -sid <span class="token variable">${ORACLE_SID}</span>                                                        \
     -characterSet <span class="token variable">$ORACLE_CHARSET</span>                                             \
     -sysPassword <span class="token variable">$ORACLE_SYS_PASSWORD</span>                                         \
     -systemPassword <span class="token variable">$ORACLE_SYSTEM_PASSWORD</span>                                   \
     <span class="token variable">$ORACLE_DBCA_SPECIAL_OPTIONS</span>                                              \
     -databaseType MULTIPURPOSE                                                \
     -totalMemory <span class="token variable">$ORACLE_TOTAL_MEMORY</span>                                         \
     -storageType FS                                                           \
     -datafileDestination &quot;<span class="token variable">${ORACLE_DATA_DIR}</span>&quot;                                 \
     -recoveryAreaDestination &quot;<span class="token variable">${ORACLE_RECOVERY_AREA_DIR}</span>&quot;                    \
     -redoLogFileSize <span class="token variable">${ORACLE_REDOLOG_SIZE}</span>                                   \
     -emConfiguration NONE                                                                                                             

echo &quot;Install Oracle Database <span class="token variable">$ORACLE_DATABASE_VERSION</span> successfully!&quot;
EOF</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">EnableAutoStartup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Edit /etc/oratab ...&quot;</span>
    <span class="token function">cp</span> /etc/oratab /etc/oratab.orabak
    <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&quot;s#<span class="token variable">${ORACLE_SID}</span>:<span class="token variable">${ORACLE_HOME}</span>:N#<span class="token variable">${ORACLE_SID}</span>:<span class="token variable">${ORACLE_HOME}</span>:Y#g&quot;</span> /etc/oratab
    <span class="token function">su</span> - <span class="token variable">$OS_ORACLE_USER</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOFOUT
sqlplus / as sysdba &lt;&lt;EOF
alter system set db_create_file_dest=&#39;<span class="token variable">${ORACLE_DATA_DIR}</span>&#39;;
alter pluggable database <span class="token variable">${ORACLE_PDB_NAME}</span> open;
alter pluggable database <span class="token variable">${ORACLE_PDB_NAME}</span> save state;
exit;
EOF
EOFOUT</span>

    <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">${OS_DBA_HOME}</span>/scripts
    <span class="token function">chown</span> <span class="token variable">$OS_ORACLE_USER</span>:root <span class="token parameter variable">-R</span> <span class="token variable">${OS_DBA_HOME}</span>

    <span class="token function">su</span> - <span class="token variable">$OS_ORACLE_USER</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
touch <span class="token variable">${OS_DBA_HOME}</span>/scripts/startup_db.sh
chmod a+x <span class="token variable">${OS_DBA_HOME}</span>/scripts/startup_db.sh

cat &gt; <span class="token variable">${OS_DBA_HOME}</span>/scripts/startup_db.sh &lt;&lt;&quot;EOFINNER&quot;
#! /bin/sh
# description: Oracle auto start-stop script.
#
# Set ORA_HOME to be equivalent to the \<span class="token variable">$ORACLE_HOME</span>
# from which you wish to execute dbstart and dbshut;
#
# Set ORA_OWNER to the user id of the owner of the
# Oracle database in ORACLE_HOME.

ORA_HOME=<span class="token variable">$ORACLE_HOME</span>
ORA_OWNER=<span class="token variable">$OS_ORACLE_USER</span>
CURRENT_USER=\<span class="token variable"><span class="token variable">`</span>whoami<span class="token punctuation">\</span><span class="token variable">`</span></span>

case &quot;\<span class="token variable">$1</span>&quot; in
&#39;start&#39;) 
    # Start the Oracle databases:
    # The following command assumes that the oracle login
    # will not prompt the user for any values
    # Remove &quot;&amp;&quot; if you don&#39;t want startup as a background process.
    if [ &quot;\<span class="token variable">$ORA_OWNER</span>&quot; = &quot;\<span class="token variable">$CURRENT_USER</span>&quot; ]; then
    \<span class="token variable">$ORA_HOME</span>/bin/dbstart \<span class="token variable">$ORA_HOME</span>
    else
    su - \<span class="token variable">$ORA_OWNER</span> -c &quot;\<span class="token variable">$ORA_HOME</span>/bin/dbstart \<span class="token variable">$ORA_HOME</span>&quot; 
    fi
    touch /var/lock/subsys/dbora
    break
    ;;

&#39;stop&#39;)
    # Stop the Oracle databases:
    # The following command assumes that the oracle login
    # will not prompt the user for any values
    if [ &quot;\<span class="token variable">$ORA_OWNER</span>&quot; = &quot;\<span class="token variable">$CURRENT_USER</span>&quot; ]; then
    \<span class="token variable">$ORA_HOME</span>/bin/dbshut \<span class="token variable">$ORA_HOME</span>
    else
    su - \<span class="token variable">$ORA_OWNER</span> -c &quot;\<span class="token variable">$ORA_HOME</span>/bin/dbshut \<span class="token variable">$ORA_HOME</span>&quot; &amp;
    fi
    rm -f /var/lock/subsys/dbora
    break
    ;;
   *)
    echo &quot;usage: <span class="token variable">$0</span> {start|stop}&quot;
    exit
    ;;
esac
EOF</span>INNER
EOF

    <span class="token function">cat</span> <span class="token operator">&gt;</span>/lib/systemd/system/dbora.service <span class="token operator">&lt;&lt;</span><span class="token string">EOF
[Unit]
Description=The Oracle Database Service
After=syslog.target network.target

[Service]
# systemd ignores PAM limits, so set any necessary limits in the service.
# Not really a bug, but a feature.
# https://bugzilla.redhat.com/show_bug.cgi?id=754285
LimitMEMLOCK=infinity
LimitNOFILE=65535

#Type=simple
# idle: similar to simple, the actual execution of the service binary is delayed
#       until all jobs are finished, which avoids mixing the status output with shell output of services.
RemainAfterExit=yes
User=oracle
Group=oinstall
Restart=no
ExecStart=/bin/bash -c &#39;<span class="token variable">${OS_DBA_HOME}</span>/scripts/startup_db.sh start&#39;
ExecStop=/bin/bash -c &#39;<span class="token variable">${OS_DBA_HOME}</span>/scripts/startup_db.sh stop&#39;

[Install]
WantedBy=multi-user.target
EOF</span>

    <span class="token comment"># autostart after os reboot</span>
    systemctl <span class="token builtin class-name">enable</span> dbora.service
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">SetFirewall</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment"># add allow port to firewalld</span>
    systemctl start firewalld
    firewall-cmd --add-port<span class="token operator">=</span><span class="token variable">$ORACLE_LISTENER_PORT</span> <span class="token parameter variable">--zone</span><span class="token operator">=</span>public <span class="token parameter variable">--permanent</span>
    firewall-cmd <span class="token parameter variable">--reload</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">UninstallDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Uninstall database ...&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Shutdown database and stop listener ...&quot;</span>
    <span class="token function">su</span> - <span class="token variable">$OS_ORACLE_USER</span> <span class="token operator">&lt;&lt;</span><span class="token string">OUT
sqlplus / as sysdba &lt;&lt;SQL
shutdown immediate;
SQL
lsnrctl stop
OUT</span>

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Removing oraInst.loc and oratab file ...&quot;</span>
    <span class="token function">rm</span> <span class="token parameter variable">-f</span> /etc/oraInst.loc
    <span class="token function">rm</span> <span class="token parameter variable">-f</span> /etc/oratab

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Removing database file and database software ...&quot;</span>
    <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">$ORACLE_BASE_APP_DIR</span>/*
    <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">$ORACLE_BASE_DATA_DIR</span>/*
    <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">$ORACLE_BASE_RECOVERY_AREA_DIR</span>/*

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Removing Oracle Group and User ...&quot;</span>
    <span class="token function">userdel</span> <span class="token variable">$OS_ORACLE_USER</span>
    <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /home/<span class="token variable">$OS_ORACLE_USER</span>

    <span class="token function">groupdel</span> oinstall
    <span class="token function">groupdel</span> dba
    <span class="token function">groupdel</span> oper

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Reset Resource Usage Limit ...&quot;</span>
    <span class="token function">cp</span> <span class="token parameter variable">-f</span> /etc/pam.d/login.orabak /etc/pam.d/login
    <span class="token function">cp</span> <span class="token parameter variable">-f</span> /etc/security/limits.conf.orabak /etc/security/limits.conf

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Reset sysctl.conf ...&quot;</span>
    <span class="token function">cp</span> <span class="token parameter variable">-f</span> /etc/sysctl.conf.orabak /etc/sysctl.conf

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Reset hosts ...&quot;</span>
    <span class="token function">cp</span> /etc/hosts.orabak /etc/hosts
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">Usage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
Usage: <span class="token variable">$0</span> -h|--helpUsage, help message.
       <span class="token variable">$0</span> -d|--installDependency, install oracle dependency.
       <span class="token variable">$0</span> -a|--installAll, install dependency,database software,create netca,create database.     
       <span class="token variable">$0</span> -s|--installSoftware, install database software. 
       <span class="token variable">$0</span> -c|--createDatabase, create database.
       <span class="token variable">$0</span> -e|--enable, enable database auto startup after system boot/reboot.
       <span class="token variable">$0</span> -p|--package, download database package.
       <span class="token variable">$0</span> -r|--remove, uninstall database.
       <span class="token variable">$0</span> -f|--firewall, set firewall.
EOF</span>
<span class="token punctuation">}</span>

<span class="token comment"># configuration before installation</span>
PackageVersionCongiguration
DatabaseVersionConfiguration

<span class="token assign-left variable">ARGS</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>getopt <span class="token parameter variable">-o</span> hdasnceprf <span class="token parameter variable">--long</span> help,installDependency,installAll,installSoftware,createNetca,createDatabase,enable,package,remove,firewall <span class="token parameter variable">-n</span> <span class="token string">&quot;<span class="token variable">$0</span>&quot;</span> -- <span class="token string">&quot;<span class="token variable">$@</span>&quot;</span><span class="token variable">)</span></span>
<span class="token builtin class-name">eval</span> <span class="token builtin class-name">set</span> -- <span class="token string">&quot;<span class="token variable">$ARGS</span>&quot;</span>
<span class="token keyword">while</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token keyword">case</span> <span class="token string">&quot;<span class="token variable">$1</span>&quot;</span> <span class="token keyword">in</span>
    <span class="token parameter variable">-h</span> <span class="token operator">|</span> --help<span class="token punctuation">)</span>
        Usage
        <span class="token builtin class-name">shift</span> <span class="token number">2</span>
        <span class="token builtin class-name">break</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token parameter variable">-d</span> <span class="token operator">|</span> --installDependency<span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;InstallDependency ...&quot;</span>
        <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
        InstallDependency
        <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: <span class="token variable"><span class="token variable">$((</span>$ENDTIME <span class="token operator">-</span> $STARTTIME<span class="token variable">))</span></span> s&quot;</span>
        <span class="token builtin class-name">shift</span> <span class="token number">2</span>
        <span class="token builtin class-name">break</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token parameter variable">-a</span> <span class="token operator">|</span> --installAll<span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;InstallAll ...&quot;</span>
        <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
        InstallDependency
        InstallSoftware
        <span class="token comment"># CreateNetca</span>
        CreateDatabase
        <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: <span class="token variable"><span class="token variable">$((</span>$ENDTIME <span class="token operator">-</span> $STARTTIME<span class="token variable">))</span></span> s&quot;</span>
        <span class="token builtin class-name">shift</span> <span class="token number">2</span>
        <span class="token builtin class-name">break</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token parameter variable">-s</span> <span class="token operator">|</span> --installSoftware<span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;InstallSoftware ...&quot;</span>
        <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
        InstallDependency
        InstallSoftware
        <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: <span class="token variable"><span class="token variable">$((</span>$ENDTIME <span class="token operator">-</span> $STARTTIME<span class="token variable">))</span></span> s&quot;</span>
        <span class="token builtin class-name">shift</span> <span class="token number">2</span>
        <span class="token builtin class-name">break</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token parameter variable">-n</span> <span class="token operator">|</span> --createNetca<span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Create Netca ...&quot;</span>
        <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
        CreateNetca
        <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Create Netca Elapsed: <span class="token variable"><span class="token variable">$((</span>$ENDTIME <span class="token operator">-</span> $STARTTIME<span class="token variable">))</span></span> s&quot;</span>
        <span class="token builtin class-name">shift</span> <span class="token number">2</span>
        <span class="token builtin class-name">break</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token parameter variable">-c</span> <span class="token operator">|</span> --createDatabase<span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;CreateDatabase ...&quot;</span>
        <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
        CreateDatabase
        <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: <span class="token variable"><span class="token variable">$((</span>$ENDTIME <span class="token operator">-</span> $STARTTIME<span class="token variable">))</span></span> s&quot;</span>
        <span class="token builtin class-name">shift</span> <span class="token number">2</span>
        <span class="token builtin class-name">break</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token parameter variable">-e</span> <span class="token operator">|</span> --enable<span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Enable Auto Startup ...&quot;</span>
        <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
        EnableAutoStartup
        <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Enable Auto Startup Elapsed: <span class="token variable"><span class="token variable">$((</span>$ENDTIME <span class="token operator">-</span> $STARTTIME<span class="token variable">))</span></span> s&quot;</span>
        <span class="token builtin class-name">shift</span> <span class="token number">2</span>
        <span class="token builtin class-name">break</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token parameter variable">-p</span> <span class="token operator">|</span> --package<span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Downloading Package ...&quot;</span>
        <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
        DownloadPackage
        <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Downloading Package Elapsed: <span class="token variable"><span class="token variable">$((</span>$ENDTIME <span class="token operator">-</span> $STARTTIME<span class="token variable">))</span></span> s&quot;</span>
        <span class="token builtin class-name">shift</span> <span class="token number">2</span>
        <span class="token builtin class-name">break</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token parameter variable">-r</span> <span class="token operator">|</span> --remove<span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Unintalling Database ...&quot;</span>
        <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
        UninstallDatabase
        <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Unintalling Database Elapsed: <span class="token variable"><span class="token variable">$((</span>$ENDTIME <span class="token operator">-</span> $STARTTIME<span class="token variable">))</span></span> s&quot;</span>
        <span class="token builtin class-name">shift</span> <span class="token number">2</span>
        <span class="token builtin class-name">break</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token parameter variable">-f</span> <span class="token operator">|</span> --firewall<span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Set Firewalld ...&quot;</span>
        <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
        SetFirewall
        <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Set Firewalld Elapsed: <span class="token variable"><span class="token variable">$((</span>$ENDTIME <span class="token operator">-</span> $STARTTIME<span class="token variable">))</span></span> s&quot;</span>
        <span class="token builtin class-name">shift</span> <span class="token number">2</span>
        <span class="token builtin class-name">break</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    *<span class="token punctuation">)</span>
        Usage
        <span class="token builtin class-name">exit</span> <span class="token number">1</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token keyword">esac</span>
<span class="token keyword">done</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-3-2" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">modb onkey</div><!--[--><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">#/bin/bash</span>
<span class="token function-name function">step1_check_os</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token comment">#1.1. check hostname </span>
	<span class="token assign-left variable">os_name</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">hostname</span><span class="token variable">`</span></span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$os_name</span>&quot;</span> <span class="token operator">=~</span> ^localhost <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
		<span class="token builtin class-name">echo</span> <span class="token string">&quot;ERROR: hostname: <span class="token variable">$os_name</span> is invalid,pls check&quot;</span>
		<span class="token builtin class-name">echo</span> <span class="token string">&quot;command set new hostname: hostnamectl set-hostname newhostname&quot;</span>
		<span class="token builtin class-name">exit</span> <span class="token parameter variable">-1</span>
	<span class="token keyword">else</span>
		<span class="token builtin class-name">echo</span> <span class="token string">&quot;1.1. hostname check passed&quot;</span>
	<span class="token keyword">fi</span>
	
	<span class="token comment">#1.2 ip check</span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">`</span><span class="token function">ip</span> addr<span class="token operator">|</span><span class="token function">egrep</span> <span class="token string">&#39;inet &#39;</span><span class="token operator">|</span><span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token string">&#39;127.0.0.1&#39;</span><span class="token operator">|</span><span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">`</span></span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
		<span class="token builtin class-name">echo</span> <span class="token string">&quot;ERROR: ip addr check is invalid,pls check&quot;</span>
	<span class="token keyword">else</span>
		<span class="token builtin class-name">echo</span> <span class="token string">&quot;1.2. ip check passed&quot;</span>
	<span class="token keyword">fi</span>
	

    <span class="token comment">#1.3 check db software</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$ora_version</span>&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;11G&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-f</span> /soft/p13390677_112040_Linux-x86-64_1of7.zip <span class="token operator">&amp;&amp;</span> <span class="token parameter variable">-f</span> /soft/p13390677_112040_Linux-x86-64_2of7.zip <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	    <span class="token builtin class-name">echo</span> <span class="token string">&quot;1.3 software check passed&quot;</span>
	<span class="token keyword">else</span>
	    <span class="token builtin class-name">echo</span> <span class="token string">&quot;ERROR: software check failed,pls upload p13390677_112040_Linux-x86-64_1of7.zip and p13390677_112040_Linux-x86-64_2of7.zip to directory /soft/&quot;</span>
	    <span class="token builtin class-name">exit</span> <span class="token parameter variable">-1</span>
	<span class="token keyword">fi</span>
<span class="token keyword">elif</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$ora_version</span>&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;19C&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-f</span> /soft/LINUX.X64_193000_db_home.zip <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	    <span class="token builtin class-name">echo</span> <span class="token string">&quot;1.3 software check passed&quot;</span>
	<span class="token keyword">else</span>
	    <span class="token builtin class-name">echo</span> <span class="token string">&quot;ERROR: software check failed,pls upload 19db.zip to directory /soft/&quot;</span>
	    <span class="token builtin class-name">exit</span> <span class="token parameter variable">-1</span>
	<span class="token keyword">fi</span>	
<span class="token keyword">elif</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$ora_version</span>&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;21C&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-f</span> /soft/LINUX.X64_213000_db_home.zip <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	    <span class="token builtin class-name">echo</span> <span class="token string">&quot;1.3 software check passed&quot;</span>
	<span class="token keyword">else</span>
			<span class="token builtin class-name">echo</span> <span class="token string">&quot;ERROR: software check failed,pls upload 21db.zip to directory /soft/&quot;</span>
			<span class="token builtin class-name">exit</span> <span class="token parameter variable">-1</span>
	<span class="token keyword">fi</span>	
<span class="token keyword">fi</span> 
	

	<span class="token comment">#2.check os release</span>
	<span class="token assign-left variable">os_release</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> /etc/redhat-release<span class="token operator">|</span><span class="token function">sed</span> <span class="token parameter variable">-r</span> <span class="token string">&#39;s/[ a-zA-Z()]//g&#39;</span><span class="token operator">|</span><span class="token function">awk</span> -F<span class="token string">&quot;.&quot;</span> <span class="token string">&#39;{print $1}&#39;</span><span class="token variable">`</span></span>
	<span class="token builtin class-name">echo</span> <span class="token string">&quot;****<span class="token variable">$os_release</span>**&quot;</span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$os_release</span> <span class="token operator">!=</span> <span class="token number">7</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	    <span class="token builtin class-name">echo</span> <span class="token string">&quot;ERROR: os release not RedHat 7.X&quot;</span>
	    <span class="token builtin class-name">exit</span> <span class="token parameter variable">-1</span>
	<span class="token keyword">else</span>
	    <span class="token builtin class-name">echo</span> <span class="token string">&quot;2. os release check passed&quot;</span>
	<span class="token keyword">fi</span>

	<span class="token comment">#3.check oracle user</span>
	<span class="token function">id</span> oracle <span class="token operator">&amp;&gt;</span> /dev/null
	<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	    <span class="token builtin class-name">echo</span> <span class="token string">&quot;ERROR: oracle user created,pls check&quot;</span>
	    <span class="token builtin class-name">exit</span> <span class="token parameter variable">-1</span>
	<span class="token keyword">else</span>
	    <span class="token builtin class-name">echo</span> <span class="token string">&quot;3. oracle user check passed&quot;</span>
	<span class="token keyword">fi</span>

	<span class="token comment">#4.check /u01/app/oracle directory</span>
	<span class="token function">ls</span> /u01/app/oracle  <span class="token operator">&amp;&gt;</span> /dev/null
	<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	    <span class="token builtin class-name">echo</span> <span class="token string">&quot;ERROR: /u01/app/oracle directory created,pls check&quot;</span>
	    <span class="token builtin class-name">exit</span> <span class="token parameter variable">-1</span>
	<span class="token keyword">else</span>
	    <span class="token builtin class-name">echo</span> <span class="token string">&quot;4. oracle user check passed&quot;</span>
	<span class="token keyword">fi</span>

	<span class="token comment">#5.check mount /dev/cdrom /mnt directory</span>
	<span class="token function">mount</span> /dev/cdrom /mnt  <span class="token operator">&amp;&gt;</span> /dev/null
	<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	    <span class="token builtin class-name">echo</span> <span class="token string">&quot;ERROR: mount /dev/cdrom /mnt failed,pls check&quot;</span>
	    <span class="token builtin class-name">exit</span> <span class="token parameter variable">-1</span>
	<span class="token keyword">else</span>
	    <span class="token builtin class-name">echo</span> <span class="token string">&quot;5. mount cdrom check passed&quot;</span>
	    <span class="token function">umount</span> /mnt
	<span class="token keyword">fi</span>
<span class="token punctuation">}</span>

<span class="token function-name function">step2_set_dbname_and_charset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">#6. input dbname/CHARACTERSET/NATIONALCHARACTERSET</span>

<span class="token comment">### dbname</span>
<span class="token keyword">while</span> <span class="token boolean">true</span>
<span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;*********************************   
    NOTE: 
    DB_NAME start with alphabetical up to 8 characters of 
    alphanumeric characters, 
    underscore (_), 
    number sign (#), 
    and dollar sign ($).
    *********************************&quot;</span>

    <span class="token builtin class-name">read</span> <span class="token parameter variable">-p</span> <span class="token string">&quot;pls,input dbname(default: orcl): &quot;</span> dbname

    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">${<span class="token operator">#</span>dbname}</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
        <span class="token assign-left variable">dbname</span><span class="token operator">=</span>orcl
    <span class="token keyword">fi</span>

    <span class="token builtin class-name">echo</span> <span class="token string">&quot;***********&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;dbname: <span class="token variable">$dbname</span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;***********&quot;</span>

    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${<span class="token operator">#</span>dbname}</span><span class="token operator">&gt;</span><span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">${<span class="token operator">#</span>dbname}</span><span class="token operator">&lt;</span><span class="token number">9</span> <span class="token operator">&amp;&amp;</span> <span class="token string">&quot;<span class="token variable">$dbname</span>&quot;</span> <span class="token operator">=~</span> <span class="token punctuation">[</span>a-Z<span class="token punctuation">]</span><span class="token punctuation">[</span>a-Z0-9_<span class="token comment">#$]* ]];then</span>
        <span class="token builtin class-name">break</span>
    <span class="token keyword">else</span>
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span> ERROR: dbname: <span class="token variable">$dbname</span> is invalid,pls input again <span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>
    <span class="token keyword">fi</span>
        
<span class="token keyword">done</span>


<span class="token comment">### ContainerDatabase</span>

	<span class="token comment"># if install 19C or 21C,choose whether use ContainerDatabase</span>
    <span class="token assign-left variable">cdb_flag</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
    <span class="token assign-left variable">s_numberOfPDBs</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
    <span class="token assign-left variable">s_pdbName</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$ora_version</span>&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;19C&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
    	<span class="token keyword">while</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$cdb_flag</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;TRUE&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token string">&quot;<span class="token variable">$cdb_flag</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;FALSE&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>
    	<span class="token keyword">do</span>
  			<span class="token builtin class-name">read</span> <span class="token parameter variable">-p</span> <span class="token string">&quot;use ContainerDatabase TRUE/FALSE(default FALSE):&quot;</span> cdb_flag
  			<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$cdb_flag</span>&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
  				<span class="token assign-left variable">cdb_flag</span><span class="token operator">=</span><span class="token string">&quot;FALSE&quot;</span>
  			<span class="token keyword">fi</span>
  		<span class="token keyword">done</span>	
  	<span class="token keyword">fi</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$ora_version</span>&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;21C&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
  		<span class="token assign-left variable">cdb_flag</span><span class="token operator">=</span><span class="token string">&quot;TRUE&quot;</span>  		
  	<span class="token keyword">fi</span>


<span class="token keyword">while</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$cdb_flag</span>&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;TRUE&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">do</span>    		  			
  		<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$s_pdbName</span>&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
  			<span class="token builtin class-name">echo</span> <span class="token string">&quot;*****<span class="token variable">$s_pdbName</span>****&quot;</span>
  			<span class="token builtin class-name">read</span> <span class="token parameter variable">-p</span> <span class="token string">&quot;pls input pdbName: &quot;</span> s_pdbName
  		<span class="token keyword">elif</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${<span class="token operator">#</span>s_pdbName}</span><span class="token operator">&gt;</span><span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">${<span class="token operator">#</span>s_pdbName}</span><span class="token operator">&lt;</span><span class="token number">9</span> <span class="token operator">&amp;&amp;</span> <span class="token string">&quot;<span class="token variable">$s_pdbName</span>&quot;</span> <span class="token operator">=~</span> <span class="token punctuation">[</span>a-Z<span class="token punctuation">]</span><span class="token punctuation">[</span>a-Z0-9_<span class="token comment">#$]* ]];then</span>
  			<span class="token builtin class-name">break</span>
  		<span class="token keyword">else</span>			
  			<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span> ERROR: pdbName: <span class="token variable">$pdbName</span> is invalid,pls input again <span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>
  			<span class="token builtin class-name">read</span> <span class="token parameter variable">-p</span> <span class="token string">&quot;pls input pdbName: &quot;</span> s_pdbName
  		<span class="token keyword">fi</span>  		
<span class="token keyword">done</span>


<span class="token comment">### charset</span>
<span class="token keyword">while</span> <span class="token boolean">true</span>
<span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span>  <span class="token string">&quot;*****************************
    1) ZHS16GBK
    2) AL32UTF8&quot;</span>
    
    <span class="token builtin class-name">read</span> <span class="token parameter variable">-p</span> <span class="token string">&quot;pls,input db CHARACTERSET(default value: ZHS16GBK):&quot;</span> db_CHARACTERSET

    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">${<span class="token operator">#</span>db_CHARACTERSET}</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
        <span class="token assign-left variable">db_CHARACTERSET</span><span class="token operator">=</span><span class="token string">&quot;ZHS16GBK&quot;</span>
    <span class="token keyword">fi</span>

    <span class="token builtin class-name">echo</span>  <span class="token string">&quot;*****************************
    1) AL16UTF16
    2) UTF8&quot;</span>
    
    <span class="token builtin class-name">read</span> <span class="token parameter variable">-p</span> <span class="token string">&quot;pls,input db NATIONAL CHARACTERSET(default value: AL16UTF16):&quot;</span> db_NCHARACTERSET


    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">${<span class="token operator">#</span>db_NCHARACTERSET}</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
        <span class="token assign-left variable">db_NCHARACTERSET</span><span class="token operator">=</span><span class="token string">&quot;AL16UTF16&quot;</span>
    <span class="token keyword">fi</span>

    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$db_CHARACTERSET</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;ZHS16GBK&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token string">&quot;<span class="token variable">$db_CHARACTERSET</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;AL32UTF8&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span> ERROR: input db CHARACTERSET: <span class="token variable">$db_CHARACTERSET</span> invalid,pls check <span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>
    <span class="token keyword">elif</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$db_NCHARACTERSET</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;AL16UTF16&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token string">&quot;<span class="token variable">$db_NCHARACTERSET</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;UTF8&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span> ERROR: input db NATIONAL CHARACTERSET: <span class="token variable">$db_NCHARACTERSET</span> invalid,pls check <span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>
    <span class="token keyword">else</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;*****************&quot;</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;db_CHARACTERSET: <span class="token variable">$db_CHARACTERSET</span>&quot;</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;db_NCHARACTERSET: <span class="token variable">$db_NCHARACTERSET</span>&quot;</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;*****************&quot;</span>
        <span class="token builtin class-name">break</span>
    <span class="token keyword">fi</span>
<span class="token keyword">done</span>

<span class="token assign-left variable">starttime</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">date</span> +<span class="token string">&#39;%Y-%m-%d %H:%M:%S&#39;</span><span class="token variable">`</span></span>
<span class="token punctuation">}</span>

<span class="token function-name function">step3_set_os</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">#7. add hostname to /etc/hosts</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">`</span><span class="token function">hostname</span><span class="token variable">`</span></span><span class="token entity" title="\t">\t</span><span class="token variable"><span class="token variable">`</span><span class="token function">ip</span> addr<span class="token operator">|</span><span class="token function">egrep</span> <span class="token string">&#39;inet &#39;</span><span class="token operator">|</span><span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token string">&#39;127.0.0.1&#39;</span><span class="token operator">|</span><span class="token function">awk</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token operator">|</span><span class="token function">sed</span> <span class="token parameter variable">-r</span> <span class="token string">&#39;s#/24##&#39;</span><span class="token operator">|</span><span class="token function">head</span> <span class="token parameter variable">-1</span><span class="token variable">`</span></span>&quot;</span><span class="token operator">&gt;&gt;</span> /etc/hosts
<span class="token function">cat</span> /etc/hosts

<span class="token comment">#8. yum config</span>
<span class="token function">mount</span> /dev/cdrom /mnt
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token operator">!=</span> <span class="token number">0</span>  <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>ERROR: cant not mount cdrom<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>
<span class="token builtin class-name">exit</span> <span class="token parameter variable">-1</span>
<span class="token keyword">else</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;8.1 cdrom have mounted&quot;</span>
<span class="token keyword">fi</span>

<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /etc/yum.repos.d/bak
<span class="token function">mv</span> /etc/yum.repos.d/*.repo /etc/yum.repos.d/bak/
<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /etc/yum.repos.d/rhel-source.repo <span class="token operator">&lt;&lt;-</span><span class="token string">EOF
[rhel-oracle-lib]
name=oracle
baseurl=file:///mnt
enabled=1
gpgcheck=0
EOF</span>

yum list <span class="token operator">&amp;&gt;</span> /dev/null
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token operator">!=</span> <span class="token number">0</span>  <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>ERROR: yum list check failed <span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>
<span class="token builtin class-name">exit</span> <span class="token parameter variable">-1</span>
<span class="token keyword">else</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;8.2 yum config completed&quot;</span>
<span class="token keyword">fi</span>

yum <span class="token function">install</span> <span class="token parameter variable">-y</span>  gcc compat-gcc-34 elfutils-libelf-devel compat-libstdc++-33 elfutils-libelf gcc-c++ glibc-headers libaio libaio-devel libgcc libstdc++ libstdc++-devel <span class="token function">make</span> ksh sysstat unixODBC compat-libcap1 libXp device-mapper-multipath libXi.x86_64 libXtst.x86_64 xorg-x11-utils  <span class="token function">unzip</span> <span class="token function">zip</span> smartmontools net-tools lrzsz <span class="token function">vim</span> sysstat dstat  libnsl policycoreutils-python <span class="token function">bc</span>



<span class="token comment">#9. stop os service</span>
systemctl status firewalld
systemctl stop firewalld
systemctl disable firewalld
systemctl is-enabled firewalld
/bin/sed <span class="token parameter variable">-i</span> s/SELINUX<span class="token operator">=</span>enforcing/SELINUX<span class="token operator">=</span>disabled/ /etc/selinux/config
<span class="token function">cat</span> /etc/selinux/config<span class="token operator">|</span><span class="token function">grep</span> <span class="token assign-left variable">SELINUX</span><span class="token operator">=</span>
systemctl stop tuned.service 
systemctl stop ktune.service
systemctl stop firewalld.service
systemctl stop postfix.service
systemctl stop avahi-daemon.socket
systemctl stop avahi-daemon.service
systemctl stop atd.service
systemctl stop bluetooth.service
systemctl stop wpa_supplicant.service
systemctl stop accounts-daemon.service
systemctl stop atd.service cups.service
systemctl stop ModemManager.service
systemctl stop debug-shell.service
systemctl stop rtkit-daemon.service
systemctl stop rpcbind.service
systemctl stop rngd.service
systemctl stop upower.service
systemctl stop rhsmcertd.service
systemctl stop mcelog.service
systemctl stop colord.service
systemctl stop gdm.service
systemctl stop libstoragemgmt.service
systemctl stop ksmtuned.service
systemctl stop brltty.service
systemctl stop avahi-dnsconfd.service
systemctl stop iptables
systemctl stop ip6tables
systemctl stop Bluetooth
systemctl stop cups
systemctl stop cpuspeed
systemctl stop NetworkManager
systemctl stop vsftpd
systemctl stop dhcpd
systemctl stop nfs
systemctl stop nfslock
systemctl stop ypbind
systemctl disable tuned.service 
systemctl disable ktune.service
systemctl disable firewalld.service
systemctl disable postfix.service
systemctl disable avahi-daemon.socket
systemctl disable avahi-daemon.service
systemctl disable atd.service
systemctl disable bluetooth.service
systemctl disable wpa_supplicant.service
systemctl disable accounts-daemon.service
systemctl disable atd.service cups.service
systemctl disable ModemManager.service
systemctl disable debug-shell.service
systemctl disable rtkit-daemon.service
systemctl disable rpcbind.service
systemctl disable rngd.service
systemctl disable upower.service
systemctl disable rhsmcertd.service
systemctl disable mcelog.service
systemctl disable colord.service
systemctl disable gdm.service
systemctl disable libstoragemgmt.service
systemctl disable ksmtuned.service
systemctl disable brltty.service
systemctl disable avahi-dnsconfd.service
systemctl disable iptables
systemctl disable ip6tables
systemctl disable Bluetooth
systemctl disable cups
systemctl disable cpuspeed
systemctl disable NetworkManager
systemctl disable vsftpd
systemctl disable dhcpd
systemctl disable nfs
systemctl disable nfslock
systemctl disable ypbind


<span class="token comment">#10. os parameter config</span>
<span class="token assign-left variable">mem_total</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">free</span><span class="token operator">|</span><span class="token function">egrep</span> <span class="token string">&#39;Mem:&#39;</span><span class="token operator">|</span><span class="token function">awk</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">`</span></span>
<span class="token assign-left variable">huge_mem</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">echo</span> <span class="token number">2</span>+$mem_total*0.525/2048<span class="token operator">|</span><span class="token function">bc</span><span class="token operator">|</span><span class="token function">awk</span> -F<span class="token string">&quot;.&quot;</span> <span class="token string">&#39;{print $1}&#39;</span><span class="token variable">`</span></span>

<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /etc/sysctl.conf <span class="token operator">&lt;&lt;-</span><span class="token string">EOF
#for oracle
kernel.shmall = <span class="token variable">$mem_total</span>
kernel.shmmax = <span class="token variable"><span class="token variable">$((</span>$mem_total<span class="token operator">*</span><span class="token number">1024</span><span class="token variable">))</span></span>
kernel.shmmni = 4096
kernel.sem = 250 32000 100 128
fs.file-max = 6815744
net.ipv4.ip_local_port_range = 9000 65500
net.core.rmem_default = 262144
net.core.rmem_max = 4194304
net.core.wmem_default = 262144
net.core.wmem_max = 1048576
net.ipv4.ipfrag_high_thresh = 4194304
net.ipv4.ipfrag_low_thresh = 3145728
fs.aio-max-nr = 1048576 
vm.min_free_kbytes = 512000
vm.vfs_cache_pressure = 200
vm.swappiness = 20
vm.nr_hugepages=<span class="token variable">$huge_mem</span>
EOF</span>
<span class="token function">sysctl</span> <span class="token parameter variable">-p</span>


<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /etc/security/limits.conf <span class="token operator">&lt;&lt;-</span><span class="token string">EOF
#for oracle
oracle  soft  nproc 16384
oracle  hard  nproc 16384
oracle  soft  nofile 10240
oracle  hard  nofile 65536
oracle  soft  stack 10240
oracle  hard  stack 32768
oracle  soft  memlock unlimited
oracle  hard  memlock unlimited
oracle  soft  core unlimited
oracle  hard  core unlimited
EOF</span>

<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /etc/pam.d/login <span class="token operator">&lt;&lt;-</span><span class="token string">EOF
#for oracle
session    required     pam_limits.so
EOF</span>



<span class="token comment">#11. creater user</span>
lsattr /etc/passwd
lsattr /etc/group
lsattr /etc/gshadow

chattr <span class="token parameter variable">-i</span> /etc/passwd
chattr <span class="token parameter variable">-i</span> /etc/group
chattr <span class="token parameter variable">-i</span> /etc/gshadow

/usr/sbin/groupadd <span class="token parameter variable">-g</span> <span class="token number">1001</span> oinstall                                     
/usr/sbin/groupadd <span class="token parameter variable">-g</span> <span class="token number">1002</span> dba                                           
                                    
/usr/sbin/useradd <span class="token parameter variable">-u</span> <span class="token number">1002</span> <span class="token parameter variable">-g</span> oinstall <span class="token parameter variable">-G</span> dba oracle               
/bin/echo <span class="token string">&quot;Enmo_1234&quot;</span> <span class="token operator">|</span>/usr/bin/passwd <span class="token parameter variable">--stdin</span> oracle

<span class="token comment">#12. disable Transparent HugePages</span>
<span class="token function">chmod</span> +x /etc/rc.d/rc.local
<span class="token function">ls</span> /sys/kernel/mm/transparent_hugepage/enabled <span class="token operator">&amp;&gt;</span> /dev/null
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	<span class="token keyword">if</span> <span class="token builtin class-name">test</span> <span class="token parameter variable">-f</span> /sys/kernel/mm/transparent_hugepage/enabled<span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token builtin class-name">echo</span> never <span class="token operator">&gt;</span> /sys/kernel/mm/transparent_hugepage/enabled
        <span class="token function">cat</span> /sys/kernel/mm/transparent_hugepage/enabled
	<span class="token keyword">fi</span>
	
	<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /etc/rc.local <span class="token operator">&lt;&lt;-</span><span class="token string">EOF
		if test -f /sys/kernel/mm/transparent_hugepage/enabled; then
   		    echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled
		fi
	EOF
    cat /etc/rc.local
    cat /sys/kernel/mm/transparent_hugepage/enabled

fi
 

ls /sys/kernel/mm/redhat_transparent_hugepage/enabled &amp;&gt; /dev/null
if [ <span class="token variable">$?</span> == 0 ];then
    echo &quot;************************&quot;
	if test -f /sys/kernel/mm/redhat_transparent_hugepage/enabled; then
        echo never &gt; /sys/kernel/mm/redhat_transparent_hugepage/enabled
        cat /sys/kernel/mm/redhat_transparent_hugepage/enabled
	fi
	
	cat &gt;&gt; /etc/rc.d/rc.local &lt;&lt;-EOF
		if test -f /sys/kernel/mm/redhat_transparent_hugepage/enabled; then
   		    echo never &gt; /sys/kernel/mm/redhat_transparent_hugepage/enabled
		fi
	EOF

    cat /etc/rc.local
    cat /sys/kernel/mm/redhat_transparent_hugepage/enabled
fi

#13. create directory
/bin/mkdir -p /u01/app/oracle
/bin/chown -R oracle:oinstall /u01
/bin/chmod -R 775 /u01

/bin/mkdir -p /oradata
/bin/chown -R oracle:oinstall /oradata
/bin/chmod -R 775 /oradata

/bin/mkdir -p /soft
/bin/chown -R oracle:oinstall /soft
/bin/chmod -R 775 /soft

#14. set oracle bash_profile


if [[ &quot;<span class="token variable">$ora_version</span>&quot; == &quot;11G&quot; ]];then
	
unzip /soft/p13390677_112040_Linux-x86-64_1of7.zip -d /soft/
unzip /soft/p13390677_112040_Linux-x86-64_2of7.zip -d /soft/
elif [[ &quot;<span class="token variable">$ora_version</span>&quot; == &quot;19C&quot; ]];then
	su - oracle -c &quot;mkdir -p /u01/app/oracle/product/<span class="token variable">$ora_number</span>/dbhome_1/&quot;
	su - oracle -c &quot;unzip /soft/LINUX.X64_193000_db_home.zip -d /u01/app/oracle/product/<span class="token variable">$ora_number</span>/dbhome_1/&quot;
elif [[ &quot;<span class="token variable">$ora_version</span>&quot; == &quot;21C&quot; ]];then
	su - oracle -c &quot;mkdir -p /u01/app/oracle/product/<span class="token variable">$ora_number</span>/dbhome_1/&quot;
	su - oracle -c &quot;unzip /soft/LINUX.X64_213000_db_home.zip -d /u01/app/oracle/product/<span class="token variable">$ora_number</span>/dbhome_1/&quot;
fi




cat &gt;&gt; /home/oracle/.bash_profile &lt;&lt;EOF
export  TMP=/tmp
export  TMPDIR=\<span class="token variable">$TMP</span>
export  ORACLE_SID=<span class="token variable">$dbname</span>
export  ORACLE_BASE=/u01/app/oracle
export  ORACLE_HOME=\<span class="token variable">$ORACLE_BASE</span>/product/<span class="token variable">$ora_number</span>/dbhome_1
export  ORACLE_TERM=xterm
export  PATH=/usr/sbin:\<span class="token environment constant">$PATH</span>
export  PATH=\<span class="token variable">$ORACLE_HOME</span>/bin:\<span class="token environment constant">$PATH</span>
export  LD_LIBRARY_PATH=\<span class="token variable">$ORACLE_HOME</span>/lib:/lib:/usr/lib
export  CLASSPATH=\<span class="token variable">$ORACLE_HOME</span>/JRE:\<span class="token variable">$ORACLE_HOME</span>/jlib:\<span class="token variable">$ORACLE_HOME</span>/rdbms/jlib
umask 022
EOF</span>

<span class="token punctuation">}</span>

<span class="token function-name function">step4_create_response_file_11g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

<span class="token comment">#15. create response file</span>
<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /etc/oraInst.loc <span class="token operator">&lt;&lt;-</span><span class="token string">EOF
inventory_loc=/u01/app/oraInventory
inst_group=oinstall 
EOF</span>

<span class="token function">chown</span> oracle:oinstall /etc/oraInst.loc
<span class="token function">chmod</span> <span class="token number">664</span> /etc/oraInst.loc

<span class="token function">rm</span> <span class="token parameter variable">-f</span> /soft/*.rsp

<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /soft/db_install.rsp <span class="token operator">&lt;&lt;</span><span class="token string">EOF
oracle.install.responseFileVersion=/oracle/install/rspfmt_dbinstall_response_schema_v11_2_0
oracle.install.option=INSTALL_DB_SWONLY
ORACLE_HOSTNAME=<span class="token variable"><span class="token variable">`</span><span class="token function">hostname</span><span class="token variable">`</span></span>
UNIX_GROUP_NAME=oinstall
INVENTORY_LOCATION=/u01/app/oraInventory
SELECTED_LANGUAGES=en,zh_CN
ORACLE_HOME=/u01/app/oracle/product/11.2.0/dbhome_1
ORACLE_BASE=/u01/app/oracle
oracle.install.db.InstallEdition=EE
oracle.install.db.EEOptionsSelection=false
oracle.install.db.DBA_GROUP=dba
oracle.install.db.OPER_GROUP=dba
oracle.install.db.isRACOneInstall=false
SECURITY_UPDATES_VIA_MYORACLESUPPORT=false
DECLINE_SECURITY_UPDATES=true
oracle.installer.autoupdates.option=SKIP_UPDATES
EOF</span>

<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /soft/netca.rsp <span class="token operator">&lt;&lt;</span><span class="token string">EOF
[GENERAL]
RESPONSEFILE_VERSION=&quot;11.2&quot;
CREATE_TYPE=&quot;CUSTOM&quot;
[oracle.net.ca]
INSTALLED_COMPONENTS={&quot;server&quot;,&quot;net8&quot;,&quot;javavm&quot;}
INSTALL_TYPE=&quot;&quot;typical&quot;&quot;
LISTENER_NUMBER=1
LISTENER_NAMES={&quot;LISTENER&quot;}
LISTENER_PROTOCOLS={&quot;TCP;1521&quot;}
LISTENER_START=&quot;&quot;LISTENER&quot;&quot;
NAMING_METHODS={&quot;TNSNAMES&quot;,&quot;ONAMES&quot;,&quot;HOSTNAME&quot;}
NSN_NUMBER=1
NSN_NAMES={&quot;EXTPROC_CONNECTION_DATA&quot;}
NSN_SERVICE={&quot;PLSExtProc&quot;}
NSN_PROTOCOLS={&quot;TCP;HOSTNAME;1521&quot;}
EOF</span>

<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /soft/dbca.rsp <span class="token operator">&lt;&lt;</span><span class="token string">EOF
[GENERAL]
RESPONSEFILE_VERSION = &quot;11.2.0&quot;
OPERATION_TYPE = &quot;createDatabase&quot;
[CREATEDATABASE]
GDBNAME = &quot;<span class="token variable">$dbname</span>&quot;
SID = &quot;<span class="token variable">$dbname</span>&quot;
TEMPLATENAME = &quot;General_Purpose.dbc&quot;
SYSPASSWORD = &quot;Enmo_1234&quot;
SYSTEMPASSWORD = &quot;Enmo_1234&quot;
SYSMANPASSWORD = &quot;Enmo_1234&quot;
DBSNMPPASSWORD = &quot;Enmo_1234&quot;
DATAFILEDESTINATION =/oradata
RECOVERYAREADESTINATION=/oradata/flash_recovery_area
CHARACTERSET = &quot;<span class="token variable">$db_CHARACTERSET</span>&quot;
NATIONALCHARACTERSET= &quot;<span class="token variable">$db_NCHARACTERSET</span>&quot;
MEMORYPERCENTAGE = &quot;70&quot;
AUTOMATICMEMORYMANAGEMENT = &quot;FALSE&quot;
EOF</span>

/bin/mkdir <span class="token parameter variable">-p</span> /soft
/bin/chown <span class="token parameter variable">-R</span> oracle:oinstall /soft
/bin/chmod <span class="token parameter variable">-R</span> <span class="token number">775</span> /soft
<span class="token punctuation">}</span>


<span class="token function-name function">step5_install_db_11g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment">#16. start install db software</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>****** start install db software ******<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>
<span class="token function">su</span> - oracle <span class="token parameter variable">-c</span> <span class="token string">&quot;/soft/database/runInstaller -silent -ignoreSysPrereqs -ignorePrereq -showProgress -responseFile /soft/db_install.rsp&quot;</span> 

<span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable"><span class="token variable">`</span><span class="token function">ps</span> <span class="token parameter variable">-fu</span> oracle<span class="token operator">|</span><span class="token function">egrep</span> <span class="token parameter variable">-v</span> <span class="token string">&quot;UID|pts&quot;</span><span class="token operator">|</span><span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">`</span></span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">]</span>
<span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;db is installing wait 10 secends....&quot;</span>
    <span class="token function">sleep</span> <span class="token number">10</span>
<span class="token keyword">done</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>****** db software install complete ******<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>****** start run root.sh ******<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>
/u01/app/oracle/product/11.2.0/dbhome_1/root.sh
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>******  run root.sh completed******<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>

<span class="token punctuation">}</span>

<span class="token function-name function">step6_config_listener_11g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment">#17. start config listener</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>****** start listener config  ******<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span> 
<span class="token function">su</span> - oracle <span class="token parameter variable">-c</span> <span class="token string">&quot;/u01/app/oracle/product/11.2.0/dbhome_1/bin/netca -silent -responsefile /soft/netca.rsp&quot;</span>

<span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable"><span class="token variable">`</span><span class="token function">ps</span> <span class="token parameter variable">-fu</span> oracle<span class="token operator">|</span><span class="token function">egrep</span> <span class="token parameter variable">-v</span> <span class="token string">&quot;tns|UID|pts&quot;</span><span class="token operator">|</span><span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">`</span></span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">]</span>
<span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;config listener is in process,plswait 10 secends....&quot;</span>
    <span class="token function">sleep</span> <span class="token number">10</span>
<span class="token keyword">done</span>


<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>****** check listern status ******<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>
<span class="token function">su</span> - oracle <span class="token parameter variable">-c</span> <span class="token string">&quot;lsnrctl status&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>****** listener config completed ******<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>

<span class="token punctuation">}</span>

<span class="token function-name function">step7_create_inst_11g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment">#18.  start db instance create</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>****** start db instance create ******<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span> 
<span class="token function">su</span> - oracle <span class="token parameter variable">-c</span> <span class="token string">&quot;/u01/app/oracle/product/11.2.0/dbhome_1/bin/dbca -silent -responsefile /soft/dbca.rsp&quot;</span>


<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>****** db instance create complete ******<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>

<span class="token punctuation">}</span>


<span class="token function-name function">step8_check_db</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment">#19. db check</span>
<span class="token comment">##19.1 db status check</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;******* 19.db check ********&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;******* 19.1 check db instance&quot;</span>
<span class="token function">su</span> - oracle <span class="token parameter variable">-c</span> <span class="token string">&#39;
sqlplus &quot;/ as sysdba&quot; &lt;&lt;-EOF 
select INSTANCE_NAME,status from v\$instance;
show pdbs;
!lsnrctl status
exit
EOF
&#39;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;******* 19.2 check HugePage info&quot;</span>
<span class="token function">grep</span> Huge /proc/meminfo

<span class="token assign-left variable">endtime</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">date</span> +<span class="token string">&#39;%Y-%m-%d %H:%M:%S&#39;</span><span class="token variable">`</span></span>
<span class="token assign-left variable">start_seconds</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> <span class="token parameter variable">--date</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$starttime</span>&quot;</span> +%s<span class="token variable">)</span></span><span class="token punctuation">;</span>
<span class="token assign-left variable">end_seconds</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> <span class="token parameter variable">--date</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$endtime</span>&quot;</span> +%s<span class="token variable">)</span></span><span class="token punctuation">;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;db install used: &quot;</span><span class="token variable"><span class="token variable">$((</span>end_seconds<span class="token operator">-</span>start_seconds<span class="token variable">))</span></span> seconds

<span class="token punctuation">}</span>


<span class="token function-name function">step4_create_response_file_19c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

<span class="token comment">#15. create response file</span>

<span class="token function">rm</span> <span class="token parameter variable">-f</span> /soft/*.rsp

<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /soft/db_install.rsp <span class="token operator">&lt;&lt;</span><span class="token string">EOF
oracle.install.responseFileVersion=/oracle/install/rspfmt_dbinstall_response_schema_v<span class="token variable">$ora_number</span>
oracle.install.option=INSTALL_DB_SWONLY
UNIX_GROUP_NAME=oinstall
INVENTORY_LOCATION=/u01/app/oraInventory
ORACLE_BASE=/u01/app/oracle
oracle.install.db.InstallEdition=EE
oracle.install.db.OSDBA_GROUP=dba
oracle.install.db.OSOPER_GROUP=dba
oracle.install.db.OSBACKUPDBA_GROUP=dba
oracle.install.db.OSDGDBA_GROUP=dba
oracle.install.db.OSKMDBA_GROUP=dba
oracle.install.db.OSRACDBA_GROUP=dba
oracle.install.db.rootconfig.executeRootScript=false
EOF</span>

<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /soft/netca.rsp <span class="token operator">&lt;&lt;</span><span class="token string">EOF
[GENERAL]
RESPONSEFILE_VERSION=&quot;<span class="token variable">$ora_number</span>&quot;
CREATE_TYPE=&quot;CUSTOM&quot;
[oracle.net.ca]
INSTALLED_COMPONENTS={&quot;server&quot;,&quot;net8&quot;,&quot;javavm&quot;}
INSTALL_TYPE=&quot;&quot;typical&quot;&quot;
LISTENER_NUMBER=1
LISTENER_NAMES={&quot;LISTENER&quot;}
LISTENER_PROTOCOLS={&quot;TCP;1521&quot;}
LISTENER_START=&quot;&quot;LISTENER&quot;&quot;
NAMING_METHODS={&quot;TNSNAMES&quot;,&quot;ONAMES&quot;,&quot;HOSTNAME&quot;}
NSN_NUMBER=1
NSN_NAMES={&quot;EXTPROC_CONNECTION_DATA&quot;}
NSN_SERVICE={&quot;PLSExtProc&quot;}
NSN_PROTOCOLS={&quot;TCP;HOSTNAME;1521&quot;}
EOF</span>

<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /soft/dbca.rsp <span class="token operator">&lt;&lt;</span><span class="token string">EOF
responseFileVersion=/oracle/assistants/rspfmt_dbca_response_schema_v<span class="token variable">$ora_number</span>
gdbName=<span class="token variable">$dbname</span>
sid=<span class="token variable">$dbname</span>
templateName=General_Purpose.dbc
createAsContainerDatabase=<span class="token variable">$cdb_flag</span>
numberOfPDBs=1
pdbName=<span class="token variable">$s_pdbName</span>
pdbAdminPassword=Enmo_1234
sysPassword=Enmo_1234
systemPassword=Enmo_1234
dbsnmpPassword=Enmo_1234
datafileDestination=/oradata
characterSet=ZHS16GBK
nationalCharacterSet=AL16UTF16
memoryPercentage=70
automaticMemoryManagement=FALSE
EOF</span>

/bin/mkdir <span class="token parameter variable">-p</span> /soft
/bin/chown <span class="token parameter variable">-R</span> oracle:oinstall /soft
/bin/chmod <span class="token parameter variable">-R</span> <span class="token number">775</span> /soft
<span class="token punctuation">}</span>


<span class="token function-name function">step5_install_db_19c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment">#16. start install db software</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>****** start install db software ******<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>
<span class="token function">su</span> - oracle <span class="token parameter variable">-c</span> <span class="token string">&quot;/u01/app/oracle/product/<span class="token variable">$ora_number</span>/dbhome_1/runInstaller -silent -responseFile /soft/db_install.rsp&quot;</span> 

<span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable"><span class="token variable">`</span><span class="token function">ps</span> <span class="token parameter variable">-fu</span> oracle<span class="token operator">|</span><span class="token function">egrep</span> <span class="token parameter variable">-v</span> <span class="token string">&quot;UID|pts&quot;</span><span class="token operator">|</span><span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">`</span></span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">]</span>
<span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;db is installing wait 10 secends....&quot;</span>
    <span class="token function">sleep</span> <span class="token number">10</span>
<span class="token keyword">done</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>****** db software install complete ******<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>****** start run root.sh ******<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>
/u01/app/oraInventory/orainstRoot.sh
/u01/app/oracle/product/<span class="token variable">$ora_number</span>/dbhome_1/root.sh
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>******  run root.sh completed******<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>

<span class="token punctuation">}</span>

<span class="token function-name function">step6_config_listener_19c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment">#17. start config listener</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>****** start listener config  ******<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span> 
<span class="token function">su</span> - oracle <span class="token parameter variable">-c</span> <span class="token string">&quot;/u01/app/oracle/product/<span class="token variable">$ora_number</span>/dbhome_1/bin/netca -silent -responsefile /soft/netca.rsp&quot;</span>

<span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable"><span class="token variable">`</span><span class="token function">ps</span> <span class="token parameter variable">-fu</span> oracle<span class="token operator">|</span><span class="token function">egrep</span> <span class="token parameter variable">-v</span> <span class="token string">&quot;tns|UID|pts&quot;</span><span class="token operator">|</span><span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">`</span></span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">]</span>
<span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;config listener is in process,plswait 10 secends....&quot;</span>
    <span class="token function">sleep</span> <span class="token number">10</span>
<span class="token keyword">done</span>


<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>****** check listern status ******<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>
<span class="token function">su</span> - oracle <span class="token parameter variable">-c</span> <span class="token string">&quot;lsnrctl status&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>****** listener config completed ******<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>

<span class="token punctuation">}</span>

<span class="token function-name function">step7_create_inst_19c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment">#18.  start db instance create</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>****** start db instance create ******<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span> 
<span class="token function">su</span> - oracle <span class="token parameter variable">-c</span> <span class="token string">&quot;/u01/app/oracle/product/<span class="token variable">$ora_number</span>/dbhome_1/bin/dbca -silent -createDatabase -responseFile /soft/dbca.rsp&quot;</span>


<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>****** db instance create complete ******<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>&quot;</span>

<span class="token punctuation">}</span>



<span class="token function-name function">hello_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;
#########################################################################
#	Author/Wechat			: xidoublestar                                      #                          
#	Version           : 0.2                                               #
#	Function          : Oracle 11g/19c/21c(Single) install on Linux 7     #
#########################################################################
NOTE: we can use this tool to install Oracle DataBase 11G/19C/21C onekey
1) create software location: mkdir -p /soft
2) when install 11G: upload two file to /soft directory: 
	/soft/p13390677_112040_Linux-x86-64_1of7.zip
	/soft/p13390677_112040_Linux-x86-64_2of7.zip
3) when install 19C: upload db file to /soft driectory: 
  /soft/LINUX.X64_193000_db_home.zip.zip
4) when install 21C: upload db file to /soft directory:
	/soft/LINUX.X64_213000_db_home.zip
5) the hostname is &quot;</span>localhost<span class="token string">&quot; is invalid,pls check
************* if you need any support,contact my wechat: xidoublestar **************&quot;</span>

<span class="token assign-left variable">ora_version</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
<span class="token assign-left variable">ora_number</span><span class="token operator">=</span><span class="token string">&quot;11.2.0&quot;</span>
<span class="token keyword">while</span> <span class="token boolean">true</span>
<span class="token keyword">do</span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$ora_version</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;11G&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token string">&quot;<span class="token variable">$ora_version</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;19C&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token string">&quot;<span class="token variable">$ora_version</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;21C&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
		<span class="token builtin class-name">echo</span> <span class="token string">&quot;
		Oracle version list:
		1) 11G
		2) 19C
		3) 21C&quot;</span>
		<span class="token builtin class-name">read</span> <span class="token parameter variable">-p</span> <span class="token string">&quot;pls,input Oracle version to install: &quot;</span> ora_version	
	<span class="token keyword">else</span>
		<span class="token builtin class-name">break</span>
	<span class="token keyword">fi</span>

	<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$ora_version</span>&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;19C&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
		<span class="token assign-left variable">ora_number</span><span class="token operator">=</span><span class="token string">&quot;19.3.0&quot;</span>
	<span class="token keyword">elif</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$ora_version</span>&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;21C&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
		<span class="token assign-left variable">ora_number</span><span class="token operator">=</span><span class="token string">&quot;21.3.0&quot;</span>
	<span class="token keyword">fi</span>
	
<span class="token keyword">done</span>

<span class="token punctuation">}</span>

<span class="token function-name function">hello_end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;
************** complete install Oracle db <span class="token variable">$ora_number</span> on Linux 7.x *********************
************** if you need any support,contact my wechat: xidoublestar *************&quot;</span>	
<span class="token punctuation">}</span>

hello_start
step1_check_os
step2_set_dbname_and_charset
step3_set_os
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$ora_version</span>&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;11G&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	step4_create_response_file_11g
	step5_install_db_11g
	step6_config_listener_11g
	step7_create_inst_11g
<span class="token keyword">elif</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$ora_version</span>&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;19C&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	step4_create_response_file_19c
	step5_install_db_19c
	step6_config_listener_19c
	step7_create_inst_19c
<span class="token keyword">elif</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$ora_version</span>&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;21C&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	step4_create_response_file_19c
	step5_install_db_19c
	step6_config_listener_19c
	step7_create_inst_19c
<span class="token keyword">fi</span>
step8_check_db
hello_end
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab active" id="codetab-3-3" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">11g</div><!--[--><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment">############ Author begin ###############</span>
<span class="token comment">## Author: Ableit</span>
<span class="token comment">## Date: 2022-07-20</span>
<span class="token comment">############ Author end ###############</span>

<span class="token comment">############ Env &amp; Virables begin ###############</span>
<span class="token comment"># custom settings</span>
<span class="token assign-left variable">DBA_HOME</span><span class="token operator">=</span>/opt/database/dba
<span class="token assign-left variable">SOFTWARE_DIR</span><span class="token operator">=</span>/opt/package

<span class="token assign-left variable"><span class="token environment constant">HOSTNAME</span></span><span class="token operator">=</span>testdb-node01
<span class="token assign-left variable">IPADDR</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">ip</span> <span class="token parameter variable">-4</span> addr show dev eth0 <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-oP</span> <span class="token string">&#39;(?&lt;=inet\s)\d+(\.\d+){3}&#39;</span><span class="token variable">`</span></span>
<span class="token assign-left variable">OS_ORACLE_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>

<span class="token assign-left variable">ORACLE_UNQNAME</span><span class="token operator">=</span>testdb
<span class="token assign-left variable">ORACLE_SID</span><span class="token operator">=</span>testdb
<span class="token assign-left variable">ORACLE_CHARSET</span><span class="token operator">=</span>AL32UTF8
<span class="token assign-left variable">ORACLE_SYS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>
<span class="token assign-left variable">ORACLE_SYSTEM_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>

<span class="token assign-left variable">ORACLE_BASE_APP_DIR</span><span class="token operator">=</span>/u01
<span class="token assign-left variable">ORACLE_BASE_DATA_DIR</span><span class="token operator">=</span>/data
<span class="token assign-left variable">ORACLE_DATABASE_VERSION</span><span class="token operator">=</span><span class="token number">11.2</span>.0.4
<span class="token comment"># 64G</span>
<span class="token assign-left variable">ORACLE_RECOVERY_AREA_SIZE</span><span class="token operator">=</span>$<span class="token punctuation">[</span> <span class="token number">64</span>*1024 <span class="token punctuation">]</span>
<span class="token assign-left variable">ORACLE_ARCHIVE</span><span class="token operator">=</span>true

<span class="token comment"># Oracle auto Settings</span>
<span class="token assign-left variable">TMP</span><span class="token operator">=</span>/tmp
<span class="token assign-left variable">ORACLE_HOSTNAME</span><span class="token operator">=</span><span class="token environment constant">$HOSTNAME</span>
<span class="token assign-left variable">ORACLE_BASE</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_APP_DIR</span>/app/oracle
<span class="token assign-left variable">ORACLE_HOME</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE</span>/product/<span class="token variable">$ORACLE_DATABASE_VERSION</span>/db_1
<span class="token assign-left variable">ORACLE_DATA_DIR</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_DATA_DIR</span>/app/oracle/oradata
<span class="token assign-left variable">ORACLE_ORA_INVENTORY</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_APP_DIR</span>/app/oraInventory
<span class="token assign-left variable">ORACLE_RECOVERY_AREA_DIR</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_DATA_DIR</span>/app/oracle/fast_recovery_area

<span class="token comment"># os auto settings</span>
<span class="token assign-left variable">OS_MEMORY</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">free</span> -b<span class="token operator">|</span><span class="token function">grep</span> Mem:<span class="token operator">|</span><span class="token function">awk</span> -F<span class="token string">&#39; &#39;</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">`</span></span>
<span class="token assign-left variable">OS_SHMMAX</span><span class="token operator">=</span>$<span class="token punctuation">[</span> <span class="token variable">$OS_MEMORY</span> * <span class="token number">2</span> / <span class="token number">3</span> <span class="token punctuation">]</span>
<span class="token assign-left variable">OS_SHMALL</span><span class="token operator">=</span>$<span class="token punctuation">[</span> <span class="token variable">$OS_SHMMAX</span> / <span class="token number">1024</span> <span class="token punctuation">]</span>
<span class="token assign-left variable">ORACLE_TOTAL_MEMORY</span><span class="token operator">=</span>$<span class="token punctuation">[</span> <span class="token variable">$OS_SHMMAX</span> / <span class="token number">1024</span> / <span class="token number">1024</span> <span class="token punctuation">]</span>
<span class="token function">hostname</span> <span class="token environment constant">$HOSTNAME</span>
<span class="token assign-left variable">OS_VERSION_ID</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> /etc/os-release <span class="token operator">|</span><span class="token function">grep</span> <span class="token string">&#39;^VERSION_ID=&#39;</span><span class="token operator">|</span><span class="token function">awk</span> -F<span class="token string">&#39;=&#39;</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">`</span></span>
<span class="token comment">############ Env &amp; Virables end ###############</span>


<span class="token keyword">function</span> <span class="token function-name function">DownloadPackages</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Downloading package ...&quot;</span>
    <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$SOFTWARE_DIR</span>
    yum <span class="token function">install</span> <span class="token parameter variable">-y</span> <span class="token function">wget</span>
    <span class="token function">wget</span> <span class="token parameter variable">-O</span> <span class="token variable">$SOFTWARE_DIR</span>/p13390677_112040_Linux-x86-64_1of7.zip ftp://10.10.12.158/pub/oracle/p13390677_112040_Linux-x86-64_1of7.zip
    <span class="token function">wget</span> <span class="token parameter variable">-O</span> <span class="token variable">$SOFTWARE_DIR</span>/p13390677_112040_Linux-x86-64_2of7.zip ftp://10.10.12.158/pub/oracle/p13390677_112040_Linux-x86-64_2of7.zip
<span class="token punctuation">}</span>


<span class="token keyword">function</span> <span class="token function-name function">InstallDependency</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;0.Set Locale ...&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;en_US.UTF-8&quot;</span> <span class="token operator">&gt;</span> /etc/locale.conf
localectl set-locale <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;en_US.UTF-8&quot;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;en_US.UTF-8&quot;</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;1.Disable selinux and stop firewalld ...&quot;</span>
<span class="token function">cp</span> /etc/selinux/config /etc/selinux/config.orabak
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;s/^SELINUX=enforcing/SELINUX=disabled/g&#39;</span> /etc/selinux/config 
setenforce <span class="token number">0</span>
systemctl stop firewalld
systemctl disable firewalld
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;2.Config hostname ...&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token environment constant">$HOSTNAME</span> <span class="token operator">&gt;</span> /etc/hostname
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;3.Config hosts ...&quot;</span>
<span class="token function">cp</span> /etc/hosts /etc/hosts.orabak
<span class="token builtin class-name">echo</span> <span class="token variable">$IPADDR</span><span class="token string">&#39;   &#39;</span><span class="token environment constant">$HOSTNAME</span> <span class="token operator">&gt;&gt;</span> /etc/hosts
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;4.Config sysctl.conf ... &quot;</span>
<span class="token function">cp</span> /etc/sysctl.conf /etc/sysctl.conf.orabak
<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /etc/sysctl.conf <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
fs.file-max = 6815744
kernel.sem = 250 32000 100 128
kernel.shmmni = 4096
kernel.shmall = <span class="token variable">$OS_SHMALL</span> 
kernel.shmmax = <span class="token variable">$OS_SHMMAX</span>
kernel.panic_on_oops = 1
net.core.rmem_default = 262144
net.core.rmem_max = 4194304
net.core.wmem_default = 262144
net.core.wmem_max = 1048576
net.ipv4.conf.all.rp_filter = 2
net.ipv4.conf.default.rp_filter = 2
fs.aio-max-nr = 1048576
net.ipv4.ip_local_port_range = 9000 65500
EOF</span>
<span class="token function">sysctl</span> <span class="token parameter variable">-p</span>
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;5.Set Resource Usage Limit ...&quot;</span>
<span class="token function">cp</span> /etc/security/limits.conf /etc/security/limits.conf.orabak
<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /etc/security/limits.conf <span class="token operator">&lt;&lt;</span><span class="token string">EOF
oracle   soft   nofile    1024
oracle   hard   nofile    65536
oracle   soft   nproc    16384
oracle   hard   nproc    16384
oracle   soft   stack    10240
oracle   hard   stack    32768
oracle   hard   memlock    134217728
oracle   soft   memlock    134217728
EOF</span>

<span class="token function">cp</span> /etc/pam.d/login /etc/pam.d/login.orabak
<span class="token builtin class-name">echo</span> <span class="token string">&quot;session   required    pam_limits.so&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/pam.d/login
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;6.Install Dependency Packages ...&quot;</span>
yum <span class="token function">install</span> <span class="token parameter variable">-y</span> binutils compat-libcap1-1.10-3.el7.x86_64 compat-libstdc++-33 compat-libstdc++-33.i686 elfutils-libelf-devel <span class="token punctuation">\</span>
gcc gcc-c++ glibc-2.17-36.el7.i686  glibc-2.17-36.el7.x86_64 glibc-devel glibc-devel.i686 glibc.i686 ksh libaio libaio-devel <span class="token punctuation">\</span>
libaio-devel.i686 libaio.i686 libcap libgcc libgcc.i686 libstdc++ libstdc++-devel libstdc++-devel.i686 libstdc++.i686 libX11 <span class="token punctuation">\</span>
libX11.i686 libXau libXau.i686 libxcb libxcb.i686 libXext libXext.i686 libXi libXi.i686 libXtst libXtst.i686 <span class="token function">make</span> sysstat <span class="token punctuation">\</span>
unixODBC unixODBC-devel zlib-devel <span class="token function">unzip</span>
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;7.Add Oracle Group and User ...&quot;</span>
<span class="token function">groupadd</span> <span class="token parameter variable">-g</span> <span class="token number">54321</span> oinstall
<span class="token function">groupadd</span> <span class="token parameter variable">-g</span> <span class="token number">54322</span> dba
<span class="token function">groupadd</span> <span class="token parameter variable">-g</span> <span class="token number">54323</span> oper
<span class="token function">useradd</span> <span class="token parameter variable">-u</span> <span class="token number">54321</span> <span class="token parameter variable">-g</span> oinstall <span class="token parameter variable">-G</span> dba,oper oracle
<span class="token builtin class-name">echo</span> <span class="token variable">$OS_ORACLE_PASSWORD</span> <span class="token operator">|</span> <span class="token function">passwd</span> <span class="token parameter variable">--stdin</span> oracle
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;8.Create Directory ...&quot;</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$ORACLE_HOME</span> <span class="token variable">$ORACLE_DATA_DIR</span> <span class="token variable">$ORACLE_ORA_INVENTORY</span> <span class="token variable">$ORACLE_RECOVERY_AREA_DIR</span>
<span class="token function">chown</span> <span class="token parameter variable">-R</span> oracle:oinstall <span class="token variable">$ORACLE_BASE_APP_DIR</span> <span class="token variable">$ORACLE_BASE_DATA_DIR</span> <span class="token variable">$ORACLE_RECOVERY_AREA_DIR</span>
<span class="token function">chmod</span> <span class="token parameter variable">-R</span> <span class="token number">775</span> <span class="token variable">$ORACLE_BASE_APP_DIR</span> <span class="token variable">$ORACLE_BASE_DATA_DIR</span> <span class="token variable">$ORACLE_RECOVERY_AREA_DIR</span>
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;9.Set Env ...&quot;</span>
<span class="token function">cp</span> /home/oracle/.bash_profile /home/oracle/.bash_profile.orabak
<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /home/oracle/.bash_profile <span class="token operator">&lt;&lt;</span><span class="token string">EOF
# Oracle ENV
export TMP=<span class="token variable">$TMP</span>
export TMPDIR=<span class="token variable">$TMP</span>

export ORACLE_HOSTNAME=<span class="token variable">$ORACLE_HOSTNAME</span>
export ORACLE_UNQNAME=<span class="token variable">$ORACLE_UNQNAME</span>
export ORACLE_SID=<span class="token variable">$ORACLE_SID</span>
export ORACLE_BASE=<span class="token variable">$ORACLE_BASE</span>
export ORACLE_HOME=<span class="token variable">$ORACLE_HOME</span>
export ORA_INVENTORY=<span class="token variable">$ORACLE_ORA_INVENTORY</span>
export DATA_DIR=<span class="token variable">$ORACLE_DATA_DIR</span>
export ORACLE_HOME_LISTNER=\<span class="token variable">$ORACLE_HOME</span>

export LD_LIBRARY_PATH=\<span class="token variable">$ORACLE_HOME</span>/lib:/lib:/usr/lib
export CLASSPATH=\<span class="token variable">$ORACLE_HOME</span>/jlib:\<span class="token variable">$ORACLE_HOME</span>/rdbms/jlib

export PATH=\<span class="token variable">$ORACLE_HOME</span>/bin:\<span class="token environment constant">$PATH</span>
EOF</span>
<span class="token function">sleep</span> <span class="token number">1</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">InstallSoftware</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;10.unzip oracle database package ...&quot;</span>
<span class="token function">chown</span> oracle:oinstall <span class="token parameter variable">-R</span> /opt/package
<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOF
cd <span class="token variable">${SOFTWARE_DIR}</span>
unzip -oq p13390677_112040_Linux-x86-64_1of7.zip
unzip -oq p13390677_112040_Linux-x86-64_2of7.zip
cd <span class="token variable">${SOFTWARE_DIR}</span>/database

echo &quot;11.install database software ...&quot;
./runInstaller -ignorePrereq -waitforcompletion -silent                        \
    -responseFile <span class="token variable">${SOFTWARE_DIR}</span>/database/response/db_install.rsp               \
    oracle.install.option=INSTALL_DB_SWONLY                                    \
    ORACLE_HOSTNAME=<span class="token variable">${ORACLE_HOSTNAME}</span>                                         \
    UNIX_GROUP_NAME=oinstall                                                   \
    INVENTORY_LOCATION=<span class="token variable">${ORACLE_ORA_INVENTORY}</span>                                        \
    SELECTED_LANGUAGES=en                                                      \
    ORACLE_HOME=<span class="token variable">${ORACLE_HOME}</span>                                                 \
    ORACLE_BASE=<span class="token variable">${ORACLE_BASE}</span>                                                 \
    oracle.install.db.InstallEdition=EE                                        \
    oracle.install.db.DBA_GROUP=dba                                          \
    oracle.install.db.OPER_GROUP=oper                                          \
    oracle.install.db.OSBACKUPDBA_GROUP=dba                                    \
    oracle.install.db.OSDGDBA_GROUP=dba                                        \
    oracle.install.db.OSKMDBA_GROUP=dba                                        \
    oracle.install.db.OSRACDBA_GROUP=dba                                       \
    SECURITY_UPDATES_VIA_MYORACLESUPPORT=false                                 \
    DECLINE_SECURITY_UPDATES=true                                              \
    oracle.installer.autoupdates.option=SKIP_UPDATES
EOF</span>
<span class="token comment"># </span>
<span class="token comment"># cp $ORACLE_HOME/sysman/lib/ins_emagent.mk $ORACLE_HOME/sysman/lib/ins_emagent.mk.orabak</span>
<span class="token comment"># sed -i &#39;s#$(MK_EMAGENT_NMECTL)#$(MK_EMAGENT_NMECTL) -lnnz11#g&#39; $ORACLE_HOME/sysman/lib/ins_emagent.mk</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;Run &#39;<span class="token variable">${ORACLE_ORA_INVENTORY}</span>/orainstRoot.sh&#39; as root ...&quot;</span>
<span class="token variable">${ORACLE_ORA_INVENTORY}</span>/orainstRoot.sh
<span class="token builtin class-name">echo</span> <span class="token string">&quot;Run &#39;<span class="token variable">${ORACLE_HOME}</span>/root.sh&#39; as root ...&quot;</span>
<span class="token variable">${ORACLE_HOME}</span>/root.sh

<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">CreateNetca</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;12.Create Netca ...&quot;</span>
<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOF
echo &quot;12.Create the listener ...&quot;
netca -silent -responsefile <span class="token variable">${ORACLE_HOME}</span>/assistants/netca/netca.rsp
echo &quot;12.Start the listener ...&quot;
lsnrctl start
EOF</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">CreateDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;13.Create Database ...&quot;</span>
<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOF
dbca -silent -createDatabase                                                   \
     -templateName General_Purpose.dbc                                         \
     -gdbName <span class="token variable">${ORACLE_SID}</span> -sid  <span class="token variable">${ORACLE_SID}</span> -responseFile NO_VALUE         \
     -characterSet <span class="token variable">$ORACLE_CHARSET</span>                                             \
     -sysPassword <span class="token variable">$ORACLE_SYS_PASSWORD</span>                                                     \
     -systemPassword <span class="token variable">$ORACLE_SYSTEM_PASSWORD</span>                                               \
     -databaseType MULTIPURPOSE                                                \
     -memoryPercentage 66                                                      \
     -totalMemory <span class="token variable">${ORACLE_TOTAL_MEMORY}</span>                                        \
     -storageType FS                                                           \
     -datafileDestination &quot;<span class="token variable">${ORACLE_DATA_DIR}</span>&quot;                                        \
     -enableArchive  <span class="token variable">${ORACLE_ARCHIVE}</span>                                                 \
     -recoveryAreaSize  <span class="token variable">${ORACLE_RECOVERY_AREA_SIZE}</span>                           \
     -recoveryAreaDestination  &quot;<span class="token variable">${ORACLE_RECOVERY_AREA_DIR}</span>&quot;                   \
     -redoLogFileSize 50                                                       \
     -emConfiguration NONE                                                     
echo &quot;Successfully Insall Oracle <span class="token variable">$ORACLE_DATABASE_VERSION</span> !&quot;
EOF</span>
<span class="token punctuation">}</span>


<span class="token keyword">function</span> <span class="token function-name function">EnableStartup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;Edit /etc/oratab ...&quot;</span>
<span class="token function">cp</span> /etc/oratab /etc/oratab.orabak
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&quot;s#<span class="token variable">${ORACLE_SID}</span>:<span class="token variable">${ORACLE_HOME}</span>:N#<span class="token variable">${ORACLE_SID}</span>:<span class="token variable">${ORACLE_HOME}</span>:Y#g&quot;</span> /etc/oratab

<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">${DBA_HOME}</span>/scripts
<span class="token function">chown</span> oracle:root <span class="token parameter variable">-R</span> <span class="token variable">${DBA_HOME}</span>

<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOF
touch <span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh
chmod a+x <span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh

cat &gt; <span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh &lt;&lt;&quot;EOFINNER&quot;
#! /bin/sh
# description: Oracle auto start-stop script.
#
# Set ORA_HOME to be equivalent to the \<span class="token variable">$ORACLE_HOME</span>
# from which you wish to execute dbstart and dbshut;
#
# Set ORA_OWNER to the user id of the owner of the
# Oracle database in ORACLE_HOME.

ORA_HOME=<span class="token variable">$ORACLE_HOME</span>
ORA_OWNER=oracle
CURRENT_USER=\<span class="token variable"><span class="token variable">`</span>whoami<span class="token punctuation">\</span><span class="token variable">`</span></span>

case &quot;\<span class="token variable">$1</span>&quot; in
&#39;start&#39;) 
    # Start the Oracle databases:
    # The following command assumes that the oracle login
    # will not prompt the user for any values
    # Remove &quot;&amp;&quot; if you don&#39;t want startup as a background process.
    if [ &quot;\<span class="token variable">$ORA_OWNER</span>&quot; = &quot;\<span class="token variable">$CURRENT_USER</span>&quot; ]; then
    #\<span class="token variable">$ORA_HOME</span>/bin/lsnrctl start &amp;
    \<span class="token variable">$ORA_HOME</span>/bin/dbstart \<span class="token variable">$ORA_HOME</span>
    else
    #su - \<span class="token variable">$ORA_OWNER</span> -c &quot;\<span class="token variable">$ORA_HOME</span>/bin/lsnrctl start&quot; &amp;
    su - \<span class="token variable">$ORA_OWNER</span> -c &quot;\<span class="token variable">$ORA_HOME</span>/bin/dbstart \<span class="token variable">$ORA_HOME</span>&quot; 
    fi
    touch /var/lock/subsys/dbora
    break
    ;;

&#39;stop&#39;)
    # Stop the Oracle databases:
    # The following command assumes that the oracle login
    # will not prompt the user for any values
    if [ &quot;\<span class="token variable">$ORA_OWNER</span>&quot; = &quot;\<span class="token variable">$CURRENT_USER</span>&quot; ]; then
    \<span class="token variable">$ORA_HOME</span>/bin/dbshut \<span class="token variable">$ORA_HOME</span>
    #\<span class="token variable">$ORA_HOME</span>/bin/lsnrctl stop &amp;
    else
    su - \<span class="token variable">$ORA_OWNER</span> -c &quot;\<span class="token variable">$ORA_HOME</span>/bin/dbshut \<span class="token variable">$ORA_HOME</span>&quot; 
    #su - \<span class="token variable">$ORA_OWNER</span> -c &quot;\<span class="token variable">$ORA_HOME</span>/bin/lsnrctl stop&quot; &amp;
    fi
    rm -f /var/lock/subsys/dbora
    break
    ;;
   *)
    echo &quot;usage: \<span class="token variable">$0</span> {start|stop}&quot;
    exit
    ;;
esac
EOF</span>INNER
EOF

<span class="token function">cat</span> <span class="token operator">&gt;</span> /lib/systemd/system/dbora.service <span class="token operator">&lt;&lt;</span><span class="token string">EOF
[Unit]
Description=The Oracle Database Service
After=syslog.target network.target

[Service]
# systemd ignores PAM limits, so set any necessary limits in the service.
# Not really a bug, but a feature.
# https://bugzilla.redhat.com/show_bug.cgi?id=754285
LimitMEMLOCK=infinity
LimitNOFILE=65535

#Type=simple
# idle: similar to simple, the actual execution of the service binary is delayed
#       until all jobs are finished, which avoids mixing the status output with shell output of services.
RemainAfterExit=yes
User=oracle
Group=oinstall
Restart=no
ExecStart=/bin/bash -c &#39;<span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh start&#39;
ExecStop=/bin/bash -c &#39;<span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh stop&#39;

[Install]
WantedBy=multi-user.target
EOF</span>

<span class="token comment"># autostart after os reboot</span>
systemctl <span class="token builtin class-name">enable</span> dbora.service
<span class="token comment"># add allow port to firewalld</span>
firewall-cmd --add-port<span class="token operator">=</span><span class="token number">1521</span> <span class="token parameter variable">--zone</span><span class="token operator">=</span>public <span class="token parameter variable">--permanent</span>
firewall-cmd <span class="token parameter variable">--reload</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">Usage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
Usage: <span class="token variable">$0</span> -h|--helpUsage, help message.
       <span class="token variable">$0</span> -d|--installDependency, install oracle dependency.
       <span class="token variable">$0</span> -a|--installAll, install dependency,database software,create netca,create database.     
       <span class="token variable">$0</span> -s|--installSoftware, install database software. 
       <span class="token variable">$0</span> -c|--createDatabase, create database.
       <span class="token variable">$0</span> -e|--enable, enable database auto startup after system boot/reboot.
       <span class="token variable">$0</span> -p|--package, download database package.
EOF</span>
<span class="token punctuation">}</span>

<span class="token assign-left variable">ARGS</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>getopt <span class="token parameter variable">-o</span> hdasncep <span class="token parameter variable">--long</span> help,installDependency,installAll,installSoftware,createNetca,createDatabase,enable,package <span class="token parameter variable">-n</span> <span class="token string">&quot;<span class="token variable">$0</span>&quot;</span>  -- <span class="token string">&quot;<span class="token variable">$@</span>&quot;</span><span class="token variable">`</span></span>
<span class="token builtin class-name">eval</span> <span class="token builtin class-name">set</span> --  <span class="token string">&quot;<span class="token variable">$ARGS</span>&quot;</span>
<span class="token keyword">while</span> <span class="token boolean">true</span>
<span class="token keyword">do</span>
<span class="token keyword">case</span> <span class="token string">&quot;<span class="token variable">$1</span>&quot;</span> <span class="token keyword">in</span>
    -h<span class="token operator">|</span>--help<span class="token punctuation">)</span>
    Usage
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -d<span class="token operator">|</span>--installDependency<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;InstallDependency ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    InstallDependency
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -a<span class="token operator">|</span>--installAll<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;InstallAll ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    InstallDependency
    InstallSoftware
    CreateNetca
    CreateDatabase
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -s<span class="token operator">|</span>--installSoftware<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;InstallSoftware ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    InstallDependency
    InstallSoftware
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -n<span class="token operator">|</span>--createNetca<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Create Netca ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    CreateNetca
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Create Netca Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -c<span class="token operator">|</span>--createDatabase<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;CreateDatabase ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    CreateDatabase
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -e<span class="token operator">|</span>--enable<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;EnableStartup ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    EnableStartup
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;EnableStartup Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -p<span class="token operator">|</span>--package<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Downloading Package ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    DownloadPackages
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Downloading Package Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    *<span class="token punctuation">)</span>
    Usage
    <span class="token builtin class-name">exit</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>
<span class="token keyword">done</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-3-4" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">12c</div><!--[--><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment">############ Author begin ###############</span>
<span class="token comment">## Author: Ableit</span>
<span class="token comment">## Date: 2022-07-20</span>
<span class="token comment">############ Author end ###############</span>

<span class="token comment">############ Env &amp; Virables begin ###############</span>
<span class="token comment"># custom settings</span>
<span class="token assign-left variable">DBA_HOME</span><span class="token operator">=</span>/opt/database/dba
<span class="token assign-left variable">SOFTWARE_DIR</span><span class="token operator">=</span>/opt/package

<span class="token assign-left variable"><span class="token environment constant">HOSTNAME</span></span><span class="token operator">=</span>testdb-node01
<span class="token assign-left variable">IPADDR</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">ip</span> <span class="token parameter variable">-4</span> addr show dev eth0 <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-oP</span> <span class="token string">&#39;(?&lt;=inet\s)\d+(\.\d+){3}&#39;</span><span class="token variable">`</span></span>
<span class="token assign-left variable">ORACLE_OS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>

<span class="token assign-left variable">ORACLE_UNQNAME</span><span class="token operator">=</span>testdb
<span class="token assign-left variable">ORACLE_SID</span><span class="token operator">=</span>testdb
<span class="token assign-left variable">ORACLE_PDB_NAME</span><span class="token operator">=</span>testpdb
<span class="token assign-left variable">ORACLE_CHARSET</span><span class="token operator">=</span>AL32UTF8
<span class="token assign-left variable">ORACLE_SYS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>
<span class="token assign-left variable">ORACLE_SYSTEM_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>
<span class="token assign-left variable">ORACLE_PDB_ADMIN_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>

<span class="token assign-left variable">ORACLE_BASE_APP_DIR</span><span class="token operator">=</span>/u01
<span class="token assign-left variable">ORACLE_BASE_DATA_DIR</span><span class="token operator">=</span>/data
<span class="token assign-left variable">ORACLE_DATABASE_VERSION</span><span class="token operator">=</span><span class="token number">12.2</span>.0.1
<span class="token comment"># 64G</span>
<span class="token assign-left variable">ORACLE_RECOVERY_AREA_SIZE</span><span class="token operator">=</span>$<span class="token punctuation">[</span> <span class="token number">64</span>*1024 <span class="token punctuation">]</span>
<span class="token assign-left variable">ORACLE_ARCHIVE</span><span class="token operator">=</span>true

<span class="token comment"># Oracle Auto Settings</span>
<span class="token assign-left variable">TMP</span><span class="token operator">=</span>/tmp
<span class="token assign-left variable">ORACLE_HOSTNAME</span><span class="token operator">=</span><span class="token environment constant">$HOSTNAME</span>
<span class="token assign-left variable">ORACLE_BASE</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_APP_DIR</span>/app/oracle
<span class="token assign-left variable">ORACLE_HOME</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE</span>/product/<span class="token variable">$ORACLE_DATABASE_VERSION</span>/db_1
<span class="token assign-left variable">ORACLE_DATA_DIR</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_DATA_DIR</span>/app/oracle/oradata
<span class="token assign-left variable">ORACLE_ORA_INVENTORY</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_APP_DIR</span>/app/oraInventory
<span class="token assign-left variable">ORACLE_RECOVERY_AREA_DIR</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_DATA_DIR</span>/app/oracle/fast_recovery_area

<span class="token comment"># os auto settings</span>
<span class="token assign-left variable">OS_MEMORY</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">free</span> -b<span class="token operator">|</span><span class="token function">grep</span> Mem:<span class="token operator">|</span><span class="token function">awk</span> -F<span class="token string">&#39; &#39;</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">`</span></span>
<span class="token assign-left variable">OS_SHMMAX</span><span class="token operator">=</span>$<span class="token punctuation">[</span> <span class="token variable">$OS_MEMORY</span> * <span class="token number">2</span> / <span class="token number">3</span> <span class="token punctuation">]</span>
<span class="token assign-left variable">OS_SHMALL</span><span class="token operator">=</span>$<span class="token punctuation">[</span> <span class="token variable">$OS_SHMMAX</span> / <span class="token number">1024</span> <span class="token punctuation">]</span>
<span class="token assign-left variable">ORACLE_TOTAL_MEMORY</span><span class="token operator">=</span>$<span class="token punctuation">[</span> <span class="token variable">$OS_SHMMAX</span> / <span class="token number">1024</span> / <span class="token number">1024</span> <span class="token punctuation">]</span>
<span class="token function">hostname</span> <span class="token environment constant">$HOSTNAME</span>
<span class="token assign-left variable">OS_VERSION_ID</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> /etc/os-release <span class="token operator">|</span><span class="token function">grep</span> <span class="token string">&#39;^VERSION_ID=&#39;</span><span class="token operator">|</span><span class="token function">awk</span> -F<span class="token string">&#39;=&#39;</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">`</span></span>
<span class="token comment">############ Env &amp; Virables end ###############</span>


<span class="token keyword">function</span> <span class="token function-name function">DownloadPackages</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Downloading package ...&quot;</span>
    <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$SOFTWARE_DIR</span>
    yum <span class="token function">install</span> <span class="token parameter variable">-y</span> <span class="token function">wget</span>
    <span class="token function">wget</span> <span class="token parameter variable">-O</span> <span class="token variable">$SOFTWARE_DIR</span>/linuxx64_12201_database.zip ftp://10.10.12.158/pub/oracle/linuxx64_12201_database.zip
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">InstallDependency</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;0.Set Locale ...&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;en_US.UTF-8&quot;</span> <span class="token operator">&gt;</span> /etc/locale.conf
localectl set-locale <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;en_US.UTF-8&quot;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;en_US.UTF-8&quot;</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;1.Disable selinux and stop firewalld ...&quot;</span>
<span class="token function">cp</span> /etc/selinux/config /etc/selinux/config.orabak
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;s/^SELINUX=enforcing/SELINUX=disabled/g&#39;</span> /etc/selinux/config 
setenforce <span class="token number">0</span>
systemctl stop firewalld
systemctl disable firewalld
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;2.Config hostname ...&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token environment constant">$HOSTNAME</span> <span class="token operator">&gt;</span> /etc/hostname
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;3.Config hosts ...&quot;</span>
<span class="token function">cp</span> /etc/hosts /etc/hosts.orabak
<span class="token builtin class-name">echo</span> <span class="token variable">$IPADDR</span><span class="token string">&#39;   &#39;</span><span class="token environment constant">$HOSTNAME</span> <span class="token operator">&gt;&gt;</span> /etc/hosts
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;4.Config sysctl.conf ... &quot;</span>
<span class="token function">cp</span> /etc/sysctl.conf /etc/sysctl.conf.orabak

<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /etc/sysctl.conf <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
fs.file-max = 6815744
kernel.sem = 250 32000 100 128
kernel.shmmni = 4096
kernel.shmall = <span class="token variable">$OS_SHMALL</span> 
kernel.shmmax = <span class="token variable">$OS_SHMMAX</span>
kernel.panic_on_oops = 1
net.core.rmem_default = 262144
net.core.rmem_max = 4194304
net.core.wmem_default = 262144
net.core.wmem_max = 1048576
net.ipv4.conf.all.rp_filter = 2
net.ipv4.conf.default.rp_filter = 2
fs.aio-max-nr = 1048576
net.ipv4.ip_local_port_range = 9000 65500
EOF</span>
<span class="token function">sysctl</span> <span class="token parameter variable">-p</span>
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;5.Set Resource Usage Limit ...&quot;</span>
<span class="token function">cp</span> /etc/security/limits.conf /etc/security/limits.conf.orabak
<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /etc/security/limits.conf <span class="token operator">&lt;&lt;</span><span class="token string">EOF
oracle   soft   nofile    1024
oracle   hard   nofile    65536
oracle   soft   nproc    16384
oracle   hard   nproc    16384
oracle   soft   stack    10240
oracle   hard   stack    32768
oracle   hard   memlock    134217728
oracle   soft   memlock    134217728
EOF</span>

<span class="token function">cp</span> /etc/pam.d/login /etc/pam.d/login.orabak
<span class="token builtin class-name">echo</span> <span class="token string">&quot;session   required    pam_limits.so&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/pam.d/login
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;6.Install Dependency Packages ...&quot;</span>
yum <span class="token function">install</span> <span class="token parameter variable">-y</span> binutils compat-libcap1 compat-libstdc++-33 compat-libstdc++-33.i686 glibc <span class="token punctuation">\</span>
glibc.i686 glibc-devel glibc-devel.i686 ksh libaio libaio.i686 libaio-devel libaio-devel.i686 <span class="token punctuation">\</span>
libX11 libX11.i686 libXau libXau.i686 libXi libXi.i686 libXtst libXtst.i686 libgcc libgcc.i686 <span class="token punctuation">\</span>
libstdc++ libstdc++.i686 libstdc++-devel libstdc++-devel.i686 libxcb libxcb.i686 <span class="token function">make</span> nfs-utils <span class="token punctuation">\</span>
net-tools smartmontools sysstat unixODBC unixODBC-devel <span class="token function">unzip</span>
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;7.Add Oracle Group and User ...&quot;</span>
<span class="token function">groupadd</span> <span class="token parameter variable">-g</span> <span class="token number">54321</span> oinstall
<span class="token function">groupadd</span> <span class="token parameter variable">-g</span> <span class="token number">54322</span> dba
<span class="token function">groupadd</span> <span class="token parameter variable">-g</span> <span class="token number">54323</span> oper
<span class="token function">useradd</span> <span class="token parameter variable">-u</span> <span class="token number">54321</span> <span class="token parameter variable">-g</span> oinstall <span class="token parameter variable">-G</span> dba,oper oracle
<span class="token builtin class-name">echo</span> <span class="token variable">$ORACLE_OS_PASSWORD</span> <span class="token operator">|</span> <span class="token function">passwd</span> <span class="token parameter variable">--stdin</span> oracle
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;8.Create Directory ...&quot;</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$ORACLE_HOME</span> <span class="token variable">$ORACLE_DATA_DIR</span> <span class="token variable">$ORACLE_ORA_INVENTORY</span> <span class="token variable">$ORACLE_RECOVERY_AREA_DIR</span>
<span class="token function">chown</span> <span class="token parameter variable">-R</span> oracle:oinstall <span class="token variable">$ORACLE_BASE_APP_DIR</span> <span class="token variable">$ORACLE_BASE_DATA_DIR</span> <span class="token variable">$ORACLE_RECOVERY_AREA_DIR</span>
<span class="token function">chmod</span> <span class="token parameter variable">-R</span> <span class="token number">775</span> <span class="token variable">$ORACLE_BASE_APP_DIR</span> <span class="token variable">$ORACLE_BASE_DATA_DIR</span> <span class="token variable">$ORACLE_RECOVERY_AREA_DIR</span>
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;9.Set Env ...&quot;</span>
<span class="token function">cp</span> /home/oracle/.bash_profile /home/oracle/.bash_profile.orabak
<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /home/oracle/.bash_profile <span class="token operator">&lt;&lt;</span><span class="token string">EOF
# Oracle ENV
export TMP=<span class="token variable">$TMP</span>
export TMPDIR=<span class="token variable">$TMP</span>

export ORACLE_HOSTNAME=<span class="token variable">$ORACLE_HOSTNAME</span>
export ORACLE_UNQNAME=<span class="token variable">$ORACLE_UNQNAME</span>
export ORACLE_SID=<span class="token variable">$ORACLE_SID</span>
export PDB_NAME=<span class="token variable">$ORACLE_PDB_NAME</span>
export ORACLE_BASE=<span class="token variable">$ORACLE_BASE</span>
export ORACLE_HOME=<span class="token variable">$ORACLE_HOME</span>
export ORA_INVENTORY=<span class="token variable">$ORACLE_ORA_INVENTORY</span>
export DATA_DIR=<span class="token variable">$ORACLE_DATA_DIR</span>
export ORACLE_HOME_LISTNER=\<span class="token variable">$ORACLE_HOME</span>

export LD_LIBRARY_PATH=\<span class="token variable">$ORACLE_HOME</span>/lib:/lib:/usr/lib
export CLASSPATH=\<span class="token variable">$ORACLE_HOME</span>/jlib:\<span class="token variable">$ORACLE_HOME</span>/rdbms/jlib

export PATH=\<span class="token variable">$ORACLE_HOME</span>/bin:\<span class="token environment constant">$PATH</span>
EOF</span>
<span class="token function">sleep</span> <span class="token number">1</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">InstallSoftware</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;10.unzip oracle database package ...&quot;</span>
<span class="token function">chown</span> oracle:oinstall <span class="token parameter variable">-R</span> /opt/package
<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOF
cd <span class="token variable">${SOFTWARE_DIR}</span>
unzip -oq linuxx64_12201_database.zip
cd <span class="token variable">${SOFTWARE_DIR}</span>/database

echo &quot;11.install database software ...&quot;
./runInstaller -ignorePrereq -waitforcompletion -silent                        \
    -responseFile <span class="token variable">${SOFTWARE_DIR}</span>/database/response/db_install.rsp               \
    oracle.install.option=INSTALL_DB_SWONLY                                    \
    ORACLE_HOSTNAME=<span class="token variable">${ORACLE_HOSTNAME}</span>                                         \
    UNIX_GROUP_NAME=oinstall                                                   \
    INVENTORY_LOCATION=<span class="token variable">${ORACLE_ORA_INVENTORY}</span>                                 \
    SELECTED_LANGUAGES=en                                                      \
    ORACLE_HOME=<span class="token variable">${ORACLE_HOME}</span>                                                 \
    ORACLE_BASE=<span class="token variable">${ORACLE_BASE}</span>                                                 \
    oracle.install.db.InstallEdition=EE                                        \
    oracle.install.db.OSDBA_GROUP=dba                                          \
    oracle.install.db.OSOPER_GROUP=oper                                         \
    oracle.install.db.OSBACKUPDBA_GROUP=dba                                    \
    oracle.install.db.OSDGDBA_GROUP=dba                                        \
    oracle.install.db.OSKMDBA_GROUP=dba                                        \
    oracle.install.db.OSRACDBA_GROUP=dba                                       \
    SECURITY_UPDATES_VIA_MYORACLESUPPORT=false                                 \
    DECLINE_SECURITY_UPDATES=true
EOF</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;Run &#39;<span class="token variable">${ORACLE_ORA_INVENTORY}</span>/orainstRoot.sh&#39; as root ...&quot;</span>
<span class="token variable">${ORACLE_ORA_INVENTORY}</span>/orainstRoot.sh
<span class="token builtin class-name">echo</span> <span class="token string">&quot;Run &#39;<span class="token variable">${ORACLE_HOME}</span>/root.sh&#39; as root ...&quot;</span>
<span class="token variable">${ORACLE_HOME}</span>/root.sh
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">CreateNetca</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;12.Create Netca ...&quot;</span>
<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOF
echo &quot;12.Create the listener ...&quot;
netca -silent -responsefile <span class="token variable">${ORACLE_HOME}</span>/assistants/netca/netca.rsp
echo &quot;12.Start the listener ...&quot;
lsnrctl start
EOF</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">CreateDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;13.Create Database ...&quot;</span>
<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOF
echo &quot;12.Start the listener ...&quot;
lsnrctl start

dbca -silent -createDatabase                                                   \
     -templateName General_Purpose.dbc                                         \
     -gdbname <span class="token variable">${ORACLE_SID}</span> -sid  <span class="token variable">${ORACLE_SID}</span> -responseFile NO_VALUE         \
     -characterSet <span class="token variable">$ORACLE_CHARSET</span>                                                  \
     -sysPassword <span class="token variable">$ORACLE_SYS_PASSWORD</span>                                                     \
     -systemPassword <span class="token variable">$ORACLE_SYSTEM_PASSWORD</span>                                               \
     -createAsContainerDatabase true                                           \
     -numberOfPDBs 1                                                           \
     -pdbName <span class="token variable">${ORACLE_PDB_NAME}</span>                                                      \
     -pdbAdminPassword <span class="token variable">$ORACLE_PDB_ADMIN_PASSWORD</span>                                           \
     -databaseType MULTIPURPOSE                                                \
     -memoryMgmtType auto_sga                                                  \
     -totalMemory <span class="token variable">$ORACLE_TOTAL_MEMORY</span>                                         \
     -storageType FS                                                           \
     -datafileDestination &quot;<span class="token variable">${ORACLE_DATA_DIR}</span>&quot;                                        \
     -enableArchive  <span class="token variable">${ORACLE_ARCHIVE}</span>                                                 \
     -recoveryAreaSize  <span class="token variable">${ORACLE_RECOVERY_AREA_SIZE}</span>                           \
     -recoveryAreaDestination  &quot;<span class="token variable">${ORACLE_RECOVERY_AREA_DIR}</span>&quot;                   \
     -redoLogFileSize 50                                                       \
     -emConfiguration NONE                                                     \
     -ignorePreReqs

echo &quot;Successfully Insall Oracle <span class="token variable">$ORACLE_DATABASE_VERSION</span> !&quot;
EOF</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">EnableStartup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;Edit /etc/oratab ...&quot;</span>
<span class="token function">cp</span> /etc/oratab /etc/oratab.orabak
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&quot;s#<span class="token variable">${ORACLE_SID}</span>:<span class="token variable">${ORACLE_HOME}</span>:N#<span class="token variable">${ORACLE_SID}</span>:<span class="token variable">${ORACLE_HOME}</span>:Y#g&quot;</span> /etc/oratab
<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOFOUT
sqlplus / as sysdba &lt;&lt;EOF
alter system set db_create_file_dest=&#39;<span class="token variable">${ORACLE_DATA_DIR}</span>&#39;;
alter pluggable database <span class="token variable">${ORACLE_PDB_NAME}</span> save state;
exit;
EOF
EOFOUT</span>

<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">${DBA_HOME}</span>/scripts
<span class="token function">chown</span> oracle:root <span class="token parameter variable">-R</span> <span class="token variable">${DBA_HOME}</span>

<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOF
touch <span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh
chmod a+x <span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh

cat &gt; <span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh &lt;&lt;&quot;EOFINNER&quot;
#! /bin/sh
# description: Oracle auto start-stop script.
#
# Set ORA_HOME to be equivalent to the \<span class="token variable">$ORACLE_HOME</span>
# from which you wish to execute dbstart and dbshut;
#
# Set ORA_OWNER to the user id of the owner of the
# Oracle database in ORACLE_HOME.

ORA_HOME=<span class="token variable">$ORACLE_HOME</span>
ORA_OWNER=oracle
CURRENT_USER=\<span class="token variable"><span class="token variable">`</span>whoami<span class="token punctuation">\</span><span class="token variable">`</span></span>

case &quot;\<span class="token variable">$1</span>&quot; in
&#39;start&#39;) 
    # Start the Oracle databases:
    # The following command assumes that the oracle login
    # will not prompt the user for any values
    # Remove &quot;&amp;&quot; if you don&#39;t want startup as a background process.
    if [ &quot;\<span class="token variable">$ORA_OWNER</span>&quot; = &quot;\<span class="token variable">$CURRENT_USER</span>&quot; ]; then
    \<span class="token variable">$ORA_HOME</span>/bin/dbstart \<span class="token variable">$ORA_HOME</span>
    else
    su - \<span class="token variable">$ORA_OWNER</span> -c &quot;\<span class="token variable">$ORA_HOME</span>/bin/dbstart \<span class="token variable">$ORA_HOME</span>&quot; 
    fi
    touch /var/lock/subsys/dbora
    break
    ;;

&#39;stop&#39;)
    # Stop the Oracle databases:
    # The following command assumes that the oracle login
    # will not prompt the user for any values
    if [ &quot;\<span class="token variable">$ORA_OWNER</span>&quot; = &quot;\<span class="token variable">$CURRENT_USER</span>&quot; ]; then
    \<span class="token variable">$ORA_HOME</span>/bin/dbshut \<span class="token variable">$ORA_HOME</span>
    else
    su - \<span class="token variable">$ORA_OWNER</span> -c &quot;\<span class="token variable">$ORA_HOME</span>/bin/dbshut \<span class="token variable">$ORA_HOME</span>&quot; &amp;
    fi
    rm -f /var/lock/subsys/dbora
    break
    ;;
   *)
    echo &quot;usage: <span class="token variable">$0</span> {start|stop}&quot;
    exit
    ;;
esac
EOF</span>INNER
EOF

<span class="token function">cat</span> <span class="token operator">&gt;</span> /lib/systemd/system/dbora.service <span class="token operator">&lt;&lt;</span><span class="token string">EOF
[Unit]
Description=The Oracle Database Service
After=syslog.target network.target

[Service]
# systemd ignores PAM limits, so set any necessary limits in the service.
# Not really a bug, but a feature.
# https://bugzilla.redhat.com/show_bug.cgi?id=754285
LimitMEMLOCK=infinity
LimitNOFILE=65535

#Type=simple
# idle: similar to simple, the actual execution of the service binary is delayed
#       until all jobs are finished, which avoids mixing the status output with shell output of services.
RemainAfterExit=yes
User=oracle
Group=oinstall
Restart=no
ExecStart=/bin/bash -c &#39;<span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh start&#39;
ExecStop=/bin/bash -c &#39;<span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh stop&#39;

[Install]
WantedBy=multi-user.target
EOF</span>

<span class="token comment"># autostart after os reboot</span>
systemctl <span class="token builtin class-name">enable</span> dbora.service
<span class="token comment"># add allow port to firewalld</span>
firewall-cmd --add-port<span class="token operator">=</span><span class="token number">1521</span> <span class="token parameter variable">--zone</span><span class="token operator">=</span>public <span class="token parameter variable">--permanent</span>
firewall-cmd <span class="token parameter variable">--reload</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">Usage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
Usage: <span class="token variable">$0</span> -h|--helpUsage, help message.
       <span class="token variable">$0</span> -d|--installDependency, install oracle dependency.
       <span class="token variable">$0</span> -a|--installAll, install dependency,database software,create netca,create database.     
       <span class="token variable">$0</span> -s|--installSoftware, install database software. 
       <span class="token variable">$0</span> -c|--createDatabase, create database.
       <span class="token variable">$0</span> -e|--enable, enable database auto startup after system boot/reboot.
       <span class="token variable">$0</span> -p|--package, download database package.
EOF</span>
<span class="token punctuation">}</span>


<span class="token assign-left variable">ARGS</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>getopt <span class="token parameter variable">-o</span> hdasncep <span class="token parameter variable">--long</span> help,installDependency,installAll,installSoftware,createNetca,createDatabase,enable,package <span class="token parameter variable">-n</span> <span class="token string">&quot;<span class="token variable">$0</span>&quot;</span>  -- <span class="token string">&quot;<span class="token variable">$@</span>&quot;</span><span class="token variable">`</span></span>
<span class="token builtin class-name">eval</span> <span class="token builtin class-name">set</span> --  <span class="token string">&quot;<span class="token variable">$ARGS</span>&quot;</span>
<span class="token keyword">while</span> <span class="token boolean">true</span>
<span class="token keyword">do</span>
<span class="token keyword">case</span> <span class="token string">&quot;<span class="token variable">$1</span>&quot;</span> <span class="token keyword">in</span>
    -h<span class="token operator">|</span>--help<span class="token punctuation">)</span>
    Usage
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -d<span class="token operator">|</span>--installDependency<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;InstallDependency ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    InstallDependency
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -a<span class="token operator">|</span>--installAll<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;InstallAll ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    InstallDependency
    InstallSoftware
    <span class="token comment"># CreateNetca</span>
    CreateDatabase
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -s<span class="token operator">|</span>--installSoftware<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;InstallSoftware ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    InstallDependency
    InstallSoftware
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -n<span class="token operator">|</span>--createNetca<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Create Netca ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    CreateNetca
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Create Netca Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -c<span class="token operator">|</span>--createDatabase<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;CreateDatabase ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    CreateDatabase
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -e<span class="token operator">|</span>--enable<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;EnableStartup ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    EnableStartup
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;EnableStartup Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -p<span class="token operator">|</span>--package<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Downloading Package ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    DownloadPackages
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Downloading Package Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    *<span class="token punctuation">)</span>
    Usage
    <span class="token builtin class-name">exit</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>
<span class="token keyword">done</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-3-5" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">18c</div><!--[--><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment">############ Author begin ###############</span>
<span class="token comment">## Author: Ableit</span>
<span class="token comment">## Date: 2022-07-20</span>
<span class="token comment">############ Author end ###############</span>

<span class="token comment">############ Env &amp; Virables begin ###############</span>
<span class="token comment"># custom settings</span>
<span class="token assign-left variable">DBA_HOME</span><span class="token operator">=</span>/opt/database/dba
<span class="token assign-left variable">SOFTWARE_DIR</span><span class="token operator">=</span>/opt/package

<span class="token assign-left variable"><span class="token environment constant">HOSTNAME</span></span><span class="token operator">=</span>testdb-node01
<span class="token assign-left variable">IPADDR</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">ip</span> <span class="token parameter variable">-4</span> addr show dev eth0 <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-oP</span> <span class="token string">&#39;(?&lt;=inet\s)\d+(\.\d+){3}&#39;</span><span class="token variable">`</span></span>
<span class="token assign-left variable">ORACLE_OS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>

<span class="token assign-left variable">ORACLE_UNQNAME</span><span class="token operator">=</span>testdb
<span class="token assign-left variable">ORACLE_SID</span><span class="token operator">=</span>testdb
<span class="token assign-left variable">ORACLE_PDB_NAME</span><span class="token operator">=</span>testpdb
<span class="token assign-left variable">ORACLE_CHARSET</span><span class="token operator">=</span>AL32UTF8
<span class="token assign-left variable">ORACLE_SYS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>
<span class="token assign-left variable">ORACLE_SYSTEM_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>
<span class="token assign-left variable">ORACLE_PDB_ADMIN_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>

<span class="token assign-left variable">ORACLE_BASE_APP_DIR</span><span class="token operator">=</span>/u01
<span class="token assign-left variable">ORACLE_BASE_DATA_DIR</span><span class="token operator">=</span>/data
<span class="token assign-left variable">ORACLE_DATABASE_VERSION</span><span class="token operator">=</span><span class="token number">18.0</span>.0.0
<span class="token comment"># 64G</span>
<span class="token assign-left variable">ORACLE_RECOVERY_AREA_SIZE</span><span class="token operator">=</span>$<span class="token punctuation">[</span> <span class="token number">64</span>*1024 <span class="token punctuation">]</span>
<span class="token assign-left variable">ORACLE_ARCHIVE</span><span class="token operator">=</span>true


<span class="token comment"># Oracle Auto Settings</span>
<span class="token assign-left variable">TMP</span><span class="token operator">=</span>/tmp
<span class="token assign-left variable">ORACLE_HOSTNAME</span><span class="token operator">=</span><span class="token environment constant">$HOSTNAME</span>
<span class="token assign-left variable">ORACLE_BASE</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_APP_DIR</span>/app/oracle
<span class="token assign-left variable">ORACLE_HOME</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE</span>/product/<span class="token variable">$ORACLE_DATABASE_VERSION</span>/db_1
<span class="token assign-left variable">ORACLE_DATA_DIR</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_DATA_DIR</span>/app/oracle/oradata
<span class="token assign-left variable">ORACLE_ORA_INVENTORY</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_APP_DIR</span>/app/oraInventory
<span class="token assign-left variable">ORACLE_RECOVERY_AREA_DIR</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_DATA_DIR</span>/app/oracle/fast_recovery_area

<span class="token comment"># os auto settings</span>
<span class="token assign-left variable">OS_MEMORY</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">free</span> -b<span class="token operator">|</span><span class="token function">grep</span> Mem:<span class="token operator">|</span><span class="token function">awk</span> -F<span class="token string">&#39; &#39;</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">`</span></span>
<span class="token assign-left variable">OS_SHMMAX</span><span class="token operator">=</span>$<span class="token punctuation">[</span> <span class="token variable">$OS_MEMORY</span> * <span class="token number">2</span> / <span class="token number">3</span> <span class="token punctuation">]</span>
<span class="token assign-left variable">OS_SHMALL</span><span class="token operator">=</span>$<span class="token punctuation">[</span> <span class="token variable">$OS_SHMMAX</span> / <span class="token number">1024</span> <span class="token punctuation">]</span>
<span class="token assign-left variable">ORACLE_TOTAL_MEMORY</span><span class="token operator">=</span>$<span class="token punctuation">[</span> <span class="token variable">$OS_SHMMAX</span> / <span class="token number">1024</span> / <span class="token number">1024</span> <span class="token punctuation">]</span>
<span class="token function">hostname</span> <span class="token environment constant">$HOSTNAME</span>
<span class="token assign-left variable">OS_VERSION_ID</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> /etc/os-release <span class="token operator">|</span><span class="token function">grep</span> <span class="token string">&#39;^VERSION_ID=&#39;</span><span class="token operator">|</span><span class="token function">awk</span> -F<span class="token string">&#39;=&#39;</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">`</span></span>
<span class="token comment">############ Env &amp; Virables end ###############</span>


<span class="token keyword">function</span> <span class="token function-name function">DownloadPackages</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Downloading package ...&quot;</span>
    <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$SOFTWARE_DIR</span>
    yum <span class="token function">install</span> <span class="token parameter variable">-y</span> <span class="token function">wget</span>
    <span class="token function">wget</span> <span class="token parameter variable">-O</span> <span class="token variable">$SOFTWARE_DIR</span>/LINUX.X64_180000_db_home.zip ftp://10.10.12.158/pub/oracle/LINUX.X64_180000_db_home.zip
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">InstallDependency</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;0.Set Locale ...&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;en_US.UTF-8&quot;</span> <span class="token operator">&gt;</span> /etc/locale.conf
localectl set-locale <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;en_US.UTF-8&quot;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;en_US.UTF-8&quot;</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;1.Disable selinux and stop firewalld ...&quot;</span>
<span class="token function">cp</span> /etc/selinux/config /etc/selinux/config.orabak
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;s/^SELINUX=enforcing/SELINUX=disabled/g&#39;</span> /etc/selinux/config 
setenforce <span class="token number">0</span>
systemctl stop firewalld
systemctl disable firewalld
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;2.Config hostname ...&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token environment constant">$HOSTNAME</span> <span class="token operator">&gt;</span> /etc/hostname
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;3.Config hosts ...&quot;</span>
<span class="token function">cp</span> /etc/hosts /etc/hosts.orabak
<span class="token builtin class-name">echo</span> <span class="token variable">$IPADDR</span><span class="token string">&#39;   &#39;</span><span class="token environment constant">$HOSTNAME</span> <span class="token operator">&gt;&gt;</span> /etc/hosts
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;4.Config sysctl.conf ... &quot;</span>
<span class="token function">cp</span> /etc/sysctl.conf /etc/sysctl.conf.orabak

<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /etc/sysctl.conf <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
fs.file-max = 6815744
kernel.sem = 250 32000 100 128
kernel.shmmni = 4096
kernel.shmall = <span class="token variable">$OS_SHMALL</span> 
kernel.shmmax = <span class="token variable">$OS_SHMMAX</span>
kernel.panic_on_oops = 1
net.core.rmem_default = 262144
net.core.rmem_max = 4194304
net.core.wmem_default = 262144
net.core.wmem_max = 1048576
net.ipv4.conf.all.rp_filter = 2
net.ipv4.conf.default.rp_filter = 2
fs.aio-max-nr = 1048576
net.ipv4.ip_local_port_range = 9000 65500
EOF</span>
<span class="token function">sysctl</span> <span class="token parameter variable">-p</span>
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;5.Set Resource Usage Limit ...&quot;</span>
<span class="token function">cp</span> /etc/security/limits.conf /etc/security/limits.conf.orabak
<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /etc/security/limits.conf <span class="token operator">&lt;&lt;</span><span class="token string">EOF
oracle   soft   nofile    1024
oracle   hard   nofile    65536
oracle   soft   nproc    16384
oracle   hard   nproc    16384
oracle   soft   stack    10240
oracle   hard   stack    32768
oracle   hard   memlock    134217728
oracle   soft   memlock    134217728
EOF</span>

<span class="token function">cp</span> /etc/pam.d/login /etc/pam.d/login.orabak
<span class="token builtin class-name">echo</span> <span class="token string">&quot;session   required    pam_limits.so&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/pam.d/login
<span class="token function">sleep</span> <span class="token number">1</span>
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;6.Install Dependency Packages ...&quot;</span>
yum <span class="token function">install</span> <span class="token parameter variable">-y</span> <span class="token function">bc</span> binutils compat-libcap1 compat-libstdc++-33 compat-libstdc++-33.i686 elfutils-libelf.i686 <span class="token punctuation">\</span>
elfutils-libelf elfutils-libelf-devel.i686 elfutils-libelf-devel fontconfig-devel glibc.i686 glibc <span class="token punctuation">\</span>
glibc-devel.i686 glibc-devel ksh libaio.i686 libaio libaio-devel.i686 libaio-devel libX11.i686 libX11 <span class="token punctuation">\</span>
libXau.i686 libXau libXi.i686 libXi libXtst.i686 libXtst libgcc.i686 libgcc librdmacm-devel libstdc++.i686 <span class="token punctuation">\</span>
libstdc++ libstdc++-devel.i686 libstdc++-devel libxcb.i686 libxcb <span class="token function">make</span> nfs-utils net-tools python <span class="token punctuation">\</span>
python-configshell python-rtslib python-six smartmontools sysstat targetcli unixODBC <span class="token function">unzip</span>
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;7.Add Oracle Group and User ...&quot;</span>
<span class="token function">groupadd</span> <span class="token parameter variable">-g</span> <span class="token number">54321</span> oinstall
<span class="token function">groupadd</span> <span class="token parameter variable">-g</span> <span class="token number">54322</span> dba
<span class="token function">groupadd</span> <span class="token parameter variable">-g</span> <span class="token number">54323</span> oper
<span class="token function">useradd</span> <span class="token parameter variable">-u</span> <span class="token number">54321</span> <span class="token parameter variable">-g</span> oinstall <span class="token parameter variable">-G</span> dba,oper oracle
<span class="token builtin class-name">echo</span> <span class="token variable">$ORACLE_OS_PASSWORD</span> <span class="token operator">|</span> <span class="token function">passwd</span> <span class="token parameter variable">--stdin</span> oracle
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;8.Create Directory ...&quot;</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$ORACLE_HOME</span> <span class="token variable">$ORACLE_DATA_DIR</span> <span class="token variable">$ORACLE_ORA_INVENTORY</span> <span class="token variable">$ORACLE_RECOVERY_AREA_DIR</span>
<span class="token function">chown</span> <span class="token parameter variable">-R</span> oracle:oinstall <span class="token variable">$ORACLE_BASE_APP_DIR</span> <span class="token variable">$ORACLE_BASE_DATA_DIR</span> <span class="token variable">$ORACLE_RECOVERY_AREA_DIR</span>
<span class="token function">chmod</span> <span class="token parameter variable">-R</span> <span class="token number">775</span> <span class="token variable">$ORACLE_BASE_APP_DIR</span> <span class="token variable">$ORACLE_BASE_DATA_DIR</span> <span class="token variable">$ORACLE_RECOVERY_AREA_DIR</span>
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;9.Set Env ...&quot;</span>
<span class="token function">cp</span> /home/oracle/.bash_profile /home/oracle/.bash_profile.orabak
<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /home/oracle/.bash_profile <span class="token operator">&lt;&lt;</span><span class="token string">EOF
# Oracle ENV
export TMP=<span class="token variable">$TMP</span>
export TMPDIR=<span class="token variable">$TMP</span>

export ORACLE_HOSTNAME=<span class="token variable">$ORACLE_HOSTNAME</span>
export ORACLE_UNQNAME=<span class="token variable">$ORACLE_UNQNAME</span>
export ORACLE_SID=<span class="token variable">$ORACLE_SID</span>
export PDB_NAME=<span class="token variable">$ORACLE_PDB_NAME</span>
export ORACLE_BASE=<span class="token variable">$ORACLE_BASE</span>
export ORACLE_HOME=<span class="token variable">$ORACLE_HOME</span>
export ORA_INVENTORY=<span class="token variable">$ORACLE_ORA_INVENTORY</span>
export DATA_DIR=<span class="token variable">$ORACLE_DATA_DIR</span>
export ORACLE_HOME_LISTNER=\<span class="token variable">$ORACLE_HOME</span>

export LD_LIBRARY_PATH=\<span class="token variable">$ORACLE_HOME</span>/lib:/lib:/usr/lib
export CLASSPATH=\<span class="token variable">$ORACLE_HOME</span>/jlib:\<span class="token variable">$ORACLE_HOME</span>/rdbms/jlib

export PATH=\<span class="token variable">$ORACLE_HOME</span>/bin:\<span class="token environment constant">$PATH</span>
EOF</span>
<span class="token function">sleep</span> <span class="token number">1</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">InstallSoftware</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;10.unzip oracle database package ...&quot;</span>
<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOF
cd <span class="token variable">$ORACLE_HOME</span>
unzip -oq <span class="token variable">$SOFTWARE_DIR</span>/LINUX.X64_180000_db_home.zip

echo &quot;11.install database software ...&quot;
./runInstaller -ignorePrereq -waitforcompletion -silent                        \
    -responseFile <span class="token variable">${ORACLE_HOME}</span>/install/response/db_install.rsp               \
    oracle.install.option=INSTALL_DB_SWONLY                                    \
    ORACLE_HOSTNAME=<span class="token variable">${ORACLE_HOSTNAME}</span>                                         \
    UNIX_GROUP_NAME=oinstall                                                   \
    INVENTORY_LOCATION=<span class="token variable">${ORACLE_ORA_INVENTORY}</span>                                 \
    SELECTED_LANGUAGES=en                                                      \
    ORACLE_HOME=<span class="token variable">${ORACLE_HOME}</span>                                                 \
    ORACLE_BASE=<span class="token variable">${ORACLE_BASE}</span>                                                 \
    oracle.install.db.InstallEdition=EE                                        \
    oracle.install.db.OSDBA_GROUP=dba                                          \
    oracle.install.db.OSOPER_GROUP=oper                                         \
    oracle.install.db.OSBACKUPDBA_GROUP=dba                                    \
    oracle.install.db.OSDGDBA_GROUP=dba                                        \
    oracle.install.db.OSKMDBA_GROUP=dba                                        \
    oracle.install.db.OSRACDBA_GROUP=dba                                       \
    SECURITY_UPDATES_VIA_MYORACLESUPPORT=false                                 \
    DECLINE_SECURITY_UPDATES=true
EOF</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;Run &#39;<span class="token variable">${ORACLE_ORA_INVENTORY}</span>/orainstRoot.sh&#39; as root ...&quot;</span>
<span class="token variable">${ORACLE_ORA_INVENTORY}</span>/orainstRoot.sh
<span class="token builtin class-name">echo</span> <span class="token string">&quot;Run &#39;<span class="token variable">${ORACLE_HOME}</span>/root.sh&#39; as root ...&quot;</span>
<span class="token variable">${ORACLE_HOME}</span>/root.sh
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">CreateNetca</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;12.Create Netca ...&quot;</span>
<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOF
echo &quot;12.Create the listener ...&quot;
netca -silent -responsefile <span class="token variable">${ORACLE_HOME}</span>/assistants/netca/netca.rsp
echo &quot;12.Start the listener ...&quot;
lsnrctl start
EOF</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">CreateDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;13.Create Database ...&quot;</span>
<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOF
echo &quot;12.Start the listener ...&quot;
lsnrctl start

dbca -silent -createDatabase                                                   \
     -templateName General_Purpose.dbc                                         \
     -gdbname <span class="token variable">${ORACLE_SID}</span> -sid  <span class="token variable">${ORACLE_SID}</span> -responseFile NO_VALUE         \
     -characterSet <span class="token variable">$ORACLE_CHARSET</span>                                                  \
     -sysPassword <span class="token variable">$ORACLE_SYS_PASSWORD</span>                                                     \
     -systemPassword <span class="token variable">$ORACLE_SYSTEM_PASSWORD</span>                                               \
     -createAsContainerDatabase true                                           \
     -numberOfPDBs 1                                                           \
     -pdbName <span class="token variable">${ORACLE_PDB_NAME}</span>                                                      \
     -pdbAdminPassword <span class="token variable">$ORACLE_PDB_ADMIN_PASSWORD</span>                                           \
     -databaseType MULTIPURPOSE                                                \
     -memoryMgmtType auto_sga                                                  \
     -totalMemory <span class="token variable">$ORACLE_TOTAL_MEMORY</span>                                         \
     -storageType FS                                                           \
     -datafileDestination &quot;<span class="token variable">${ORACLE_DATA_DIR}</span>&quot;                                        \
     -enableArchive  <span class="token variable">${ORACLE_ARCHIVE}</span>                                                 \
     -recoveryAreaSize  <span class="token variable">${ORACLE_RECOVERY_AREA_SIZE}</span>                           \
     -recoveryAreaDestination  &quot;<span class="token variable">${ORACLE_RECOVERY_AREA_DIR}</span>&quot;                   \
     -redoLogFileSize 50                                                       \
     -emConfiguration NONE                                                     \
     -ignorePreReqs

echo &quot;Successfully Insall Oracle <span class="token variable">$ORACLE_DATABASE_VERSION</span> !&quot;
EOF</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">EnableStartup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;Edit /etc/oratab ...&quot;</span>
<span class="token function">cp</span> /etc/oratab /etc/oratab.orabak
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&quot;s#<span class="token variable">${ORACLE_SID}</span>:<span class="token variable">${ORACLE_HOME}</span>:N#<span class="token variable">${ORACLE_SID}</span>:<span class="token variable">${ORACLE_HOME}</span>:Y#g&quot;</span> /etc/oratab
<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOFOUT
sqlplus / as sysdba &lt;&lt;EOF
alter system set db_create_file_dest=&#39;<span class="token variable">${ORACLE_DATA_DIR}</span>&#39;;
alter pluggable database <span class="token variable">${ORACLE_PDB_NAME}</span> save state;
exit;
EOF
EOFOUT</span>

<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">${DBA_HOME}</span>/scripts
<span class="token function">chown</span> oracle:root <span class="token parameter variable">-R</span> <span class="token variable">${DBA_HOME}</span>

<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOF
touch <span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh
chmod a+x <span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh

cat &gt; <span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh &lt;&lt;&quot;EOFINNER&quot;
#! /bin/sh
# description: Oracle auto start-stop script.
#
# Set ORA_HOME to be equivalent to the \<span class="token variable">$ORACLE_HOME</span>
# from which you wish to execute dbstart and dbshut;
#
# Set ORA_OWNER to the user id of the owner of the
# Oracle database in ORACLE_HOME.

ORA_HOME=<span class="token variable">$ORACLE_HOME</span>
ORA_OWNER=oracle
CURRENT_USER=\<span class="token variable"><span class="token variable">`</span>whoami<span class="token punctuation">\</span><span class="token variable">`</span></span>

case &quot;\<span class="token variable">$1</span>&quot; in
&#39;start&#39;) 
    # Start the Oracle databases:
    # The following command assumes that the oracle login
    # will not prompt the user for any values
    # Remove &quot;&amp;&quot; if you don&#39;t want startup as a background process.
    if [ &quot;\<span class="token variable">$ORA_OWNER</span>&quot; = &quot;\<span class="token variable">$CURRENT_USER</span>&quot; ]; then
    \<span class="token variable">$ORA_HOME</span>/bin/dbstart \<span class="token variable">$ORA_HOME</span>
    else
    su - \<span class="token variable">$ORA_OWNER</span> -c &quot;\<span class="token variable">$ORA_HOME</span>/bin/dbstart \<span class="token variable">$ORA_HOME</span>&quot; 
    fi
    touch /var/lock/subsys/dbora
    break
    ;;

&#39;stop&#39;)
    # Stop the Oracle databases:
    # The following command assumes that the oracle login
    # will not prompt the user for any values
    if [ &quot;\<span class="token variable">$ORA_OWNER</span>&quot; = &quot;\<span class="token variable">$CURRENT_USER</span>&quot; ]; then
    \<span class="token variable">$ORA_HOME</span>/bin/dbshut \<span class="token variable">$ORA_HOME</span>
    else
    su - \<span class="token variable">$ORA_OWNER</span> -c &quot;\<span class="token variable">$ORA_HOME</span>/bin/dbshut \<span class="token variable">$ORA_HOME</span>&quot; &amp;
    fi
    rm -f /var/lock/subsys/dbora
    break
    ;;
   *)
    echo &quot;usage: <span class="token variable">$0</span> {start|stop}&quot;
    exit
    ;;
esac
EOF</span>INNER
EOF

<span class="token function">cat</span> <span class="token operator">&gt;</span> /lib/systemd/system/dbora.service <span class="token operator">&lt;&lt;</span><span class="token string">EOF
[Unit]
Description=The Oracle Database Service
After=syslog.target network.target

[Service]
# systemd ignores PAM limits, so set any necessary limits in the service.
# Not really a bug, but a feature.
# https://bugzilla.redhat.com/show_bug.cgi?id=754285
LimitMEMLOCK=infinity
LimitNOFILE=65535

#Type=simple
# idle: similar to simple, the actual execution of the service binary is delayed
#       until all jobs are finished, which avoids mixing the status output with shell output of services.
RemainAfterExit=yes
User=oracle
Group=oinstall
Restart=no
ExecStart=/bin/bash -c &#39;<span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh start&#39;
ExecStop=/bin/bash -c &#39;<span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh stop&#39;

[Install]
WantedBy=multi-user.target
EOF</span>

<span class="token comment"># autostart after os reboot</span>
systemctl <span class="token builtin class-name">enable</span> dbora.service

<span class="token comment"># add allow port to firewalld</span>
firewall-cmd --add-port<span class="token operator">=</span><span class="token number">1521</span> <span class="token parameter variable">--zone</span><span class="token operator">=</span>public <span class="token parameter variable">--permanent</span>
firewall-cmd <span class="token parameter variable">--reload</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">Usage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
Usage: <span class="token variable">$0</span> -h|--helpUsage, help message.
       <span class="token variable">$0</span> -d|--installDependency, install oracle dependency.
       <span class="token variable">$0</span> -a|--installAll, install dependency,database software,create netca,create database.     
       <span class="token variable">$0</span> -s|--installSoftware, install database software. 
       <span class="token variable">$0</span> -c|--createDatabase, create database.
       <span class="token variable">$0</span> -e|--enable, enable database auto startup after system boot/reboot.
       <span class="token variable">$0</span> -p|--package, download database package.
EOF</span>
<span class="token punctuation">}</span>


<span class="token assign-left variable">ARGS</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>getopt <span class="token parameter variable">-o</span> hdasncep <span class="token parameter variable">--long</span> help,installDependency,installAll,installSoftware,createNetca,createDatabase,enable,package <span class="token parameter variable">-n</span> <span class="token string">&quot;<span class="token variable">$0</span>&quot;</span>  -- <span class="token string">&quot;<span class="token variable">$@</span>&quot;</span><span class="token variable">`</span></span>
<span class="token builtin class-name">eval</span> <span class="token builtin class-name">set</span> --  <span class="token string">&quot;<span class="token variable">$ARGS</span>&quot;</span>
<span class="token keyword">while</span> <span class="token boolean">true</span>
<span class="token keyword">do</span>
<span class="token keyword">case</span> <span class="token string">&quot;<span class="token variable">$1</span>&quot;</span> <span class="token keyword">in</span>
    -h<span class="token operator">|</span>--help<span class="token punctuation">)</span>
    Usage
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -d<span class="token operator">|</span>--installDependency<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;InstallDependency ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    InstallDependency
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -a<span class="token operator">|</span>--installAll<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;InstallAll ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    InstallDependency
    InstallSoftware
    <span class="token comment"># CreateNetca</span>
    CreateDatabase
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -s<span class="token operator">|</span>--installSoftware<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;InstallSoftware ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    InstallDependency
    InstallSoftware
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -n<span class="token operator">|</span>--createNetca<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Create Netca ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    CreateNetca
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Create Netca Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -c<span class="token operator">|</span>--createDatabase<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;CreateDatabase ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    CreateDatabase
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -e<span class="token operator">|</span>--enable<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;EnableStartup ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    EnableStartup
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;EnableStartup Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -p<span class="token operator">|</span>--package<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Downloading Package ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    DownloadPackages
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Downloading Package Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    *<span class="token punctuation">)</span>
    Usage
    <span class="token builtin class-name">exit</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>
<span class="token keyword">done</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-3-6" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">19c</div><!--[--><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment">############ Author begin ###############</span>
<span class="token comment">## Author: Ableit</span>
<span class="token comment">## Date: 2022-07-20</span>
<span class="token comment">############ Author end ###############</span>

<span class="token comment">############ Env &amp; Virables begin ###############</span>
<span class="token comment"># custom settings</span>
<span class="token assign-left variable">DBA_HOME</span><span class="token operator">=</span>/opt/database/dba
<span class="token assign-left variable">SOFTWARE_DIR</span><span class="token operator">=</span>/opt/package

<span class="token assign-left variable"><span class="token environment constant">HOSTNAME</span></span><span class="token operator">=</span>testdb-node01
<span class="token assign-left variable">IPADDR</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">ip</span> <span class="token parameter variable">-4</span> addr show dev eth0 <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-oP</span> <span class="token string">&#39;(?&lt;=inet\s)\d+(\.\d+){3}&#39;</span><span class="token variable">`</span></span>
<span class="token assign-left variable">ORACLE_OS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>

<span class="token assign-left variable">ORACLE_UNQNAME</span><span class="token operator">=</span>testdb
<span class="token assign-left variable">ORACLE_SID</span><span class="token operator">=</span>testdb
<span class="token assign-left variable">ORACLE_PDB_NAME</span><span class="token operator">=</span>testpdb
<span class="token assign-left variable">ORACLE_CHARSET</span><span class="token operator">=</span>AL32UTF8
<span class="token assign-left variable">ORACLE_SYS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>
<span class="token assign-left variable">ORACLE_SYSTEM_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>
<span class="token assign-left variable">ORACLE_PDB_ADMIN_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>

<span class="token assign-left variable">ORACLE_BASE_APP_DIR</span><span class="token operator">=</span>/u01
<span class="token assign-left variable">ORACLE_BASE_DATA_DIR</span><span class="token operator">=</span>/data
<span class="token assign-left variable">ORACLE_DATABASE_VERSION</span><span class="token operator">=</span><span class="token number">19.3</span>.0.0
<span class="token comment"># 64G</span>
<span class="token assign-left variable">ORACLE_RECOVERY_AREA_SIZE</span><span class="token operator">=</span>$<span class="token punctuation">[</span> <span class="token number">64</span>*1024 <span class="token punctuation">]</span>
<span class="token assign-left variable">ORACLE_ARCHIVE</span><span class="token operator">=</span>true

<span class="token comment"># Oracle Auto Settings</span>
<span class="token assign-left variable">TMP</span><span class="token operator">=</span>/tmp
<span class="token assign-left variable">ORACLE_HOSTNAME</span><span class="token operator">=</span><span class="token environment constant">$HOSTNAME</span>
<span class="token assign-left variable">ORACLE_BASE</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_APP_DIR</span>/app/oracle
<span class="token assign-left variable">ORACLE_HOME</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE</span>/product/<span class="token variable">$ORACLE_DATABASE_VERSION</span>/db_1
<span class="token assign-left variable">ORACLE_DATA_DIR</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_DATA_DIR</span>/app/oracle/oradata
<span class="token assign-left variable">ORACLE_ORA_INVENTORY</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_APP_DIR</span>/app/oraInventory
<span class="token assign-left variable">ORACLE_RECOVERY_AREA_DIR</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_DATA_DIR</span>/app/oracle/fast_recovery_area

<span class="token comment"># os auto settings</span>
<span class="token assign-left variable">OS_MEMORY</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">free</span> -b<span class="token operator">|</span><span class="token function">grep</span> Mem:<span class="token operator">|</span><span class="token function">awk</span> -F<span class="token string">&#39; &#39;</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">`</span></span>
<span class="token assign-left variable">OS_SHMMAX</span><span class="token operator">=</span>$<span class="token punctuation">[</span> <span class="token variable">$OS_MEMORY</span> * <span class="token number">2</span> / <span class="token number">3</span> <span class="token punctuation">]</span>
<span class="token assign-left variable">OS_SHMALL</span><span class="token operator">=</span>$<span class="token punctuation">[</span> <span class="token variable">$OS_SHMMAX</span> / <span class="token number">1024</span> <span class="token punctuation">]</span>
<span class="token assign-left variable">ORACLE_TOTAL_MEMORY</span><span class="token operator">=</span>$<span class="token punctuation">[</span> <span class="token variable">$OS_SHMMAX</span> / <span class="token number">1024</span> / <span class="token number">1024</span> <span class="token punctuation">]</span>
<span class="token function">hostname</span> <span class="token environment constant">$HOSTNAME</span>
<span class="token assign-left variable">OS_VERSION_ID</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> /etc/os-release <span class="token operator">|</span><span class="token function">grep</span> <span class="token string">&#39;^VERSION_ID=&#39;</span><span class="token operator">|</span><span class="token function">awk</span> -F<span class="token string">&#39;=&#39;</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">`</span></span>
<span class="token comment">############ Env &amp; Virables end ###############</span>

<span class="token keyword">function</span> <span class="token function-name function">DownloadPackages</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Downloading package ...&quot;</span>
    <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$SOFTWARE_DIR</span>
    yum <span class="token function">install</span> <span class="token parameter variable">-y</span> <span class="token function">wget</span>
    <span class="token function">wget</span> <span class="token parameter variable">-O</span> <span class="token variable">$SOFTWARE_DIR</span>/LINUX.X64_193000_db_home.zip ftp://10.10.12.158/pub/oracle/LINUX.X64_193000_db_home.zip
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">InstallDependency</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;0.Set Locale ...&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;en_US.UTF-8&quot;</span> <span class="token operator">&gt;</span> /etc/locale.conf
localectl set-locale <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;en_US.UTF-8&quot;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;en_US.UTF-8&quot;</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;1.Disable selinux and stop firewalld ...&quot;</span>
<span class="token function">cp</span> /etc/selinux/config /etc/selinux/config.orabak
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;s/^SELINUX=enforcing/SELINUX=disabled/g&#39;</span> /etc/selinux/config 
setenforce <span class="token number">0</span>
systemctl stop firewalld
systemctl disable firewalld
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;2.Config hostname ...&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token environment constant">$HOSTNAME</span> <span class="token operator">&gt;</span> /etc/hostname
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;3.Config hosts ...&quot;</span>
<span class="token function">cp</span> /etc/hosts /etc/hosts.orabak
<span class="token builtin class-name">echo</span> <span class="token variable">$IPADDR</span><span class="token string">&#39;   &#39;</span><span class="token environment constant">$HOSTNAME</span> <span class="token operator">&gt;&gt;</span> /etc/hosts
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;4.Config sysctl.conf ... &quot;</span>
<span class="token function">cp</span> /etc/sysctl.conf /etc/sysctl.conf.orabak

<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /etc/sysctl.conf <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
fs.file-max = 6815744
kernel.sem = 250 32000 100 128
kernel.shmmni = 4096
kernel.shmall = <span class="token variable">$OS_SHMALL</span> 
kernel.shmmax = <span class="token variable">$OS_SHMMAX</span>
kernel.panic_on_oops = 1
net.core.rmem_default = 262144
net.core.rmem_max = 4194304
net.core.wmem_default = 262144
net.core.wmem_max = 1048576
net.ipv4.conf.all.rp_filter = 2
net.ipv4.conf.default.rp_filter = 2
fs.aio-max-nr = 1048576
net.ipv4.ip_local_port_range = 9000 65500
EOF</span>
<span class="token function">sysctl</span> <span class="token parameter variable">-p</span>
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;5.Set Resource Usage Limit ...&quot;</span>
<span class="token function">cp</span> /etc/security/limits.conf /etc/security/limits.conf.orabak
<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /etc/security/limits.conf <span class="token operator">&lt;&lt;</span><span class="token string">EOF
oracle   soft   nofile    1024
oracle   hard   nofile    65536
oracle   soft   nproc    16384
oracle   hard   nproc    16384
oracle   soft   stack    10240
oracle   hard   stack    32768
oracle   hard   memlock    134217728
oracle   soft   memlock    134217728
EOF</span>

<span class="token function">cp</span> /etc/pam.d/login /etc/pam.d/login.orabak
<span class="token builtin class-name">echo</span> <span class="token string">&quot;session   required    pam_limits.so&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/pam.d/login
<span class="token function">sleep</span> <span class="token number">1</span>
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;6.Install Dependency Packages ...&quot;</span>
yum <span class="token function">install</span> <span class="token parameter variable">-y</span>  <span class="token function">bc</span> binutils compat-libcap1 compat-libstdc++-33 <span class="token punctuation">\</span>
dtrace-utils elfutils-libelf elfutils-libelf-devel fontconfig-devel <span class="token punctuation">\</span>
glibc glibc-devel ksh libaio libaio-devel libdtrace-ctf-devel libgcc <span class="token punctuation">\</span>
librdmacm-devel libstdc++ libstdc++-devel libX11 libXau libxcb libXi <span class="token punctuation">\</span>
libXrender libXrender-devel libXtst <span class="token function">make</span> net-tools nfs-utils <span class="token punctuation">\</span>
policycoreutils policycoreutils-python python python-configshell <span class="token punctuation">\</span>
python-rtslib python-six smartmontools sysstat targetcli unixODBC <span class="token function">unzip</span>
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;7.Add Oracle Group and User ...&quot;</span>
<span class="token function">groupadd</span> <span class="token parameter variable">-g</span> <span class="token number">54321</span> oinstall
<span class="token function">groupadd</span> <span class="token parameter variable">-g</span> <span class="token number">54322</span> dba
<span class="token function">groupadd</span> <span class="token parameter variable">-g</span> <span class="token number">54323</span> oper
<span class="token function">useradd</span> <span class="token parameter variable">-u</span> <span class="token number">54321</span> <span class="token parameter variable">-g</span> oinstall <span class="token parameter variable">-G</span> dba,oper oracle
<span class="token builtin class-name">echo</span> <span class="token variable">$ORACLE_OS_PASSWORD</span> <span class="token operator">|</span> <span class="token function">passwd</span> <span class="token parameter variable">--stdin</span> oracle
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;8.Create Directory ...&quot;</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$ORACLE_HOME</span> <span class="token variable">$ORACLE_DATA_DIR</span> <span class="token variable">$ORACLE_ORA_INVENTORY</span> <span class="token variable">$ORACLE_RECOVERY_AREA_DIR</span>
<span class="token function">chown</span> <span class="token parameter variable">-R</span> oracle:oinstall <span class="token variable">$ORACLE_BASE_APP_DIR</span> <span class="token variable">$ORACLE_BASE_DATA_DIR</span> <span class="token variable">$ORACLE_RECOVERY_AREA_DIR</span>
<span class="token function">chmod</span> <span class="token parameter variable">-R</span> <span class="token number">775</span> <span class="token variable">$ORACLE_BASE_APP_DIR</span> <span class="token variable">$ORACLE_BASE_DATA_DIR</span> <span class="token variable">$ORACLE_RECOVERY_AREA_DIR</span>
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;9.Set Env ...&quot;</span>
<span class="token function">cp</span> /home/oracle/.bash_profile /home/oracle/.bash_profile.orabak
<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /home/oracle/.bash_profile <span class="token operator">&lt;&lt;</span><span class="token string">EOF
# Oracle ENV
export TMP=<span class="token variable">$TMP</span>
export TMPDIR=<span class="token variable">$TMP</span>

export ORACLE_HOSTNAME=<span class="token variable">$ORACLE_HOSTNAME</span>
export ORACLE_UNQNAME=<span class="token variable">$ORACLE_UNQNAME</span>
export ORACLE_SID=<span class="token variable">$ORACLE_SID</span>
export PDB_NAME=<span class="token variable">$ORACLE_PDB_NAME</span>
export ORACLE_BASE=<span class="token variable">$ORACLE_BASE</span>
export ORACLE_HOME=<span class="token variable">$ORACLE_HOME</span>
export ORA_INVENTORY=<span class="token variable">$ORACLE_ORA_INVENTORY</span>
export DATA_DIR=<span class="token variable">$ORACLE_DATA_DIR</span>
export ORACLE_HOME_LISTNER=\<span class="token variable">$ORACLE_HOME</span>

export LD_LIBRARY_PATH=\<span class="token variable">$ORACLE_HOME</span>/lib:/lib:/usr/lib
export CLASSPATH=\<span class="token variable">$ORACLE_HOME</span>/jlib:\<span class="token variable">$ORACLE_HOME</span>/rdbms/jlib

export PATH=\<span class="token variable">$ORACLE_HOME</span>/bin:\<span class="token environment constant">$PATH</span>
EOF</span>
<span class="token function">sleep</span> <span class="token number">1</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">InstallSoftware</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;10.unzip oracle database package ...&quot;</span>
<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOF
cd <span class="token variable">$ORACLE_HOME</span>
unzip -oq <span class="token variable">$SOFTWARE_DIR</span>/LINUX.X64_193000_db_home.zip

echo &quot;11.install database software ...&quot;
./runInstaller -ignorePrereq -waitforcompletion -silent                        \
    -responseFile <span class="token variable">${ORACLE_HOME}</span>/install/response/db_install.rsp               \
    oracle.install.option=INSTALL_DB_SWONLY                                    \
    ORACLE_HOSTNAME=<span class="token variable">${ORACLE_HOSTNAME}</span>                                         \
    UNIX_GROUP_NAME=oinstall                                                   \
    INVENTORY_LOCATION=<span class="token variable">${ORACLE_ORA_INVENTORY}</span>                                 \
    SELECTED_LANGUAGES=en                                                      \
    ORACLE_HOME=<span class="token variable">${ORACLE_HOME}</span>                                                 \
    ORACLE_BASE=<span class="token variable">${ORACLE_BASE}</span>                                                 \
    oracle.install.db.InstallEdition=EE                                        \
    oracle.install.db.OSDBA_GROUP=dba                                          \
    oracle.install.db.OSOPER_GROUP=oper                                         \
    oracle.install.db.OSBACKUPDBA_GROUP=dba                                    \
    oracle.install.db.OSDGDBA_GROUP=dba                                        \
    oracle.install.db.OSKMDBA_GROUP=dba                                        \
    oracle.install.db.OSRACDBA_GROUP=dba                                       \
    SECURITY_UPDATES_VIA_MYORACLESUPPORT=false                                 \
    DECLINE_SECURITY_UPDATES=true
EOF</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;Run &#39;<span class="token variable">${ORACLE_ORA_INVENTORY}</span>/orainstRoot.sh&#39; as root ...&quot;</span>
<span class="token variable">${ORACLE_ORA_INVENTORY}</span>/orainstRoot.sh
<span class="token builtin class-name">echo</span> <span class="token string">&quot;Run &#39;<span class="token variable">${ORACLE_HOME}</span>/root.sh&#39; as root ...&quot;</span>
<span class="token variable">${ORACLE_HOME}</span>/root.sh
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">CreateNetca</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;12.Create Netca ...&quot;</span>
<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOF
echo &quot;12.Create the listener ...&quot;
netca -silent -responsefile <span class="token variable">${ORACLE_HOME}</span>/assistants/netca/netca.rsp
echo &quot;12.Start the listener ...&quot;
lsnrctl start
EOF</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">CreateDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;13.Create Database ...&quot;</span>
<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOF
echo &quot;12.Start the listener ...&quot;
lsnrctl start

dbca -silent -createDatabase                                                   \
     -templateName General_Purpose.dbc                                         \
     -gdbname <span class="token variable">${ORACLE_SID}</span> -sid  <span class="token variable">${ORACLE_SID}</span> -responseFile NO_VALUE         \
     -characterSet <span class="token variable">$ORACLE_CHARSET</span>                                                  \
     -sysPassword <span class="token variable">$ORACLE_SYS_PASSWORD</span>                                                     \
     -systemPassword <span class="token variable">$ORACLE_SYSTEM_PASSWORD</span>                                               \
     -createAsContainerDatabase true                                           \
     -numberOfPDBs 1                                                           \
     -pdbName <span class="token variable">${ORACLE_PDB_NAME}</span>                                                      \
     -pdbAdminPassword <span class="token variable">$ORACLE_PDB_ADMIN_PASSWORD</span>                                           \
     -databaseType MULTIPURPOSE                                                \
     -memoryMgmtType auto_sga                                                  \
     -totalMemory <span class="token variable">$ORACLE_TOTAL_MEMORY</span>                                         \
     -storageType FS                                                           \
     -datafileDestination &quot;<span class="token variable">${ORACLE_DATA_DIR}</span>&quot;                                        \
     -enableArchive  <span class="token variable">${ORACLE_ARCHIVE}</span>                                                 \
     -recoveryAreaSize  <span class="token variable">${ORACLE_RECOVERY_AREA_SIZE}</span>                           \
     -recoveryAreaDestination  &quot;<span class="token variable">${ORACLE_RECOVERY_AREA_DIR}</span>&quot;                   \
     -redoLogFileSize 50                                                       \
     -emConfiguration NONE                                                     \
     -ignorePreReqs

echo &quot;Successfully Insall Oracle <span class="token variable">$ORACLE_DATABASE_VERSION</span> !&quot;
EOF</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">EnableStartup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;Edit /etc/oratab ...&quot;</span>
<span class="token function">cp</span> /etc/oratab /etc/oratab.orabak
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&quot;s#<span class="token variable">${ORACLE_SID}</span>:<span class="token variable">${ORACLE_HOME}</span>:N#<span class="token variable">${ORACLE_SID}</span>:<span class="token variable">${ORACLE_HOME}</span>:Y#g&quot;</span> /etc/oratab
<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOFOUT
sqlplus / as sysdba &lt;&lt;EOF
alter system set db_create_file_dest=&#39;<span class="token variable">${ORACLE_DATA_DIR}</span>&#39;;
alter pluggable database <span class="token variable">${ORACLE_PDB_NAME}</span> save state;
exit;
EOF
EOFOUT</span>

<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">${DBA_HOME}</span>/scripts
<span class="token function">chown</span> oracle:root <span class="token parameter variable">-R</span> <span class="token variable">${DBA_HOME}</span>

<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOF
touch <span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh
chmod a+x <span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh

cat &gt; <span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh &lt;&lt;&quot;EOFINNER&quot;
#! /bin/sh
# description: Oracle auto start-stop script.
#
# Set ORA_HOME to be equivalent to the \<span class="token variable">$ORACLE_HOME</span>
# from which you wish to execute dbstart and dbshut;
#
# Set ORA_OWNER to the user id of the owner of the
# Oracle database in ORACLE_HOME.

ORA_HOME=<span class="token variable">$ORACLE_HOME</span>
ORA_OWNER=oracle
CURRENT_USER=\<span class="token variable"><span class="token variable">`</span>whoami<span class="token punctuation">\</span><span class="token variable">`</span></span>

case &quot;\<span class="token variable">$1</span>&quot; in
&#39;start&#39;) 
    # Start the Oracle databases:
    # The following command assumes that the oracle login
    # will not prompt the user for any values
    # Remove &quot;&amp;&quot; if you don&#39;t want startup as a background process.
    if [ &quot;\<span class="token variable">$ORA_OWNER</span>&quot; = &quot;\<span class="token variable">$CURRENT_USER</span>&quot; ]; then
    \<span class="token variable">$ORA_HOME</span>/bin/dbstart \<span class="token variable">$ORA_HOME</span>
    else
    su - \<span class="token variable">$ORA_OWNER</span> -c &quot;\<span class="token variable">$ORA_HOME</span>/bin/dbstart \<span class="token variable">$ORA_HOME</span>&quot; 
    fi
    touch /var/lock/subsys/dbora
    break
    ;;

&#39;stop&#39;)
    # Stop the Oracle databases:
    # The following command assumes that the oracle login
    # will not prompt the user for any values
    if [ &quot;\<span class="token variable">$ORA_OWNER</span>&quot; = &quot;\<span class="token variable">$CURRENT_USER</span>&quot; ]; then
    \<span class="token variable">$ORA_HOME</span>/bin/dbshut \<span class="token variable">$ORA_HOME</span>
    else
    su - \<span class="token variable">$ORA_OWNER</span> -c &quot;\<span class="token variable">$ORA_HOME</span>/bin/dbshut \<span class="token variable">$ORA_HOME</span>&quot; &amp;
    fi
    rm -f /var/lock/subsys/dbora
    break
    ;;
   *)
    echo &quot;usage: <span class="token variable">$0</span> {start|stop}&quot;
    exit
    ;;
esac
EOF</span>INNER
EOF

<span class="token function">cat</span> <span class="token operator">&gt;</span> /lib/systemd/system/dbora.service <span class="token operator">&lt;&lt;</span><span class="token string">EOF
[Unit]
Description=The Oracle Database Service
After=syslog.target network.target

[Service]
# systemd ignores PAM limits, so set any necessary limits in the service.
# Not really a bug, but a feature.
# https://bugzilla.redhat.com/show_bug.cgi?id=754285
LimitMEMLOCK=infinity
LimitNOFILE=65535

#Type=simple
# idle: similar to simple, the actual execution of the service binary is delayed
#       until all jobs are finished, which avoids mixing the status output with shell output of services.
RemainAfterExit=yes
User=oracle
Group=oinstall
Restart=no
ExecStart=/bin/bash -c &#39;<span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh start&#39;
ExecStop=/bin/bash -c &#39;<span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh stop&#39;

[Install]
WantedBy=multi-user.target
EOF</span>

<span class="token comment"># autostart after os reboot</span>
systemctl <span class="token builtin class-name">enable</span> dbora.service
<span class="token comment"># add allow port to firewalld</span>
firewall-cmd --add-port<span class="token operator">=</span><span class="token number">1521</span> <span class="token parameter variable">--zone</span><span class="token operator">=</span>public <span class="token parameter variable">--permanent</span>
firewall-cmd <span class="token parameter variable">--reload</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">Usage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
Usage: <span class="token variable">$0</span> -h|--helpUsage, help message.
       <span class="token variable">$0</span> -d|--installDependency, install oracle dependency.
       <span class="token variable">$0</span> -a|--installAll, install dependency,database software,create netca,create database.     
       <span class="token variable">$0</span> -s|--installSoftware, install database software. 
       <span class="token variable">$0</span> -c|--createDatabase, create database.
       <span class="token variable">$0</span> -e|--enable, enable database auto startup after system boot/reboot.
       <span class="token variable">$0</span> -p|--package, download database package.
EOF</span>
<span class="token punctuation">}</span>


<span class="token assign-left variable">ARGS</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>getopt <span class="token parameter variable">-o</span> hdasncep <span class="token parameter variable">--long</span> help,installDependency,installAll,installSoftware,createNetca,createDatabase,enable,package <span class="token parameter variable">-n</span> <span class="token string">&quot;<span class="token variable">$0</span>&quot;</span>  -- <span class="token string">&quot;<span class="token variable">$@</span>&quot;</span><span class="token variable">`</span></span>
<span class="token builtin class-name">eval</span> <span class="token builtin class-name">set</span> --  <span class="token string">&quot;<span class="token variable">$ARGS</span>&quot;</span>
<span class="token keyword">while</span> <span class="token boolean">true</span>
<span class="token keyword">do</span>
<span class="token keyword">case</span> <span class="token string">&quot;<span class="token variable">$1</span>&quot;</span> <span class="token keyword">in</span>
    -h<span class="token operator">|</span>--help<span class="token punctuation">)</span>
    Usage
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -d<span class="token operator">|</span>--installDependency<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;InstallDependency ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    InstallDependency
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -a<span class="token operator">|</span>--installAll<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;InstallAll ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    InstallDependency
    InstallSoftware
    <span class="token comment"># CreateNetca</span>
    CreateDatabase
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -s<span class="token operator">|</span>--installSoftware<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;InstallSoftware ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    InstallDependency
    InstallSoftware
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -n<span class="token operator">|</span>--createNetca<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Create Netca ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    CreateNetca
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Create Netca Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -c<span class="token operator">|</span>--createDatabase<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;CreateDatabase ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    CreateDatabase
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -e<span class="token operator">|</span>--enable<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;EnableStartup ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    EnableStartup
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;EnableStartup Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -p<span class="token operator">|</span>--package<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Downloading Package ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    DownloadPackages
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Downloading Package Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    *<span class="token punctuation">)</span>
    Usage
    <span class="token builtin class-name">exit</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>
<span class="token keyword">done</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-3-7" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">21c</div><!--[--><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment">############ Author begin ###############</span>
<span class="token comment">## Author: Ableit</span>
<span class="token comment">## Date: 2022-07-20</span>
<span class="token comment">############ Author end ###############</span>

<span class="token comment">############ Env &amp; Virables begin ###############</span>
<span class="token comment"># custom settings</span>
<span class="token assign-left variable">DBA_HOME</span><span class="token operator">=</span>/opt/database/dba
<span class="token assign-left variable">SOFTWARE_DIR</span><span class="token operator">=</span>/opt/package

<span class="token assign-left variable"><span class="token environment constant">HOSTNAME</span></span><span class="token operator">=</span>testdb-node01
<span class="token assign-left variable">IPADDR</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">ip</span> <span class="token parameter variable">-4</span> addr show dev eth0 <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-oP</span> <span class="token string">&#39;(?&lt;=inet\s)\d+(\.\d+){3}&#39;</span><span class="token variable">`</span></span>
<span class="token assign-left variable">ORACLE_OS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>

<span class="token assign-left variable">ORACLE_UNQNAME</span><span class="token operator">=</span>testdb
<span class="token assign-left variable">ORACLE_SID</span><span class="token operator">=</span>testdb
<span class="token assign-left variable">ORACLE_PDB_NAME</span><span class="token operator">=</span>testpdb
<span class="token assign-left variable">ORACLE_CHARSET</span><span class="token operator">=</span>AL32UTF8
<span class="token assign-left variable">ORACLE_SYS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>
<span class="token assign-left variable">ORACLE_SYSTEM_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>
<span class="token assign-left variable">ORACLE_PDB_ADMIN_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;YsDB_GreatMen2022&quot;</span>

<span class="token assign-left variable">ORACLE_BASE_APP_DIR</span><span class="token operator">=</span>/u01
<span class="token assign-left variable">ORACLE_BASE_DATA_DIR</span><span class="token operator">=</span>/data
<span class="token assign-left variable">ORACLE_DATABASE_VERSION</span><span class="token operator">=</span><span class="token number">21.3</span>.0.0
<span class="token comment"># 64G</span>
<span class="token assign-left variable">ORACLE_RECOVERY_AREA_SIZE</span><span class="token operator">=</span>$<span class="token punctuation">[</span> <span class="token number">64</span>*1024 <span class="token punctuation">]</span>
<span class="token assign-left variable">ORACLE_ARCHIVE</span><span class="token operator">=</span>true

<span class="token comment"># Oracle Auto Settings</span>
<span class="token assign-left variable">TMP</span><span class="token operator">=</span>/tmp
<span class="token assign-left variable">ORACLE_HOSTNAME</span><span class="token operator">=</span><span class="token environment constant">$HOSTNAME</span>
<span class="token assign-left variable">ORACLE_BASE</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_APP_DIR</span>/app/oracle
<span class="token assign-left variable">ORACLE_HOME</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE</span>/product/<span class="token variable">$ORACLE_DATABASE_VERSION</span>/db_1
<span class="token assign-left variable">ORACLE_DATA_DIR</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_DATA_DIR</span>/app/oracle/oradata
<span class="token assign-left variable">ORACLE_ORA_INVENTORY</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_APP_DIR</span>/app/oraInventory
<span class="token assign-left variable">ORACLE_RECOVERY_AREA_DIR</span><span class="token operator">=</span><span class="token variable">$ORACLE_BASE_DATA_DIR</span>/app/oracle/fast_recovery_area

<span class="token comment"># os auto settings</span>
<span class="token assign-left variable">OS_MEMORY</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">free</span> -b<span class="token operator">|</span><span class="token function">grep</span> Mem:<span class="token operator">|</span><span class="token function">awk</span> -F<span class="token string">&#39; &#39;</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">`</span></span>
<span class="token assign-left variable">OS_SHMMAX</span><span class="token operator">=</span>$<span class="token punctuation">[</span> <span class="token variable">$OS_MEMORY</span> * <span class="token number">2</span> / <span class="token number">3</span> <span class="token punctuation">]</span>
<span class="token assign-left variable">OS_SHMALL</span><span class="token operator">=</span>$<span class="token punctuation">[</span> <span class="token variable">$OS_SHMMAX</span> / <span class="token number">1024</span> <span class="token punctuation">]</span>
<span class="token assign-left variable">ORACLE_TOTAL_MEMORY</span><span class="token operator">=</span>$<span class="token punctuation">[</span> <span class="token variable">$OS_SHMMAX</span> / <span class="token number">1024</span> / <span class="token number">1024</span> <span class="token punctuation">]</span>
<span class="token function">hostname</span> <span class="token environment constant">$HOSTNAME</span>
<span class="token assign-left variable">OS_VERSION_ID</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> /etc/os-release <span class="token operator">|</span><span class="token function">grep</span> <span class="token string">&#39;^VERSION_ID=&#39;</span><span class="token operator">|</span><span class="token function">awk</span> -F<span class="token string">&#39;=&#39;</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">`</span></span>
<span class="token comment">############ Env &amp; Virables end ###############</span>

<span class="token keyword">function</span> <span class="token function-name function">DownloadPackages</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Downloading package ...&quot;</span>
    <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$SOFTWARE_DIR</span>
    yum <span class="token function">install</span> <span class="token parameter variable">-y</span> <span class="token function">wget</span>
    <span class="token function">wget</span> <span class="token parameter variable">-O</span> <span class="token variable">$SOFTWARE_DIR</span>/LINUX.X64_213000_db_home.zip ftp://10.10.12.158/pub/oracle/LINUX.X64_213000_db_home.zip
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">InstallDependency</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;0.Set Locale ...&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;en_US.UTF-8&quot;</span> <span class="token operator">&gt;</span> /etc/locale.conf
localectl set-locale <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;en_US.UTF-8&quot;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;en_US.UTF-8&quot;</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;1.Disable selinux and stop firewalld ...&quot;</span>
<span class="token function">cp</span> /etc/selinux/config /etc/selinux/config.orabak
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;s/^SELINUX=enforcing/SELINUX=disabled/g&#39;</span> /etc/selinux/config 
setenforce <span class="token number">0</span>
systemctl stop firewalld
systemctl disable firewalld
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;2.Config hostname ...&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token environment constant">$HOSTNAME</span> <span class="token operator">&gt;</span> /etc/hostname
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;3.Config hosts ...&quot;</span>
<span class="token function">cp</span> /etc/hosts /etc/hosts.orabak
<span class="token builtin class-name">echo</span> <span class="token variable">$IPADDR</span><span class="token string">&#39;   &#39;</span><span class="token environment constant">$HOSTNAME</span> <span class="token operator">&gt;&gt;</span> /etc/hosts
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;4.Config sysctl.conf ... &quot;</span>
<span class="token function">cp</span> /etc/sysctl.conf /etc/sysctl.conf.orabak

<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /etc/sysctl.conf <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
fs.file-max = 6815744
kernel.sem = 250 32000 100 128
kernel.shmmni = 4096
kernel.shmall = <span class="token variable">$OS_SHMALL</span> 
kernel.shmmax = <span class="token variable">$OS_SHMMAX</span>
kernel.panic_on_oops = 1
net.core.rmem_default = 262144
net.core.rmem_max = 4194304
net.core.wmem_default = 262144
net.core.wmem_max = 1048576
net.ipv4.conf.all.rp_filter = 2
net.ipv4.conf.default.rp_filter = 2
fs.aio-max-nr = 1048576
net.ipv4.ip_local_port_range = 9000 65500
EOF</span>
<span class="token function">sysctl</span> <span class="token parameter variable">-p</span>
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;5.Set Resource Usage Limit ...&quot;</span>
<span class="token function">cp</span> /etc/security/limits.conf /etc/security/limits.conf.orabak
<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /etc/security/limits.conf <span class="token operator">&lt;&lt;</span><span class="token string">EOF
oracle   soft   nofile    1024
oracle   hard   nofile    65536
oracle   soft   nproc    16384
oracle   hard   nproc    16384
oracle   soft   stack    10240
oracle   hard   stack    32768
oracle   hard   memlock    134217728
oracle   soft   memlock    134217728
EOF</span>

<span class="token function">cp</span> /etc/pam.d/login /etc/pam.d/login.orabak
<span class="token builtin class-name">echo</span> <span class="token string">&quot;session   required    pam_limits.so&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/pam.d/login
<span class="token function">sleep</span> <span class="token number">1</span>
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;6.Install Dependency Packages ...&quot;</span>
yum <span class="token function">install</span> <span class="token parameter variable">-y</span>  <span class="token function">bc</span> binutils compat-libcap1 compat-libstdc++-33 <span class="token punctuation">\</span>
dtrace-utils elfutils-libelf elfutils-libelf-devel fontconfig-devel <span class="token punctuation">\</span>
glibc glibc-devel ksh libaio libaio-devel libdtrace-ctf-devel libgcc <span class="token punctuation">\</span>
librdmacm-devel libstdc++ libstdc++-devel libX11 libXau libxcb libXi <span class="token punctuation">\</span>
libXrender libXrender-devel libXtst <span class="token function">make</span> net-tools nfs-utils <span class="token punctuation">\</span>
policycoreutils policycoreutils-python python python-configshell <span class="token punctuation">\</span>
python-rtslib python-six smartmontools sysstat targetcli unixODBC <span class="token function">unzip</span>
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;7.Add Oracle Group and User ...&quot;</span>
<span class="token function">groupadd</span> <span class="token parameter variable">-g</span> <span class="token number">54321</span> oinstall
<span class="token function">groupadd</span> <span class="token parameter variable">-g</span> <span class="token number">54322</span> dba
<span class="token function">groupadd</span> <span class="token parameter variable">-g</span> <span class="token number">54323</span> oper
<span class="token function">useradd</span> <span class="token parameter variable">-u</span> <span class="token number">54321</span> <span class="token parameter variable">-g</span> oinstall <span class="token parameter variable">-G</span> dba,oper oracle
<span class="token builtin class-name">echo</span> <span class="token variable">$ORACLE_OS_PASSWORD</span> <span class="token operator">|</span> <span class="token function">passwd</span> <span class="token parameter variable">--stdin</span> oracle
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;8.Create Directory ...&quot;</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$ORACLE_HOME</span> <span class="token variable">$ORACLE_DATA_DIR</span> <span class="token variable">$ORACLE_ORA_INVENTORY</span> <span class="token variable">$ORACLE_RECOVERY_AREA_DIR</span>
<span class="token function">chown</span> <span class="token parameter variable">-R</span> oracle:oinstall <span class="token variable">$ORACLE_BASE_APP_DIR</span> <span class="token variable">$ORACLE_BASE_DATA_DIR</span> <span class="token variable">$ORACLE_RECOVERY_AREA_DIR</span>
<span class="token function">chmod</span> <span class="token parameter variable">-R</span> <span class="token number">775</span> <span class="token variable">$ORACLE_BASE_APP_DIR</span> <span class="token variable">$ORACLE_BASE_DATA_DIR</span> <span class="token variable">$ORACLE_RECOVERY_AREA_DIR</span>
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;9.Set Env ...&quot;</span>
<span class="token function">cp</span> /home/oracle/.bash_profile /home/oracle/.bash_profile.orabak
<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /home/oracle/.bash_profile <span class="token operator">&lt;&lt;</span><span class="token string">EOF
# Oracle ENV
export TMP=<span class="token variable">$TMP</span>
export TMPDIR=<span class="token variable">$TMP</span>

export ORACLE_HOSTNAME=<span class="token variable">$ORACLE_HOSTNAME</span>
export ORACLE_UNQNAME=<span class="token variable">$ORACLE_UNQNAME</span>
export ORACLE_SID=<span class="token variable">$ORACLE_SID</span>
export PDB_NAME=<span class="token variable">$ORACLE_PDB_NAME</span>
export ORACLE_BASE=<span class="token variable">$ORACLE_BASE</span>
export ORACLE_HOME=<span class="token variable">$ORACLE_HOME</span>
export ORA_INVENTORY=<span class="token variable">$ORACLE_ORA_INVENTORY</span>
export DATA_DIR=<span class="token variable">$ORACLE_DATA_DIR</span>
export ORACLE_HOME_LISTNER=\<span class="token variable">$ORACLE_HOME</span>

export LD_LIBRARY_PATH=\<span class="token variable">$ORACLE_HOME</span>/lib:/lib:/usr/lib
export CLASSPATH=\<span class="token variable">$ORACLE_HOME</span>/jlib:\<span class="token variable">$ORACLE_HOME</span>/rdbms/jlib

export PATH=\<span class="token variable">$ORACLE_HOME</span>/bin:\<span class="token environment constant">$PATH</span>
EOF</span>
<span class="token function">sleep</span> <span class="token number">1</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">InstallSoftware</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;10.unzip oracle database package ...&quot;</span>
<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOF
cd <span class="token variable">$ORACLE_HOME</span>
unzip -oq <span class="token variable">$SOFTWARE_DIR</span>/LINUX.X64_213000_db_home.zip

echo &quot;11.install database software ...&quot;
./runInstaller -ignorePrereq -waitforcompletion -silent                        \
    -responseFile <span class="token variable">${ORACLE_HOME}</span>/install/response/db_install.rsp               \
    oracle.install.option=INSTALL_DB_SWONLY                                    \
    ORACLE_HOSTNAME=<span class="token variable">${ORACLE_HOSTNAME}</span>                                         \
    UNIX_GROUP_NAME=oinstall                                                   \
    INVENTORY_LOCATION=<span class="token variable">${ORACLE_ORA_INVENTORY}</span>                                 \
    SELECTED_LANGUAGES=en                                                      \
    ORACLE_HOME=<span class="token variable">${ORACLE_HOME}</span>                                                 \
    ORACLE_BASE=<span class="token variable">${ORACLE_BASE}</span>                                                 \
    oracle.install.db.InstallEdition=EE                                        \
    oracle.install.db.OSDBA_GROUP=dba                                          \
    oracle.install.db.OSOPER_GROUP=oper                                         \
    oracle.install.db.OSBACKUPDBA_GROUP=dba                                    \
    oracle.install.db.OSDGDBA_GROUP=dba                                        \
    oracle.install.db.OSKMDBA_GROUP=dba                                        \
    oracle.install.db.OSRACDBA_GROUP=dba                                       \
    SECURITY_UPDATES_VIA_MYORACLESUPPORT=false                                 \
    DECLINE_SECURITY_UPDATES=true
EOF</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;Run &#39;<span class="token variable">${ORACLE_ORA_INVENTORY}</span>/orainstRoot.sh&#39; as root ...&quot;</span>
<span class="token variable">${ORACLE_ORA_INVENTORY}</span>/orainstRoot.sh
<span class="token builtin class-name">echo</span> <span class="token string">&quot;Run &#39;<span class="token variable">${ORACLE_HOME}</span>/root.sh&#39; as root ...&quot;</span>
<span class="token variable">${ORACLE_HOME}</span>/root.sh
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">CreateNetca</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;12.Create Netca ...&quot;</span>
<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOF
echo &quot;12.Create the listener ...&quot;
netca -silent -responsefile <span class="token variable">${ORACLE_HOME}</span>/assistants/netca/netca.rsp
echo &quot;12.Start the listener ...&quot;
lsnrctl start
EOF</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">CreateDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;13.Create Database ...&quot;</span>
<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOF
echo &quot;12.Start the listener ...&quot;
lsnrctl start

dbca -silent -createDatabase                                                   \
     -templateName General_Purpose.dbc                                         \
     -gdbname <span class="token variable">${ORACLE_SID}</span> -sid  <span class="token variable">${ORACLE_SID}</span> -responseFile NO_VALUE         \
     -characterSet <span class="token variable">$ORACLE_CHARSET</span>                                                  \
     -sysPassword <span class="token variable">$ORACLE_SYS_PASSWORD</span>                                                     \
     -systemPassword <span class="token variable">$ORACLE_SYSTEM_PASSWORD</span>                                               \
     -createAsContainerDatabase true                                           \
     -numberOfPDBs 1                                                           \
     -pdbName <span class="token variable">${ORACLE_PDB_NAME}</span>                                                      \
     -pdbAdminPassword <span class="token variable">$ORACLE_PDB_ADMIN_PASSWORD</span>                                           \
     -databaseType MULTIPURPOSE                                                \
     -memoryMgmtType auto_sga                                                  \
     -totalMemory <span class="token variable">$ORACLE_TOTAL_MEMORY</span>                                         \
     -storageType FS                                                           \
     -datafileDestination &quot;<span class="token variable">${ORACLE_DATA_DIR}</span>&quot;                                        \
     -enableArchive  <span class="token variable">${ORACLE_ARCHIVE}</span>                                                 \
     -recoveryAreaSize  <span class="token variable">${ORACLE_RECOVERY_AREA_SIZE}</span>                           \
     -recoveryAreaDestination  &quot;<span class="token variable">${ORACLE_RECOVERY_AREA_DIR}</span>&quot;                   \
     -redoLogFileSize 50                                                       \
     -emConfiguration NONE                                                     \
     -ignorePreReqs

echo &quot;Successfully Insall Oracle <span class="token variable">$ORACLE_DATABASE_VERSION</span> !&quot;
EOF</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">EnableStartup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;Edit /etc/oratab ...&quot;</span>
<span class="token function">cp</span> /etc/oratab /etc/oratab.orabak
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&quot;s#<span class="token variable">${ORACLE_SID}</span>:<span class="token variable">${ORACLE_HOME}</span>:N#<span class="token variable">${ORACLE_SID}</span>:<span class="token variable">${ORACLE_HOME}</span>:Y#g&quot;</span> /etc/oratab
<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOFOUT
sqlplus / as sysdba &lt;&lt;EOF
alter system set db_create_file_dest=&#39;<span class="token variable">${ORACLE_DATA_DIR}</span>&#39;;
alter pluggable database <span class="token variable">${ORACLE_PDB_NAME}</span> save state;
exit;
EOF
EOFOUT</span>

<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">${DBA_HOME}</span>/scripts
<span class="token function">chown</span> oracle:root <span class="token parameter variable">-R</span> <span class="token variable">${DBA_HOME}</span>

<span class="token function">su</span> - oracle <span class="token operator">&lt;&lt;</span><span class="token string">EOF
touch <span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh
chmod a+x <span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh

cat &gt; <span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh &lt;&lt;&quot;EOFINNER&quot;
#! /bin/sh
# description: Oracle auto start-stop script.
#
# Set ORA_HOME to be equivalent to the \<span class="token variable">$ORACLE_HOME</span>
# from which you wish to execute dbstart and dbshut;
#
# Set ORA_OWNER to the user id of the owner of the
# Oracle database in ORACLE_HOME.

ORA_HOME=<span class="token variable">$ORACLE_HOME</span>
ORA_OWNER=oracle
CURRENT_USER=\<span class="token variable"><span class="token variable">`</span>whoami<span class="token punctuation">\</span><span class="token variable">`</span></span>

case &quot;\<span class="token variable">$1</span>&quot; in
&#39;start&#39;) 
    # Start the Oracle databases:
    # The following command assumes that the oracle login
    # will not prompt the user for any values
    # Remove &quot;&amp;&quot; if you don&#39;t want startup as a background process.
    if [ &quot;\<span class="token variable">$ORA_OWNER</span>&quot; = &quot;\<span class="token variable">$CURRENT_USER</span>&quot; ]; then
    \<span class="token variable">$ORA_HOME</span>/bin/dbstart \<span class="token variable">$ORA_HOME</span>
    else
    su - \<span class="token variable">$ORA_OWNER</span> -c &quot;\<span class="token variable">$ORA_HOME</span>/bin/dbstart \<span class="token variable">$ORA_HOME</span>&quot; 
    fi
    touch /var/lock/subsys/dbora
    break
    ;;

&#39;stop&#39;)
    # Stop the Oracle databases:
    # The following command assumes that the oracle login
    # will not prompt the user for any values
    if [ &quot;\<span class="token variable">$ORA_OWNER</span>&quot; = &quot;\<span class="token variable">$CURRENT_USER</span>&quot; ]; then
    \<span class="token variable">$ORA_HOME</span>/bin/dbshut \<span class="token variable">$ORA_HOME</span>
    else
    su - \<span class="token variable">$ORA_OWNER</span> -c &quot;\<span class="token variable">$ORA_HOME</span>/bin/dbshut \<span class="token variable">$ORA_HOME</span>&quot; &amp;
    fi
    rm -f /var/lock/subsys/dbora
    break
    ;;
   *)
    echo &quot;usage: <span class="token variable">$0</span> {start|stop}&quot;
    exit
    ;;
esac
EOF</span>INNER
EOF

<span class="token function">cat</span> <span class="token operator">&gt;</span> /lib/systemd/system/dbora.service <span class="token operator">&lt;&lt;</span><span class="token string">EOF
[Unit]
Description=The Oracle Database Service
After=syslog.target network.target

[Service]
# systemd ignores PAM limits, so set any necessary limits in the service.
# Not really a bug, but a feature.
# https://bugzilla.redhat.com/show_bug.cgi?id=754285
LimitMEMLOCK=infinity
LimitNOFILE=65535

#Type=simple
# idle: similar to simple, the actual execution of the service binary is delayed
#       until all jobs are finished, which avoids mixing the status output with shell output of services.
RemainAfterExit=yes
User=oracle
Group=oinstall
Restart=no
ExecStart=/bin/bash -c &#39;<span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh start&#39;
ExecStop=/bin/bash -c &#39;<span class="token variable">${DBA_HOME}</span>/scripts/startup_db.sh stop&#39;

[Install]
WantedBy=multi-user.target
EOF</span>

<span class="token comment"># autostart after os reboot</span>
systemctl <span class="token builtin class-name">enable</span> dbora.service
<span class="token comment"># add allow port to firewalld</span>
firewall-cmd --add-port<span class="token operator">=</span><span class="token number">1521</span> <span class="token parameter variable">--zone</span><span class="token operator">=</span>public <span class="token parameter variable">--permanent</span>
firewall-cmd <span class="token parameter variable">--reload</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">Usage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
Usage: <span class="token variable">$0</span> -h|--helpUsage, help message.
       <span class="token variable">$0</span> -d|--installDependency, install oracle dependency.
       <span class="token variable">$0</span> -a|--installAll, install dependency,database software,create netca,create database.     
       <span class="token variable">$0</span> -s|--installSoftware, install database software. 
       <span class="token variable">$0</span> -c|--createDatabase, create database.
       <span class="token variable">$0</span> -e|--enable, enable database auto startup after system boot/reboot.
       <span class="token variable">$0</span> -p|--package, download database package.
EOF</span>
<span class="token punctuation">}</span>


<span class="token assign-left variable">ARGS</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>getopt <span class="token parameter variable">-o</span> hdasncep <span class="token parameter variable">--long</span> help,installDependency,installAll,installSoftware,createNetca,createDatabase,enable,package <span class="token parameter variable">-n</span> <span class="token string">&quot;<span class="token variable">$0</span>&quot;</span>  -- <span class="token string">&quot;<span class="token variable">$@</span>&quot;</span><span class="token variable">`</span></span>
<span class="token builtin class-name">eval</span> <span class="token builtin class-name">set</span> --  <span class="token string">&quot;<span class="token variable">$ARGS</span>&quot;</span>
<span class="token keyword">while</span> <span class="token boolean">true</span>
<span class="token keyword">do</span>
<span class="token keyword">case</span> <span class="token string">&quot;<span class="token variable">$1</span>&quot;</span> <span class="token keyword">in</span>
    -h<span class="token operator">|</span>--help<span class="token punctuation">)</span>
    Usage
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -d<span class="token operator">|</span>--installDependency<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;InstallDependency ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    InstallDependency
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -a<span class="token operator">|</span>--installAll<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;InstallAll ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    InstallDependency
    InstallSoftware
    <span class="token comment"># CreateNetca</span>
    CreateDatabase
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -s<span class="token operator">|</span>--installSoftware<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;InstallSoftware ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    InstallSoftware
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -n<span class="token operator">|</span>--createNetca<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Create Netca ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    CreateNetca
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Create Netca Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -c<span class="token operator">|</span>--createDatabase<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;CreateDatabase ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    CreateDatabase
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Installation Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -e<span class="token operator">|</span>--enable<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;EnableStartup ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    EnableStartup
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;EnableStartup Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    -p<span class="token operator">|</span>--package<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Downloading Package ...&quot;</span>
    <span class="token assign-left variable">STARTTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    DownloadPackages
    <span class="token assign-left variable">ENDTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Downloading Package Elapsed: $[ <span class="token variable">$ENDTIME</span> - <span class="token variable">$STARTTIME</span> ] s&quot;</span>
    <span class="token builtin class-name">shift</span> <span class="token number">2</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    *<span class="token punctuation">)</span>
    Usage
    <span class="token builtin class-name">exit</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>
<span class="token keyword">done</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><h2 id="自启动" tabindex="-1"><a class="header-anchor" href="#自启动"><span>自启动</span></a></h2><h3 id="设置-etc-oratab" tabindex="-1"><a class="header-anchor" href="#设置-etc-oratab"><span>设置/etc/oratab</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token variable">$ORACLE_SID</span><span class="token builtin class-name">:</span><span class="token variable">$ORACLE_HOME</span>:<span class="token operator">&lt;</span>N<span class="token operator">|</span>Y<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>使用dbstart和dbshut脚本需设置为<code>$ORACLE_SID:$ORACLE_HOME:Y</code></p></blockquote><h3 id="开机启动脚本" tabindex="-1"><a class="header-anchor" href="#开机启动脚本"><span>开机启动脚本</span></a></h3><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-47-0" aria-selected="true">脚本1</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-47-1" aria-selected="false">脚本2</button></div><!--[--><div class="vp-code-tab active" id="codetab-47-0" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">脚本1</div><!--[--><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token shebang important">#! /bin/sh </span>
<span class="token comment"># description: Oracle auto start-stop script.</span>
<span class="token comment">#</span>
<span class="token comment"># Set ORACLE_HOME to be equivalent to the $ORACLE_HOME</span>
<span class="token comment"># from which you wish to execute dbstart and dbshut;</span>
<span class="token comment">#</span>
<span class="token comment"># Set ORA_OWNER to the user id of the owner of the</span>
<span class="token comment"># Oracle database in ORACLE_HOME.</span>

<span class="token assign-left variable">ORA_HOME</span><span class="token operator">=</span><span class="token operator">&lt;</span>Type your ORACLE_HOME <span class="token keyword">in</span> full path here<span class="token operator">&gt;</span>
<span class="token assign-left variable">ORA_OWNER</span><span class="token operator">=</span><span class="token operator">&lt;</span>Type your Oracle account name here<span class="token operator">&gt;</span>

<span class="token keyword">case</span> <span class="token string">&quot;<span class="token variable">$1</span>&quot;</span> <span class="token keyword">in</span>
<span class="token string">&#39;start&#39;</span><span class="token punctuation">)</span>
    <span class="token comment"># Start the Oracle databases:</span>
    <span class="token comment"># The following command assumes that the oracle login</span>
    <span class="token comment"># will not prompt the user for any values</span>
    <span class="token comment"># Remove &quot;&amp;&quot; if you don&#39;t want startup as a background process.</span>
    <span class="token function">su</span> - <span class="token variable">$ORA_OWNER</span> <span class="token parameter variable">-c</span> <span class="token string">&quot;<span class="token variable">$ORA_HOME</span>/bin/dbstart <span class="token variable">$ORA_HOME</span>&quot;</span> <span class="token operator">&amp;</span>
    <span class="token function">touch</span> /var/lock/subsys/dbora
    <span class="token punctuation">;</span><span class="token punctuation">;</span>

<span class="token string">&#39;stop&#39;</span><span class="token punctuation">)</span>
    <span class="token comment"># Stop the Oracle databases:</span>
    <span class="token comment"># The following command assumes that the oracle login</span>
    <span class="token comment"># will not prompt the user for any values</span>
    <span class="token function">su</span> - <span class="token variable">$ORA_OWNER</span> <span class="token parameter variable">-c</span> <span class="token string">&quot;<span class="token variable">$ORA_HOME</span>/bin/dbshut <span class="token variable">$ORA_HOME</span>&quot;</span> <span class="token operator">&amp;</span>
    <span class="token function">rm</span> <span class="token parameter variable">-f</span> /var/lock/subsys/dbora
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-47-1" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">脚本2</div><!--[--><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash </span>
<span class="token comment">#desciption:Oracle auto start-stop script.</span>
<span class="token comment">#chkconfig:345 66 66</span>
<span class="token comment">#</span>
<span class="token comment">#Set ORA_HOME TO to be equivalent to the $ORACLE_HOME</span>
<span class="token comment">#from which you wish to execute dbstart and dbshut;</span>
<span class="token comment">#Set ORA_OWNER to the user id of the owner of the</span>
<span class="token comment">#Oracle database in ORA_HOME.</span>

<span class="token comment"># vim /etc/init.d/oracle</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">ORA_BASE</span><span class="token operator">=</span>/u01/oracle
<span class="token builtin class-name">export</span> <span class="token assign-left variable">ORA_HOME</span><span class="token operator">=</span>/u01/oracle/product/11.2.0/db_1<span class="token punctuation">;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">ORACLE_USER</span><span class="token operator">=</span>oracle


<span class="token keyword">case</span> <span class="token variable">$1</span> <span class="token keyword">in</span>
    start<span class="token punctuation">)</span>
    <span class="token function">su</span> - <span class="token string">&quot;<span class="token variable">$ORACLE_USER</span>&quot;</span><span class="token operator">&lt;&lt;</span><span class="token string">EOO
    lsnrctl start
    sqlplus /nolog&lt;&lt;EOS
    connect / as sysdba
    startup
EOS
    emctl start dbconsole
EOO</span>
<span class="token function">touch</span> /var/lock/subsys/<span class="token variable">$scriptname</span>
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
    stop<span class="token punctuation">)</span>
<span class="token function">su</span> - <span class="token string">&quot;<span class="token variable">$ORACLE_USER</span>&quot;</span><span class="token operator">&lt;&lt;</span><span class="token string">EOO
    lsnrctl stop
    sqlplus /nolog&lt;&lt;EOS
    connect / as sysdba
    shutdown immediate
EOS
    emctl stop dbconsole
EOO</span>
<span class="token function">rm</span> <span class="token parameter variable">-f</span> /var/lock/subsys/scriptname
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
    *<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Usage: <span class="token variable">$0</span> {start|stop}&quot;</span>
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><blockquote><p>如果监听名称不是默认“LISTENER”，需要在脚本中添加<code>$ORACLE_HOME/bin/lsnrctl {start|stop} listener_name</code></p></blockquote><h3 id="配置run-level实现自启动" tabindex="-1"><a class="header-anchor" href="#配置run-level实现自启动"><span>配置run-level实现自启动</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">chgrp</span> dba dbora
<span class="token function">chmod</span> <span class="token number">750</span> dbora
<span class="token function">ln</span> <span class="token parameter variable">-s</span> /etc/init.d/dbora /etc/rc.d/rc0.d/K01dbora
<span class="token function">ln</span> <span class="token parameter variable">-s</span> /etc/init.d/dbora /etc/rc.d/rc3.d/S99dbora
<span class="token function">ln</span> <span class="token parameter variable">-s</span> /etc/init.d/dbora /etc/rc.d/rc5.d/S99dbora
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="字符集" tabindex="-1"><a class="header-anchor" href="#字符集"><span>字符集</span></a></h2><h3 id="更改数据库字符集" tabindex="-1"><a class="header-anchor" href="#更改数据库字符集"><span>更改数据库字符集</span></a></h3><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">shutdown</span> immediate<span class="token punctuation">;</span>
startup mount<span class="token punctuation">;</span>
<span class="token keyword">alter</span> system <span class="token keyword">enable</span> restricted <span class="token keyword">session</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> system <span class="token keyword">set</span> job_queue_processes<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> system <span class="token keyword">set</span> aq_tm_processes<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">database</span> <span class="token keyword">open</span><span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">DATABASE</span> <span class="token keyword">character</span> <span class="token keyword">set</span> INTERNAL_USE AL32UTF8<span class="token punctuation">;</span>
<span class="token keyword">shutdown</span> immediate<span class="token punctuation">;</span>
startup<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="rac-安装常见问题" tabindex="-1"><a class="header-anchor" href="#rac-安装常见问题"><span>RAC 安装常见问题</span></a></h2><ul><li>错误代码：INS-35354</li></ul><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>The system on which you are attempting to install Oracle RAC is not part of a valid cluster.
   CAUSE: Before you can install Oracle RAC, you must install Oracle Grid Infrastructure on all servers (Oracle Clusterware and Oracle ASM) to create a cluster.
   ACTION: Oracle Grid Infrastructure is not installed. Install it either from the separate installation media included in your media pack, or install it by downloading it from Electronic Product Delivery (EPD) or the Oracle Technology Network (OTN). Oracle Grid Infrastructure normally is installed by a different operating system user than the one used for Oracle Database. It may need to be installed by your system administrator. See the installation guide for more details.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>原因： 由于在静默安装grid软件时，没有执行最后一步的脚本,导致 /u01/app/oraInventory/ContentsXML/inventory.xml 文件中缺失了：<code>CRS=&quot;true&quot;</code>。</li></ul><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>Execute Root Scripts successful.
As install user, execute the following script to complete the configuration.
	1. /u01/app/11.2.0.4/grid/cfgtoollogs/configToolAllCommands RESPONSE_FILE=
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code>[root@testdb1 ~]# cat /u01/app/oraInventory/ContentsXML/inventory.xml 
<span class="token prolog">&lt;?xml version=&quot;1.0&quot; standalone=&quot;yes&quot; ?&gt;</span>
<span class="token comment">&lt;!-- Copyright (c) 1999, 2013, Oracle and/or its affiliates.
All rights reserved. --&gt;</span>
<span class="token comment">&lt;!-- Do not modify the contents of this file by hand. --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>INVENTORY</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>VERSION_INFO</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SAVED_WITH</span><span class="token punctuation">&gt;</span></span>11.2.0.4.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SAVED_WITH</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MINIMUM_VER</span><span class="token punctuation">&gt;</span></span>2.1.0.6.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>MINIMUM_VER</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>VERSION_INFO</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HOME_LIST</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HOME</span> <span class="token attr-name">NAME</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Ora11g_gridinfrahome1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">LOC</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/u01/app/11.2.0.4/grid<span class="token punctuation">&quot;</span></span> <span class="token attr-name">TYPE</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>O<span class="token punctuation">&quot;</span></span> <span class="token attr-name">IDX</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>NODE_LIST</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>NODE</span> <span class="token attr-name">NAME</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>testdb1<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>NODE</span> <span class="token attr-name">NAME</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>testdb2<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>NODE_LIST</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HOME</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HOME_LIST</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>COMPOSITEHOME_LIST</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>COMPOSITEHOME_LIST</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>INVENTORY</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>解决方案</li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>grid@testdb1 ~<span class="token punctuation">]</span>$ /u01/app/11.2.0.4/grid/cfgtoollogs/configToolAllCommands
Setting the invPtrLoc to /u01/app/11.2.0.4/grid/oraInst.loc

perform - mode is starting <span class="token keyword">for</span> action: configure


perform - mode finished <span class="token keyword">for</span> action: configure

You can see the log file: /u01/app/11.2.0.4/grid/cfgtoollogs/oui/configActions2023-03-02_09-18-05-AM.log
<span class="token punctuation">[</span>grid@testdb1 ~<span class="token punctuation">]</span>$ crsctl status res -t^C
<span class="token punctuation">[</span>grid@testdb1 ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">exit</span>
<span class="token builtin class-name">logout</span>
<span class="token punctuation">[</span>root@testdb1 ~<span class="token punctuation">]</span><span class="token comment"># cat /u01/app/oraInventory/ContentsXML/inventory.xml </span>
<span class="token operator">&lt;</span>?xml <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">&quot;1.0&quot;</span> <span class="token assign-left variable">standalone</span><span class="token operator">=</span><span class="token string">&quot;yes&quot;</span> ?<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span>-- Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">1999</span>, <span class="token number">2013</span>, Oracle and/or its affiliates.
All rights reserved. --<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span>-- Do not modify the contents of this <span class="token function">file</span> by hand. --<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>INVENTORY<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>VERSION_INFO<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>SAVED_WITH<span class="token operator">&gt;</span><span class="token number">11.2</span>.0.4.<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>/SAVED_WITH<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>MINIMUM_VER<span class="token operator">&gt;</span><span class="token number">2.1</span>.0.6.<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>/MINIMUM_VER<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/VERSION_INFO<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>HOME_LIST<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token environment constant">HOME</span> <span class="token assign-left variable">NAME</span><span class="token operator">=</span><span class="token string">&quot;Ora11g_gridinfrahome1&quot;</span> <span class="token assign-left variable">LOC</span><span class="token operator">=</span><span class="token string">&quot;/u01/app/11.2.0.4/grid&quot;</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">&quot;O&quot;</span> <span class="token assign-left variable">IDX</span><span class="token operator">=</span><span class="token string">&quot;1&quot;</span> <span class="token assign-left variable">CRS</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span><span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>NODE_LIST<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>NODE <span class="token assign-left variable">NAME</span><span class="token operator">=</span><span class="token string">&quot;testdb1&quot;</span>/<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>NODE <span class="token assign-left variable">NAME</span><span class="token operator">=</span><span class="token string">&quot;testdb2&quot;</span>/<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>/NODE_LIST<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/<span class="token environment constant">HOME</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/HOME_LIST<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>COMPOSITEHOME_LIST<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/COMPOSITEHOME_LIST<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/INVENTORY<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>错误代码：INS-35423</li></ul><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>FATAL] [INS-35423] The installer has detected that Oracle Clusterware is not running on local node.
   CAUSE: You have chosen to install Oracle RAC when Oracle Clusterware stack is not running on the local node.
   ACTION: Start the Oracle Clusterware stack by running the following command as the root user from the Oracle Clusterware home (Grid home) : /bin/crsctl start crs. When the Oracle Clusterware stack is running, restart the installer and continue with the Oracle RAC installation.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>原因：ORACLE_HOSTNAME 169.xxx.xxx.94 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Runinstaller picking wrong HOST name/IP</p></li><li><p>解决方案： 指定安装Oracle Database软件时选项ORACLE_HOSTNAME的值为当前节点hostname。</p></li></ul></div><!--[--><!----><!--]--><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="vp-link vp-meta-label" href="https://github.com/abelit/abelit-datapeacock/edit/main/src/guide/database/oracle/installation/install-oracle19c-on-centos7.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">上次编辑于: </span><!----></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: ychenid@live.com">ableit</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><!----><a class="route-link vp-link next" href="/guide/database/oracle/installation/install-oracle19c-on-centos9.html" aria-label="在CentOS/RHEL 9.x上安装Oracle"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">在CentOS/RHEL 9.x上安装Oracle<!----></div></a></nav><!----><!--[--><!----><!--]--><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">MIT Licensed | Copyright © 2022-present Abelit</div><div class="vp-copyright">Copyright © 2024 Abelit </div></footer></div><!--]--><!--[--><!----><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-DR5J2daJ.js" defer></script>
  </body>
</html>
