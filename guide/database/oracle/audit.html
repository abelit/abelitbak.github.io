<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.9" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.39" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://github.com/abelit/abelit-datapeacock.git/guide/database/oracle/audit.html"><meta property="og:site_name" content="数之雀"><meta property="og:title" content="数据库审计"><meta property="og:description" content="Audit 的概念 审计（Audit)用于监视用户所执行的数据库操作，审计记录可存在数据字典表（称为审计记录:存储在 system 表空间中的SYS.AUD$表中，可通过视图 dba_audit_trail 查看）或操作系统审计记录中(默认位置为$ORACLE_BASE/admin/$ORACLE_SID/adump/)。Oracle Audit 包含..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-05-11T14:06:18.000Z"><meta property="article:author" content="Abelit"><meta property="article:modified_time" content="2024-05-11T14:06:18.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"数据库审计","image":[""],"dateModified":"2024-05-11T14:06:18.000Z","author":[{"@type":"Person","name":"Abelit","url":"https://github.com/abelit"}]}</script><link rel="icon" href="/favicon.ico"><link rel="icon" href="/assets/icon/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icon/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icon/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icon/chrome-192.png" type="image/png" sizes="192x192"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><link rel="apple-touch-icon" href="/assets/icon/apple-icon-152.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-TileImage" content="/assets/icon/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><title>数据库审计 | 数之雀</title><meta name="description" content="Audit 的概念 审计（Audit)用于监视用户所执行的数据库操作，审计记录可存在数据字典表（称为审计记录:存储在 system 表空间中的SYS.AUD$表中，可通过视图 dba_audit_trail 查看）或操作系统审计记录中(默认位置为$ORACLE_BASE/admin/$ORACLE_SID/adump/)。Oracle Audit 包含...">
    <link rel="preload" href="/assets/style-IQdVitae.css" as="style"><link rel="stylesheet" href="/assets/style-IQdVitae.css">
    <link rel="modulepreload" href="/assets/app-DR5J2daJ.js"><link rel="modulepreload" href="/assets/audit.html-uu1nVbjX.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">数之雀</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="开发"><!--[--><span class="font-icon icon iconfont icon-development" style=""></span>开发<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">程序设计语言</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/go/" aria-label="Go"><span class="font-icon icon iconfont icon-language-golang" style=""></span>Go<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/python/" aria-label="Python"><span class="font-icon icon iconfont icon-language-python" style=""></span>Python<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/rust/" aria-label="Rust"><span class="font-icon icon iconfont icon-language-rust" style=""></span>Rust<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/javascript/" aria-label="Javascript"><span class="font-icon icon iconfont icon-language-javascript" style=""></span>Javascript<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/typescript/" aria-label="Typescript"><span class="font-icon icon iconfont icon-language-typescript" style=""></span>Typescript<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">数据结构与算法</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/algorithm/" aria-label="Data Structure &amp; Algorithm"><span class="font-icon icon iconfont icon-algorithm" style=""></span>Data Structure &amp; Algorithm<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">后台框架</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/backend/flask/" aria-label="Flask"><span class="font-icon icon iconfont icon-flask" style=""></span>Flask<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/backend/django/" aria-label="Django"><span class="font-icon icon iconfont icon-django" style=""></span>Django<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/fastapi/" aria-label="FastAPI"><span class="font-icon icon iconfont icon-fastapi" style=""></span>FastAPI<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/gin/" aria-label="GIN"><span class="font-icon icon iconfont icon-gin" style=""></span>GIN<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/language/beego/" aria-label="Beego"><span class="font-icon icon iconfont icon-beego" style=""></span>Beego<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">前端框架</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/frontend/vue/" aria-label="Vue"><span class="font-icon icon iconfont icon-vue" style=""></span>Vue<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/frontend/react/" aria-label="React"><span class="font-icon icon iconfont icon-react" style=""></span>React<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">UI框架</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/ui/ant-design-vue.html" aria-label="ant-design-vue"><span class="font-icon icon iconfont icon-antdesign" style=""></span>ant-design-vue<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/ui/ant-design-react.html" aria-label="ant-design-react"><span class="font-icon icon iconfont icon-antdesign" style=""></span>ant-design-react<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/ui/element-plus.html" aria-label="element-plus"><span class="font-icon icon iconfont icon-eleme" style=""></span>element-plus<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/development/ui/vuetify.html" aria-label="vuetify"><span class="font-icon icon iconfont icon-vuetify" style=""></span>vuetify<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">模板</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="vp-link" href="https://pro.antdv.com/" rel="noopener noreferrer" target="_blank" aria-label="Ant Design Pro(Vue)"><!---->Ant Design Pro(Vue)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://pro.ant.design/" rel="noopener noreferrer" target="_blank" aria-label="Ant Design Pro(React)"><!---->Ant Design Pro(React)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://panjiachen.github.io/vue-element-admin-site/" rel="noopener noreferrer" target="_blank" aria-label="vue-element-admin"><!---->vue-element-admin<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://vvbin.cn/next/#/login?redirect=/dashboard" rel="noopener noreferrer" target="_blank" aria-label="vue-vben-admin"><!---->vue-vben-admin<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://pro.arco.design/" rel="noopener noreferrer" target="_blank" aria-label="Arco Design Pro"><!---->Arco Design Pro<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://github.com/vueleague/tpl-vue-admin-better?organization=vueleague&amp;organization=vueleague" rel="noopener noreferrer" target="_blank" aria-label="vue-admin-better"><!---->vue-admin-better<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="数据库"><!--[--><span class="font-icon icon iconfont icon-database" style=""></span>数据库<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">关系数据库</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link active vp-link" href="/guide/database/oracle/" aria-label="Oracle"><span class="font-icon icon iconfont icon-oracle" style=""></span>Oracle<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/mysql/" aria-label="MySQL"><span class="font-icon icon iconfont icon-mysql" style=""></span>MySQL<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/sqlite/" aria-label="SQlite"><span class="font-icon icon iconfont icon-sqlite" style=""></span>SQlite<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/postgresql/" aria-label="PostgreSQL"><span class="font-icon icon iconfont icon-postgresql" style=""></span>PostgreSQL<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/sqlserver/" aria-label="SQLServer"><span class="font-icon icon iconfont icon-sqlserver" style=""></span>SQLServer<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">非关系数据库</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/redis/" aria-label="Redis"><span class="font-icon icon iconfont icon-redis" style=""></span>Redis<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/mongo/" aria-label="MongoDB"><span class="font-icon icon iconfont icon-mongodb" style=""></span>MongoDB<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/couchdb/" aria-label="CouchDB"><span class="font-icon icon iconfont icon-couchdb" style=""></span>CouchDB<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/gauss/" aria-label="GaussDB"><span class="font-icon icon iconfont icon-opengauss" style=""></span>GaussDB<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/elasticsearch/" aria-label="ElasticSearch"><span class="font-icon icon iconfont icon-elasticsearch" style=""></span>ElasticSearch<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/hbase/" aria-label="HBase"><span class="font-icon icon iconfont icon-hbase" style=""></span>HBase<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/couchdb/" aria-label="CouchDB"><span class="font-icon icon iconfont icon-couchdb" style=""></span>CouchDB<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/database/clickhouse/" aria-label="ClickHouse"><span class="font-icon icon iconfont icon-clickhouse" style=""></span>ClickHouse<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="数据科学"><!--[--><span class="font-icon icon iconfont icon-datascience" style=""></span>数据科学<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">数据分析与挖掘</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/pandas/" aria-label="Pandas"><span class="font-icon icon iconfont icon-pandas-short" style=""></span>Pandas<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/numpy/" aria-label="Numpy"><span class="font-icon icon iconfont icon-numpy" style=""></span>Numpy<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/scipy/" aria-label="Scipy"><span class="font-icon icon iconfont icon-scipy" style=""></span>Scipy<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/sympy/" aria-label="Sympy"><span class="font-icon icon iconfont icon-sympy" style=""></span>Sympy<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">数据可视化</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/antv/" aria-label="Antv"><span class="font-icon icon iconfont icon-antv" style=""></span>Antv<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/echarts/" aria-label="Echarts"><span class="font-icon icon iconfont icon-echarts-footer-logo" style=""></span>Echarts<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/d3js/" aria-label="D3.js"><span class="font-icon icon iconfont icon-d3js" style=""></span>D3.js<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/thingjs/" aria-label="Thingjs"><span class="font-icon icon iconfont icon-thingjs" style=""></span>Thingjs<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/threejs/" aria-label="Threejs"><span class="font-icon icon iconfont icon-threejs" style=""></span>Threejs<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/matplotlib/" aria-label="Matplotlib"><span class="font-icon icon iconfont icon-matplotlib" style=""></span>Matplotlib<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/dashplotly/" aria-label="Dash/Plotly"><span class="font-icon icon iconfont icon-plotly" style=""></span>Dash/Plotly<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/vasualization/highcharts/" aria-label="HighCharts"><span class="font-icon icon iconfont icon-highcharts" style=""></span>HighCharts<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">机器学习与深度学习</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/tensorflow/" aria-label="Tensorflow"><span class="font-icon icon iconfont icon-tensorflow" style=""></span>Tensorflow<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/pytorch/" aria-label="PyTorch"><span class="font-icon icon iconfont icon-pytorch" style=""></span>PyTorch<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/scikit-learn/" aria-label="Scikit-Learn"><span class="font-icon icon iconfont icon-scikitlearn" style=""></span>Scikit-Learn<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">商务智能报表</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/bi/tableau/" aria-label="Tableau"><span class="font-icon icon iconfont icon-tableau" style=""></span>Tableau<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/bi/powerbi/" aria-label="Power BI"><span class="font-icon icon iconfont icon-powerbi" style=""></span>Power BI<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/bi/finebi/" aria-label="Fine BI"><span class="font-icon icon iconfont icon-finebi" style=""></span>Fine BI<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/datascience/bi/pentaho/" aria-label="Pentaho"><span class="font-icon icon iconfont icon-pentaho" style=""></span>Pentaho<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="区块链"><!--[--><span class="font-icon icon iconfont icon-blockchain" style=""></span>区块链<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/blockchain/" aria-label="区块链"><!---->区块链<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/blockchain/coin/" aria-label="加密货币"><!---->加密货币<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Linux"><!--[--><span class="font-icon icon iconfont icon-linux" style=""></span>Linux<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/os/linux/administration/" aria-label="系统管理"><!---->系统管理<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/os/linux/program/" aria-label="内核编程"><!---->内核编程<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="DevOps"><!--[--><span class="font-icon icon iconfont icon-devops" style=""></span>DevOps<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/zabbix/" aria-label="Zabbix"><span class="font-icon icon iconfont icon-zabbix-outline" style=""></span>Zabbix<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/prometheus/" aria-label="Prometheus"><span class="font-icon icon iconfont icon-prometheus" style=""></span>Prometheus<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/openfalcon/" aria-label="Open-Falcon"><span class="font-icon icon iconfont icon-open-falcon" style=""></span>Open-Falcon<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/ansible/" aria-label="Ansible"><span class="font-icon icon iconfont icon-ansible" style=""></span>Ansible<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/terraform/" aria-label="Terraform"><span class="font-icon icon iconfont icon-terraform" style=""></span>Terraform<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/jenkins/" aria-label="Jenkins"><span class="font-icon icon iconfont icon-jenkins" style=""></span>Jenkins<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/nginx/" aria-label="Nginx"><span class="font-icon icon iconfont icon-nginx" style=""></span>Nginx<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/grafana/" aria-label="Grafana"><span class="font-icon icon iconfont icon-grafana" style=""></span>Grafana<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/teleport/" aria-label="Teleport"><span class="font-icon icon iconfont icon-teleport" style=""></span>Teleport<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/jumpserver/" aria-label="JumpServer"><span class="font-icon icon iconfont icon-jumpserver" style=""></span>JumpServer<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/guide/devops/nextcloud/" aria-label="Nextcloud"><span class="font-icon icon iconfont icon-nextcloud" style=""></span>Nextcloud<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="工具集"><!--[--><span class="font-icon icon iconfont icon-tool" style=""></span>工具集<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">常用工具</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/vim/" aria-label="Vim"><span class="font-icon icon iconfont icon-vim" style=""></span>Vim<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/vscode/" aria-label="VSCode"><span class="font-icon icon iconfont icon-vscode" style=""></span>VSCode<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/markdown/" aria-label="Markdown"><span class="font-icon icon iconfont icon-markdown" style=""></span>Markdown<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/tex/" aria-label="Tex"><span class="font-icon icon iconfont icon-tex" style=""></span>Tex<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/gitbook/" aria-label="Gitbook"><span class="font-icon icon iconfont icon-gitbook" style=""></span>Gitbook<!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://v2.vuepress.vuejs.org/" rel="noopener noreferrer" target="_blank" aria-label="VuePress"><span class="font-icon icon iconfont icon-vuepress" style=""></span>VuePress<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/git/" aria-label="Git"><span class="font-icon icon iconfont icon-git" style=""></span>Git<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/guide/tool/github/" aria-label="GitHub"><span class="font-icon icon iconfont icon-github" style=""></span>GitHub<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">文档主题</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="vp-link" href="https://v2.vuepress.vuejs.org/zh/" rel="noopener noreferrer" target="_blank" aria-label="VuePress"><!---->VuePress<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://vuepress-theme-hope.github.io/v2/" rel="noopener noreferrer" target="_blank" aria-label="Vuepres-Theme-Hope"><!---->Vuepres-Theme-Hope<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="https://vuepress-theme-mix.vercel.app/" rel="noopener noreferrer" target="_blank" aria-label="VuePress Mix Theme"><!---->VuePress Mix Theme<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-subitem"><a class="vp-link" href="http://v2.vuepress-reco.recoluan.com/" rel="noopener noreferrer" target="_blank" aria-label="vuepress-theme-reco"><!---->vuepress-theme-reco<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="项目"><!--[--><span class="font-icon icon iconfont icon-project" style=""></span>项目<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="vp-link" href="https://github.com/abelit/abelit-archlinux.git" rel="noopener noreferrer" target="_blank" aria-label="Archlinux"><!---->Archlinux<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-item"><a class="vp-link" href="https://github.com/abelit/abelit-conky.git" rel="noopener noreferrer" target="_blank" aria-label="Conky"><!---->Conky<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="vp-dropdown-item"><a class="vp-link" href="https://github.com/abelit/abelit-pwdkeeper.git" rel="noopener noreferrer" target="_blank" aria-label="Password Keeper"><!---->Password Keeper<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul></button></div></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><div class="vp-nav-item"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="选择语言"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link active vp-link" href="/guide/database/oracle/audit.html" aria-label="简体中文"><!---->简体中文<!----></a></li><li class="vp-dropdown-item"><a class="route-link vp-link" href="/en/" aria-label="English"><!---->English<!----></a></li></ul></button></div></div><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/abelit/abelit-datapeacock" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">搜索</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/" aria-label="主页"><span class="font-icon icon iconfont icon-home" style=""></span>主页<!----></a></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable active"><span class="font-icon icon iconfont icon-note" style=""></span><a class="route-link active vp-link vp-sidebar-title" href="/guide/" aria-label="文档"><!---->文档<!----></a><!----></p><ul class="vp-sidebar-links"><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/" aria-label="指南"><span class="font-icon icon iconfont icon-creative" style=""></span>指南<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><span class="font-icon icon iconfont icon-database" style=""></span><span class="vp-sidebar-title">Database</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><span class="font-icon icon iconfont icon-oracle" style=""></span><span class="vp-sidebar-title">Oracle</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">性能优化</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/ash.html" aria-label="ASH"><!---->ASH<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/awr.html" aria-label="AWR"><!---->AWR<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/dataguard.html" aria-label="Data Guard"><!---->Data Guard<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/ddl.html" aria-label="DDL创建语句"><!---->DDL创建语句<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/autotask.html" aria-label="Oracle AutoTask"><!---->Oracle AutoTask<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/netservice.html" aria-label="Oracle网络服务"><!---->Oracle网络服务<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Oracle高可用</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/pdb.html" aria-label="PDB"><!---->PDB<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">SQL</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/sqlplus.html" aria-label="sqlplus工具"><!---->sqlplus工具<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/transaction.html" aria-label="事务管理"><!---->事务管理<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/session.html" aria-label="会话"><!---->会话<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">备份与恢复</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/characterset.html" aria-label="字符集"><!---->字符集<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">安装指南</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/instance.html" aria-label="实例"><!---->实例<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/archivelog.html" aria-label="归档日志"><!---->归档日志<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/error.html" aria-label="故障与错误"><!---->故障与错误<!----></a></li><li><a class="route-link active vp-link vp-sidebar-link vp-sidebar-page active" href="/guide/database/oracle/audit.html" aria-label="数据库审计"><!---->数据库审计<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/spaceobject.html" aria-label="数据库对象"><!---->数据库对象<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/user.html" aria-label="用户"><!---->用户<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/scripts.html" aria-label="脚本"><!---->脚本<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">表空间</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/scheduler.html" aria-label="调度器"><!---->调度器<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/trace.html" aria-label="跟踪文件"><!---->跟踪文件<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/guide/database/oracle/flashback.html" aria-label="闪回"><!---->闪回<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-mysql" style=""></span><span class="vp-sidebar-title">MySQL</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-postgresql" style=""></span><span class="vp-sidebar-title">PostgreSQL</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-sqlserver" style=""></span><span class="vp-sidebar-title">SQL Server</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-sqlite" style=""></span><span class="vp-sidebar-title">SQLite</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-mongodb" style=""></span><span class="vp-sidebar-title">Mongo</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-opengauss" style=""></span><span class="vp-sidebar-title">Gausss</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-clickhouse" style=""></span><span class="vp-sidebar-title">ClickHouse</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-redis" style=""></span><span class="vp-sidebar-title">Redis</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-elasticsearch" style=""></span><span class="vp-sidebar-title">ElasticSearch</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-tidb" style=""></span><span class="vp-sidebar-title">TiDB</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-cassandra" style=""></span><span class="vp-sidebar-title">Cassandra</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-couchdb" style=""></span><span class="vp-sidebar-title">CouchDB</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-hbase" style=""></span><span class="vp-sidebar-title">HBase</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-etcd" style=""></span><span class="vp-sidebar-title">etcd</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-apachekylin" style=""></span><span class="vp-sidebar-title">Apache Kylin</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-devops" style=""></span><span class="vp-sidebar-title">DevOps</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-os" style=""></span><span class="vp-sidebar-title">OS</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-cncf" style=""></span><span class="vp-sidebar-title">云原生</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-ai" style=""></span><span class="vp-sidebar-title">人工智能</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-infosec" style=""></span><span class="vp-sidebar-title">信息安全</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-blockchain" style=""></span><span class="vp-sidebar-title">区块链</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-tool" style=""></span><span class="vp-sidebar-title">工具集</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-development" style=""></span><span class="vp-sidebar-title">开发</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-opensource-fill" style=""></span><span class="vp-sidebar-title">开源软件</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-mindmap" style=""></span><span class="vp-sidebar-title">思维导入与学习路径</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-finance-fill" style=""></span><span class="vp-sidebar-title">投资理财</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-datascience" style=""></span><span class="vp-sidebar-title">数据科学</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-algorithm" style=""></span><span class="vp-sidebar-title">数据结构与算法</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-markdown" style=""></span><span class="vp-sidebar-title">文档管理</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-iot" style=""></span><span class="vp-sidebar-title">物联网</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/slides/" aria-label="演示文稿"><span class="font-icon icon iconfont icon-office-pptx" style=""></span>演示文稿<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/demo/" aria-label="案例"><span class="font-icon icon iconfont icon-discover" style=""></span>案例<!----></a></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable"><span class="font-icon icon iconfont icon-workspace" style=""></span><a class="route-link vp-link vp-sidebar-title" href="/workspace/" aria-label="工作空间"><!---->工作空间<!----></a><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-creative" style=""></span><span class="vp-sidebar-title">多彩贵州航空知识分享</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->数据库审计</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/abelit" target="_blank" rel="noopener noreferrer">Abelit</a></span><span property="author" content="Abelit"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-05-11T14:06:18.000Z"></span><!----><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 19 分钟</span><meta property="timeRequired" content="PT19M"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!--[--><!----><!--]--><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#audit-的概念">Audit 的概念</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#开启和关闭审计">开启和关闭审计</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#安装审计">安装审计</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#审计参数">审计参数</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#启用审计功能">启用审计功能</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#关闭审计功能">关闭审计功能</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#相关表和视图">相关表和视图</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#oracle-默认审计">Oracle 默认审计</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#审计配置查询">审计配置查询</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#审计记录查询">审计记录查询</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#类型与操作">类型与操作</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#操作参数">操作参数</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#标准审计">标准审计</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#基于值的审计">基于值的审计</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#细粒度审计-fga">细粒度审计（FGA）</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#清理-audit-数据">清理 Audit 数据</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#自动清理">自动清理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#手动清理">手动清理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#直接清理">直接清理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#自定义清理">自定义清理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#删除系统中审计文件">删除系统中审计文件</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#空间回收">空间回收</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#审计表空间">审计表空间</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#数据库审计最佳实践">数据库审计最佳实践</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><h2 id="audit-的概念" tabindex="-1"><a class="header-anchor" href="#audit-的概念"><span>Audit 的概念</span></a></h2><p>审计（Audit)用于监视用户所执行的数据库操作，审计记录可存在数据字典表（称为审计记录:存储在 system 表空间中的<code>SYS.AUD$</code>表中，可通过视图 <code>dba_audit_trail</code> 查看）或操作系统审计记录中(默认位置为<code>$ORACLE_BASE/admin/$ORACLE_SID/adump/</code>)。Oracle Audit 包含强制性审计、标准审计（Standard Auditing）、基于值的审计（Value-Base Auditing）、细粒度审计（Fine-Grained Auditing）、SYSDBA（和 SYSOPER）审计。</p><ul><li>强制性审计：不管其它审计选项或参数如何设置，所有 OracleDB 都会审计特定的操作。由于数据库需要记录诸如授权用户连接等数据库活动，所以存在强制性审计日志。</li><li>标准数据库审计：通过使用 AUDIT_TRAIL 初始化参数在系统级别启用。启用审计之后，选择要审计的对象和权限，并使用 AUDIT 命令设置审计属性。</li><li>基于值审计：扩展了标准数据库审计的功能，不仅会捕获发生的审计事件，还会捕获插入、更新或删除的实际值。基于值审计是通过数据库触发器实施的。</li><li>细粒度审计(FGA)：扩展了标准数据库审计的功能，从而可捕获发出的实际 SQL 语句，而不仅仅是发生事件的情况。</li><li>SYSDBA（和 SYSOPER）审计：将 DBA 与审计者或安全管理员的审计责任分离开，审计者或安全管理员在操作系统审计线索中负责监视 DBA 的活动。</li></ul><div class="hint-container tip"><p class="hint-container-title">参考地址</p><p>https://docs.oracle.com/cd/E25054_01/network.1111/e16543/auditing.htm</p></div><h2 id="开启和关闭审计" tabindex="-1"><a class="header-anchor" href="#开启和关闭审计"><span>开启和关闭审计</span></a></h2><h3 id="安装审计" tabindex="-1"><a class="header-anchor" href="#安装审计"><span>安装审计</span></a></h3><ul><li>判断是否安装审计</li></ul><p>如果做下面查询的时候发现表不存在，说明审计相关的表还没有安装，需要安装。</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> sys<span class="token punctuation">.</span>aud$<span class="token punctuation">;</span> <span class="token comment">--没有记录返回</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dba_audit_trail<span class="token punctuation">;</span> <span class="token comment">--没有记录返回</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>安装审计模块</li></ul><p>审计表安装在 SYSTEM 表空间。所以要确保 SYSTEM 表空间又足够的空间存放审计信息。</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token variable">@$ORACLE_HOME</span><span class="token operator">/</span>rdbms<span class="token operator">/</span>admin<span class="token operator">/</span>cataudit<span class="token punctuation">.</span><span class="token keyword">sql</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="审计参数" tabindex="-1"><a class="header-anchor" href="#审计参数"><span>审计参数</span></a></h3><ul><li><p>audit_sys_operations 参数</p><ul><li>audit_sys_operations 参数为 false 时，系统只以 os 文件记录 sysdba 身份的登录、开关数据库的操作。</li><li>audit_sys_operations 参数为 true 时，系统以 os 文件记录 sysdba 身份的登录、开关数据库的操作，以及其它辅助的操作。</li></ul></li><li><p>audit_trail 参数</p><ul><li>none：不启用审计功能；</li><li>db：启用审计功能，将审计信息记录在数据库中（sys.aud$），只包含连接信息（LOGON,LOGOFF），但不包含以 sysdba 或者 sysoper 连接的信息（记录在 OS 中）;</li><li>db,extended：将审计信息记录在数据库中，同时包含执行的 SQL 以及绑定变量;</li><li>os：以 XML 的形式将审计信息记录在 OS 中;</li><li>xml：启用审计功能，审计信息写入 xml 格式的操作系统文件中；</li><li>xml,extended：以 XML 的形式将审计信息记录在 OS 中，同时记录执行的 SQL 以及绑定变量.</li></ul></li><li><p>查看是否启用了审计功能</p></li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">show</span> parameter audit_trail<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="启用审计功能" tabindex="-1"><a class="header-anchor" href="#启用审计功能"><span>启用审计功能</span></a></h3><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> system <span class="token keyword">set</span> audit_trail <span class="token operator">=</span> <span class="token string">&#39;DB_EXTENDED&#39;</span> scope <span class="token operator">=</span> spfile<span class="token punctuation">;</span>
<span class="token keyword">shutdown</span> immediate<span class="token punctuation">;</span>
startup<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="关闭审计功能" tabindex="-1"><a class="header-anchor" href="#关闭审计功能"><span>关闭审计功能</span></a></h3><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> system <span class="token keyword">set</span> audit_trail <span class="token operator">=</span> <span class="token string">&#39;None&#39;</span> scope <span class="token operator">=</span> spfile<span class="token punctuation">;</span>
<span class="token keyword">shutdown</span> immediate<span class="token punctuation">;</span>
startup<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="相关表和视图" tabindex="-1"><a class="header-anchor" href="#相关表和视图"><span>相关表和视图</span></a></h2><ul><li><p>SYS.AUD$: 存储标准审计记录</p></li><li><p>SYS.FGA_LOG$: 存储细粒度审计记录</p></li><li><p>DBA_STMT_AUDIT_OPTS: 语句级别标准审计的策略，此视图仅在未启用统一审计</p></li><li><p>DBA_PRIV_AUDIT_OPTS: 权限级别标准审计策略，此视图仅在未启用统一审计</p></li><li><p>DBA_OBJ_AUDIT_OPTS: 对象级别标准审计的策略，此视图仅在未启用统一审计</p></li><li><p>DBA_AUDIT_EXISTS: 显示由AUDIT EXIST和AUDIT NOT EXIST产生的Audit Trail条目,此视图仅在未启用统一审计</p></li><li><p>DBA_AUDIT_MGMT_CLEAN_EVENTS: 显示有关审计跟踪清理或清除事件历史的信息,此视图仅适用于传统审计</p></li><li><p>DBA_AUDIT_MGMT_CLEANUP_JOBS: 显示有关配置的审计跟踪清除作业的信息</p></li><li><p>DBA_AUDIT_MGMT_CONFIG_PARAMS: 显示有关 PL/SQL 包使用的当前配置的审计跟踪属性的信息</p></li><li><p>DBA_AUDIT_MGMT_LAST_ARCH_TS: 显示有关为审计跟踪清理或清除设置的最后一个归档时间戳的信息</p></li><li><p>DBA_AUDIT_OBJECT: 对象级别标准审计记录，此视图仅在未启用统一审计</p></li><li><p>DBA_AUDIT_POLICIES: 描述了数据库中所有细粒度的审计策略，此视图仅在未启用统一审计</p></li><li><p>DBA_AUDIT_POLICY_COLUMNS: 描述数据库中所有细粒度的审计策略列，此视图仅在未启用统一审计</p></li><li><p>DBA_AUDIT_SESSION: 登录登出标准审计记录（普通用户，以 SYSDBA 或者 SYSOPER 的用户不记录），此视图仅在未启用统一审计</p></li><li><p>DBA_AUDIT_STATEMENT: 语句级别标准审计记录，此视图仅在未启用统一审计</p></li><li><p>DBA_AUDIT_TRAIL: 显示所有标准审计跟踪条目，显示所有标准审计跟踪条目，此视图仅在未启用统一审计</p></li><li><p>DBA_FGA_AUDIT_TRAIL: 显示所有审计记录，用于细粒度审计，此视图仅在未启用统一审计</p></li><li><p>DBA_COMMON_AUDIT_TRAIL: DBA_AUDIT_TRAIL+DBA_FGA_AUDIT_TRAIL</p></li><li><p>AUDIT_ACTIONS: 审计行为代码</p></li><li><p>V$XML_AUDIT_TRAIL: XML审计格式，包含标准、FGA、强制审计、SYS</p></li></ul><h3 id="oracle-默认审计" tabindex="-1"><a class="header-anchor" href="#oracle-默认审计"><span>Oracle 默认审计</span></a></h3><ul><li><p>默认权限审计</p><ul><li>ALTER ANY PROCEDURE</li><li>CREATE ANY LIBRARY</li><li>DROP ANY TABLE</li><li>ALTER ANY TABLE</li><li>CREATE ANY PROCEDURE</li><li>DROP PROFILE</li><li>ALTER DATABASE</li><li>CREATE ANY TABLE</li><li>DROP USER</li><li>ALTER PROFILE</li><li>CREATE EXTERNAL JOB</li><li>EXEMPT ACCESS POLICY</li><li>ALTER SYSTEM</li><li>CREATE PUBLIC DATABASE LINK</li><li>GRANT ANY OBJECT PRIVILEGE</li><li>ALTER USER</li><li>CREATE SESSION</li><li>GRANT ANY PRIVILEGE</li><li>AUDIT SYSTEM</li><li>CREATE USER</li><li>GRANT ANY ROLE</li><li>CREATE ANY JOB</li><li>DROP ANY PROCEDURE</li></ul></li><li><p>默认语句审计</p><ul><li>ROLE</li><li>SYSTEM AUDIT</li><li>PUBLIC SYNONYM</li><li>DATABASE LINK</li><li>PROFILE</li><li>SYSTEM GRANT</li></ul></li><li><p>启用审计脚本： <code>$ORACLE_HOME/rdbms/admin/secconf.sql</code>，仅修改 audit 配置；</p></li><li><p>禁用审计脚本： <code>$ORACLE_HOME/rdbms/admin/undoaud.sql</code>，会更改 audit 配置和用户密码设置。</p></li></ul><h3 id="审计配置查询" tabindex="-1"><a class="header-anchor" href="#审计配置查询"><span>审计配置查询</span></a></h3><ul><li>查询配置的语句级审计选项</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> DBA_STMT_AUDIT_OPTS<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>查询配置的权限级审计选项</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> DBA_PRIV_AUDIT_OPTS<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>查询配置的对象级审计选项</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> DBA_OBJ_AUDIT_OPTS
    <span class="token keyword">WHERE</span> OWNER <span class="token operator">=</span> <span class="token string">&#39;LAUREL&#39;</span> <span class="token operator">AND</span> OBJECT_NAME <span class="token operator">LIKE</span> <span class="token string">&#39;EMP%&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>查询默认对象审计选项</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> ALL_DEF_AUDIT_OPTS<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="审计记录查询" tabindex="-1"><a class="header-anchor" href="#审计记录查询"><span>审计记录查询</span></a></h3><ul><li>查询某个时段审计记录</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    a<span class="token punctuation">.</span>ntimestamp<span class="token comment">#,</span>
    a<span class="token punctuation">.</span>userid<span class="token punctuation">,</span>
    a<span class="token punctuation">.</span>userhost<span class="token punctuation">,</span>
    a<span class="token punctuation">.</span>terminal<span class="token punctuation">,</span>
    a<span class="token punctuation">.</span><span class="token keyword">action</span><span class="token comment">#,</span>
    aa<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
    a<span class="token punctuation">.</span>obj$creator<span class="token punctuation">,</span>
    a<span class="token punctuation">.</span>obj$name<span class="token punctuation">,</span>
    dbms_lob<span class="token punctuation">.</span>substr<span class="token punctuation">(</span>
        a<span class="token punctuation">.</span>sqltext
    <span class="token punctuation">)</span> <span class="token keyword">AS</span> sqltext<span class="token punctuation">,</span>
    dbms_lob<span class="token punctuation">.</span>substr<span class="token punctuation">(</span>
        a<span class="token punctuation">.</span>sqlbind
    <span class="token punctuation">)</span> <span class="token keyword">AS</span> sqlbind
<span class="token keyword">FROM</span>
    sys<span class="token punctuation">.</span>aud$          a<span class="token punctuation">,</span>
    sys<span class="token punctuation">.</span>audit_actions aa
<span class="token keyword">WHERE</span>
    a<span class="token punctuation">.</span><span class="token keyword">action</span><span class="token comment"># = aa.action</span>
    <span class="token operator">AND</span> a<span class="token punctuation">.</span>ntimestamp<span class="token comment"># &gt;= TO_DATE(&#39;20221212&#39;, &#39;yyyymmdd&#39;);</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>查询审计记录</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token comment">-- The following query lists audit records generated for all objects in the database:</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> DBA_AUDIT_OBJECT<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>查询审计会话选项的审计记录</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> USERNAME<span class="token punctuation">,</span> LOGOFF_TIME<span class="token punctuation">,</span> LOGOFF_LREAD<span class="token punctuation">,</span> LOGOFF_PREAD<span class="token punctuation">,</span>
    LOGOFF_LWRITE<span class="token punctuation">,</span> LOGOFF_DLOCK
    <span class="token keyword">FROM</span> DBA_AUDIT_SESSION<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="类型与操作" tabindex="-1"><a class="header-anchor" href="#类型与操作"><span>类型与操作</span></a></h2><h3 id="操作参数" tabindex="-1"><a class="header-anchor" href="#操作参数"><span>操作参数</span></a></h3><ul><li><p>操作是否成功</p><ul><li>（when successful）对执行成功的语句进行审；</li><li>（when not successful）对不成功的语句进行审计；</li><li>（不加）无论成功与否都进行审计。</li></ul></li><li><p>审计记录策略</p><ul><li>会话审计（by session），会话审计是指对某个用户或所有用户的同一语句只审计一次，形成一条审计记录；</li><li>存取审计（by access），存取审计是指对某个用户或所有用户的同一语句每执行一次审计一次，形成多条审计记录。</li></ul></li></ul><h3 id="标准审计" tabindex="-1"><a class="header-anchor" href="#标准审计"><span>标准审计</span></a></h3><ul><li>语句审计（Statement Auditing）：对特定的 SQL 语句进行审计，不指定具体对象；</li><li>权限审计（Privilege Auditing）：对特定的系统权限使用情况进行审计；</li><li>对象审计（Object Auditing）：对特定的模式对象上执行的特定语句进行审计；</li><li>网络审计（Network Auditing）：对网络协议错误与网络层内部错误进行审计。</li></ul><h4 id="语句审计-statement-auditing" tabindex="-1"><a class="header-anchor" href="#语句审计-statement-auditing"><span>语句审计(Statement Auditing)</span></a></h4><p>（1）语句审计是对特定的 SQL 语句进行审计，与具体的对象没有关系。创建语句审计的基本语法为：</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code>AUDIT
 sql_statement_
shortcut  <span class="token operator">|</span>  <span class="token keyword">ALL</span>  <span class="token operator">|</span>
<span class="token keyword">ALL</span> STATEMENTS
<span class="token punctuation">[</span> <span class="token keyword">BY</span>  user_lists <span class="token punctuation">]</span>  <span class="token operator">|</span>  <span class="token punctuation">[</span> <span class="token operator">IN</span> <span class="token keyword">SESSION</span>  <span class="token keyword">CURRENT</span> <span class="token punctuation">]</span>  <span class="token punctuation">[</span> <span class="token keyword">BY</span>  <span class="token keyword">SESSION</span>  <span class="token operator">|</span>  ACCESS <span class="token punctuation">]</span>  <span class="token punctuation">[</span> WHENEVER  <span class="token punctuation">[</span><span class="token operator">NOT</span> <span class="token punctuation">]</span> SUCCESSFUL<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>参数解释</em>：</p><ul><li>sql_statement_shortcut：被审计的 SQL 语句的快捷方式；</li><li>ALL：审计大部分 SQL 语句，这里不在列出；</li><li>ALL STATEMENT：对最高级别的 SQL 语句进行审计，即对直接执行的 SQL 语句进行审计，而不对包含在 PL/SQL 程序中的 SQL 语句进行审计；</li><li>BY user_lists：指定审计的用户，如果不指定，则审计全部用户；</li><li>IN SESSION CURRENT：只对当前会话进行审计；</li><li>BY SESSION：会话审计，同一个 SQL 语句只审计一次；</li><li>BY ACCESS：存取审计，同一个 SQL 语句执行几次就审计几次；</li><li>WHENEVER SUCCESSFUL：只审计执行成功的 SQL 语句；</li><li>WHENEVER NOT SUCCESS：只审计执行不成功的 SQL 语句；</li></ul><p>（2）如果要取消对某个语句的审计，只需将<code>AUDIT</code>命令改为<code>NOAUDIT</code>命令即可，其语法与创建 AUDIT 相同。 （3）通过数据字典<code>DBA_STMT_AUDIT_OPTS</code>可以了解当前数据库哪些用户进行了语句审计及审计设置信息。</p><p>（4）配置语句级审计示例</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token comment">-- Auditing all SQL statements for individual users.</span>
<span class="token comment">-- You can use the ALL STATEMENTS clause to audit only the top-level SQL statements. The behavior of this audit option is different from other statement audit options. If the SQL statement is issued from inside a PL/SQL procedure, then the ALL STATEMENTS audit option does not audit it. This audit option does not affect any other AUDIT options that you may have already set.</span>
AUDIT <span class="token keyword">ALL</span> STATEMENTS <span class="token keyword">BY</span> jward<span class="token punctuation">,</span> jsmith <span class="token keyword">BY</span> ACCESS WHENEVER SUCCESSFUL<span class="token punctuation">;</span>

<span class="token comment">-- Auditing all the SQL statement shortcut activities performed by individual users.</span>
AUDIT <span class="token keyword">ALL</span> <span class="token keyword">BY</span> jward <span class="token keyword">BY</span> ACCESS<span class="token punctuation">;</span>

<span class="token comment">-- Auditing all SQL statements for the current session, regardless of user.</span>
<span class="token comment">-- You can use the IN SESSION CURRENT clause for ALL STATEMENTS audit option to audit top-level SQL statements in the lifetime of the user session. You cannot use the IN SESSION CURRENT clause for a specific user. You cannot use the NOAUDIT statement to cancel it, but the auditing lasts only as long as the user session lasts. When the user ends the session, the auditing ends.</span>
AUDIT <span class="token keyword">ALL</span> STATEMENTS <span class="token operator">IN</span> <span class="token keyword">SESSION</span> <span class="token keyword">CURRENT</span> <span class="token keyword">BY</span> ACCESS WHENEVER <span class="token operator">NOT</span> SUCCESSFUL<span class="token punctuation">;</span>

<span class="token comment">-- Auditing login and logoff connections and disconnections.</span>
AUDIT <span class="token keyword">SESSION</span> <span class="token keyword">BY</span> ACCESS<span class="token punctuation">;</span>
AUDIT <span class="token keyword">SESSION</span> <span class="token keyword">BY</span> jward<span class="token punctuation">,</span> jsmith <span class="token keyword">BY</span> ACCESS<span class="token punctuation">;</span>

<span class="token comment">-- Auditing statements that fail because an object does not exist. </span>
<span class="token comment">-- The NOT EXISTS option of the AUDIT statement specifies auditing of all SQL statements that fail because the target object does not exist.</span>
AUDIT <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">;</span>

audit <span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">by</span> <span class="token keyword">session</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（4）取消语句级审计示例</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token comment">-- Using NOAUDIT to Remove Session and SQL Statement Auditing</span>
NOAUDIT <span class="token keyword">session</span><span class="token punctuation">;</span>
NOAUDIT <span class="token keyword">session</span> <span class="token keyword">BY</span> preston<span class="token punctuation">,</span> sebastian<span class="token punctuation">;</span>
NOAUDIT <span class="token keyword">DELETE</span> <span class="token keyword">ANY</span> <span class="token keyword">TABLE</span><span class="token punctuation">;</span>
NOAUDIT <span class="token keyword">SELECT</span> <span class="token keyword">TABLE</span><span class="token punctuation">,</span> <span class="token keyword">INSERT</span> <span class="token keyword">TABLE</span><span class="token punctuation">,</span> <span class="token keyword">DELETE</span> <span class="token keyword">TABLE</span><span class="token punctuation">,</span> <span class="token keyword">EXECUTE</span> <span class="token keyword">PROCEDURE</span><span class="token punctuation">;</span>

<span class="token comment">-- Using NOAUDIT to Remove ALL STATEMENTS Auditing</span>
NOAUDIT <span class="token keyword">ALL</span> STATEMENTS<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="权限审计-privilege-auditing" tabindex="-1"><a class="header-anchor" href="#权限审计-privilege-auditing"><span>权限审计（Privilege Auditing）</span></a></h4><p>（1）权限审计是对特定的系统权限进行审计，语法为：</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code>AUDIT
 system_privilege <span class="token operator">|</span>
<span class="token punctuation">[</span> <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span> <span class="token punctuation">]</span>  <span class="token punctuation">[</span> <span class="token keyword">BY</span> user_lists <span class="token punctuation">]</span>  <span class="token operator">|</span>  <span class="token punctuation">[</span> <span class="token operator">IN</span> <span class="token keyword">SESSION</span> <span class="token keyword">CURRENT</span> <span class="token punctuation">]</span>  <span class="token punctuation">[</span> <span class="token keyword">BY</span> <span class="token keyword">SESSION</span> <span class="token operator">|</span> ACCESS <span class="token punctuation">]</span>  <span class="token punctuation">[</span> WHENEVER  <span class="token punctuation">[</span> <span class="token operator">NOT</span> <span class="token punctuation">]</span> SUCCESSFUL<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（2）如果要了解当前数据库中对哪些用户使用了什么权限审计，可以通过数据字典<code>DBA_PRIV_AUDIT_OPTS</code>来查看。</p><p>（3）配置权限级审计示例</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token comment">-- Using AUDIT to Configure Privilege Auditing</span>
audit <span class="token keyword">create</span> <span class="token keyword">any</span> <span class="token keyword">table</span> <span class="token keyword">by</span> access<span class="token punctuation">;</span>

<span class="token comment">-- Auditing Unsuccessful Statements and Privileges</span>
AUDIT <span class="token keyword">SELECT</span> <span class="token keyword">TABLE</span><span class="token punctuation">,</span> <span class="token keyword">INSERT</span> <span class="token keyword">TABLE</span><span class="token punctuation">,</span> <span class="token keyword">DELETE</span> <span class="token keyword">TABLE</span><span class="token punctuation">,</span> <span class="token keyword">EXECUTE</span> <span class="token keyword">PROCEDURE</span>
      <span class="token keyword">BY</span> ACCESS
      WHENEVER <span class="token operator">NOT</span> SUCCESSFUL<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（4）取消权限级审计示例</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token comment">-- The following statement removes all privilege audit options</span>
NOAUDIT <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span><span class="token punctuation">;</span>
<span class="token comment">-- Removing the special privileges autdit options</span>
NOAUDIT <span class="token keyword">SELECT</span> <span class="token keyword">TABLE</span><span class="token punctuation">,</span> <span class="token keyword">INSERT</span> <span class="token keyword">TABLE</span><span class="token punctuation">,</span> <span class="token keyword">DELETE</span> <span class="token keyword">TABLE</span><span class="token punctuation">,</span> <span class="token keyword">EXECUTE</span> <span class="token keyword">PROCEDURE</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="对象审计" tabindex="-1"><a class="header-anchor" href="#对象审计"><span>对象审计</span></a></h4><p>（1）对象审计是指对特定模式对象的操作进行审计，与用户无关，语法为：</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code>AUDIT
 sql_operation <span class="token operator">|</span>
<span class="token keyword">ALL</span>  <span class="token keyword">ON</span> <span class="token punctuation">[</span><span class="token keyword">schema</span><span class="token punctuation">.</span><span class="token punctuation">]</span>object <span class="token punctuation">]</span>  <span class="token punctuation">[</span> <span class="token keyword">BY</span> user_lists <span class="token punctuation">]</span>  <span class="token operator">|</span>  <span class="token punctuation">[</span> <span class="token operator">IN</span> <span class="token keyword">SESSION</span> <span class="token keyword">CURRENT</span> <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token keyword">BY</span> <span class="token keyword">SESSION</span> <span class="token operator">|</span> ACCESS <span class="token punctuation">]</span>  <span class="token punctuation">[</span> WHENEVER  <span class="token punctuation">[</span> <span class="token operator">NOT</span> <span class="token punctuation">]</span> SUCCESSFUL<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>说明：</em> sql_operation 指定了特定对象上要审计的 SQL 语句。</p><p>（2）如果要查看当前数据库哪些模式对象进行了对象审计，可以通过查询<code>DBA_OBJ_AUDIT_OPTS</code>获得。</p><p>（3）配置对象级审计示例</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token comment">-- Configuring Auditing for a Schema Table</span>
AUDIT <span class="token keyword">DELETE</span> <span class="token keyword">ON</span> laurel<span class="token punctuation">.</span>emp <span class="token keyword">BY</span> ACCESS<span class="token punctuation">;</span>
audit <span class="token keyword">all</span> <span class="token keyword">on</span> scott<span class="token punctuation">.</span>dept <span class="token keyword">by</span> <span class="token keyword">session</span><span class="token punctuation">;</span>

<span class="token comment">-- Configuring Auditing for Any New Objects Using the DEFAULT Clause</span>
AUDIT <span class="token keyword">SELECT</span>
     <span class="token keyword">ON</span> <span class="token keyword">DEFAULT</span>
     <span class="token keyword">BY</span> ACCESS
     WHENEVER <span class="token operator">NOT</span> SUCCESSFUL<span class="token punctuation">;</span>

<span class="token comment">-- Auditing the Execution of a Procedure or Function</span>
AUDIT <span class="token keyword">EXECUTE</span> <span class="token keyword">ON</span> sec_mgr<span class="token punctuation">.</span>auth_orders <span class="token keyword">BY</span> ACCESS<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（4）取消对象级审计示例</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token comment">-- Use the NOAUDIT statement to remove object auditing. The following statements turn off the corresponding auditing options:</span>
NOAUDIT <span class="token keyword">DELETE</span> <span class="token keyword">ON</span> emp<span class="token punctuation">;</span>
NOAUDIT <span class="token keyword">SELECT</span><span class="token punctuation">,</span> <span class="token keyword">INSERT</span><span class="token punctuation">,</span> <span class="token keyword">DELETE</span> <span class="token keyword">ON</span> jward<span class="token punctuation">.</span>dept<span class="token punctuation">;</span>

<span class="token comment">-- To remove all object audit options on the emp table, enter the following statement:</span>
NOAUDIT <span class="token keyword">ALL</span> <span class="token keyword">ON</span> emp<span class="token punctuation">;</span>

<span class="token comment">-- To remove all default object audit options, enter the following statement:</span>
NOAUDIT <span class="token keyword">ALL</span> <span class="token keyword">ON</span> <span class="token keyword">DEFAULT</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="网络审计" tabindex="-1"><a class="header-anchor" href="#网络审计"><span>网络审计</span></a></h4><p>（1）网络审计对协议错误与网络层内部错误进行审计，网络审计捕获客户端与服务器通信过程中发生的错误，这些错误由 SQL*NET 网络服务抛出。网络审计的语法为：</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code>AUDIT NETWORK
<span class="token punctuation">[</span><span class="token keyword">BY</span> <span class="token keyword">SESSION</span> <span class="token operator">|</span> ACCESS<span class="token punctuation">]</span><span class="token punctuation">[</span>WHENEVER <span class="token punctuation">[</span><span class="token operator">NOT</span><span class="token punctuation">]</span> SUCCESSFUL<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="标准审计总结" tabindex="-1"><a class="header-anchor" href="#标准审计总结"><span>标准审计总结</span></a></h4><ol><li>对删除表(drop table)进行审计 由于没有对 drop table 进行单独审计的操作,需要添加 audit table by user(此命令将对 create table ,drop table, truncate table 进行审计)</li><li>对视图的审计:可以单独对视图的 create 进行审计,如果要对 drop 操作进行审计需要对视图加 audit view(该命令包含有 create view,drop view).</li><li>对程序包的审计:可以对包(函数,存储过程等)的 create 进行审计,如果需要对 drop 操作进行审计需要加 audit procedure(该命令对 CREATE FUNCTION, CREATE LIBRARY , CREATE PACKAGE, CREATE PACKAGE BODY, CREATE PROCEDURE, DROP FUNCTION, DROP LIBRARY, DROP PACKAGE, DROP PROCEDURE 进行审计)</li><li>对用户的审计:可以通过 audit user(该命令包含 create user,alter user,drop user)进行审计.</li></ol><h3 id="基于值的审计" tabindex="-1"><a class="header-anchor" href="#基于值的审计"><span>基于值的审计</span></a></h3><p>进行数据库审计时会记录审计对象中发生的插入、更新和删除操作，但是不会捕获更改的实际值。要扩展 数据库审计，可使用基于值的审计，利用数据库触发（事件驱动的 PL/SQL 构造）来捕获更改的值。</p><p>基于值的审计由用户或第三方代码实施。Oracle DB 提供了可用来构建基于值的审计系统的 PL/SQL 构 造。基于值的审计的关键部分是审计触发器，这是一个单纯为了捕获审计信息而构造的 PL/SQL 触发器。</p><p>通过触发器配置基于值的审计示例：</p><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-703-0" aria-selected="true">基本示例</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-703-1" aria-selected="false">完整示例</button></div><!--[--><div class="vp-code-tab active" id="codetab-703-0" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">基本示例</div><!--[--><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token comment">--以下是一个审计触发器的典型示例：</span>
<span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">TRIGGER</span> system<span class="token punctuation">.</span>hrsalary_audit
    <span class="token keyword">AFTER</span> <span class="token keyword">UPDATE</span> <span class="token keyword">OF</span> salary
    <span class="token keyword">ON</span> hr<span class="token punctuation">.</span>employees REFERENCING NEW <span class="token keyword">AS</span> NEW OLD <span class="token keyword">AS</span> OLD
    <span class="token keyword">FOR EACH ROW</span> <span class="token keyword">BEGIN</span>
    <span class="token keyword">IF</span> :old<span class="token punctuation">.</span>salary <span class="token operator">!=</span> :new<span class="token punctuation">.</span>salary <span class="token keyword">THEN</span>
        <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> system<span class="token punctuation">.</span>audit_employeesVALUES <span class="token punctuation">(</span>sys_context<span class="token punctuation">(</span><span class="token string">&#39;userenv&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;os_user&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sysdate<span class="token punctuation">,</span> sys_context<span class="token punctuation">(</span><span class="token string">&#39;userenv&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;ip_address&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>:new<span class="token punctuation">.</span>employee_id <span class="token operator">||</span><span class="token string">&#39; salary changed from &#39;</span><span class="token operator">||</span>:old<span class="token punctuation">.</span>salary<span class="token operator">||</span> <span class="token string">&#39; to &#39;</span><span class="token operator">||</span>:new<span class="token punctuation">.</span>salary<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-703-1" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">完整示例</div><!--[--><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code>Audit <span class="token keyword">Trigger</span> <span class="token keyword">to</span> Record Before <span class="token operator">and</span> <span class="token keyword">After</span> Changes <span class="token keyword">to</span> a <span class="token keyword">Table</span>

<span class="token comment">/* 1. Create the following table: */</span> 
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> emp_tab <span class="token punctuation">(</span>
   empno               NUMBER<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   ename               VARCHAR2<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   job                 VARCHAR2<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   mgr                 NUMBER<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   hiredate            <span class="token keyword">DATE</span><span class="token punctuation">,</span>
   sal                 NUMBER<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   deptno              NUMBER<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/* 2. Create a table to capture the audit data. */</span> 
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> emp_audit_tab <span class="token punctuation">(</span>
   oldname             VARCHAR2<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   oldjob              VARCHAR2<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   oldsal              NUMBER <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   newname             VARCHAR2<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   newjob              VARCHAR2<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   newsal              NUMBER<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   user1               varchar2<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   systemdate          <span class="token keyword">TIMESTAMP</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/* 3. Create a trigger to record the old and new values, the author of the change, 
      and when the change took place. */</span> 
<span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">TRIGGER</span> emp_audit_trig
  <span class="token keyword">AFTER</span> <span class="token keyword">INSERT</span> <span class="token operator">OR</span> <span class="token keyword">DELETE</span> <span class="token operator">OR</span> <span class="token keyword">UPDATE</span> <span class="token keyword">ON</span> emp_tab
  <span class="token keyword">FOR EACH ROW</span>
<span class="token keyword">BEGIN</span>
   <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> emp_audit_tab <span class="token punctuation">(</span>
   oldname<span class="token punctuation">,</span> oldjob<span class="token punctuation">,</span> oldsal<span class="token punctuation">,</span>
   newname<span class="token punctuation">,</span> newjob<span class="token punctuation">,</span> newsal<span class="token punctuation">,</span>
   user1<span class="token punctuation">,</span> systemdate
  <span class="token punctuation">)</span>
  <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>
    :OLD<span class="token punctuation">.</span>ename<span class="token punctuation">,</span> :OLD<span class="token punctuation">.</span>job<span class="token punctuation">,</span> :OLD<span class="token punctuation">.</span>sal<span class="token punctuation">,</span>
    :NEW<span class="token punctuation">.</span>ename<span class="token punctuation">,</span> :NEW<span class="token punctuation">.</span>job<span class="token punctuation">,</span> :NEW<span class="token punctuation">.</span>sal<span class="token punctuation">,</span>
    <span class="token keyword">user</span><span class="token punctuation">,</span> sysdate
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><h3 id="细粒度审计-fga" tabindex="-1"><a class="header-anchor" href="#细粒度审计-fga"><span>细粒度审计（FGA）</span></a></h3><p>细粒度审计(FGA) 扩展了审计功能，可捕获查询或处理数据的实际 SQL 语句。审计记录会被记录在 FGA_LOG$表中。DBMS_FGA 包主要包括 ADD_POLICY，ENABLE_POLICY，DISABLE_POLICY，和 DROP_POLICY 这 4 个存储过程。</p><p>示例：</p><ul><li>创建审计策略</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code>dbms_fga<span class="token punctuation">.</span>add_policy <span class="token punctuation">(</span>
object_schema<span class="token operator">=</span><span class="token operator">&gt;</span><span class="token string">&#39;BANK&#39;</span><span class="token punctuation">,</span>
object_name<span class="token operator">=</span><span class="token operator">&gt;</span><span class="token string">&#39;ACCOUNTS&#39;</span><span class="token punctuation">,</span>
audit_column <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;BALANCE&#39;</span><span class="token punctuation">,</span>
audit_condition <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;BALANCE &gt;= 11000&#39;</span><span class="token punctuation">,</span>
policy_name<span class="token operator">=</span><span class="token operator">&gt;</span><span class="token string">&#39;ACCOUNTS_ACCESS&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>删除审计策略</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">Begin</span>
dbms_fga<span class="token punctuation">.</span>drop_policy <span class="token punctuation">(</span>
object_schema<span class="token operator">=</span><span class="token operator">&gt;</span><span class="token string">&#39;BANK&#39;</span><span class="token punctuation">,</span>
object_name<span class="token operator">=</span><span class="token operator">&gt;</span><span class="token string">&#39;ACCOUNTS&#39;</span><span class="token punctuation">,</span>
policy_name<span class="token operator">=</span><span class="token operator">&gt;</span><span class="token string">&#39;ACCOUNTS_ACCESS&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>启用审计</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">begin</span>
dbms_fga<span class="token punctuation">.</span>enable_policy <span class="token punctuation">(</span>
object_schema <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;BANK&#39;</span><span class="token punctuation">,</span>
object_name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;ACCOUNTS&#39;</span><span class="token punctuation">,</span>
policy_name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;ACCOUNTS_ACCESS&#39;</span><span class="token punctuation">,</span>
<span class="token keyword">enable</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">FALSE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>禁用审计</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">begin</span>
dbms_fga<span class="token punctuation">.</span>disable_policy <span class="token punctuation">(</span>
object_schema <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;BANK&#39;</span><span class="token punctuation">,</span>
object_name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;ACCOUNTS&#39;</span><span class="token punctuation">,</span>
policy_name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;ACCOUNTS_ACCESS&#39;</span><span class="token punctuation">,</span>
<span class="token keyword">enable</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">FALSE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-752-0" aria-selected="true">查询视图</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-752-1" aria-selected="false">查询引用列</button></div><!--[--><div class="vp-code-tab active" id="codetab-752-0" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">查询视图</div><!--[--><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">TEXT</span> <span class="token keyword">FROM</span> DBA_VIEWS D <span class="token keyword">WHERE</span> D<span class="token punctuation">.</span>VIEW_NAME<span class="token operator">=</span><span class="token string">&#39;DBA_FGA_AUDIT_TRAIL&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-752-1" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">查询引用列</div><!--[--><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> D<span class="token punctuation">.</span>REFERENCED_OWNER<span class="token punctuation">,</span> D<span class="token punctuation">.</span>REFERENCED_NAME<span class="token punctuation">,</span> D<span class="token punctuation">.</span>REFERENCED_TYPE
<span class="token keyword">FROM</span> DBA_DEPENDENCIES D
<span class="token keyword">WHERE</span> D<span class="token punctuation">.</span>NAME <span class="token operator">=</span> <span class="token string">&#39;DBA_SQL_PLAN_BASELINES&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><ul><li>查看生成的审计</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">TIMESTAMP</span><span class="token punctuation">,</span>DB_USER<span class="token punctuation">,</span>OS_USER<span class="token punctuation">,</span>OBJECT_SCHEMA<span class="token punctuation">,</span>OBJECT_NAME<span class="token punctuation">,</span>SQL_TEXT <span class="token keyword">FROM</span> DBA_FGA_AUDIT_TRAIL<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>如何禁用或删除某个用户下的所有细粒度审计？</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
    <span class="token keyword">FOR</span> CUR <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> DBA_AUDIT_POLICIES<span class="token punctuation">)</span> <span class="token keyword">LOOP</span>
        <span class="token comment">--禁用</span>
        DBMS_FGA<span class="token punctuation">.</span>DISABLE_POLICY<span class="token punctuation">(</span>CUR<span class="token punctuation">.</span>OBJECT_SCHEMA<span class="token punctuation">,</span>CUR<span class="token punctuation">.</span>OBJECT_NAME<span class="token punctuation">,</span>CUR<span class="token punctuation">.</span>POLICY_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">--删除</span>
        <span class="token comment">--DBMS_FGA.DROP_POLICY(CUR.OBJECT_SCHEMA,CUR.OBJECT_NAME,CUR.POLICY_NAME);</span>
    <span class="token keyword">END</span> <span class="token keyword">LOOP</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="清理-audit-数据" tabindex="-1"><a class="header-anchor" href="#清理-audit-数据"><span>清理 Audit 数据</span></a></h2><p>Audit 的数据主要存储在 sys.aud$ 表中，该表默认位于 system 表空间中，我们根据需求，将该表移到了 sysaux 表空间中。</p><h3 id="自动清理" tabindex="-1"><a class="header-anchor" href="#自动清理"><span>自动清理</span></a></h3><p>（1）查看审计表大小</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">set</span> timing <span class="token keyword">on</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> sys<span class="token punctuation">.</span>aud$<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>（2）查看 Audit 审计表中记录的最早的时间</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>ntimestamp<span class="token comment">#) from sys.aud$;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>（3）查看审计数据最后归档时间，只有归档的数据才能删除</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> dba_audit_mgmt_last_arch_ts<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>（4）初始化清理Audit的功能，default_cleanup_interval =&gt;168代表清理周期为168(24*7)小时（只需执行一次）。</p><ul><li>验证是否初始化清理审计日志</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> SERVEROUTPUT <span class="token keyword">ON</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">IF</span>
    DBMS_AUDIT_MGMT<span class="token punctuation">.</span>IS_CLEANUP_INITIALIZED<span class="token punctuation">(</span>DBMS_AUDIT_MGMT<span class="token punctuation">.</span>AUDIT_TRAIL_AUD_STD<span class="token punctuation">)</span>
    <span class="token keyword">THEN</span>
    DBMS_OUTPUT<span class="token punctuation">.</span>PUT_LINE<span class="token punctuation">(</span><span class="token string">&#39;AUD$ is initialized for cleanup&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">ELSE</span>
    DBMS_OUTPUT<span class="token punctuation">.</span>PUT_LINE<span class="token punctuation">(</span><span class="token string">&#39;AUD$ is not initialized for cleanup.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>初始化清理审计日志</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
    dbms_audit_mgmt<span class="token punctuation">.</span>init_cleanup<span class="token punctuation">(</span>
        audit_trail_type <span class="token operator">=</span><span class="token operator">&gt;</span> dbms_audit_mgmt<span class="token punctuation">.</span>AUDIT_TRAIL_AUD_STD<span class="token punctuation">,</span>
        default_cleanup_interval <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">24</span><span class="token operator">*</span><span class="token number">7</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>取消初始化</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
DBMS_AUDIT_MGMT<span class="token punctuation">.</span>DEINIT_CLEANUP<span class="token punctuation">(</span>
    AUDIT_TRAIL_TYPE <span class="token operator">=</span><span class="token operator">&gt;</span> DBMS_AUDIT_MGMT<span class="token punctuation">.</span>AUDIT_TRAIL_AUD_STD<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>参数说明：</em></p><ul><li>AUDIT_TRAIL_TYPE <ul><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_AUD_STD: 标准审计, AUD$；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_FGA_STD: FGA审计, FGA_LOG$；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_DB_STD: 标准审计+FGA；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_OS: 系统审计文件（.aud）；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_XML: XML格式系统审计文件；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_FILES: 系统审计文件+XML格式系统审计文件；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_ALL: 所有审计记录,数据库+系统。</li></ul></li></ul><p>（5）设置需要清理的天数，最后一个数字<code>30</code>代表清理 30 天前的数据（归档时间大于等于清除时间）</p><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-874-0" aria-selected="true">11g</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-874-1" aria-selected="false">12c</button></div><!--[--><div class="vp-code-tab active" id="codetab-874-0" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">11g</div><!--[--><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
    dbms_audit_mgmt<span class="token punctuation">.</span>set_last_archive_timestamp<span class="token punctuation">(</span>
        audit_trail_type <span class="token operator">=</span><span class="token operator">&gt;</span> dbms_audit_mgmt<span class="token punctuation">.</span>audit_trail_aud_std<span class="token punctuation">,</span>
        last_archive_time <span class="token operator">=</span><span class="token operator">&gt;</span> systimestamp <span class="token operator">-</span> <span class="token number">30</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-874-1" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">12c</div><!--[--><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
    DBMS_AUDIT_MGMT<span class="token punctuation">.</span>SET_LAST_ARCHIVE_TIMESTAMP<span class="token punctuation">(</span>
    AUDIT_TRAIL_TYPE     <span class="token operator">=</span><span class="token operator">&gt;</span>  DBMS_AUDIT_MGMT<span class="token punctuation">.</span>AUDIT_TRAIL_UNIFIED<span class="token punctuation">,</span>
    LAST_ARCHIVE_TIME    <span class="token operator">=</span><span class="token operator">&gt;</span>  systimestamp <span class="token operator">-</span> <span class="token number">30</span><span class="token punctuation">,</span>
    RAC_INSTANCE_NUMBER  <span class="token operator">=</span><span class="token operator">&gt;</span>  <span class="token number">1</span><span class="token punctuation">,</span>
    CONTAINER            <span class="token operator">=</span><span class="token operator">&gt;</span> DBMS_AUDIT_MGMT<span class="token punctuation">.</span>CONTAINER_CURRENT<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p><em>参数说明：</em></p><ul><li>AUDIT_TRAIL_TYPE <ul><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_UNIFIED，设置通用 audit trail；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_AUD_STD：用于传统标准审计文件表<code>AUD$</code>；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_FGA_STD：用于传统 fine-grained 审计文件表<code>FGA_LOG$</code>；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_OS：用于传统操作系统审计文件<code>.aud</code>；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_XML：用于传统操作系统 xml 审计文件。</li></ul></li><li>AUDIT_TRAIL_PURGE_INTERVAL：执行清理 Job 的间隔时间（单位：小时）；</li><li>LAST_ARCHIVE_TIME 设置审计文件的时间戳格式（UTC）： YYYY-MM-DD HH:MI:SS.FF；</li><li>RAC_INSTANCE_NUMBER 指定 Oracle RAC 实例节点；</li><li>CONTAINER用于多租环境 <ul><li>DBMS_AUDIT_MGMT.CONTAINER_CURRENT：当前 PDB，只能在当前 PDB 中执行；</li><li>DBMS_AUDIT_MGMT.CONTAINER_ALL：所有 PDB，只能在 root 容器中执行。</li></ul></li></ul><p>（6）创建 Job 调度程序</p><ul><li>创建</li></ul><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-961-0" aria-selected="true">11g-</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-961-1" aria-selected="false">12c+</button></div><!--[--><div class="vp-code-tab active" id="codetab-961-0" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">11g-</div><!--[--><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
    DBMS_AUDIT_MGMT<span class="token punctuation">.</span>CREATE_PURGE_JOB <span class="token punctuation">(</span>
    AUDIT_TRAIL_TYPE            <span class="token operator">=</span><span class="token operator">&gt;</span> DBMS_AUDIT_MGMT<span class="token punctuation">.</span>AUDIT_TRAIL_AUD_STD<span class="token punctuation">,</span>
    AUDIT_TRAIL_PURGE_INTERVAL  <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">12</span><span class="token punctuation">,</span>
    AUDIT_TRAIL_PURGE_NAME      <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;Audit_Trail_PJ&#39;</span><span class="token punctuation">,</span>
    USE_LAST_ARCH_TIMESTAMP     <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-961-1" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">12c+</div><!--[--><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
    DBMS_AUDIT_MGMT<span class="token punctuation">.</span>CREATE_PURGE_JOB <span class="token punctuation">(</span>
    AUDIT_TRAIL_TYPE            <span class="token operator">=</span><span class="token operator">&gt;</span> DBMS_AUDIT_MGMT<span class="token punctuation">.</span>AUDIT_TRAIL_AUD_STD<span class="token punctuation">,</span>
    AUDIT_TRAIL_PURGE_INTERVAL  <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">12</span><span class="token punctuation">,</span>
    AUDIT_TRAIL_PURGE_NAME      <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;Audit_Trail_PJ&#39;</span><span class="token punctuation">,</span>
    USE_LAST_ARCH_TIMESTAMP     <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
    CONTAINER                   <span class="token operator">=</span><span class="token operator">&gt;</span> DBMS_AUDIT_MGMT<span class="token punctuation">.</span>CONTAINER_CURRENT<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><ul><li>启用</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
    DBMS_AUDIT_MGMT<span class="token punctuation">.</span>SET_PURGE_JOB_STATUS<span class="token punctuation">(</span>
    AUDIT_TRAIL_PURGE_NAME      <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;Audit_Trail_PJ&#39;</span><span class="token punctuation">,</span>
    AUDIT_TRAIL_STATUS_VALUE    <span class="token operator">=</span><span class="token operator">&gt;</span> DBMS_AUDIT_MGMT<span class="token punctuation">.</span>PURGE_JOB_ENABLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>禁用</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
    DBMS_AUDIT_MGMT<span class="token punctuation">.</span>SET_PURGE_JOB_STATUS<span class="token punctuation">(</span>
    AUDIT_TRAIL_PURGE_NAME      <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;Audit_Trail_PJ&#39;</span><span class="token punctuation">,</span>
    AUDIT_TRAIL_STATUS_VALUE    <span class="token operator">=</span><span class="token operator">&gt;</span> DBMS_AUDIT_MGMT<span class="token punctuation">.</span>PURGE_JOB_DISABLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>删除</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
 DBMS_AUDIT_MGMT<span class="token punctuation">.</span>DROP_PURGE_JOB<span class="token punctuation">(</span>
  AUDIT_TRAIL_PURGE_NAME  <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;Audit_Trail_PJ&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（7）清理 Archive Timestamp 设置</p><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-996-0" aria-selected="true">11g-</button></div><!--[--><div class="vp-code-tab active" id="codetab-996-0" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">11g-</div><!--[--><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
  DBMS_AUDIT_MGMT<span class="token punctuation">.</span>CLEAR_LAST_ARCHIVE_TIMESTAMP<span class="token punctuation">(</span>
   AUDIT_TRAIL_TYPE     <span class="token operator">=</span><span class="token operator">&gt;</span>  DBMS_AUDIT_MGMT<span class="token punctuation">.</span>AUDIT_TRAIL_AUD_STD<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p><em>参数说明：</em></p><ul><li>AUDIT_TRAIL_TYPE <ul><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_AUD_STD: 标准审计, AUD$；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_FGA_STD: FGA审计, FGA_LOG$；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_DB_STD: 标准审计+FGA；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_OS: 系统审计文件（.aud）；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_XML: XML格式系统审计文件；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_FILES: 系统审计文件+XML格式系统审计文件；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_ALL: 所有审计记录,数据库+系统。</li></ul></li></ul><h3 id="手动清理" tabindex="-1"><a class="header-anchor" href="#手动清理"><span>手动清理</span></a></h3><p>（1）查看审计表大小</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">set</span> timing <span class="token keyword">on</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> sys<span class="token punctuation">.</span>aud$<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>（2）查看 Audit 审计表中记录的最早的时间</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>ntimestamp<span class="token comment">#) from sys.aud$;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>（3）查看审计数据最后归档时间，只有归档的数据才能删除</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> dba_audit_mgmt_last_arch_ts<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>（4）初始化清理Audit的功能，default_cleanup_interval =&gt;168代表清理周期为168(24*7)小时（只需执行一次）。</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
    dbms_audit_mgmt<span class="token punctuation">.</span>init_cleanup<span class="token punctuation">(</span>
        audit_trail_type <span class="token operator">=</span><span class="token operator">&gt;</span> dbms_audit_mgmt<span class="token punctuation">.</span>audit_trail_db_std<span class="token punctuation">,</span>
        default_cleanup_interval <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">24</span><span class="token operator">*</span><span class="token number">7</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>参数说明：</em></p><ul><li>AUDIT_TRAIL_TYPE <ul><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_AUD_STD: 标准审计, AUD$；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_FGA_STD: FGA审计, FGA_LOG$；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_DB_STD: 标准审计+FGA；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_OS: 系统审计文件（.aud）；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_XML: XML格式系统审计文件；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_FILES: 系统审计文件+XML格式系统审计文件；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_ALL: 所有审计记录,数据库+系统。</li></ul></li></ul><p>（5）设置需要清理的天数，最后一个数字<code>30</code>代表清理 30 天前的数据（归档时间大于等于清除时间）</p><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-1121-0" aria-selected="true">11g</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-1121-1" aria-selected="false">12c</button></div><!--[--><div class="vp-code-tab active" id="codetab-1121-0" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">11g</div><!--[--><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
    dbms_audit_mgmt<span class="token punctuation">.</span>set_last_archive_timestamp<span class="token punctuation">(</span>
        audit_trail_type <span class="token operator">=</span><span class="token operator">&gt;</span> dbms_audit_mgmt<span class="token punctuation">.</span>audit_trail_aud_std<span class="token punctuation">,</span>
        last_archive_time <span class="token operator">=</span><span class="token operator">&gt;</span> systimestamp <span class="token operator">-</span> <span class="token number">30</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-1121-1" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">12c</div><!--[--><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
    DBMS_AUDIT_MGMT<span class="token punctuation">.</span>SET_LAST_ARCHIVE_TIMESTAMP<span class="token punctuation">(</span>
    AUDIT_TRAIL_TYPE     <span class="token operator">=</span><span class="token operator">&gt;</span>  DBMS_AUDIT_MGMT<span class="token punctuation">.</span>AUDIT_TRAIL_UNIFIED<span class="token punctuation">,</span>
    LAST_ARCHIVE_TIME    <span class="token operator">=</span><span class="token operator">&gt;</span>  systimestamp <span class="token operator">-</span> <span class="token number">30</span><span class="token punctuation">,</span>
    RAC_INSTANCE_NUMBER  <span class="token operator">=</span><span class="token operator">&gt;</span>  <span class="token number">1</span><span class="token punctuation">,</span>
    CONTAINER            <span class="token operator">=</span><span class="token operator">&gt;</span> DBMS_AUDIT_MGMT<span class="token punctuation">.</span>CONTAINER_CURRENT<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p><em>参数说明：</em></p><ul><li>AUDIT_TRAIL_TYPE <ul><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_UNIFIED，设置统一audit trail（12c+）；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_AUD_STD：用于传统标准审计文件表<code>AUD$</code>；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_FGA_STD：用于传统 fine-grained 审计文件表<code>FGA_LOG$</code>；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_OS：用于传统操作系统审计文件<code>.aud</code>；</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_XML：用于传统操作系统 xml 审计文件。</li></ul></li><li>AUDIT_TRAIL_PURGE_INTERVAL：执行清理 Job 的间隔时间（单位：小时）；</li><li>LAST_ARCHIVE_TIME 设置审计文件的时间戳格式（UTC）： YYYY-MM-DD HH:MI:SS.FF；</li><li>RAC_INSTANCE_NUMBER 指定 Oracle RAC 实例节点；</li><li>CONTAINER用于多租环境 <ul><li>DBMS_AUDIT_MGMT.CONTAINER_CURRENT：当前 PDB，只能在当前 PDB 中执行；</li><li>DBMS_AUDIT_MGMT.CONTAINER_ALL：所有 PDB，只能在 root 容器中执行。</li></ul></li></ul><p>（6）手动清理审计日志</p><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-1201-0" aria-selected="true">11g-</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-1201-1" aria-selected="false">12c+</button></div><!--[--><div class="vp-code-tab active" id="codetab-1201-0" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">11g-</div><!--[--><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
  DBMS_AUDIT_MGMT<span class="token punctuation">.</span>CLEAN_AUDIT_TRAIL<span class="token punctuation">(</span>
   AUDIT_TRAIL_TYPE           <span class="token operator">=</span><span class="token operator">&gt;</span>  DBMS_AUDIT_MGMT<span class="token punctuation">.</span>AUDIT_TRAIL_AUD_STD<span class="token punctuation">,</span>
   USE_LAST_ARCH_TIMESTAMP    <span class="token operator">=</span><span class="token operator">&gt;</span>  <span class="token boolean">TRUE</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-1201-1" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">12c+</div><!--[--><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
  DBMS_AUDIT_MGMT<span class="token punctuation">.</span>CLEAN_AUDIT_TRAIL<span class="token punctuation">(</span>
   AUDIT_TRAIL_TYPE           <span class="token operator">=</span><span class="token operator">&gt;</span>  DBMS_AUDIT_MGMT<span class="token punctuation">.</span>AUDIT_TRAIL_AUD_STD<span class="token punctuation">,</span>
   USE_LAST_ARCH_TIMESTAMP    <span class="token operator">=</span><span class="token operator">&gt;</span>  <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
   CONTAINER                  <span class="token operator">=</span><span class="token operator">&gt;</span>  DBMS_AUDIT_MGMT<span class="token punctuation">.</span>CONTAINER_CURRENT <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>（7）清理 Archive Timestamp 设置</p><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-1212-0" aria-selected="true">11g-</button></div><!--[--><div class="vp-code-tab active" id="codetab-1212-0" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">11g-</div><!--[--><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
  DBMS_AUDIT_MGMT<span class="token punctuation">.</span>CLEAR_LAST_ARCHIVE_TIMESTAMP<span class="token punctuation">(</span>
   AUDIT_TRAIL_TYPE     <span class="token operator">=</span><span class="token operator">&gt;</span>  DBMS_AUDIT_MGMT<span class="token punctuation">.</span>AUDIT_TRAIL_AUD_STD<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><h3 id="直接清理" tabindex="-1"><a class="header-anchor" href="#直接清理"><span>直接清理</span></a></h3><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token comment">-- 1. Initialize the AUD$ table for cleanup:</span>
<span class="token keyword">PROCEDURE</span> CleanUpAuditTrailMain<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
  <span class="token comment">-- Connect to the database using appropriate login.</span>
  <span class="token keyword">CALL</span> ConnectToDatabase<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">-- The login used must have privileges to modify Audit settings. </span>
  <span class="token comment">-- Currently, the DBA will be the authorized user</span>

  DBMS_AUDIT_MGMT<span class="token punctuation">.</span>INIT_CLEANUP<span class="token punctuation">(</span>
   AUDIT_TRAIL_TYPE           <span class="token operator">=</span><span class="token operator">&gt;</span> DBMS_AUDIT_MGMT<span class="token punctuation">.</span>AUDIT_TRAIL_AUD_STD<span class="token punctuation">,</span>
   DEFAULT_CLEANUP_INTERVAL   <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">12</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span> <span class="token comment">/*PROCEDURE */</span>
<span class="token operator">/</span>
<span class="token comment">-- 2. Optionally, set the batch size:</span>
<span class="token keyword">BEGIN</span>
  DBMS_AUDIT_MGMT<span class="token punctuation">.</span>SET_AUDIT_TRAIL_PROPERTY<span class="token punctuation">(</span>
   AUDIT_TRAIL_TYPE           <span class="token operator">=</span><span class="token operator">&gt;</span> DBMS_AUDIT_MGMT<span class="token punctuation">.</span>AUDIT_TRAIL_AUD_STD<span class="token punctuation">,</span>
   AUDIT_TRAIL_PROPERTY       <span class="token operator">=</span><span class="token operator">&gt;</span> DBMS_AUDIT_MGMT<span class="token punctuation">.</span>DB_DELETE_BATCH_SIZE<span class="token punctuation">,</span>
   AUDIT_TRAIL_PROPERTY_VALUE <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">100000</span> <span class="token comment">/* delete batch size */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span> <span class="token comment">/*PROCEDURE */</span>
<span class="token operator">/</span>
<span class="token comment">-- 3. Set the last archive timestamp:</span>
<span class="token keyword">PROCEDURE</span> SetCleanUpAuditTrail<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
  <span class="token keyword">CALL</span> FindLastArchivedTimestamp<span class="token punctuation">(</span>AUD$<span class="token punctuation">)</span><span class="token punctuation">;</span>
  DBMS_AUDIT_MGMT<span class="token punctuation">.</span>SET_LAST_ARCHIVE_TIMESTAMP<span class="token punctuation">(</span>
   AUDIT_TRAIL_TYPE          <span class="token operator">=</span><span class="token operator">&gt;</span> DBMS_AUDIT_MGMT<span class="token punctuation">.</span>AUDIT_TRAIL_AUD_STD<span class="token punctuation">,</span>
   LAST_ARCHIVE_TIME         <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;20-AUG-2009 00:00:00&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span> <span class="token comment">/* PROCEDURE */</span>
<span class="token operator">/</span>
<span class="token comment">-- 4. Run a customized archive procedure to purge the audit trail records:</span>
<span class="token keyword">BEGIN</span>
  <span class="token keyword">CALL</span> MakeAuditSettings<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">LOOP</span> <span class="token punctuation">(</span><span class="token comment">/* How long to loop*/</span><span class="token punctuation">)</span>
    <span class="token comment">-- Invoke function for audit record archival</span>
    <span class="token keyword">CALL</span> DoAuditRecordArchival<span class="token punctuation">(</span>AUD$<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
    <span class="token keyword">CALL</span> SetCleanUpAuditTrail<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token comment">/* Clean up is needed immediately */</span><span class="token punctuation">)</span>
      DBMS_AUDIT_MGMT<span class="token punctuation">.</span>CLEAN_AUDIT_TRAIL<span class="token punctuation">(</span>
       AUDIT_TRAIL_TYPE        <span class="token operator">=</span><span class="token operator">&gt;</span> DBMS_AUDIT_MGMT<span class="token punctuation">.</span>AUDIT_TRAIL_AUD_STD<span class="token punctuation">,</span>
       USE_LAST_ARCH_TIMESTAMP <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">END</span> <span class="token keyword">IF</span>
  <span class="token keyword">END</span> <span class="token keyword">LOOP</span> <span class="token comment">/*LOOP*/</span>
<span class="token keyword">END</span><span class="token punctuation">;</span> <span class="token comment">/* PROCEDURE */</span> 
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="自定义清理" tabindex="-1"><a class="header-anchor" href="#自定义清理"><span>自定义清理</span></a></h3><p>（1）创建存储过程：</p><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-1231-0" aria-selected="true">truncate</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-1231-1" aria-selected="false">delete</button></div><!--[--><div class="vp-code-tab active" id="codetab-1231-0" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">truncate</div><!--[--><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token operator">or</span> <span class="token keyword">replace</span> <span class="token keyword">procedure</span> sp_trunc_aud_log <span class="token operator">is</span>
<span class="token keyword">begin</span>
    <span class="token keyword">execute</span> immediate <span class="token string">&#39;truncate table sys.aud$&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-1231-1" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">delete</div><!--[--><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token operator">or</span> <span class="token keyword">replace</span> <span class="token keyword">procedure</span> purge_aud_trail <span class="token punctuation">(</span>days <span class="token operator">in</span> number<span class="token punctuation">)</span> <span class="token keyword">as</span>
    purge_date <span class="token keyword">date</span><span class="token punctuation">;</span>
<span class="token keyword">begin</span>
    purge_date :<span class="token operator">=</span> trunc<span class="token punctuation">(</span>sysdate<span class="token operator">-</span>days<span class="token punctuation">)</span><span class="token punctuation">;</span>
    dbms_system<span class="token punctuation">.</span>ksdwrt<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">&#39;AUDIT: Purging Audit Trail until &#39;</span> <span class="token operator">||</span>
    purge_date <span class="token operator">||</span> <span class="token string">&#39; started&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">delete</span> <span class="token keyword">from</span> aud$ <span class="token keyword">where</span> ntimestamp<span class="token comment"># &lt; purge_date;</span>
    <span class="token keyword">commit</span><span class="token punctuation">;</span>
    dbms_system<span class="token punctuation">.</span>ksdwrt<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">&#39;AUDIT: Purging Audit Trail until &#39;</span> <span class="token operator">||</span>
    purge_date <span class="token operator">||</span> <span class="token string">&#39; has completed&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>（2）创建自动调度 job</p><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-1242-0" aria-selected="true">truncate</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-1242-1" aria-selected="false">delete</button></div><!--[--><div class="vp-code-tab active" id="codetab-1242-0" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">truncate</div><!--[--><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
    DBMS_SCHEDULER<span class="token punctuation">.</span>CREATE_JOB
    <span class="token punctuation">(</span>
    job_name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;day_trunc_aud_log&#39;</span><span class="token punctuation">,</span>
    job_type <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;STORED_PROCEDURE&#39;</span><span class="token punctuation">,</span>
    job_action <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;SP_TRUNC_AUD_LOG&#39;</span><span class="token punctuation">,</span>
    start_date <span class="token operator">=</span><span class="token operator">&gt;</span> sysdate<span class="token punctuation">,</span>
    repeat_interval <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;FREQ=DAILY; BYHOUR=03; BYMINUTE=30;INTERVAL=1&#39;</span><span class="token punctuation">,</span>
    enabled <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    comments <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;truncate table aud$ every day&#39;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-1242-1" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">delete</div><!--[--><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
    sys<span class="token punctuation">.</span>dbms_scheduler<span class="token punctuation">.</span>create_job<span class="token punctuation">(</span>
    job_name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;AUDIT_PURGE&#39;</span><span class="token punctuation">,</span>
    job_type <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;PLSQL_BLOCK&#39;</span><span class="token punctuation">,</span>
    job_action <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;begin purge_aud_trail(31); end;&#39;</span><span class="token punctuation">,</span>
    schedule_name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;MAINTENANCE_WINDOW_GROUP&#39;</span><span class="token punctuation">,</span>
    job_class <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;&quot;DEFAULT_JOB_CLASS&quot;&#39;</span><span class="token punctuation">,</span>
    comments <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;Audit Trail Purge&#39;</span><span class="token punctuation">,</span>
    auto_drop <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
    enabled <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><h3 id="删除系统中审计文件" tabindex="-1"><a class="header-anchor" href="#删除系统中审计文件"><span>删除系统中审计文件</span></a></h3><p>删除30天前的审计文件</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">find</span> <span class="token variable">$ORACLE_BASE</span>/admin/<span class="token variable">$ORACLE_SID</span>/adump/ <span class="token parameter variable">-t</span> f <span class="token parameter variable">-name</span> <span class="token string">&#39;*.aud&#39;</span> <span class="token parameter variable">-mtime</span> +30 <span class="token parameter variable">-exec</span> <span class="token function">rm</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">\</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="空间回收" tabindex="-1"><a class="header-anchor" href="#空间回收"><span>空间回收</span></a></h3><p>在清理<code>sys.aud$</code> 表后,表占用的空间的大小并没有发生改变，需要收回空间。（在上面清理表 <code>sys.aud$</code> 后，实际上，数据还在磁盘上，只是数据不受保护了而已，其空间并没有释放，需要将其释放回收）</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">select</span> segment_name<span class="token punctuation">,</span>bytes<span class="token operator">/</span><span class="token number">1024</span><span class="token operator">/</span><span class="token number">1024</span> <span class="token keyword">from</span> dba_segments <span class="token keyword">where</span> segment_name<span class="token operator">=</span><span class="token string">&#39;AUD$&#39;</span>
<span class="token comment">--激活行移动 Table altered.</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> sys<span class="token punctuation">.</span>aud$ <span class="token keyword">enable</span> <span class="token keyword">row</span> movement<span class="token punctuation">;</span>
<span class="token comment">--进行空间回收 Table altered.</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> sys<span class="token punctuation">.</span>aud$ shrink space <span class="token keyword">cascade</span><span class="token punctuation">;</span>
<span class="token comment">--关闭行移动 Table altered.</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> sys<span class="token punctuation">.</span>aud$ <span class="token keyword">disable</span> <span class="token keyword">row</span> movement<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="审计表空间" tabindex="-1"><a class="header-anchor" href="#审计表空间"><span>审计表空间</span></a></h2><p>（1）创建表空间</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLESPACE</span> audtbs
    DATAFILE <span class="token string">&#39;&lt;oracle data path&gt;/aud01.dbf&#39;</span> SIZE <span class="token number">2</span>G
    AUTOEXTEND <span class="token keyword">ON</span> <span class="token keyword">NEXT</span> <span class="token number">8192</span> MAXSIZE UNLIMITED<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（2）查看<code>AUD$</code>,<code>FGA_LOG$</code>表所在表空间</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    table_name<span class="token punctuation">,</span>
    tablespace_name
<span class="token keyword">FROM</span>
    dba_tables
<span class="token keyword">WHERE</span>
    table_name <span class="token operator">IN</span> <span class="token punctuation">(</span> <span class="token string">&#39;AUD$&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;FGA_LOG$&#39;</span> <span class="token punctuation">)</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
    table_name<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（3）移动表空间</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
    dbms_audit_mgmt<span class="token punctuation">.</span>set_audit_trail_location<span class="token punctuation">(</span>
        audit_trail_type <span class="token operator">=</span><span class="token operator">&gt;</span> dbms_audit_mgmt<span class="token punctuation">.</span>audit_trail_db_std<span class="token punctuation">,</span>
        audit_trail_location_value <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;AUDTBS&#39;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>参数说明：</em></p><ul><li><p>AUDIT_TRAIL_TYPE</p><ul><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_AUD_STD： 标准审计（AUD$）</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_FGA_STD： 细粒度审计（FGA_LOG$）</li><li>DBMS_AUDIT_MGMT.AUDIT_TRAIL_DB_STD： 标准+细粒度审计（AUD<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mi>F</mi><mi>G</mi><msub><mi>A</mi><mi>L</mi></msub><mi>O</mi><mi>G</mi></mrow><annotation encoding="application/x-tex">+FGA_LOG</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord">+</span><span class="mord mathnormal">FG</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">OG</span></span></span></span>）</li></ul></li><li><p>AUDIT_TRAIL_LOCATION_VALUE： 表空间</p></li></ul><h2 id="数据库审计最佳实践" tabindex="-1"><a class="header-anchor" href="#数据库审计最佳实践"><span>数据库审计最佳实践</span></a></h2><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token comment">-- 查看audit是否开启</span>
<span class="token keyword">show</span> parameter audit_trail<span class="token punctuation">;</span>
<span class="token comment">--开启审计 DB_EXTENDED： 把审计信息写入表并记录sql信息</span>
<span class="token keyword">alter</span> system <span class="token keyword">set</span> audit_trail<span class="token operator">=</span><span class="token string">&#39;DB_EXTENDED&#39;</span> scope<span class="token operator">=</span>both<span class="token punctuation">;</span>

<span class="token comment">-- 查看审计选项</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> DBA_STMT_AUDIT_OPTS<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> DBA_PRIV_AUDIT_OPTS<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> DBA_OBJ_AUDIT_OPTS<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> ALL_DEF_AUDIT_OPTS<span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> ysdba<span class="token punctuation">.</span>his_DBA_STMT_AUDIT_OPTS <span class="token keyword">as</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> DBA_STMT_AUDIT_OPTS<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> ysdba<span class="token punctuation">.</span>his_DBA_PRIV_AUDIT_OPTS <span class="token keyword">as</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> DBA_PRIV_AUDIT_OPTS<span class="token punctuation">;</span>


<span class="token comment">---------------------根据需要开启审计内容-----------------------------</span>
<span class="token comment">--- audit </span>
audit <span class="token keyword">all</span> statements <span class="token keyword">by</span> access<span class="token punctuation">;</span>
<span class="token comment">--audit select table by access;</span>
<span class="token comment">--audit select any table by access;</span>
<span class="token comment">--audit insert table by access;</span>
<span class="token comment">--audit insert any table by access;</span>
<span class="token comment">--audit update table by access;</span>
<span class="token comment">--audit update any table by access;</span>
<span class="token comment">--audit delete table by access;</span>
<span class="token comment">--audit delete any table by access;</span>

<span class="token comment">--- noaudit </span>
noaudit <span class="token keyword">all</span> statements<span class="token punctuation">;</span>
<span class="token comment">--noaudit select table;</span>
<span class="token comment">--noaudit select any table;</span>
<span class="token comment">--noaudit insert table;</span>
<span class="token comment">--noaudit insert any table;</span>
<span class="token comment">--noaudit update table;</span>
<span class="token comment">--noaudit update any table;</span>
<span class="token comment">--noaudit delete table;</span>
<span class="token comment">--noaudit delete any table;</span>
<span class="token comment">------------------</span>


<span class="token comment">--------审计记录查询-------------</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> DBA_AUDIT_OBJECT<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> sys<span class="token punctuation">.</span>aud$<span class="token punctuation">;</span>

<span class="token keyword">grant</span> <span class="token keyword">select</span> <span class="token keyword">on</span> sys<span class="token punctuation">.</span>DBA_AUDIT_OBJECT <span class="token keyword">to</span> ysdba <span class="token keyword">with</span> <span class="token keyword">grant</span> <span class="token keyword">option</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">view</span> ysdba<span class="token punctuation">.</span>abelit_auditlog <span class="token keyword">as</span> <span class="token keyword">select</span> os_username<span class="token punctuation">,</span>username<span class="token punctuation">,</span>userhost<span class="token punctuation">,</span>terminal<span class="token punctuation">,</span><span class="token keyword">timestamp</span><span class="token punctuation">,</span>owner<span class="token punctuation">,</span>obj_name<span class="token punctuation">,</span>action_name<span class="token punctuation">,</span>sql_text <span class="token keyword">from</span> sys<span class="token punctuation">.</span>DBA_AUDIT_OBJECT<span class="token punctuation">;</span>


<span class="token keyword">create</span> <span class="token keyword">user</span> p_auditlog_ro identified <span class="token keyword">by</span> <span class="token string">&quot;&lt;password&gt;&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> role pr_auditlog_ro<span class="token punctuation">;</span>
<span class="token keyword">grant</span> pr_auditlog_ro <span class="token keyword">to</span> p_auditlog_ro<span class="token punctuation">;</span>
<span class="token keyword">grant</span> resource<span class="token punctuation">,</span><span class="token keyword">connect</span> <span class="token keyword">to</span> pr_auditlog_ro<span class="token punctuation">;</span>
<span class="token keyword">grant</span> <span class="token keyword">select</span> <span class="token keyword">on</span> ysdba<span class="token punctuation">.</span>abelit_auditlog <span class="token keyword">to</span> pr_auditlog_ro <span class="token keyword">with</span> <span class="token keyword">grant</span> <span class="token keyword">option</span><span class="token punctuation">;</span>

<span class="token comment">--create view p_auditlog_ro.abelit_auditlog as select os_username,username,userhost,terminal,timestamp,owner,obj_name,action_name,sql_text from ysdba.abelit_auditlog;</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> ysdba<span class="token punctuation">.</span>abelit_auditlog<span class="token punctuation">;</span>


<span class="token comment">-- 样例信息</span>
<span class="token comment">-- 数据库地址： 120.24.235.132</span>
<span class="token comment">-- 数据库端口： 1521</span>
<span class="token comment">-- 数据库用户： p_auditlog_ro</span>
<span class="token comment">-- 数据库密码： &lt;password&gt;</span>
<span class="token comment">-- 实例名称： ynmtxdb1</span>
<span class="token comment">-- 查询语句： select * from ysdba.abelit_auditlog;</span>
<span class="token comment">-------------------------------</span>


<span class="token comment">----------审计日志保留策略-----------------</span>
<span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>ntimestamp<span class="token comment">#) from sys.aud$;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> dba_audit_mgmt_last_arch_ts

<span class="token comment">--- 验证是否初始化清理audit任务</span>
<span class="token keyword">SET</span> SERVEROUTPUT <span class="token keyword">ON</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">IF</span>
    DBMS_AUDIT_MGMT<span class="token punctuation">.</span>IS_CLEANUP_INITIALIZED<span class="token punctuation">(</span>DBMS_AUDIT_MGMT<span class="token punctuation">.</span>AUDIT_TRAIL_AUD_STD<span class="token punctuation">)</span>
    <span class="token keyword">THEN</span>
    DBMS_OUTPUT<span class="token punctuation">.</span>PUT_LINE<span class="token punctuation">(</span><span class="token string">&#39;AUD$ is initialized for cleanup&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">ELSE</span>
    DBMS_OUTPUT<span class="token punctuation">.</span>PUT_LINE<span class="token punctuation">(</span><span class="token string">&#39;AUD$ is not initialized for cleanup.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>

<span class="token comment">--- 初始化清理任务</span>
<span class="token keyword">BEGIN</span>
    dbms_audit_mgmt<span class="token punctuation">.</span>init_cleanup<span class="token punctuation">(</span>
        audit_trail_type <span class="token operator">=</span><span class="token operator">&gt;</span> dbms_audit_mgmt<span class="token punctuation">.</span>AUDIT_TRAIL_AUD_STD<span class="token punctuation">,</span>
        default_cleanup_interval <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">24</span><span class="token operator">*</span><span class="token number">1</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>

<span class="token comment">-- 设置需要清理的天数</span>
<span class="token keyword">BEGIN</span>
    dbms_audit_mgmt<span class="token punctuation">.</span>set_last_archive_timestamp<span class="token punctuation">(</span>
        audit_trail_type <span class="token operator">=</span><span class="token operator">&gt;</span> dbms_audit_mgmt<span class="token punctuation">.</span>audit_trail_aud_std<span class="token punctuation">,</span>
        last_archive_time <span class="token operator">=</span><span class="token operator">&gt;</span> systimestamp <span class="token operator">-</span> <span class="token number">7</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>

<span class="token comment">-- 创建 Job 调度程序</span>
<span class="token keyword">BEGIN</span>
    DBMS_AUDIT_MGMT<span class="token punctuation">.</span>CREATE_PURGE_JOB <span class="token punctuation">(</span>
    AUDIT_TRAIL_TYPE            <span class="token operator">=</span><span class="token operator">&gt;</span> DBMS_AUDIT_MGMT<span class="token punctuation">.</span>AUDIT_TRAIL_AUD_STD<span class="token punctuation">,</span>
    AUDIT_TRAIL_PURGE_INTERVAL  <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">12</span><span class="token punctuation">,</span>
    AUDIT_TRAIL_PURGE_NAME      <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;Audit_Trail_PJ&#39;</span><span class="token punctuation">,</span>
    USE_LAST_ARCH_TIMESTAMP     <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>

<span class="token comment">-- 启动 Job 调度程序</span>
<span class="token keyword">BEGIN</span>
    DBMS_AUDIT_MGMT<span class="token punctuation">.</span>SET_PURGE_JOB_STATUS<span class="token punctuation">(</span>
    AUDIT_TRAIL_PURGE_NAME      <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;Audit_Trail_PJ&#39;</span><span class="token punctuation">,</span>
    AUDIT_TRAIL_STATUS_VALUE    <span class="token operator">=</span><span class="token operator">&gt;</span> DBMS_AUDIT_MGMT<span class="token punctuation">.</span>PURGE_JOB_ENABLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>

<span class="token comment">--------------------------------</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!----><!--]--><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="vp-link vp-meta-label" href="https://github.com/abelit/abelit-datapeacock/edit/main/src/guide/database/oracle/audit.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">上次编辑于: </span><!----></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: ychenid@live.com">ableit</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link vp-link prev" href="/guide/database/oracle/error.html" aria-label="故障与错误"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->故障与错误</div></a><a class="route-link vp-link next" href="/guide/database/oracle/spaceobject.html" aria-label="数据库对象"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">数据库对象<!----></div></a></nav><!----><!--[--><!----><!--]--><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">MIT Licensed | Copyright © 2022-present Abelit</div><div class="vp-copyright">Copyright © 2024 Abelit </div></footer></div><!--]--><!--[--><!----><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-DR5J2daJ.js" defer></script>
  </body>
</html>
