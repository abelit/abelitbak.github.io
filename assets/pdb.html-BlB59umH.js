import{_ as o}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as d,o as c,c as i,b as r,w as n,f as l,d as s,a}from"./app-DR5J2daJ.js";const k={},u=l(`<h2 id="pdb启动" tabindex="-1"><a class="header-anchor" href="#pdb启动"><span>PDB启动</span></a></h2><h3 id="手动启动" tabindex="-1"><a class="header-anchor" href="#手动启动"><span>手动启动</span></a></h3><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> pluggable <span class="token keyword">database</span> <span class="token punctuation">[</span><span class="token keyword">all</span><span class="token operator">|</span>pdbname<span class="token punctuation">]</span> <span class="token keyword">open</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="自动启动" tabindex="-1"><a class="header-anchor" href="#自动启动"><span>自动启动</span></a></h3>`,4),b=a("div",{class:"language-sql line-numbers-mode","data-ext":"sql","data-title":"sql"},[a("pre",{class:"language-sql"},[a("code",null,[a("span",{class:"token keyword"},"alter"),s(" pluggable "),a("span",{class:"token keyword"},"database"),s(),a("span",{class:"token punctuation"},"["),a("span",{class:"token keyword"},"all"),a("span",{class:"token operator"},"|"),s("pdbname"),a("span",{class:"token punctuation"},"]"),s(),a("span",{class:"token keyword"},"open"),a("span",{class:"token punctuation"},";"),s(`
`),a("span",{class:"token keyword"},"alter"),s(" pluggable "),a("span",{class:"token keyword"},"database"),s(),a("span",{class:"token punctuation"},"["),a("span",{class:"token keyword"},"all"),a("span",{class:"token operator"},"|"),s("pdbname"),a("span",{class:"token punctuation"},"]"),s(),a("span",{class:"token keyword"},"save"),s(" state"),a("span",{class:"token punctuation"},";"),s(`
`)])]),a("div",{class:"line-numbers","aria-hidden":"true"},[a("div",{class:"line-number"}),a("div",{class:"line-number"})])],-1),m=a("div",{class:"language-sql line-numbers-mode","data-ext":"sql","data-title":"sql"},[a("pre",{class:"language-sql"},[a("code",null,[a("span",{class:"token keyword"},"create"),s(),a("span",{class:"token operator"},"or"),s(),a("span",{class:"token keyword"},"replace"),s(),a("span",{class:"token keyword"},"trigger"),s(` open_pdbs
`),a("span",{class:"token keyword"},"after"),s(" startup "),a("span",{class:"token keyword"},"on"),s(),a("span",{class:"token keyword"},"database"),s(`
`),a("span",{class:"token keyword"},"begin"),s(`
`),a("span",{class:"token keyword"},"execute"),s(" immediate "),a("span",{class:"token string"},"'alter pluggable database [all|pdbname] open'"),a("span",{class:"token punctuation"},";"),s(`
`),a("span",{class:"token keyword"},"end"),s(" open_pdbs"),a("span",{class:"token punctuation"},";"),s(`
`),a("span",{class:"token operator"},"/"),s(`
`)])]),a("div",{class:"line-numbers","aria-hidden":"true"},[a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"})])],-1),v=l(`<h2 id="创建pdb" tabindex="-1"><a class="header-anchor" href="#创建pdb"><span>创建PDB</span></a></h2><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">create</span> pluggable <span class="token keyword">database</span> backuppdb admin <span class="token keyword">user</span> pdbadmin identified <span class="token keyword">by</span> pdbadmin create_file_dest<span class="token operator">=</span><span class="token string">&#39;/data/app/oracle/oradata/YSOEMCDB/backuppdb&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="pdb字符集" tabindex="-1"><a class="header-anchor" href="#pdb字符集"><span>PDB字符集</span></a></h2><p>Oracle 19c上cdb支持不同字符集pdb得特性。</p><ul><li>查看CDB字符集</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">select</span> userenv<span class="token punctuation">(</span><span class="token string">&#39;language&#39;</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>创建pdb目录</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token operator">!</span>mkdir <span class="token operator">-</span>p <span class="token operator">/</span><span class="token keyword">data</span><span class="token operator">/</span>app<span class="token operator">/</span>oracle<span class="token operator">/</span>oradata<span class="token operator">/</span>YSOEMCDB<span class="token operator">/</span>backuppdb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>创建PDB</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">session</span> <span class="token keyword">set</span> container<span class="token operator">=</span>cdb$root<span class="token punctuation">;</span>
<span class="token keyword">create</span> pluggable <span class="token keyword">database</span> backuppdb admin <span class="token keyword">user</span> pdbadmin identified <span class="token keyword">by</span> pdbadmin create_file_dest<span class="token operator">=</span><span class="token string">&#39;/data/app/oracle/oradata/YSOEMCDB/backuppdb&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>查看pdb字符集</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> pluggable <span class="token keyword">database</span> backuppdb <span class="token keyword">open</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">session</span> <span class="token keyword">set</span> container<span class="token operator">=</span>backuppdb<span class="token punctuation">;</span>
<span class="token keyword">select</span> userenv<span class="token punctuation">(</span><span class="token string">&#39;language&#39;</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>更改pdb字符集</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">select</span> userenv<span class="token punctuation">(</span><span class="token string">&#39;language&#39;</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>
<span class="token keyword">alter</span> pluggable <span class="token keyword">database</span> backuppdb <span class="token keyword">close</span> immediate<span class="token punctuation">;</span>
<span class="token keyword">alter</span> pluggable <span class="token keyword">database</span> backuppdb <span class="token keyword">open</span> <span class="token keyword">read</span> <span class="token keyword">write</span> restricted<span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">session</span> <span class="token keyword">set</span> container<span class="token operator">=</span>backuppdb<span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">database</span> <span class="token keyword">character</span> <span class="token keyword">set</span> internal_use zhs16gbk<span class="token punctuation">;</span>
<span class="token keyword">alter</span> pluggable <span class="token keyword">database</span> backuppdb <span class="token keyword">close</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> pluggable <span class="token keyword">database</span> backuppdb <span class="token keyword">open</span><span class="token punctuation">;</span>
 <span class="token keyword">select</span> userenv<span class="token punctuation">(</span><span class="token string">&#39;language&#39;</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="pdb重命名" tabindex="-1"><a class="header-anchor" href="#pdb重命名"><span>PDB重命名</span></a></h2><p>在生产环境中，可能会遇到如下需求，原来的pdb需要改名，正常情况下我们首先会想到的是克隆或者重建pdb处理；但在oracle下还有另外的修改方式，就是改名，具体操作如下：</p><ol><li>启动pdb到受限制模式(在pdb里面操作)</li></ol><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">session</span> <span class="token keyword">set</span> container<span class="token operator">=</span>pdb<span class="token punctuation">;</span>
<span class="token keyword">alter</span> pluggable <span class="token keyword">database</span> pdb <span class="token keyword">close</span> immediate<span class="token punctuation">;</span>
<span class="token keyword">alter</span> pluggable <span class="token keyword">database</span> pdb <span class="token keyword">open</span> restricted<span class="token punctuation">;</span>
<span class="token comment">--或者</span>
<span class="token keyword">shutdown</span> immediate
startup <span class="token keyword">open</span> <span class="token keyword">restrict</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>进入pdb里面对pdb进行初始化</li></ol><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">session</span> <span class="token keyword">set</span> container<span class="token operator">=</span>pdb<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> global_name<span class="token punctuation">;</span>
<span class="token keyword">alter</span> pluggable <span class="token keyword">database</span> pdb <span class="token keyword">rename</span> global_name <span class="token keyword">to</span> pdb1<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>正常关闭和启动pdb</li></ol><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> pluggable <span class="token keyword">database</span> <span class="token keyword">close</span> immediate<span class="token punctuation">;</span>
<span class="token keyword">alter</span> pluggable <span class="token keyword">database</span> <span class="token keyword">open</span><span class="token punctuation">;</span>
<span class="token comment">--或者</span>
<span class="token keyword">shutdown</span> immediate
startup <span class="token keyword">open</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container warning"><p class="hint-container-title">注意事项</p><p>1、必须进入目标PDB中才可以对其进行重命名，否则报错“ORA-65046: operation not allowed from outside a pluggable database”。</p><p>2、在修改完成后，监听里的service_name已经自动被修改了。所以，如果配置了相关的tnsnames.ora文件，那么就需要同时手工去修改该文件。</p></div>`,23);function g(y,w){const p=d("CodeTabs");return c(),i("div",null,[u,r(p,{id:"10",data:[{id:"Oracle自动方式"},{id:"触发器方式"}],active:0},{title0:n(({value:e,isActive:t})=>[s("Oracle自动方式")]),title1:n(({value:e,isActive:t})=>[s("触发器方式")]),tab0:n(({value:e,isActive:t})=>[b]),tab1:n(({value:e,isActive:t})=>[m]),_:1}),v])}const _=o(k,[["render",g],["__file","pdb.html.vue"]]),B=JSON.parse('{"path":"/guide/database/oracle/pdb.html","title":"PDB","lang":"zh-CN","frontmatter":{"title":"PDB","description":"PDB启动 手动启动 自动启动 创建PDB PDB字符集 Oracle 19c上cdb支持不同字符集pdb得特性。 查看CDB字符集 创建pdb目录 创建PDB 查看pdb字符集 更改pdb字符集 PDB重命名 在生产环境中，可能会遇到如下需求，原来的pdb需要改名，正常情况下我们首先会想到的是克隆或者重建pdb处理；但在oracle下还有另外的修改方...","head":[["meta",{"property":"og:url","content":"https://github.com/abelit/abelit-datapeacock.git/guide/database/oracle/pdb.html"}],["meta",{"property":"og:site_name","content":"数之雀"}],["meta",{"property":"og:title","content":"PDB"}],["meta",{"property":"og:description","content":"PDB启动 手动启动 自动启动 创建PDB PDB字符集 Oracle 19c上cdb支持不同字符集pdb得特性。 查看CDB字符集 创建pdb目录 创建PDB 查看pdb字符集 更改pdb字符集 PDB重命名 在生产环境中，可能会遇到如下需求，原来的pdb需要改名，正常情况下我们首先会想到的是克隆或者重建pdb处理；但在oracle下还有另外的修改方..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-11T14:06:18.000Z"}],["meta",{"property":"article:author","content":"Abelit"}],["meta",{"property":"article:modified_time","content":"2024-05-11T14:06:18.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"PDB\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-05-11T14:06:18.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Abelit\\",\\"url\\":\\"https://github.com/abelit\\"}]}"]]},"headers":[{"level":2,"title":"PDB启动","slug":"pdb启动","link":"#pdb启动","children":[{"level":3,"title":"手动启动","slug":"手动启动","link":"#手动启动","children":[]},{"level":3,"title":"自动启动","slug":"自动启动","link":"#自动启动","children":[]}]},{"level":2,"title":"创建PDB","slug":"创建pdb","link":"#创建pdb","children":[]},{"level":2,"title":"PDB字符集","slug":"pdb字符集","link":"#pdb字符集","children":[]},{"level":2,"title":"PDB重命名","slug":"pdb重命名","link":"#pdb重命名","children":[]}],"git":{"createdTime":1715436378000,"updatedTime":1715436378000,"contributors":[{"name":"ableit","email":"ychenid@live.com","commits":1}]},"readingTime":{"minutes":1.59,"words":478},"filePathRelative":"guide/database/oracle/pdb.md","localizedDate":"2024年5月11日","autoDesc":true,"excerpt":"<h2>PDB启动</h2>\\n<h3>手动启动</h3>\\n<div class=\\"language-sql\\" data-ext=\\"sql\\" data-title=\\"sql\\"><pre class=\\"language-sql\\"><code><span class=\\"token keyword\\">alter</span> pluggable <span class=\\"token keyword\\">database</span> <span class=\\"token punctuation\\">[</span><span class=\\"token keyword\\">all</span><span class=\\"token operator\\">|</span>pdbname<span class=\\"token punctuation\\">]</span> <span class=\\"token keyword\\">open</span><span class=\\"token punctuation\\">;</span>\\n</code></pre></div>"}');export{_ as comp,B as data};
