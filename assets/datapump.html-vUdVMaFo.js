import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as s,c as n,f as e}from"./app-DR5J2daJ.js";const t={},p=e(`<h2 id="数据泵" tabindex="-1"><a class="header-anchor" href="#数据泵"><span>数据泵</span></a></h2><h3 id="备份表" tabindex="-1"><a class="header-anchor" href="#备份表"><span>备份表</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>expdp <span class="token punctuation">\\</span>&#39;<span class="token punctuation">\\</span>/ as sysdba<span class="token punctuation">\\</span>&#39; <span class="token assign-left variable">directory</span><span class="token operator">=</span>ysbackup <span class="token assign-left variable">dumpfile</span><span class="token operator">=</span>ds_user.doc_ordheaderdetail20230116.%U.dmp <span class="token assign-left variable">logfile</span><span class="token operator">=</span>expdp_ds_user.table20230116.log <span class="token assign-left variable">tables</span><span class="token operator">=</span>DS_USER.DOC_ORDER_HEADER_20230109,DS_USER.DOC_ORDER_DETAILS_20230109 <span class="token assign-left variable">parallel</span><span class="token operator">=</span><span class="token number">2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="备份脚本" tabindex="-1"><a class="header-anchor" href="#备份脚本"><span>备份脚本</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment"># Function: Backup database by data pump</span>
<span class="token comment"># Usage: crontab on linux/Unix, ie.# 0 0 * * * sh -c &#39;/home/oracle/dba/scripts/ora_export.sh&#39; &gt;&gt; /home/oracle/dba/log/scripts.log 2&gt;&amp;1</span>
<span class="token comment"># Last modfiy: 2023-04-24</span>
<span class="token comment"># Author: abelit</span>

<span class="token comment">##################### start user conf #############</span>
<span class="token comment"># Set oracle environment</span>
<span class="token builtin class-name">source</span> /home/oracle/.bash_profile
<span class="token comment"># ORACLE_HOME=/u01/app/oracle/product/11.2.0/db_1</span>
<span class="token comment"># ORACLE_SID=testdb</span>

<span class="token assign-left variable">DBA_LOGPATH</span><span class="token operator">=</span>/home/oracle/dba/log
<span class="token assign-left variable">DBA_SCRIPTPATH</span><span class="token operator">=</span>/home/oracle/dba/scripts

<span class="token assign-left variable">BACKUP_SAVE_DAYS</span><span class="token operator">=</span><span class="token number">15</span>
<span class="token comment">#################### end user conf ################</span>

<span class="token comment">##################### start auto preparing ##############</span>
<span class="token comment"># TODAY</span>
<span class="token assign-left variable">RUNNING_TIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> <span class="token string">&quot;+%Y%m%d%H&quot;</span><span class="token variable">)</span></span>
<span class="token assign-left variable">EXPORT_DBNAME</span><span class="token operator">=</span>ynmtx

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-d</span> <span class="token string">&quot;<span class="token variable">$DBA_LOGPATH</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">$DBA_LOGPATH</span>&quot;</span>
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-d</span> <span class="token string">&quot;<span class="token variable">$DBA_SCRIPTPATH</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">$DBA_SCRIPTPATH</span>&quot;</span>
<span class="token keyword">fi</span>
<span class="token comment">##################### end auto preparing ##############</span>

<span class="token comment"># expdp ysdba@backuppdb directory=ysbackup dumpfile=expdp_\${EXPORT_DBNAME}20230423001_%U.dmp logfile=expdp_\${EXPORT_DBNAME}20230423001.log full=y parallel=2 network_link=link_\${EXPORT_DBNAME} compression=all</span>
<span class="token comment"># expdp ysdba directory=ysbackup dumpfile=YS3048_20221129_%U.dmp logfile=YS3048_20221129_expdp.log schemas=YS3048 parallel=2</span>
<span class="token comment"># impdp ysdba directory=ysbackup dumpfile=YS3048_20221129_%U.dmp logfile=YS3048_20221129_impdp.log  remap_schema=ys3048:ys3048cw parallel=2 table_exists_action=skip transform=oid:n</span>
<span class="token keyword">function</span> <span class="token function-name function">expdpFullDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$ORACLE_HOME</span>/bin/expdp ysdba/password@backuppdb <span class="token assign-left variable">directory</span><span class="token operator">=</span>ysbackup <span class="token assign-left variable">dumpfile</span><span class="token operator">=</span>expdp_<span class="token variable">\${EXPORT_DBNAME}</span>_<span class="token variable">\${RUNNING_TIME}</span>_%U.dmp <span class="token assign-left variable">logfile</span><span class="token operator">=</span>expdp_<span class="token variable">\${EXPORT_DBNAME}</span>_<span class="token variable">\${RUNNING_TIME}</span>.log <span class="token assign-left variable">full</span><span class="token operator">=</span>y <span class="token assign-left variable">parallel</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">network_link</span><span class="token operator">=</span>link_<span class="token variable">\${EXPORT_DBNAME}</span> <span class="token assign-left variable">compression</span><span class="token operator">=</span>all
<span class="token punctuation">}</span>

expdpFullDatabase
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5),l=[p];function o(i,c){return s(),n("div",null,l)}const u=a(t,[["render",o],["__file","datapump.html.vue"]]),m=JSON.parse(`{"path":"/guide/database/oracle/backuprecovery/datapump.html","title":"逻辑备份","lang":"zh-CN","frontmatter":{"title":"逻辑备份","description":"数据泵 备份表 备份脚本","head":[["meta",{"property":"og:url","content":"https://github.com/abelit/abelit-datapeacock.git/guide/database/oracle/backuprecovery/datapump.html"}],["meta",{"property":"og:site_name","content":"数之雀"}],["meta",{"property":"og:title","content":"逻辑备份"}],["meta",{"property":"og:description","content":"数据泵 备份表 备份脚本"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-11T14:06:18.000Z"}],["meta",{"property":"article:author","content":"Abelit"}],["meta",{"property":"article:modified_time","content":"2024-05-11T14:06:18.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"逻辑备份\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-05-11T14:06:18.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Abelit\\",\\"url\\":\\"https://github.com/abelit\\"}]}"]]},"headers":[{"level":2,"title":"数据泵","slug":"数据泵","link":"#数据泵","children":[{"level":3,"title":"备份表","slug":"备份表","link":"#备份表","children":[]},{"level":3,"title":"备份脚本","slug":"备份脚本","link":"#备份脚本","children":[]}]}],"git":{"createdTime":1715436378000,"updatedTime":1715436378000,"contributors":[{"name":"ableit","email":"ychenid@live.com","commits":1}]},"readingTime":{"minutes":0.65,"words":195},"filePathRelative":"guide/database/oracle/backuprecovery/datapump.md","localizedDate":"2024年5月11日","autoDesc":true,"excerpt":"<h2>数据泵</h2>\\n<h3>备份表</h3>\\n<div class=\\"language-bash\\" data-ext=\\"sh\\" data-title=\\"sh\\"><pre class=\\"language-bash\\"><code>expdp <span class=\\"token punctuation\\">\\\\</span>'<span class=\\"token punctuation\\">\\\\</span>/ as sysdba<span class=\\"token punctuation\\">\\\\</span>' <span class=\\"token assign-left variable\\">directory</span><span class=\\"token operator\\">=</span>ysbackup <span class=\\"token assign-left variable\\">dumpfile</span><span class=\\"token operator\\">=</span>ds_user.doc_ordheaderdetail20230116.%U.dmp <span class=\\"token assign-left variable\\">logfile</span><span class=\\"token operator\\">=</span>expdp_ds_user.table20230116.log <span class=\\"token assign-left variable\\">tables</span><span class=\\"token operator\\">=</span>DS_USER.DOC_ORDER_HEADER_20230109,DS_USER.DOC_ORDER_DETAILS_20230109 <span class=\\"token assign-left variable\\">parallel</span><span class=\\"token operator\\">=</span><span class=\\"token number\\">2</span>\\n</code></pre></div>"}`);export{u as comp,m as data};
