import{_ as l}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r,o as i,c,b as u,w as a,f as p,d as n,a as s}from"./app-DR5J2daJ.js";const d="/assets/mysql_ha_solutions_002-UaoGRYef.png",k={},v=p('<h2 id="mysql-innodb-cluster" tabindex="-1"><a class="header-anchor" href="#mysql-innodb-cluster"><span>MySQL InnoDB Cluster</span></a></h2><h3 id="组件说明" tabindex="-1"><a class="header-anchor" href="#组件说明"><span>组件说明</span></a></h3><p>MySQL InnoDB 集群由 3 个组件组成：</p><ul><li>MySQL组复制（一组数据库服务器，它们以容错能力相互复制）;</li><li>MySQL 路由器（查询路由器到正常数据库节点）;</li><li>MySQL Shell（帮助程序，客户端，配置工具）。</li></ul><h3 id="主机信息" tabindex="-1"><a class="header-anchor" href="#主机信息"><span>主机信息</span></a></h3><table><thead><tr><th>编号</th><th>IP 地址</th><th>角色</th><th>操作系统</th><th>内核版本</th><th>软件及版本</th></tr></thead><tbody><tr><td>1</td><td>10.10.12.211</td><td>router</td><td>CentOS 7.9</td><td>3.10.0-1160.el7.x86_64</td><td>MySQL Router 8.0.34</td></tr><tr><td>2</td><td>10.10.12.212</td><td>mysql主</td><td>CentOS 7.9</td><td>3.10.0-1160.el7.x86_64</td><td>MySQL 8.0.34, MySQL Shell 8.0.34</td></tr><tr><td>3</td><td>10.10.12.213</td><td>mysql从</td><td>CentOS 7.9</td><td>3.10.0-1160.el7.x86_64</td><td>MySQL 8.0.34, MySQL Shell 8.0.34</td></tr><tr><td>4</td><td>10.10.12.214</td><td>mysql从</td><td>CentOS 7.9</td><td>3.10.0-1160.el7.x86_64</td><td>MySQL 8.0.34, MySQL Shell 8.0.34</td></tr></tbody></table><h3 id="拓扑结构" tabindex="-1"><a class="header-anchor" href="#拓扑结构"><span>拓扑结构</span></a></h3><figure><img src="'+d+`" alt="MySQL InnoDB Cluster" tabindex="0" loading="lazy"><figcaption>MySQL InnoDB Cluster</figcaption></figure><h3 id="主机设置" tabindex="-1"><a class="header-anchor" href="#主机设置"><span>主机设置</span></a></h3><ul><li>主机名称设置</li></ul><blockquote><p>所有节点</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 路由节点</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;dataforum-router1&quot;</span> <span class="token operator">&gt;</span> /etc/hostname
hostnamectl set-hostname dataforum-router1

<span class="token comment"># 节点1</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;dataforum-db1&quot;</span> <span class="token operator">&gt;</span> /etc/hostname
hostnamectl set-hostname dataforum-db1

<span class="token comment"># 节点2</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;dataforum-db2&quot;</span> <span class="token operator">&gt;</span> /etc/hostname
hostnamectl set-hostname dataforum-db2

<span class="token comment"># 节点3</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;dataforum-db3&quot;</span> <span class="token operator">&gt;</span> /etc/hostname
hostnamectl set-hostname dataforum-db3
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>主机<code>hosts</code>设置</li></ul><blockquote><p>所有节点</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">&gt;&gt;</span> /etc/hosts</span>
10.10.12.211 dataforum-router1
10.10.12.212 dataforum-db1
10.10.12.213 dataforum-db2
10.10.12.214 dataforum-db3
EOF</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>关闭防火墙</li></ul><blockquote><p>所有节点</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>systemctl stop firewalld
systemctl disable firewalld
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Selinux设置</li></ul><blockquote><p>所有节点</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>setenforce <span class="token number">0</span>
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&quot;s/^SELINUX=enforcing/SELINUX=disabled/g&quot;</span> /etc/selinux/config
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ssh免密设置（可选）</li></ul><blockquote><p>所有节点</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>ssh-keygen <span class="token parameter variable">-t</span> rsa

ssh-copy-id <span class="token parameter variable">-i</span> ~/.ssh/id_rsa.pub <span class="token number">10.10</span>.12.211
ssh-copy-id <span class="token parameter variable">-i</span> ~/.ssh/id_rsa.pub <span class="token number">10.10</span>.12.212
ssh-copy-id <span class="token parameter variable">-i</span> ~/.ssh/id_rsa.pub <span class="token number">10.10</span>.12.213
ssh-copy-id <span class="token parameter variable">-i</span> ~/.ssh/id_rsa.pub <span class="token number">10.10</span>.12.214
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="安装和初始化" tabindex="-1"><a class="header-anchor" href="#安装和初始化"><span>安装和初始化</span></a></h3><ul><li>添加yum仓库</li></ul><blockquote><p>所有节点</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">wget</span> https://repo.mysql.com//mysql80-community-release-el7-9.noarch.rpm
<span class="token function">rpm</span> <span class="token parameter variable">-ivh</span> mysql80-community-release-el7-9.noarch.rpm
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>安装MySQL Server</li></ul><blockquote><p>在mysql主/从节点进行此安装</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># wget https://cdn.mysql.com//Downloads/MySQL-8.0/mysql-community-server-8.0.34-1.el7.x86_64.rpm</span>
<span class="token comment"># rpm -ivh mysql-community-server-8.0.34-1.el7.x86_64.rpm</span>
yum <span class="token function">install</span> mysql-community-server
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>安装MySQL Shell</li></ul><blockquote><p>在mysql主/从节点进行此安装</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># wget https://cdn.mysql.com//Downloads/MySQL-Shell/mysql-shell-8.0.34-1.el7.x86_64.rpm</span>
<span class="token comment"># rpm -ivh mysql-shell-8.0.34-1.el7.x86_64.rpm</span>
yum <span class="token function">install</span> mysql-shell
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>安装MySQL Router</li></ul><blockquote><p>在router节点进行此安装</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># wget https://cdn.mysql.com//Downloads/MySQL-Router/mysql-router-community-8.0.34-1.el7.x86_64.rpm</span>
<span class="token comment"># rpm -ivh mysql-router-community-8.0.34-1.el7.x86_64.rpm</span>
yum <span class="token function">install</span> mysql-router
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>初始化MySQL Server</li></ul><blockquote><p>在mysql主/从节点进行此安装</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># mysqld --initialize</span>

<span class="token comment"># #赋访问权限：</span>
<span class="token comment"># chown mysql:mysql /var/lib/mysql -R</span>

<span class="token comment">#启动mysql服务：</span>
systemctl start mysqld.service

<span class="token comment">#设置mysql开机自启</span>
systemctl <span class="token builtin class-name">enable</span> mysqld.service

<span class="token comment">#命令查看数据库的密码：</span>
<span class="token function">cat</span> /var/log/mysqld.log <span class="token operator">|</span> <span class="token function">grep</span> password

<span class="token comment">#进入mysql命令行：</span>
mysql <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token comment">-- 命令来修改密码： </span>
<span class="token keyword">ALTER</span> <span class="token keyword">USER</span> <span class="token string">&#39;root&#39;</span><span class="token variable">@&#39;localhost&#39;</span> IDENTIFIED <span class="token keyword">WITH</span> mysql_native_password <span class="token keyword">BY</span>  <span class="token string">&#39;Hello@2023&#39;</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建远程访问权限：</span>
<span class="token keyword">create</span> <span class="token keyword">user</span> <span class="token string">&#39;root&#39;</span><span class="token variable">@&#39;%&#39;</span> identified <span class="token keyword">with</span> mysql_native_password <span class="token keyword">by</span>  <span class="token string">&#39;Hello@2023&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">GRANT</span> <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span> <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">&#39;root&#39;</span><span class="token variable">@&#39;%&#39;</span> <span class="token keyword">WITH</span> <span class="token keyword">GRANT</span> <span class="token keyword">OPTION</span><span class="token punctuation">;</span>
flush <span class="token keyword">privileges</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建集群用户</span>
<span class="token keyword">create</span> <span class="token keyword">user</span> <span class="token string">&#39;clusteradmin&#39;</span><span class="token variable">@&#39;%&#39;</span> identified <span class="token keyword">with</span> mysql_native_password <span class="token keyword">by</span>  <span class="token string">&#39;Hello@2023&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">GRANT</span> <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span> <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">&#39;clusteradmin&#39;</span><span class="token variable">@&#39;%&#39;</span> <span class="token keyword">WITH</span> <span class="token keyword">GRANT</span> <span class="token keyword">OPTION</span><span class="token punctuation">;</span>
flush <span class="token keyword">privileges</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="使用mysql-shell搭建集群" tabindex="-1"><a class="header-anchor" href="#使用mysql-shell搭建集群"><span>使用MySQL Shell搭建集群</span></a></h3><blockquote><p>在mysql主/从节点进行此安装</p></blockquote><ul><li>交互模式</li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>mysqlsh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>dba<span class="token punctuation">.</span><span class="token function">configureLocalInstance</span><span class="token punctuation">(</span><span class="token string">&quot;clusteradmin@localhost:3306&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>命令模式</li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>mysqlsh <span class="token parameter variable">--mysql</span> <span class="token parameter variable">-uclusteradmin</span> <span class="token parameter variable">-h</span> <span class="token number">127.0</span>.0.1  <span class="token parameter variable">-P</span> <span class="token number">3306</span> <span class="token parameter variable">-p</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>dba<span class="token punctuation">.</span><span class="token function">configureLocalInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="创建集群" tabindex="-1"><a class="header-anchor" href="#创建集群"><span>创建集群</span></a></h3><blockquote><p>在mysql主节点： 10.10.12.212 dataforum-db1上进行配置</p></blockquote><ul><li>创建集群</li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>shell<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">&#39;clusteradmin@dataforum-db1:3306&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

cluster <span class="token operator">=</span> dba<span class="token punctuation">.</span><span class="token function">createCluster</span><span class="token punctuation">(</span><span class="token string">&#39;abelit_innodb_cluster&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>添加节点</li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">var</span> cluster<span class="token operator">=</span>dba<span class="token punctuation">.</span><span class="token function">getCluster</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cluster<span class="token punctuation">.</span><span class="token function">addInstance</span><span class="token punctuation">(</span><span class="token string">&#39;clusteradmin@dataforum-db2:3306&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cluster<span class="token punctuation">.</span><span class="token function">addInstance</span><span class="token punctuation">(</span><span class="token string">&#39;clusteradmin@dataforum-db3:3306&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="查看状态" tabindex="-1"><a class="header-anchor" href="#查看状态"><span>查看状态</span></a></h3>`,56),m=s("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[s("pre",{class:"language-javascript"},[s("code",null,[s("span",{class:"token keyword"},"var"),n(" cluster"),s("span",{class:"token operator"},"="),n("dba"),s("span",{class:"token punctuation"},"."),s("span",{class:"token function"},"getCluster"),s("span",{class:"token punctuation"},"("),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},";"),n(`
cluster`),s("span",{class:"token punctuation"},"."),s("span",{class:"token function"},"status"),s("span",{class:"token punctuation"},"("),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},";"),n(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),b=s("div",{class:"language-sql line-numbers-mode","data-ext":"sql","data-title":"sql"},[s("pre",{class:"language-sql"},[s("code",null,[s("span",{class:"token keyword"},"select"),n(),s("span",{class:"token operator"},"*"),n(),s("span",{class:"token keyword"},"from"),n(" performance_schema"),s("span",{class:"token punctuation"},"."),n("replication_group_members"),s("span",{class:"token punctuation"},";"),n(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),q=p(`<h3 id="配置mysql-router" tabindex="-1"><a class="header-anchor" href="#配置mysql-router"><span>配置MySQL Router</span></a></h3><blockquote><p>在router节点进行此安装</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>mysqlrouter <span class="token parameter variable">--bootstrap</span> clusteradmin@dataforum-db1:3306 <span class="token parameter variable">--directory</span> /opt/myrouter <span class="token parameter variable">--user</span><span class="token operator">=</span>root

/opt/myrouter/start.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="连接集群" tabindex="-1"><a class="header-anchor" href="#连接集群"><span>连接集群</span></a></h3><h4 id="创建测试数据库和账号" tabindex="-1"><a class="header-anchor" href="#创建测试数据库和账号"><span>创建测试数据库和账号</span></a></h4><blockquote><p>在router节点</p></blockquote><p>在 dataforum-db1 上，通过 MySQL shell 连接到 MySQL 服务器：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>mysqlsh root@localhost:3306
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>从 JavaScript 模式切换到 SQL 模式：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>\\sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>创建数据库：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token constant">CREATE</span> <span class="token constant">DATABASE</span> sbtest<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>创建数据库用户：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token constant">CREATE</span> <span class="token constant">USER</span> sbtest@<span class="token string">&#39;%&#39;</span> <span class="token constant">IDENTIFIED</span> <span class="token constant">BY</span> <span class="token string">&#39;Hello@2023&#39;</span><span class="token punctuation">;</span>
<span class="token constant">ALTER</span> <span class="token constant">USER</span> sbtest@<span class="token string">&#39;%&#39;</span> <span class="token constant">IDENTIFIED</span> <span class="token keyword">with</span> mysql_native_password <span class="token constant">BY</span> <span class="token string">&#39;Hello@2023&#39;</span><span class="token punctuation">;</span>
flush privileges<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>将用户授予数据库权限：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token constant">GRANT</span> <span class="token constant">ALL</span> <span class="token constant">PRIVILEGES</span> <span class="token constant">ON</span> sbtest<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token constant">TO</span> sbtest@<span class="token string">&#39;%&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="测试连接" tabindex="-1"><a class="header-anchor" href="#测试连接"><span>测试连接</span></a></h4><blockquote><p>在router节点</p></blockquote><p>使用sysbench 来生成一些测试数据</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">wget</span> <span class="token parameter variable">-O</span> /etc/yum.repos.d/epel.repo https://mirrors.aliyun.com/repo/epel-7.repo

yum <span class="token function">install</span> sysbench mysql-community-client
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>应用服务器上进行测试，连接mysql路由节点。对于写入连接，请连接到路由器主机的端口6446：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>mysql <span class="token parameter variable">-usbtest</span> <span class="token parameter variable">-p</span> <span class="token parameter variable">-h10.10.12.211</span> <span class="token parameter variable">-P6446</span> <span class="token parameter variable">-e</span> <span class="token string">&#39;select user(), @@hostname, @@read_only, @@super_read_only&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>对于只读连接，请连接到路由器主机的端口 6447：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>mysql <span class="token parameter variable">-usbtest</span> <span class="token parameter variable">-p</span> <span class="token parameter variable">-h10.10.12.211</span> <span class="token parameter variable">-P6447</span> <span class="token parameter variable">-e</span> <span class="token string">&#39;select user(), @@hostname, @@read_only, @@super_read_only&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="压力测试" tabindex="-1"><a class="header-anchor" href="#压力测试"><span>压力测试</span></a></h4><blockquote><p>在router节点</p></blockquote><p>在应用服务器上，通过连接到应用服务器的端口6446,生产20个表，每个表 100,000行数据：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>sysbench /usr/share/sysbench/oltp_common.lua <span class="token punctuation">\\</span>
--db-driver<span class="token operator">=</span>mysql <span class="token punctuation">\\</span>
--mysql-user<span class="token operator">=</span>sbtest <span class="token punctuation">\\</span>
--mysql-db<span class="token operator">=</span>sbtest <span class="token punctuation">\\</span>
--mysql-password<span class="token operator">=</span>Hello@2023 <span class="token punctuation">\\</span>
--mysql-port<span class="token operator">=</span><span class="token number">6446</span> <span class="token punctuation">\\</span>
--mysql-host<span class="token operator">=</span><span class="token number">10.10</span>.12.211 <span class="token punctuation">\\</span>
<span class="token parameter variable">--tables</span><span class="token operator">=</span><span class="token number">20</span> <span class="token punctuation">\\</span>
--table-size<span class="token operator">=</span><span class="token number">100000</span> <span class="token punctuation">\\</span>
prepare
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>要在端口 6446 上执行简单的读写测试 300 秒，请运行：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>sysbench /usr/share/sysbench/oltp_read_write.lua <span class="token punctuation">\\</span>
--report-interval<span class="token operator">=</span><span class="token number">2</span> <span class="token punctuation">\\</span>
<span class="token parameter variable">--threads</span><span class="token operator">=</span><span class="token number">8</span> <span class="token punctuation">\\</span>
<span class="token parameter variable">--time</span><span class="token operator">=</span><span class="token number">300</span> <span class="token punctuation">\\</span>
--db-driver<span class="token operator">=</span>mysql <span class="token punctuation">\\</span>
--mysql-host<span class="token operator">=</span><span class="token number">10.10</span>.12.211 <span class="token punctuation">\\</span>
--mysql-port<span class="token operator">=</span><span class="token number">6446</span> <span class="token punctuation">\\</span>
--mysql-user<span class="token operator">=</span>sbtest <span class="token punctuation">\\</span>
--mysql-db<span class="token operator">=</span>sbtest <span class="token punctuation">\\</span>
--mysql-password<span class="token operator">=</span>Hello@2023 <span class="token punctuation">\\</span>
<span class="token parameter variable">--tables</span><span class="token operator">=</span><span class="token number">20</span> <span class="token punctuation">\\</span>
--table-size<span class="token operator">=</span><span class="token number">100000</span> <span class="token punctuation">\\</span>
run
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>对于只读工作负载，我们可以将 MySQL 连接发送到端口 6447：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>sysbench /usr/share/sysbench/oltp_read_only.lua <span class="token punctuation">\\</span>
--report-interval<span class="token operator">=</span><span class="token number">2</span> <span class="token punctuation">\\</span>
<span class="token parameter variable">--threads</span><span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">\\</span>
<span class="token parameter variable">--time</span><span class="token operator">=</span><span class="token number">300</span> <span class="token punctuation">\\</span>
--db-driver<span class="token operator">=</span>mysql <span class="token punctuation">\\</span>
--mysql-host<span class="token operator">=</span><span class="token number">10.10</span>.12.211 <span class="token punctuation">\\</span>
--mysql-port<span class="token operator">=</span><span class="token number">6447</span> <span class="token punctuation">\\</span>
--mysql-user<span class="token operator">=</span>sbtest <span class="token punctuation">\\</span>
--mysql-db<span class="token operator">=</span>sbtest <span class="token punctuation">\\</span>
--mysql-password<span class="token operator">=</span>Hello@2023 <span class="token punctuation">\\</span>
<span class="token parameter variable">--tables</span><span class="token operator">=</span><span class="token number">20</span> <span class="token punctuation">\\</span>
--table-size<span class="token operator">=</span><span class="token number">100000</span> <span class="token punctuation">\\</span>
run
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="主从切换" tabindex="-1"><a class="header-anchor" href="#主从切换"><span>主从切换</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>mysqlsh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>shell<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">&#39;clusteradmin@dataforum-db1:3306&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> cluster<span class="token operator">=</span>dba<span class="token punctuation">.</span><span class="token function">getCluster</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cluster<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cluster<span class="token punctuation">.</span><span class="token function">setPrimaryInstance</span><span class="token punctuation">(</span><span class="token string">&#39;dataforum-db3:3306&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cluster<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>切换之前的状态：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code> MySQL  dataforum<span class="token operator">-</span>db1<span class="token operator">:</span><span class="token number">3306</span> ssl  <span class="token constant">JS</span> <span class="token operator">&gt;</span> cluster<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">{</span>
    <span class="token string-property property">&quot;clusterName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;abelit_innodb_cluster&quot;</span><span class="token punctuation">,</span> 
    <span class="token string-property property">&quot;defaultReplicaSet&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;primary&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataforum-db1:3306&quot;</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;ssl&quot;</span><span class="token operator">:</span> <span class="token string">&quot;REQUIRED&quot;</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OK&quot;</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;statusText&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Cluster is ONLINE and can tolerate up to ONE failure.&quot;</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;topology&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;dataforum-db1:3306&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string-property property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataforum-db1:3306&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;memberRole&quot;</span><span class="token operator">:</span> <span class="token string">&quot;PRIMARY&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;mode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;R/W&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;readReplicas&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;replicationLag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;applier_queue_applied&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;role&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HA&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ONLINE&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;8.0.34&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> 
            <span class="token string-property property">&quot;dataforum-db2:3306&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string-property property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataforum-db2:3306&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;memberRole&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SECONDARY&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;mode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;R/O&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;readReplicas&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;replicationLag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;applier_queue_applied&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;role&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HA&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ONLINE&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;8.0.34&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> 
            <span class="token string-property property">&quot;dataforum-db3:3306&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string-property property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataforum-db3:3306&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;memberRole&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SECONDARY&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;mode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;R/O&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;readReplicas&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;replicationLag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;applier_queue_applied&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;role&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HA&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ONLINE&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;8.0.34&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;topologyMode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Single-Primary&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token string-property property">&quot;groupInformationSourceMember&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataforum-db1:3306&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>切换之后的状态：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code> MySQL  dataforum<span class="token operator">-</span>db1<span class="token operator">:</span><span class="token number">3306</span> ssl  <span class="token constant">JS</span> <span class="token operator">&gt;</span> cluster<span class="token punctuation">.</span><span class="token function">setPrimaryInstance</span><span class="token punctuation">(</span><span class="token string">&#39;dataforum-db3:3306&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Setting instance <span class="token string">&#39;dataforum-db3:3306&#39;</span> <span class="token keyword">as</span> the primary instance <span class="token keyword">of</span> cluster <span class="token string">&#39;abelit_innodb_cluster&#39;</span><span class="token operator">...</span>

Instance <span class="token string">&#39;dataforum-db2:3306&#39;</span> remains <span class="token constant">SECONDARY</span><span class="token punctuation">.</span>
Instance <span class="token string">&#39;dataforum-db1:3306&#39;</span> was switched <span class="token keyword">from</span> <span class="token constant">PRIMARY</span> to <span class="token constant">SECONDARY</span><span class="token punctuation">.</span>
Instance <span class="token string">&#39;dataforum-db3:3306&#39;</span> was switched <span class="token keyword">from</span> <span class="token constant">SECONDARY</span> to <span class="token constant">PRIMARY</span><span class="token punctuation">.</span>

The instance <span class="token string">&#39;dataforum-db3:3306&#39;</span> was successfully elected <span class="token keyword">as</span> primary<span class="token punctuation">.</span>
 MySQL  dataforum<span class="token operator">-</span>db1<span class="token operator">:</span><span class="token number">3306</span> ssl  <span class="token constant">JS</span> <span class="token operator">&gt;</span> cluster<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">{</span>
    <span class="token string-property property">&quot;clusterName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;abelit_innodb_cluster&quot;</span><span class="token punctuation">,</span> 
    <span class="token string-property property">&quot;defaultReplicaSet&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;primary&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataforum-db3:3306&quot;</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;ssl&quot;</span><span class="token operator">:</span> <span class="token string">&quot;REQUIRED&quot;</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OK&quot;</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;statusText&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Cluster is ONLINE and can tolerate up to ONE failure.&quot;</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;topology&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;dataforum-db1:3306&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string-property property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataforum-db1:3306&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;memberRole&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SECONDARY&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;mode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;R/O&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;readReplicas&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;replicationLag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;applier_queue_applied&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;role&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HA&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ONLINE&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;8.0.34&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> 
            <span class="token string-property property">&quot;dataforum-db2:3306&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string-property property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataforum-db2:3306&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;memberRole&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SECONDARY&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;mode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;R/O&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;readReplicas&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;replicationLag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;applier_queue_applied&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;role&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HA&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ONLINE&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;8.0.34&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> 
            <span class="token string-property property">&quot;dataforum-db3:3306&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string-property property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataforum-db3:3306&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;memberRole&quot;</span><span class="token operator">:</span> <span class="token string">&quot;PRIMARY&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;mode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;R/W&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;readReplicas&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;replicationLag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;applier_queue_applied&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;role&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HA&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ONLINE&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;8.0.34&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;topologyMode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Single-Primary&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token string-property property">&quot;groupInformationSourceMember&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataforum-db3:3306&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="故障转移" tabindex="-1"><a class="header-anchor" href="#故障转移"><span>故障转移</span></a></h3><p>这里模拟演示。</p><ol><li>当前集群状态如下（当前主节点为： dataforum-db3）：</li></ol><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code> MySQL  dataforum<span class="token operator">-</span>db1<span class="token operator">:</span><span class="token number">3306</span> ssl  <span class="token constant">JS</span> <span class="token operator">&gt;</span> cluster<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">{</span>
    <span class="token string-property property">&quot;clusterName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;abelit_innodb_cluster&quot;</span><span class="token punctuation">,</span> 
    <span class="token string-property property">&quot;defaultReplicaSet&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;primary&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataforum-db3:3306&quot;</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;ssl&quot;</span><span class="token operator">:</span> <span class="token string">&quot;REQUIRED&quot;</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OK&quot;</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;statusText&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Cluster is ONLINE and can tolerate up to ONE failure.&quot;</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;topology&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;dataforum-db1:3306&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string-property property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataforum-db1:3306&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;memberRole&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SECONDARY&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;mode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;R/O&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;readReplicas&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;replicationLag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;applier_queue_applied&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;role&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HA&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ONLINE&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;8.0.34&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> 
            <span class="token string-property property">&quot;dataforum-db2:3306&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string-property property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataforum-db2:3306&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;memberRole&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SECONDARY&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;mode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;R/O&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;readReplicas&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;replicationLag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;applier_queue_applied&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;role&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HA&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ONLINE&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;8.0.34&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> 
            <span class="token string-property property">&quot;dataforum-db3:3306&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string-property property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataforum-db3:3306&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;memberRole&quot;</span><span class="token operator">:</span> <span class="token string">&quot;PRIMARY&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;mode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;R/W&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;readReplicas&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;replicationLag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;applier_queue_applied&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;role&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HA&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ONLINE&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;8.0.34&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;topologyMode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Single-Primary&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token string-property property">&quot;groupInformationSourceMember&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataforum-db3:3306&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>停止主节点mysql主进程或关闭主节点主机</li></ol><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>systemctl stop mysqld
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="3"><li>发生故障后集群信息如下：</li></ol><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code> MySQL  dataforum<span class="token operator">-</span>db1<span class="token operator">:</span><span class="token number">3306</span> ssl  <span class="token constant">JS</span> <span class="token operator">&gt;</span> cluster<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Cluster<span class="token punctuation">.</span>status<span class="token operator">:</span> Failed to execute query on Metadata server dataforum<span class="token operator">-</span>db3<span class="token operator">:</span><span class="token number">3306</span><span class="token operator">:</span> Server shutdown <span class="token keyword">in</span> <span class="token function">progress</span> <span class="token punctuation">(</span>MySQL Error <span class="token number">1053</span><span class="token punctuation">)</span>
 MySQL  dataforum<span class="token operator">-</span>db1<span class="token operator">:</span><span class="token number">3306</span> ssl  <span class="token constant">JS</span> <span class="token operator">&gt;</span> <span class="token keyword">var</span> cluster<span class="token operator">=</span>dba<span class="token punctuation">.</span><span class="token function">getCluster</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 MySQL  dataforum<span class="token operator">-</span>db1<span class="token operator">:</span><span class="token number">3306</span> ssl  <span class="token constant">JS</span> <span class="token operator">&gt;</span> cluster<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">{</span>
    <span class="token string-property property">&quot;clusterName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;abelit_innodb_cluster&quot;</span><span class="token punctuation">,</span> 
    <span class="token string-property property">&quot;defaultReplicaSet&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;primary&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataforum-db1:3306&quot;</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;ssl&quot;</span><span class="token operator">:</span> <span class="token string">&quot;REQUIRED&quot;</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OK_NO_TOLERANCE_PARTIAL&quot;</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;statusText&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Cluster is NOT tolerant to any failures. 1 member is not active.&quot;</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;topology&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;dataforum-db1:3306&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string-property property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataforum-db1:3306&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;memberRole&quot;</span><span class="token operator">:</span> <span class="token string">&quot;PRIMARY&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;mode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;R/W&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;readReplicas&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;replicationLag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;applier_queue_applied&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;role&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HA&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ONLINE&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;8.0.34&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> 
            <span class="token string-property property">&quot;dataforum-db2:3306&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string-property property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataforum-db2:3306&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;memberRole&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SECONDARY&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;mode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;R/O&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;readReplicas&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;replicationLag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;applier_queue_applied&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;role&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HA&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ONLINE&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;8.0.34&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> 
            <span class="token string-property property">&quot;dataforum-db3:3306&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string-property property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataforum-db3:3306&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;memberRole&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SECONDARY&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;mode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;n/a&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;readReplicas&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;role&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HA&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;shellConnectError&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MySQL Error 2003: Could not open connection to &#39;dataforum-db3:3306&#39;: Can&#39;t connect to MySQL server on &#39;dataforum-db3:3306&#39; (111)&quot;</span><span class="token punctuation">,</span> 
                <span class="token string-property property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;(MISSING)&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> 
        <span class="token string-property property">&quot;topologyMode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Single-Primary&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token string-property property">&quot;groupInformationSourceMember&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataforum-db1:3306&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过模拟主节点mysql服务挂掉或宕机，发现集群成功实现故障转移，主节点从<code>dataforum-db3:3306</code>变为<code>dataforum-db1:3306</code>。</p>`,48);function y(g,h){const o=r("CodeTabs");return i(),c("div",null,[v,u(o,{id:"331",data:[{id:"mysqlsh"},{id:"sql"}],active:0},{title0:a(({value:t,isActive:e})=>[n("mysqlsh")]),title1:a(({value:t,isActive:e})=>[n("sql")]),tab0:a(({value:t,isActive:e})=>[m]),tab1:a(({value:t,isActive:e})=>[b]),_:1}),q])}const L=l(k,[["render",y],["__file","mysql-innodb-cluster.html.vue"]]),_=JSON.parse('{"path":"/guide/database/mysql/ha/deployment/mysql-innodb-cluster.html","title":"MySQL InnoDB Cluster","lang":"zh-CN","frontmatter":{"title":"MySQL InnoDB Cluster","description":"MySQL InnoDB Cluster 组件说明 MySQL InnoDB 集群由 3 个组件组成： MySQL组复制（一组数据库服务器，它们以容错能力相互复制）; MySQL 路由器（查询路由器到正常数据库节点）; MySQL Shell（帮助程序，客户端，配置工具）。 主机信息 拓扑结构 MySQL InnoDB ClusterMySQL Inn...","head":[["meta",{"property":"og:url","content":"https://github.com/abelit/abelit-datapeacock.git/guide/database/mysql/ha/deployment/mysql-innodb-cluster.html"}],["meta",{"property":"og:site_name","content":"数之雀"}],["meta",{"property":"og:title","content":"MySQL InnoDB Cluster"}],["meta",{"property":"og:description","content":"MySQL InnoDB Cluster 组件说明 MySQL InnoDB 集群由 3 个组件组成： MySQL组复制（一组数据库服务器，它们以容错能力相互复制）; MySQL 路由器（查询路由器到正常数据库节点）; MySQL Shell（帮助程序，客户端，配置工具）。 主机信息 拓扑结构 MySQL InnoDB ClusterMySQL Inn..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-11T14:06:18.000Z"}],["meta",{"property":"article:author","content":"Abelit"}],["meta",{"property":"article:modified_time","content":"2024-05-11T14:06:18.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"MySQL InnoDB Cluster\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-05-11T14:06:18.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Abelit\\",\\"url\\":\\"https://github.com/abelit\\"}]}"]]},"headers":[{"level":2,"title":"MySQL InnoDB Cluster","slug":"mysql-innodb-cluster","link":"#mysql-innodb-cluster","children":[{"level":3,"title":"组件说明","slug":"组件说明","link":"#组件说明","children":[]},{"level":3,"title":"主机信息","slug":"主机信息","link":"#主机信息","children":[]},{"level":3,"title":"拓扑结构","slug":"拓扑结构","link":"#拓扑结构","children":[]},{"level":3,"title":"主机设置","slug":"主机设置","link":"#主机设置","children":[]},{"level":3,"title":"安装和初始化","slug":"安装和初始化","link":"#安装和初始化","children":[]},{"level":3,"title":"使用MySQL Shell搭建集群","slug":"使用mysql-shell搭建集群","link":"#使用mysql-shell搭建集群","children":[]},{"level":3,"title":"创建集群","slug":"创建集群","link":"#创建集群","children":[]},{"level":3,"title":"查看状态","slug":"查看状态","link":"#查看状态","children":[]},{"level":3,"title":"配置MySQL Router","slug":"配置mysql-router","link":"#配置mysql-router","children":[]},{"level":3,"title":"连接集群","slug":"连接集群","link":"#连接集群","children":[]},{"level":3,"title":"主从切换","slug":"主从切换","link":"#主从切换","children":[]},{"level":3,"title":"故障转移","slug":"故障转移","link":"#故障转移","children":[]}]}],"git":{"createdTime":1715436378000,"updatedTime":1715436378000,"contributors":[{"name":"ableit","email":"ychenid@live.com","commits":1}]},"readingTime":{"minutes":5.91,"words":1773},"filePathRelative":"guide/database/mysql/ha/deployment/mysql-innodb-cluster.md","localizedDate":"2024年5月11日","autoDesc":true,"excerpt":"<h2>MySQL InnoDB Cluster</h2>\\n<h3>组件说明</h3>\\n<p>MySQL InnoDB 集群由 3 个组件组成：</p>\\n<ul>\\n<li>MySQL组复制（一组数据库服务器，它们以容错能力相互复制）;</li>\\n<li>MySQL 路由器（查询路由器到正常数据库节点）;</li>\\n<li>MySQL Shell（帮助程序，客户端，配置工具）。</li>\\n</ul>\\n<h3>主机信息</h3>\\n<table>\\n<thead>\\n<tr>\\n<th>编号</th>\\n<th>IP 地址</th>\\n<th>角色</th>\\n<th>操作系统</th>\\n<th>内核版本</th>\\n<th>软件及版本</th>\\n</tr>\\n</thead>\\n<tbody>\\n<tr>\\n<td>1</td>\\n<td>10.10.12.211</td>\\n<td>router</td>\\n<td>CentOS 7.9</td>\\n<td>3.10.0-1160.el7.x86_64</td>\\n<td>MySQL Router 8.0.34</td>\\n</tr>\\n<tr>\\n<td>2</td>\\n<td>10.10.12.212</td>\\n<td>mysql主</td>\\n<td>CentOS 7.9</td>\\n<td>3.10.0-1160.el7.x86_64</td>\\n<td>MySQL 8.0.34, MySQL Shell 8.0.34</td>\\n</tr>\\n<tr>\\n<td>3</td>\\n<td>10.10.12.213</td>\\n<td>mysql从</td>\\n<td>CentOS 7.9</td>\\n<td>3.10.0-1160.el7.x86_64</td>\\n<td>MySQL 8.0.34, MySQL Shell 8.0.34</td>\\n</tr>\\n<tr>\\n<td>4</td>\\n<td>10.10.12.214</td>\\n<td>mysql从</td>\\n<td>CentOS 7.9</td>\\n<td>3.10.0-1160.el7.x86_64</td>\\n<td>MySQL 8.0.34, MySQL Shell 8.0.34</td>\\n</tr>\\n</tbody>\\n</table>"}');export{L as comp,_ as data};
