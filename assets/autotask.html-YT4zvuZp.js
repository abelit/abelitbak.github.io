import{_ as l}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as c,o as i,c as r,b as u,w as a,f as p,d as n,a as s}from"./app-DR5J2daJ.js";const d={},k=p(`<h2 id="oracle自动维护任务" tabindex="-1"><a class="header-anchor" href="#oracle自动维护任务"><span>Oracle自动维护任务</span></a></h2><p>Oracle数据库里提供了自动维护任务，以保证Oracle数据库可以更高效的运行。</p><h3 id="任务类型" tabindex="-1"><a class="header-anchor" href="#任务类型"><span>任务类型</span></a></h3><h4 id="_10g里的自动任务有两种" tabindex="-1"><a class="header-anchor" href="#_10g里的自动任务有两种"><span>10g里的自动任务有两种：</span></a></h4><ul><li>AUTO_SPACE_ADVISOR_JOB，自动空间顾问JOB</li><li>GATHER_STATS_JOB，自动收集统计信息JOB</li></ul><h4 id="_11g里的自动任务有三种" tabindex="-1"><a class="header-anchor" href="#_11g里的自动任务有三种"><span>11g里的自动任务有三种：</span></a></h4><ul><li><p>auto optimizer stats collection，自动统计信息收集顾问。为所有方案对象收集陈旧的或缺少的统计数据，所收集的统计信息将被用来提高sql的执行的性能。</p></li><li><p>auto space advisor，自动空间顾问。标识数据库中的段是否有可以回收的空间，并以此信息统计为基础做出怎样整理段的碎片以节约空间。你也可以手动的执行此job来获取最新的建议信息，或者获取自动段advisor 不检测的但又可以回收的段的信息。</p></li><li><p>sql tuning advisor，sql调优顾问。自动标识并尝试调整高负载的SQL。</p></li><li><p>查询自动维护窗口（AutoTask Window）每次运行情况的历史追踪信息</p></li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> DBA_AUTOTASK_WINDOW_HISTORY <span class="token keyword">order</span> <span class="token keyword">by</span> window_start_time <span class="token keyword">desc</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>查看oracle自动维护定时任务</li></ul>`,9),m=s("div",{class:"language-sql line-numbers-mode","data-ext":"sql","data-title":"sql"},[s("pre",{class:"language-sql"},[s("code",null,[s("span",{class:"token keyword"},"set"),n(" linesize "),s("span",{class:"token number"},"200"),n(`
col owner `),s("span",{class:"token keyword"},"for"),n(` a30
col job_name `),s("span",{class:"token keyword"},"for"),n(` a30
`),s("span",{class:"token keyword"},"select"),n(" owner"),s("span",{class:"token punctuation"},","),n("job_name "),s("span",{class:"token keyword"},"from"),n(" dba_scheduler_jobs "),s("span",{class:"token keyword"},"where"),n(" job_class"),s("span",{class:"token operator"},"="),s("span",{class:"token string"},"'AUTO_TASKS_JOB_CLASS'"),s("span",{class:"token punctuation"},";"),n(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),b=s("div",{class:"language-sql line-numbers-mode","data-ext":"sql","data-title":"sql"},[s("pre",{class:"language-sql"},[s("code",null,[s("span",{class:"token keyword"},"select"),n(" client_name "),s("span",{class:"token punctuation"},","),s("span",{class:"token keyword"},"status"),n(),s("span",{class:"token keyword"},"from"),n(" DBA_AUTOTASK_CLIENT"),s("span",{class:"token punctuation"},";"),n(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),v=p(`<h3 id="维护窗口时间" tabindex="-1"><a class="header-anchor" href="#维护窗口时间"><span>维护窗口时间</span></a></h3><p>10g中分为两个时间段WEEKNIGHT_WINDOW和WEEKEND_WINDOW，可以从dba_scheduler_windows视图中查到。它们分别的运行开始时间和持续时间为：</p><ul><li><p>WEEKNIGHT_WINDOW，每周一至周五晚22:00:00开始，持续8小时。</p></li><li><p>WEEKEND_WINDOW，第周六00:00:00，持续2天。</p></li></ul><p>11g中维护窗口分得更细，分为7个，即第一天个维护窗口，可以针对不同的需求做出更细粒度的调整，dba_scheduler_windows视图中查到，分别为MONDAY_WINDOW,TUESDAY_WINDOW,WEDNESDAY_WINDOW,THURSDAY_WINDOW,FRIDAY_WINDOW,SATURDAY_WINDOW,SUNDAY_WINDOW。开始时间和持续时间分别为：</p><ul><li><p>周一到周五晚22:00:00开始，持续4小时。</p></li><li><p>周六和周日早6:00:00开始，执行20小时。</p></li><li><p>查询维护窗口时间</p></li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token keyword">select</span> * from DBA_AUTOTASK_WINDOW_CLIENTS<span class="token punctuation">;</span>

<span class="token keyword">select</span> * from dba_scheduler_windows<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="维护方式" tabindex="-1"><a class="header-anchor" href="#维护方式"><span>维护方式</span></a></h3><p>10g的维护方式</p><ul><li>停用JOB</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span><span class="token keyword">disable</span><span class="token punctuation">(</span><span class="token string">&#39;AUTO_SPACE_ADVISOR_JOB&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> enabled <span class="token keyword">from</span> dba_scheduler_jobs <span class="token keyword">where</span> job_name<span class="token operator">=</span><span class="token string">&#39;AUTO_SPACE_ADVISOR_JOB&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>启用JOB</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span><span class="token keyword">ENABLE</span><span class="token punctuation">(</span><span class="token string">&#39;AUTO_SPACE_ADVISOR_JOB&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> enabled <span class="token keyword">from</span> dba_scheduler_jobs <span class="token keyword">where</span> job_name<span class="token operator">=</span><span class="token string">&#39;AUTO_SPACE_ADVISOR_JOB&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>11g里自动任务的维护</p><ol><li>启动和停用自动维护任务</li></ol><ul><li>停用sql tuning advisor</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
dbms_auto_task_admin<span class="token punctuation">.</span><span class="token keyword">disable</span><span class="token punctuation">(</span>
    client_name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;sql tuning advisor&#39;</span><span class="token punctuation">,</span>
    operation   <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    window_name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>

<span class="token keyword">select</span> client_name<span class="token punctuation">,</span><span class="token keyword">status</span> <span class="token keyword">from</span> dba_autotask_client<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>启用sql tuning advisor</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span><span class="token keyword">BEGIN</span>
dbms_auto_task_admin<span class="token punctuation">.</span><span class="token keyword">enable</span><span class="token punctuation">(</span>
    client_name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;sql tuning advisor&#39;</span><span class="token punctuation">,</span>
    operation   <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    window_name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>

<span class="token keyword">select</span> client_name<span class="token punctuation">,</span><span class="token keyword">status</span> <span class="token keyword">from</span> dba_autotask_client<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>停用所有维护窗口下的所有的自动任务</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">exec</span> dbms_auto_task_admin<span class="token punctuation">.</span><span class="token keyword">disable</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> window_name<span class="token punctuation">,</span>autotask_status <span class="token keyword">from</span> dba_autotask_window_clients<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>启用所有维护窗口下的所有自动任务</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">exec</span> dbms_auto_task_admin<span class="token punctuation">.</span><span class="token keyword">enable</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> window_name<span class="token punctuation">,</span>autotask_status <span class="token keyword">from</span> dba_autotask_window_clients<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>停用针对某个维护窗口的自动任务</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
    dbms_auto_task_admin<span class="token punctuation">.</span><span class="token keyword">disable</span><span class="token punctuation">(</span>
    client_name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;sql tuning advisor&#39;</span><span class="token punctuation">,</span> 
    operation   <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> 
    window_name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;MONDAY_WINDOW&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>


<span class="token keyword">select</span> window_name<span class="token punctuation">,</span>autotask_status<span class="token punctuation">,</span>sql_tune_advisor <span class="token keyword">from</span> dba_autotask_window_clients<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>配置维护窗口</li></ol><ul><li>修改维护窗口的属性，把SATURDAY_WINDOW的持续时间修改为4小时</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">BEGIN</span>
    dbms_scheduler<span class="token punctuation">.</span><span class="token keyword">disable</span><span class="token punctuation">(</span>
        name  <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;SATURDAY_WINDOW&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    dbms_scheduler<span class="token punctuation">.</span>set_attribute<span class="token punctuation">(</span>
        name      <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;SATURDAY_WINDOW&#39;</span><span class="token punctuation">,</span>
        attribute <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;DURATION&#39;</span><span class="token punctuation">,</span>
        <span class="token keyword">value</span>     <span class="token operator">=</span><span class="token operator">&gt;</span> numtodsinterval<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&#39;hour&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    dbms_scheduler<span class="token punctuation">.</span><span class="token keyword">enable</span><span class="token punctuation">(</span>
        name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;SATURDAY_WINDOW&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token operator">/</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> dba_scheduler_windows <span class="token keyword">WHERE</span> window_name<span class="token operator">=</span><span class="token string">&#39;SATURDAY_WINDOW&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>修改维护窗口的属性,</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span><span class="token keyword">disable</span><span class="token punctuation">(</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;MONDAY_WINDOW&#39;</span><span class="token punctuation">,</span> <span class="token keyword">force</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span>set_attribute<span class="token punctuation">(</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;MONDAY_WINDOW&#39;</span><span class="token punctuation">,</span> attribute <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;repeat_interval&#39;</span><span class="token punctuation">,</span><span class="token keyword">value</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;freq=daily;byday=MON;byhour=2;byminute=0;bysecond=0&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span>set_attribute<span class="token punctuation">(</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;MONDAY_WINDOW&#39;</span><span class="token punctuation">,</span> attribute <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;DURATION&#39;</span><span class="token punctuation">,</span><span class="token keyword">value</span> <span class="token operator">=</span><span class="token operator">&gt;</span> numtodsinterval<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">&#39;hour&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span><span class="token keyword">enable</span><span class="token punctuation">(</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;MONDAY_WINDOW&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span><span class="token keyword">disable</span><span class="token punctuation">(</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;TUESDAY_WINDOW&#39;</span><span class="token punctuation">,</span> <span class="token keyword">force</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span>set_attribute<span class="token punctuation">(</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;TUESDAY_WINDOW&#39;</span><span class="token punctuation">,</span> attribute <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;repeat_interval&#39;</span><span class="token punctuation">,</span><span class="token keyword">value</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;freq=daily;byday=TUE;byhour=2;byminute=0;bysecond=0&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span>set_attribute<span class="token punctuation">(</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;TUESDAY_WINDOW&#39;</span><span class="token punctuation">,</span> attribute <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;DURATION&#39;</span><span class="token punctuation">,</span><span class="token keyword">value</span> <span class="token operator">=</span><span class="token operator">&gt;</span> numtodsinterval<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">&#39;hour&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span><span class="token keyword">enable</span><span class="token punctuation">(</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;TUESDAY_WINDOW&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span><span class="token keyword">disable</span><span class="token punctuation">(</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;WEDNESDAY_WINDOW&#39;</span><span class="token punctuation">,</span> <span class="token keyword">force</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span>set_attribute<span class="token punctuation">(</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;WEDNESDAY_WINDOW&#39;</span><span class="token punctuation">,</span> attribute <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;repeat_interval&#39;</span><span class="token punctuation">,</span><span class="token keyword">value</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;freq=daily;byday=WED;byhour=2;byminute=0;bysecond=0&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span>set_attribute<span class="token punctuation">(</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;WEDNESDAY_WINDOW&#39;</span><span class="token punctuation">,</span> attribute <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;DURATION&#39;</span><span class="token punctuation">,</span><span class="token keyword">value</span> <span class="token operator">=</span><span class="token operator">&gt;</span> numtodsinterval<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">&#39;hour&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span><span class="token keyword">enable</span><span class="token punctuation">(</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;WEDNESDAY_WINDOW&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span><span class="token keyword">disable</span><span class="token punctuation">(</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;THURSDAY_WINDOW&#39;</span><span class="token punctuation">,</span> <span class="token keyword">force</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span>set_attribute<span class="token punctuation">(</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;THURSDAY_WINDOW&#39;</span><span class="token punctuation">,</span> attribute <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;repeat_interval&#39;</span><span class="token punctuation">,</span><span class="token keyword">value</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;freq=daily;byday=THU;byhour=2;byminute=0;bysecond=0&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span>set_attribute<span class="token punctuation">(</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;THURSDAY_WINDOW&#39;</span><span class="token punctuation">,</span> attribute <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;DURATION&#39;</span><span class="token punctuation">,</span><span class="token keyword">value</span> <span class="token operator">=</span><span class="token operator">&gt;</span> numtodsinterval<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">&#39;hour&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span><span class="token keyword">enable</span><span class="token punctuation">(</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;THURSDAY_WINDOW&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span><span class="token keyword">disable</span><span class="token punctuation">(</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;FRIDAY_WINDOW&#39;</span><span class="token punctuation">,</span> <span class="token keyword">force</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span>set_attribute<span class="token punctuation">(</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;FRIDAY_WINDOW&#39;</span><span class="token punctuation">,</span> attribute <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;repeat_interval&#39;</span><span class="token punctuation">,</span><span class="token keyword">value</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;freq=daily;byday=FRI;byhour=2;byminute=0;bysecond=0&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span>set_attribute<span class="token punctuation">(</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;FRIDAY_WINDOW&#39;</span><span class="token punctuation">,</span> attribute <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;DURATION&#39;</span><span class="token punctuation">,</span><span class="token keyword">value</span> <span class="token operator">=</span><span class="token operator">&gt;</span> numtodsinterval<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">&#39;hour&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">exec</span> dbms_scheduler<span class="token punctuation">.</span><span class="token keyword">enable</span><span class="token punctuation">(</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&#39;FRIDAY_WINDOW&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dba_scheduler_windows<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="自动维护任务相关视图" tabindex="-1"><a class="header-anchor" href="#自动维护任务相关视图"><span>自动维护任务相关视图</span></a></h3><ul><li>dba_scheduler_window_groups; --维护窗口组</li><li>dba_scheduler_wingroup_members --维护窗口组对应窗口</li><li>dba_scheduler_windows --维护窗口历史信息</li><li>DBA_AUTOTASK_CLIENT_JOB --查询自动收集任务正在执行的job</li><li>DBA_AUTOTASK_JOB_HISTORY --查询自动收集任务历史执行状态</li><li>DBA_AUTOTASK_CLIENT_HISTORY --查询自动收集任务历史job</li></ul>`,31);function _(g,w){const o=c("CodeTabs");return i(),r("div",null,[k,u(o,{id:"57",data:[{id:"10g"},{id:"11g+"}],active:0},{title0:a(({value:e,isActive:t})=>[n("10g")]),title1:a(({value:e,isActive:t})=>[n("11g+")]),tab0:a(({value:e,isActive:t})=>[m]),tab1:a(({value:e,isActive:t})=>[b]),_:1}),v])}const O=l(d,[["render",_],["__file","autotask.html.vue"]]),A=JSON.parse('{"path":"/guide/database/oracle/autotask.html","title":"Oracle AutoTask","lang":"zh-CN","frontmatter":{"title":"Oracle AutoTask","description":"Oracle自动维护任务 Oracle数据库里提供了自动维护任务，以保证Oracle数据库可以更高效的运行。 任务类型 10g里的自动任务有两种： AUTO_SPACE_ADVISOR_JOB，自动空间顾问JOB GATHER_STATS_JOB，自动收集统计信息JOB 11g里的自动任务有三种： auto optimizer stats collec...","head":[["meta",{"property":"og:url","content":"https://github.com/abelit/abelit-datapeacock.git/guide/database/oracle/autotask.html"}],["meta",{"property":"og:site_name","content":"数之雀"}],["meta",{"property":"og:title","content":"Oracle AutoTask"}],["meta",{"property":"og:description","content":"Oracle自动维护任务 Oracle数据库里提供了自动维护任务，以保证Oracle数据库可以更高效的运行。 任务类型 10g里的自动任务有两种： AUTO_SPACE_ADVISOR_JOB，自动空间顾问JOB GATHER_STATS_JOB，自动收集统计信息JOB 11g里的自动任务有三种： auto optimizer stats collec..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-11T14:06:18.000Z"}],["meta",{"property":"article:author","content":"Abelit"}],["meta",{"property":"article:modified_time","content":"2024-05-11T14:06:18.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Oracle AutoTask\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-05-11T14:06:18.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Abelit\\",\\"url\\":\\"https://github.com/abelit\\"}]}"]]},"headers":[{"level":2,"title":"Oracle自动维护任务","slug":"oracle自动维护任务","link":"#oracle自动维护任务","children":[{"level":3,"title":"任务类型","slug":"任务类型","link":"#任务类型","children":[]},{"level":3,"title":"维护窗口时间","slug":"维护窗口时间","link":"#维护窗口时间","children":[]},{"level":3,"title":"维护方式","slug":"维护方式","link":"#维护方式","children":[]},{"level":3,"title":"自动维护任务相关视图","slug":"自动维护任务相关视图","link":"#自动维护任务相关视图","children":[]}]}],"git":{"createdTime":1715436378000,"updatedTime":1715436378000,"contributors":[{"name":"ableit","email":"ychenid@live.com","commits":1}]},"readingTime":{"minutes":3.45,"words":1035},"filePathRelative":"guide/database/oracle/autotask.md","localizedDate":"2024年5月11日","autoDesc":true,"excerpt":"<h2>Oracle自动维护任务</h2>\\n<p>Oracle数据库里提供了自动维护任务，以保证Oracle数据库可以更高效的运行。</p>\\n<h3>任务类型</h3>\\n<h4>10g里的自动任务有两种：</h4>\\n<ul>\\n<li>AUTO_SPACE_ADVISOR_JOB，自动空间顾问JOB</li>\\n<li>GATHER_STATS_JOB，自动收集统计信息JOB</li>\\n</ul>\\n<h4>11g里的自动任务有三种：</h4>\\n<ul>\\n<li>\\n<p>auto optimizer stats collection，自动统计信息收集顾问。为所有方案对象收集陈旧的或缺少的统计数据，所收集的统计信息将被用来提高sql的执行的性能。</p>\\n</li>\\n<li>\\n<p>auto space advisor，自动空间顾问。标识数据库中的段是否有可以回收的空间，并以此信息统计为基础做出怎样整理段的碎片以节约空间。你也可以手动的执行此job来获取最新的建议信息，或者获取自动段advisor 不检测的但又可以回收的段的信息。</p>\\n</li>\\n<li>\\n<p>sql tuning advisor，sql调优顾问。自动标识并尝试调整高负载的SQL。</p>\\n</li>\\n<li>\\n<p>查询自动维护窗口（AutoTask Window）每次运行情况的历史追踪信息</p>\\n</li>\\n</ul>"}');export{O as comp,A as data};
