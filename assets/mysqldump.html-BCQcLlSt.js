import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as s,c as e,f as l}from"./app-DR5J2daJ.js";const t={},p=l(`<h2 id="mysqldump备份" tabindex="-1"><a class="header-anchor" href="#mysqldump备份"><span>mysqldump备份</span></a></h2><h3 id="备份整个数据库" tabindex="-1"><a class="header-anchor" href="#备份整个数据库"><span>备份整个数据库</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 使用 --skip-opt参数</span>
<span class="token comment"># mysqldump ​--skip-opt  --compress -uroot -p --all-databases &gt; /backup/mysqlbackup/ddi-all-databases-\`date +%Y%m%d%H%M\`.sql </span>

<span class="token comment"># mysqldump+gzip减少文件大小和降低网络传输</span>
<span class="token comment"># mysqldump --lock-tables=0 -uroot -p --all-databases | gzip &gt; /backup/mysqlbackup/ddi-all-databases-\`date +%Y%m%d%H%M\`.sql.gz</span>

<span class="token comment"># mysqldump+compres参数降低网络传输</span>
mysqldump --lock-tables<span class="token operator">=</span><span class="token number">0</span> <span class="token parameter variable">--compress</span> <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> --all-databases <span class="token operator">&gt;</span> /backup/mysqlbackup/ddi-all-databases-<span class="token variable"><span class="token variable">\`</span><span class="token function">date</span> +%Y%m%d%H%M<span class="token variable">\`</span></span>.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">参数说明</p><p>语法： mysqldump -h主机名 -P端口 -u用户名 -p密码 --all-databases &gt; 文件名.sql</p><ul><li><p>-h主机名是指定连接到数据库的主机名或 IP 地址。</p></li><li><p>-P端口是指定连接到数据库的端口号。</p></li><li><p>-u用户名是指定连接到数据库的用户名。</p></li><li><p>-p密码是指定连接到数据库的密码。</p></li><li><p>--all-databases是指定导出所有的数据库。</p></li><li><p>文件名.sql是将导出的 SQL 语句重定向到一个文件中，您可以自己指定文件的名称和位置。</p></li><li><p>--single-transaction是一个用于导出MySQL数据库的命令，它可以在导出过程中使用一个单一的事务，保证导出的数据的一致性。使用–single-transaction选项的好处是，它不需要锁定表，也不会阻止其他的操作对表进行修改。这个选项对于使用InnoDB等事务型的存储引擎的表是适合的，因为它可以利用InnoDB的快照读特性，获取导出时刻的数据。使用–single-transaction选项的注意事项是，它只能用于导出事务型的表，如果导出的数据库中包含非事务型的表，如MyISAM，那么导出的数据可能不一致。另外，如果在导出过程中有其他的连接对表结构进行修改，如ALTER TABLE或DROP TABLE，那么导出的数据也可能不正确或导出失败。</p></li><li><p>--compress是指定使用压缩协议传输数据。</p></li><li><p>--lock-tables是一个用于在导出之前锁定所有的表的选项，它可以保证导出的数据的一致性，但是会阻止其他的操作对表进行修改。这个选项对于使用MyISAM等非事务型的存储引擎的表是必要的，但是对于使用InnoDB等事务型的存储引擎的表，可以使用--single-transaction选项来避免锁定表。</p></li><li><p>--skip-opt是一个用于禁用默认的优化选项的选项，它相当于同时使用以下选项：--skip-add-drop-table, --skip-add-locks, --skip-create-options, --skip-disable-keys, --skip-extended-insert, --skip-lock-tables, --skip-quick, and - --skip-set-charset。这些选项的作用分别是：</p><ul><li>--skip-add-drop-table：不在导出的SQL语句中添加DROP TABLE语句。</li><li>--skip-add-locks：不在导出的SQL语句中添加LOCK TABLES和UNLOCK TABLES语句。</li><li>--skip-create-options：不在导出的SQL语句中添加表的选项，如AUTO_INCREMENT值。</li><li>--skip-disable-keys：不在导出的SQL语句中添加DISABLE KEYS和ENABLE KEYS语句，用于禁用和启用表的索引。</li><li>--skip-extended-insert：不使用扩展的INSERT语句，即每个INSERT语句只插入一行数据。</li><li>--skip-lock-tables：不使用--lock-tables选项，即不锁定表。</li><li>--skip-quick：不使用缓冲区来获取查询结果，而是直接从服务器获取。</li><li>--skip-set-charset：不在导出的SQL语句中添加设置字符集的语句。 使用--skip-opt选项可以使导出的SQL语句更容易阅读和编辑，但是也会降低导出和导入的效率和性能。</li></ul></li></ul></div><p>如果不加<code>--lock-tables=0</code>或<code>​--skip-opt​</code>参数，会产生如下错误：</p><div class="hint-container warning"><p class="hint-container-title">注意</p><p>[root@localhost packages]# mysqldump -uroot -p --all-databases &gt; /backup/mysqlbackup/ddi-all-databases.sql Enter password: mysqldump: Got error: 1556: You can&#39;t use locks with log tables. when using LOCK TABLES</p></div>`,6),n=[p];function i(o,d){return s(),e("div",null,n)}const r=a(t,[["render",i],["__file","mysqldump.html.vue"]]),u=JSON.parse('{"path":"/guide/database/mysql/backup/mysqldump.html","title":"mysqldump备份与恢复","lang":"zh-CN","frontmatter":{"title":"mysqldump备份与恢复","description":"mysqldump备份 备份整个数据库 参数说明 语法： mysqldump -h主机名 -P端口 -u用户名 -p密码 --all-databases > 文件名.sql -h主机名是指定连接到数据库的主机名或 IP 地址。 -P端口是指定连接到数据库的端口号。 -u用户名是指定连接到数据库的用户名。 -p密码是指定连接到数据库的密码。 --all-...","head":[["meta",{"property":"og:url","content":"https://github.com/abelit/abelit-datapeacock.git/guide/database/mysql/backup/mysqldump.html"}],["meta",{"property":"og:site_name","content":"数之雀"}],["meta",{"property":"og:title","content":"mysqldump备份与恢复"}],["meta",{"property":"og:description","content":"mysqldump备份 备份整个数据库 参数说明 语法： mysqldump -h主机名 -P端口 -u用户名 -p密码 --all-databases > 文件名.sql -h主机名是指定连接到数据库的主机名或 IP 地址。 -P端口是指定连接到数据库的端口号。 -u用户名是指定连接到数据库的用户名。 -p密码是指定连接到数据库的密码。 --all-..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-11T14:06:18.000Z"}],["meta",{"property":"article:author","content":"Abelit"}],["meta",{"property":"article:modified_time","content":"2024-05-11T14:06:18.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"mysqldump备份与恢复\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-05-11T14:06:18.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Abelit\\",\\"url\\":\\"https://github.com/abelit\\"}]}"]]},"headers":[{"level":2,"title":"mysqldump备份","slug":"mysqldump备份","link":"#mysqldump备份","children":[{"level":3,"title":"备份整个数据库","slug":"备份整个数据库","link":"#备份整个数据库","children":[]}]}],"git":{"createdTime":1715436378000,"updatedTime":1715436378000,"contributors":[{"name":"ableit","email":"ychenid@live.com","commits":1}]},"readingTime":{"minutes":3.12,"words":935},"filePathRelative":"guide/database/mysql/backup/mysqldump.md","localizedDate":"2024年5月11日","autoDesc":true,"excerpt":"<h2>mysqldump备份</h2>\\n<h3>备份整个数据库</h3>\\n<div class=\\"language-bash\\" data-ext=\\"sh\\" data-title=\\"sh\\"><pre class=\\"language-bash\\"><code><span class=\\"token comment\\"># 使用 --skip-opt参数</span>\\n<span class=\\"token comment\\"># mysqldump ​--skip-opt  --compress -uroot -p --all-databases &gt; /backup/mysqlbackup/ddi-all-databases-`date +%Y%m%d%H%M`.sql </span>\\n\\n<span class=\\"token comment\\"># mysqldump+gzip减少文件大小和降低网络传输</span>\\n<span class=\\"token comment\\"># mysqldump --lock-tables=0 -uroot -p --all-databases | gzip &gt; /backup/mysqlbackup/ddi-all-databases-`date +%Y%m%d%H%M`.sql.gz</span>\\n\\n<span class=\\"token comment\\"># mysqldump+compres参数降低网络传输</span>\\nmysqldump --lock-tables<span class=\\"token operator\\">=</span><span class=\\"token number\\">0</span> <span class=\\"token parameter variable\\">--compress</span> <span class=\\"token parameter variable\\">-uroot</span> <span class=\\"token parameter variable\\">-p</span> --all-databases <span class=\\"token operator\\">&gt;</span> /backup/mysqlbackup/ddi-all-databases-<span class=\\"token variable\\"><span class=\\"token variable\\">`</span><span class=\\"token function\\">date</span> +%Y%m%d%H%M<span class=\\"token variable\\">`</span></span>.sql\\n</code></pre></div>"}');export{r as comp,u as data};
